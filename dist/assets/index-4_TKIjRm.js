var e,t,s,i,a,n,r,o,l,c,h,u,d,p,f,m,g,y,b,v,w,x,k,A,S,E,T,P,C,M,B,R,D,N,_,F,O,L,I,j,H,V,G,U,z,W,Q,q,K,Z,J,X,$,Y,ee,te,se,ie,ae,ne,re,oe,le,ce,he,ue,de,pe,fe,me,ge,ye,be,ve,we,xe,ke,Ae,Se,Ee,Te,Pe,Ce,Me,Be,Re,De,Ne,_e,Fe,Oe,Le,Ie,je,He,Ve,Ge,Ue,ze,We,Qe,qe,Ke,Ze,Je,Xe,$e,Ye,et,tt,st,it,at,nt,rt,ot,lt,ct,ht,ut,dt,pt,ft,mt,gt,yt,bt,vt,wt,xt,kt,At,St,Et,Tt,Pt,Ct,Mt,Bt,Rt,Dt,Nt,_t,Ft,Ot,Lt,It,jt,Ht,Vt,Gt,Ut,zt,Wt,Qt,qt,Kt,Zt,Jt,Xt,$t,Yt,es,ts,ss,is,as,ns,rs,os,ls,cs,hs,us,ds,ps,fs,ms,gs,ys,bs,vs,ws,xs,ks,As,Ss,Es,Ts,Ps,Cs,Ms,Bs,Rs,Ds,Ns,_s,Fs,Os,Ls,Is,js,Hs,Vs,Gs,Us,zs,Ws,Qs,qs,Ks,Zs,Js,Xs,$s,Ys,ei,ti,si,ii,ai,ni,ri,oi,li,ci,hi,ui,di,pi,fi,mi,gi,yi,bi,vi,wi,xi=Object.defineProperty,ki=e=>{throw TypeError(e)},Ai=(e,t,s)=>((e,t,s)=>t in e?xi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s),Si=(e,t,s)=>t.has(e)||ki("Cannot "+s),Ei=(e,t,s)=>(Si(e,t,"read from private field"),s?s.call(e):t.get(e)),Ti=(e,t,s)=>t.has(e)?ki("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),Pi=(e,t,s,i)=>(Si(e,t,"write to private field"),i?i.call(e,s):t.set(e,s),s),Ci=(e,t,s)=>(Si(e,t,"access private method"),s),Mi=(e,t,s,i)=>({set _(i){Pi(e,t,i,s)},get _(){return Ei(e,t,i)}});import{g as Bi,P as Ri}from"./phaser-CPm-u6kw.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var Di={exports:{}},Ni={},_i={exports:{}},Fi={},Oi=Symbol.for("react.element"),Li=Symbol.for("react.portal"),Ii=Symbol.for("react.fragment"),ji=Symbol.for("react.strict_mode"),Hi=Symbol.for("react.profiler"),Vi=Symbol.for("react.provider"),Gi=Symbol.for("react.context"),Ui=Symbol.for("react.forward_ref"),zi=Symbol.for("react.suspense"),Wi=Symbol.for("react.memo"),Qi=Symbol.for("react.lazy"),qi=Symbol.iterator,Ki={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Zi=Object.assign,Ji={};function Xi(e,t,s){this.props=e,this.context=t,this.refs=Ji,this.updater=s||Ki}function $i(){}function Yi(e,t,s){this.props=e,this.context=t,this.refs=Ji,this.updater=s||Ki}Xi.prototype.isReactComponent={},Xi.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},Xi.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},$i.prototype=Xi.prototype;var ea=Yi.prototype=new $i;ea.constructor=Yi,Zi(ea,Xi.prototype),ea.isPureReactComponent=!0;var ta=Array.isArray,sa=Object.prototype.hasOwnProperty,ia={current:null},aa={key:!0,ref:!0,__self:!0,__source:!0};function na(e,t,s){var i,a={},n=null,r=null;if(null!=t)for(i in void 0!==t.ref&&(r=t.ref),void 0!==t.key&&(n=""+t.key),t)sa.call(t,i)&&!aa.hasOwnProperty(i)&&(a[i]=t[i]);var o=arguments.length-2;if(1===o)a.children=s;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(i in o=e.defaultProps)void 0===a[i]&&(a[i]=o[i]);return{$$typeof:Oi,type:e,key:n,ref:r,props:a,_owner:ia.current}}function ra(e){return"object"==typeof e&&null!==e&&e.$$typeof===Oi}var oa=/\/+/g;function la(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function ca(e,t,s,i,a){var n=typeof e;"undefined"!==n&&"boolean"!==n||(e=null);var r=!1;if(null===e)r=!0;else switch(n){case"string":case"number":r=!0;break;case"object":switch(e.$$typeof){case Oi:case Li:r=!0}}if(r)return a=a(r=e),e=""===i?"."+la(r,0):i,ta(a)?(s="",null!=e&&(s=e.replace(oa,"$&/")+"/"),ca(a,t,s,"",(function(e){return e}))):null!=a&&(ra(a)&&(a=function(e,t){return{$$typeof:Oi,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,s+(!a.key||r&&r.key===a.key?"":(""+a.key).replace(oa,"$&/")+"/")+e)),t.push(a)),1;if(r=0,i=""===i?".":i+":",ta(e))for(var o=0;o<e.length;o++){var l=i+la(n=e[o],o);r+=ca(n,t,s,l,a)}else if(l=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=qi&&e[qi]||e["@@iterator"])?e:null}(e),"function"==typeof l)for(e=l.call(e),o=0;!(n=e.next()).done;)r+=ca(n=n.value,t,s,l=i+la(n,o++),a);else if("object"===n)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return r}function ha(e,t,s){if(null==e)return e;var i=[],a=0;return ca(e,i,"","",(function(e){return t.call(s,e,a++)})),i}function ua(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var da={current:null},pa={transition:null},fa={ReactCurrentDispatcher:da,ReactCurrentBatchConfig:pa,ReactCurrentOwner:ia};function ma(){throw Error("act(...) is not supported in production builds of React.")}Fi.Children={map:ha,forEach:function(e,t,s){ha(e,(function(){t.apply(this,arguments)}),s)},count:function(e){var t=0;return ha(e,(function(){t++})),t},toArray:function(e){return ha(e,(function(e){return e}))||[]},only:function(e){if(!ra(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},Fi.Component=Xi,Fi.Fragment=Ii,Fi.Profiler=Hi,Fi.PureComponent=Yi,Fi.StrictMode=ji,Fi.Suspense=zi,Fi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fa,Fi.act=ma,Fi.cloneElement=function(e,t,s){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=Zi({},e.props),a=e.key,n=e.ref,r=e._owner;if(null!=t){if(void 0!==t.ref&&(n=t.ref,r=ia.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)sa.call(t,l)&&!aa.hasOwnProperty(l)&&(i[l]=void 0===t[l]&&void 0!==o?o[l]:t[l])}var l=arguments.length-2;if(1===l)i.children=s;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];i.children=o}return{$$typeof:Oi,type:e.type,key:a,ref:n,props:i,_owner:r}},Fi.createContext=function(e){return(e={$$typeof:Gi,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:Vi,_context:e},e.Consumer=e},Fi.createElement=na,Fi.createFactory=function(e){var t=na.bind(null,e);return t.type=e,t},Fi.createRef=function(){return{current:null}},Fi.forwardRef=function(e){return{$$typeof:Ui,render:e}},Fi.isValidElement=ra,Fi.lazy=function(e){return{$$typeof:Qi,_payload:{_status:-1,_result:e},_init:ua}},Fi.memo=function(e,t){return{$$typeof:Wi,type:e,compare:void 0===t?null:t}},Fi.startTransition=function(e){var t=pa.transition;pa.transition={};try{e()}finally{pa.transition=t}},Fi.unstable_act=ma,Fi.useCallback=function(e,t){return da.current.useCallback(e,t)},Fi.useContext=function(e){return da.current.useContext(e)},Fi.useDebugValue=function(){},Fi.useDeferredValue=function(e){return da.current.useDeferredValue(e)},Fi.useEffect=function(e,t){return da.current.useEffect(e,t)},Fi.useId=function(){return da.current.useId()},Fi.useImperativeHandle=function(e,t,s){return da.current.useImperativeHandle(e,t,s)},Fi.useInsertionEffect=function(e,t){return da.current.useInsertionEffect(e,t)},Fi.useLayoutEffect=function(e,t){return da.current.useLayoutEffect(e,t)},Fi.useMemo=function(e,t){return da.current.useMemo(e,t)},Fi.useReducer=function(e,t,s){return da.current.useReducer(e,t,s)},Fi.useRef=function(e){return da.current.useRef(e)},Fi.useState=function(e){return da.current.useState(e)},Fi.useSyncExternalStore=function(e,t,s){return da.current.useSyncExternalStore(e,t,s)},Fi.useTransition=function(){return da.current.useTransition()},Fi.version="18.3.1",_i.exports=Fi;var ga=_i.exports;const ya=Bi(ga);var ba=ga,va=Symbol.for("react.element"),wa=Symbol.for("react.fragment"),xa=Object.prototype.hasOwnProperty,ka=ba.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Aa={key:!0,ref:!0,__self:!0,__source:!0};function Sa(e,t,s){var i,a={},n=null,r=null;for(i in void 0!==s&&(n=""+s),void 0!==t.key&&(n=""+t.key),void 0!==t.ref&&(r=t.ref),t)xa.call(t,i)&&!Aa.hasOwnProperty(i)&&(a[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===a[i]&&(a[i]=t[i]);return{$$typeof:va,type:e,key:n,ref:r,props:a,_owner:ka.current}}Ni.Fragment=wa,Ni.jsx=Sa,Ni.jsxs=Sa,Di.exports=Ni;var Ea=Di.exports,Ta={},Pa={exports:{}},Ca={},Ma={exports:{}},Ba={};!function(e){function t(e,t){var s=e.length;e.push(t);e:for(;0<s;){var i=s-1>>>1,n=e[i];if(!(0<a(n,t)))break e;e[i]=t,e[s]=n,s=i}}function s(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],s=e.pop();if(s!==t){e[0]=s;e:for(var i=0,n=e.length,r=n>>>1;i<r;){var o=2*(i+1)-1,l=e[o],c=o+1,h=e[c];if(0>a(l,s))c<n&&0>a(h,l)?(e[i]=h,e[c]=s,i=c):(e[i]=l,e[o]=s,i=o);else{if(!(c<n&&0>a(h,s)))break e;e[i]=h,e[c]=s,i=c}}}return t}function a(e,t){var s=e.sortIndex-t.sortIndex;return 0!==s?s:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var n=performance;e.unstable_now=function(){return n.now()}}else{var r=Date,o=r.now();e.unstable_now=function(){return r.now()-o}}var l=[],c=[],h=1,u=null,d=3,p=!1,f=!1,m=!1,g="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function v(e){for(var a=s(c);null!==a;){if(null===a.callback)i(c);else{if(!(a.startTime<=e))break;i(c),a.sortIndex=a.expirationTime,t(l,a)}a=s(c)}}function w(e){if(m=!1,v(e),!f)if(null!==s(l))f=!0,D(x);else{var t=s(c);null!==t&&N(w,t.startTime-e)}}function x(t,a){f=!1,m&&(m=!1,y(E),E=-1),p=!0;var n=d;try{for(v(a),u=s(l);null!==u&&(!(u.expirationTime>a)||t&&!C());){var r=u.callback;if("function"==typeof r){u.callback=null,d=u.priorityLevel;var o=r(u.expirationTime<=a);a=e.unstable_now(),"function"==typeof o?u.callback=o:u===s(l)&&i(l),v(a)}else i(l);u=s(l)}if(null!==u)var h=!0;else{var g=s(c);null!==g&&N(w,g.startTime-a),h=!1}return h}finally{u=null,d=n,p=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,A=!1,S=null,E=-1,T=5,P=-1;function C(){return!(e.unstable_now()-P<T)}function M(){if(null!==S){var t=e.unstable_now();P=t;var s=!0;try{s=S(!0,t)}finally{s?k():(A=!1,S=null)}}else A=!1}if("function"==typeof b)k=function(){b(M)};else if("undefined"!=typeof MessageChannel){var B=new MessageChannel,R=B.port2;B.port1.onmessage=M,k=function(){R.postMessage(null)}}else k=function(){g(M,0)};function D(e){S=e,A||(A=!0,k())}function N(t,s){E=g((function(){t(e.unstable_now())}),s)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){f||p||(f=!0,D(x))},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return s(l)},e.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var s=d;d=t;try{return e()}finally{d=s}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var s=d;d=e;try{return t()}finally{d=s}},e.unstable_scheduleCallback=function(i,a,n){var r=e.unstable_now();switch(n="object"==typeof n&&null!==n&&"number"==typeof(n=n.delay)&&0<n?r+n:r,i){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return i={id:h++,callback:a,priorityLevel:i,startTime:n,expirationTime:o=n+o,sortIndex:-1},n>r?(i.sortIndex=n,t(c,i),null===s(l)&&i===s(c)&&(m?(y(E),E=-1):m=!0,N(w,n-r))):(i.sortIndex=o,t(l,i),f||p||(f=!0,D(x))),i},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(e){var t=d;return function(){var s=d;d=t;try{return e.apply(this,arguments)}finally{d=s}}}}(Ba),Ma.exports=Ba;var Ra=Ma.exports,Da=ga,Na=Ra;function _a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Fa=new Set,Oa={};function La(e,t){Ia(e,t),Ia(e+"Capture",t)}function Ia(e,t){for(Oa[e]=t,e=0;e<t.length;e++)Fa.add(t[e])}var ja=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),Ha=Object.prototype.hasOwnProperty,Va=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ga={},Ua={};function za(e,t,s,i,a,n,r){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=a,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=n,this.removeEmptyString=r}var Wa={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){Wa[e]=new za(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];Wa[t]=new za(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){Wa[e]=new za(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){Wa[e]=new za(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){Wa[e]=new za(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){Wa[e]=new za(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){Wa[e]=new za(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){Wa[e]=new za(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){Wa[e]=new za(e,5,!1,e.toLowerCase(),null,!1,!1)}));var Qa=/[\-:]([a-z])/g;function qa(e){return e[1].toUpperCase()}function Ka(e,t,s,i){var a=Wa.hasOwnProperty(t)?Wa[t]:null;(null!==a?0!==a.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,s,i){if(null==t||function(e,t,s,i){if(null!==s&&0===s.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==s?!s.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,s,i))return!0;if(i)return!1;if(null!==s)switch(s.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,s,a,i)&&(s=null),i||null===a?function(e){return!!Ha.call(Ua,e)||!Ha.call(Ga,e)&&(Va.test(e)?Ua[e]=!0:(Ga[e]=!0,!1))}(t)&&(null===s?e.removeAttribute(t):e.setAttribute(t,""+s)):a.mustUseProperty?e[a.propertyName]=null===s?3!==a.type&&"":s:(t=a.attributeName,i=a.attributeNamespace,null===s?e.removeAttribute(t):(s=3===(a=a.type)||4===a&&!0===s?"":""+s,i?e.setAttributeNS(i,t,s):e.setAttribute(t,s))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(Qa,qa);Wa[t]=new za(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(Qa,qa);Wa[t]=new za(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(Qa,qa);Wa[t]=new za(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){Wa[e]=new za(e,1,!1,e.toLowerCase(),null,!1,!1)})),Wa.xlinkHref=new za("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){Wa[e]=new za(e,1,!1,e.toLowerCase(),null,!0,!0)}));var Za=Da.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ja=Symbol.for("react.element"),Xa=Symbol.for("react.portal"),$a=Symbol.for("react.fragment"),Ya=Symbol.for("react.strict_mode"),en=Symbol.for("react.profiler"),tn=Symbol.for("react.provider"),sn=Symbol.for("react.context"),an=Symbol.for("react.forward_ref"),nn=Symbol.for("react.suspense"),rn=Symbol.for("react.suspense_list"),on=Symbol.for("react.memo"),ln=Symbol.for("react.lazy"),cn=Symbol.for("react.offscreen"),hn=Symbol.iterator;function un(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=hn&&e[hn]||e["@@iterator"])?e:null}var dn,pn=Object.assign;function fn(e){if(void 0===dn)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);dn=t&&t[1]||""}return"\n"+dn+e}var mn=!1;function gn(e,t){if(!e||mn)return"";mn=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"==typeof c.stack){for(var a=c.stack.split("\n"),n=i.stack.split("\n"),r=a.length-1,o=n.length-1;1<=r&&0<=o&&a[r]!==n[o];)o--;for(;1<=r&&0<=o;r--,o--)if(a[r]!==n[o]){if(1!==r||1!==o)do{if(r--,0>--o||a[r]!==n[o]){var l="\n"+a[r].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=r&&0<=o);break}}}finally{mn=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?fn(e):""}function yn(e){switch(e.tag){case 5:return fn(e.type);case 16:return fn("Lazy");case 13:return fn("Suspense");case 19:return fn("SuspenseList");case 0:case 2:case 15:return gn(e.type,!1);case 11:return gn(e.type.render,!1);case 1:return gn(e.type,!0);default:return""}}function bn(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case $a:return"Fragment";case Xa:return"Portal";case en:return"Profiler";case Ya:return"StrictMode";case nn:return"Suspense";case rn:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case sn:return(e.displayName||"Context")+".Consumer";case tn:return(e._context.displayName||"Context")+".Provider";case an:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case on:return null!==(t=e.displayName||null)?t:bn(e.type)||"Memo";case ln:t=e._payload,e=e._init;try{return bn(e(t))}catch(s){}}return null}function vn(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return bn(t);case 8:return t===Ya?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function wn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function xn(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function kn(e){e._valueTracker||(e._valueTracker=function(e){var t=xn(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==s&&"function"==typeof s.get&&"function"==typeof s.set){var a=s.get,n=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){i=""+e,n.call(this,e)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function An(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),i="";return e&&(i=xn(e)?e.checked?"true":"false":e.value),(e=i)!==s&&(t.setValue(e),!0)}function Sn(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function En(e,t){var s=t.checked;return pn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=s?s:e._wrapperState.initialChecked})}function Tn(e,t){var s=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;s=wn(null!=t.value?t.value:s),e._wrapperState={initialChecked:i,initialValue:s,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Pn(e,t){null!=(t=t.checked)&&Ka(e,"checked",t,!1)}function Cn(e,t){Pn(e,t);var s=wn(t.value),i=t.type;if(null!=s)"number"===i?(0===s&&""===e.value||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?Bn(e,t.type,s):t.hasOwnProperty("defaultValue")&&Bn(e,t.type,wn(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Mn(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}""!==(s=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==s&&(e.name=s)}function Bn(e,t,s){"number"===t&&Sn(e.ownerDocument)===e||(null==s?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var Rn=Array.isArray;function Dn(e,t,s,i){if(e=e.options,t){t={};for(var a=0;a<s.length;a++)t["$"+s[a]]=!0;for(s=0;s<e.length;s++)a=t.hasOwnProperty("$"+e[s].value),e[s].selected!==a&&(e[s].selected=a),a&&i&&(e[s].defaultSelected=!0)}else{for(s=""+wn(s),t=null,a=0;a<e.length;a++){if(e[a].value===s)return e[a].selected=!0,void(i&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function Nn(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(_a(91));return pn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function _n(e,t){var s=t.value;if(null==s){if(s=t.children,t=t.defaultValue,null!=s){if(null!=t)throw Error(_a(92));if(Rn(s)){if(1<s.length)throw Error(_a(93));s=s[0]}t=s}null==t&&(t=""),s=t}e._wrapperState={initialValue:wn(s)}}function Fn(e,t){var s=wn(t.value),i=wn(t.defaultValue);null!=s&&((s=""+s)!==e.value&&(e.value=s),null==t.defaultValue&&e.defaultValue!==s&&(e.defaultValue=s)),null!=i&&(e.defaultValue=""+i)}function On(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function Ln(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function In(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?Ln(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var jn,Hn,Vn=(Hn=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((jn=jn||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=jn.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,s,i){MSApp.execUnsafeLocalFunction((function(){return Hn(e,t)}))}:Hn);function Gn(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&3===s.nodeType)return void(s.nodeValue=t)}e.textContent=t}var Un={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},zn=["Webkit","ms","Moz","O"];function Wn(e,t,s){return null==t||"boolean"==typeof t||""===t?"":s||"number"!=typeof t||0===t||Un.hasOwnProperty(e)&&Un[e]?(""+t).trim():t+"px"}function Qn(e,t){for(var s in e=e.style,t)if(t.hasOwnProperty(s)){var i=0===s.indexOf("--"),a=Wn(s,t[s],i);"float"===s&&(s="cssFloat"),i?e.setProperty(s,a):e[s]=a}}Object.keys(Un).forEach((function(e){zn.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Un[t]=Un[e]}))}));var qn=pn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Kn(e,t){if(t){if(qn[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(_a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(_a(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(_a(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(_a(62))}}function Zn(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Jn=null;function Xn(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var $n=null,Yn=null,er=null;function tr(e){if(e=Zc(e)){if("function"!=typeof $n)throw Error(_a(280));var t=e.stateNode;t&&(t=Xc(t),$n(e.stateNode,e.type,t))}}function sr(e){Yn?er?er.push(e):er=[e]:Yn=e}function ir(){if(Yn){var e=Yn,t=er;if(er=Yn=null,tr(e),t)for(e=0;e<t.length;e++)tr(t[e])}}function ar(e,t){return e(t)}function nr(){}var rr=!1;function or(e,t,s){if(rr)return e(t,s);rr=!0;try{return ar(e,t,s)}finally{rr=!1,(null!==Yn||null!==er)&&(nr(),ir())}}function lr(e,t){var s=e.stateNode;if(null===s)return null;var i=Xc(s);if(null===i)return null;s=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(s&&"function"!=typeof s)throw Error(_a(231,t,typeof s));return s}var cr=!1;if(ja)try{var hr={};Object.defineProperty(hr,"passive",{get:function(){cr=!0}}),window.addEventListener("test",hr,hr),window.removeEventListener("test",hr,hr)}catch(Hn){cr=!1}function ur(e,t,s,i,a,n,r,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(s,c)}catch(h){this.onError(h)}}var dr=!1,pr=null,fr=!1,mr=null,gr={onError:function(e){dr=!0,pr=e}};function yr(e,t,s,i,a,n,r,o,l){dr=!1,pr=null,ur.apply(gr,arguments)}function br(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(s=t.return),e=t.return}while(e)}return 3===t.tag?s:null}function vr(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function wr(e){if(br(e)!==e)throw Error(_a(188))}function xr(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=br(e)))throw Error(_a(188));return t!==e?null:e}for(var s=e,i=t;;){var a=s.return;if(null===a)break;var n=a.alternate;if(null===n){if(null!==(i=a.return)){s=i;continue}break}if(a.child===n.child){for(n=a.child;n;){if(n===s)return wr(a),e;if(n===i)return wr(a),t;n=n.sibling}throw Error(_a(188))}if(s.return!==i.return)s=a,i=n;else{for(var r=!1,o=a.child;o;){if(o===s){r=!0,s=a,i=n;break}if(o===i){r=!0,i=a,s=n;break}o=o.sibling}if(!r){for(o=n.child;o;){if(o===s){r=!0,s=n,i=a;break}if(o===i){r=!0,i=n,s=a;break}o=o.sibling}if(!r)throw Error(_a(189))}}if(s.alternate!==i)throw Error(_a(190))}if(3!==s.tag)throw Error(_a(188));return s.stateNode.current===s?e:t}(e))?kr(e):null}function kr(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=kr(e);if(null!==t)return t;e=e.sibling}return null}var Ar=Na.unstable_scheduleCallback,Sr=Na.unstable_cancelCallback,Er=Na.unstable_shouldYield,Tr=Na.unstable_requestPaint,Pr=Na.unstable_now,Cr=Na.unstable_getCurrentPriorityLevel,Mr=Na.unstable_ImmediatePriority,Br=Na.unstable_UserBlockingPriority,Rr=Na.unstable_NormalPriority,Dr=Na.unstable_LowPriority,Nr=Na.unstable_IdlePriority,_r=null,Fr=null,Or=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(Lr(e)/Ir|0)|0},Lr=Math.log,Ir=Math.LN2,jr=64,Hr=4194304;function Vr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Gr(e,t){var s=e.pendingLanes;if(0===s)return 0;var i=0,a=e.suspendedLanes,n=e.pingedLanes,r=268435455&s;if(0!==r){var o=r&~a;0!==o?i=Vr(o):0!=(n&=r)&&(i=Vr(n))}else 0!=(r=s&~a)?i=Vr(r):0!==n&&(i=Vr(n));if(0===i)return 0;if(0!==t&&t!==i&&!(t&a)&&((a=i&-i)>=(n=t&-t)||16===a&&4194240&n))return t;if(4&i&&(i|=16&s),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)a=1<<(s=31-Or(t)),i|=e[s],t&=~a;return i}function Ur(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function zr(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Wr(){var e=jr;return!(4194240&(jr<<=1))&&(jr=64),e}function Qr(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function qr(e,t,s){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-Or(t)]=s}function Kr(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var i=31-Or(s),a=1<<i;a&t|e[i]&t&&(e[i]|=t),s&=~a}}var Zr=0;function Jr(e){return 1<(e&=-e)?4<e?268435455&e?16:536870912:4:1}var Xr,$r,Yr,eo,to,so=!1,io=[],ao=null,no=null,ro=null,oo=new Map,lo=new Map,co=[],ho="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function uo(e,t){switch(e){case"focusin":case"focusout":ao=null;break;case"dragenter":case"dragleave":no=null;break;case"mouseover":case"mouseout":ro=null;break;case"pointerover":case"pointerout":oo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":lo.delete(t.pointerId)}}function po(e,t,s,i,a,n){return null===e||e.nativeEvent!==n?(e={blockedOn:t,domEventName:s,eventSystemFlags:i,nativeEvent:n,targetContainers:[a]},null!==t&&null!==(t=Zc(t))&&$r(t),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function fo(e){var t=Kc(e.target);if(null!==t){var s=br(t);if(null!==s)if(13===(t=s.tag)){if(null!==(t=vr(s)))return e.blockedOn=t,void to(e.priority,(function(){Yr(s)}))}else if(3===t&&s.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===s.tag?s.stateNode.containerInfo:null)}e.blockedOn=null}function mo(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var s=To(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==s)return null!==(t=Zc(s))&&$r(t),e.blockedOn=s,!1;var i=new(s=e.nativeEvent).constructor(s.type,s);Jn=i,s.target.dispatchEvent(i),Jn=null,t.shift()}return!0}function go(e,t,s){mo(e)&&s.delete(t)}function yo(){so=!1,null!==ao&&mo(ao)&&(ao=null),null!==no&&mo(no)&&(no=null),null!==ro&&mo(ro)&&(ro=null),oo.forEach(go),lo.forEach(go)}function bo(e,t){e.blockedOn===t&&(e.blockedOn=null,so||(so=!0,Na.unstable_scheduleCallback(Na.unstable_NormalPriority,yo)))}function vo(e){function t(t){return bo(t,e)}if(0<io.length){bo(io[0],e);for(var s=1;s<io.length;s++){var i=io[s];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==ao&&bo(ao,e),null!==no&&bo(no,e),null!==ro&&bo(ro,e),oo.forEach(t),lo.forEach(t),s=0;s<co.length;s++)(i=co[s]).blockedOn===e&&(i.blockedOn=null);for(;0<co.length&&null===(s=co[0]).blockedOn;)fo(s),null===s.blockedOn&&co.shift()}var wo=Za.ReactCurrentBatchConfig,xo=!0;function ko(e,t,s,i){var a=Zr,n=wo.transition;wo.transition=null;try{Zr=1,So(e,t,s,i)}finally{Zr=a,wo.transition=n}}function Ao(e,t,s,i){var a=Zr,n=wo.transition;wo.transition=null;try{Zr=4,So(e,t,s,i)}finally{Zr=a,wo.transition=n}}function So(e,t,s,i){if(xo){var a=To(e,t,s,i);if(null===a)wc(e,t,i,Eo,s),uo(e,i);else if(function(e,t,s,i,a){switch(t){case"focusin":return ao=po(ao,e,t,s,i,a),!0;case"dragenter":return no=po(no,e,t,s,i,a),!0;case"mouseover":return ro=po(ro,e,t,s,i,a),!0;case"pointerover":var n=a.pointerId;return oo.set(n,po(oo.get(n)||null,e,t,s,i,a)),!0;case"gotpointercapture":return n=a.pointerId,lo.set(n,po(lo.get(n)||null,e,t,s,i,a)),!0}return!1}(a,e,t,s,i))i.stopPropagation();else if(uo(e,i),4&t&&-1<ho.indexOf(e)){for(;null!==a;){var n=Zc(a);if(null!==n&&Xr(n),null===(n=To(e,t,s,i))&&wc(e,t,i,Eo,s),n===a)break;a=n}null!==a&&i.stopPropagation()}else wc(e,t,i,null,s)}}var Eo=null;function To(e,t,s,i){if(Eo=null,null!==(e=Kc(e=Xn(i))))if(null===(t=br(e)))e=null;else if(13===(s=t.tag)){if(null!==(e=vr(t)))return e;e=null}else if(3===s){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Eo=e,null}function Po(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Cr()){case Mr:return 1;case Br:return 4;case Rr:case Dr:return 16;case Nr:return 536870912;default:return 16}default:return 16}}var Co=null,Mo=null,Bo=null;function Ro(){if(Bo)return Bo;var e,t,s=Mo,i=s.length,a="value"in Co?Co.value:Co.textContent,n=a.length;for(e=0;e<i&&s[e]===a[e];e++);var r=i-e;for(t=1;t<=r&&s[i-t]===a[n-t];t++);return Bo=a.slice(e,1<t?1-t:void 0)}function Do(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function No(){return!0}function _o(){return!1}function Fo(e){function t(t,s,i,a,n){for(var r in this._reactName=t,this._targetInst=i,this.type=s,this.nativeEvent=a,this.target=n,this.currentTarget=null,e)e.hasOwnProperty(r)&&(t=e[r],this[r]=t?t(a):a[r]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?No:_o,this.isPropagationStopped=_o,this}return pn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=No)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=No)},persist:function(){},isPersistent:No}),t}var Oo,Lo,Io,jo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ho=Fo(jo),Vo=pn({},jo,{view:0,detail:0}),Go=Fo(Vo),Uo=pn({},Vo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tl,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Io&&(Io&&"mousemove"===e.type?(Oo=e.screenX-Io.screenX,Lo=e.screenY-Io.screenY):Lo=Oo=0,Io=e),Oo)},movementY:function(e){return"movementY"in e?e.movementY:Lo}}),zo=Fo(Uo),Wo=Fo(pn({},Uo,{dataTransfer:0})),Qo=Fo(pn({},Vo,{relatedTarget:0})),qo=Fo(pn({},jo,{animationName:0,elapsedTime:0,pseudoElement:0})),Ko=pn({},jo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Zo=Fo(Ko),Jo=Fo(pn({},jo,{data:0})),Xo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$o={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yo={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function el(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Yo[e])&&!!t[e]}function tl(){return el}var sl=pn({},Vo,{key:function(e){if(e.key){var t=Xo[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Do(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?$o[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tl,charCode:function(e){return"keypress"===e.type?Do(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Do(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),il=Fo(sl),al=Fo(pn({},Uo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),nl=Fo(pn({},Vo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tl})),rl=Fo(pn({},jo,{propertyName:0,elapsedTime:0,pseudoElement:0})),ol=pn({},Uo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ll=Fo(ol),cl=[9,13,27,32],hl=ja&&"CompositionEvent"in window,ul=null;ja&&"documentMode"in document&&(ul=document.documentMode);var dl=ja&&"TextEvent"in window&&!ul,pl=ja&&(!hl||ul&&8<ul&&11>=ul),fl=String.fromCharCode(32),ml=!1;function gl(e,t){switch(e){case"keyup":return-1!==cl.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yl(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var bl=!1,vl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wl(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!vl[e.type]:"textarea"===t}function xl(e,t,s,i){sr(i),0<(t=kc(t,"onChange")).length&&(s=new Ho("onChange","change",null,s,i),e.push({event:s,listeners:t}))}var kl=null,Al=null;function Sl(e){fc(e,0)}function El(e){if(An(Jc(e)))return e}function Tl(e,t){if("change"===e)return t}var Pl=!1;if(ja){var Cl;if(ja){var Ml="oninput"in document;if(!Ml){var Bl=document.createElement("div");Bl.setAttribute("oninput","return;"),Ml="function"==typeof Bl.oninput}Cl=Ml}else Cl=!1;Pl=Cl&&(!document.documentMode||9<document.documentMode)}function Rl(){kl&&(kl.detachEvent("onpropertychange",Dl),Al=kl=null)}function Dl(e){if("value"===e.propertyName&&El(Al)){var t=[];xl(t,Al,e,Xn(e)),or(Sl,t)}}function Nl(e,t,s){"focusin"===e?(Rl(),Al=s,(kl=t).attachEvent("onpropertychange",Dl)):"focusout"===e&&Rl()}function _l(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return El(Al)}function Fl(e,t){if("click"===e)return El(t)}function Ol(e,t){if("input"===e||"change"===e)return El(t)}var Ll="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function Il(e,t){if(Ll(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var s=Object.keys(e),i=Object.keys(t);if(s.length!==i.length)return!1;for(i=0;i<s.length;i++){var a=s[i];if(!Ha.call(t,a)||!Ll(e[a],t[a]))return!1}return!0}function jl(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Hl(e,t){var s,i=jl(e);for(e=0;i;){if(3===i.nodeType){if(s=e+i.textContent.length,e<=t&&s>=t)return{node:i,offset:t-e};e=s}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=jl(i)}}function Vl(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Vl(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function Gl(){for(var e=window,t=Sn();t instanceof e.HTMLIFrameElement;){try{var s="string"==typeof t.contentWindow.location.href}catch(i){s=!1}if(!s)break;t=Sn((e=t.contentWindow).document)}return t}function Ul(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function zl(e){var t=Gl(),s=e.focusedElem,i=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&Vl(s.ownerDocument.documentElement,s)){if(null!==i&&Ul(s))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if((e=(t=s.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=s.textContent.length,n=Math.min(i.start,a);i=void 0===i.end?n:Math.min(i.end,a),!e.extend&&n>i&&(a=i,i=n,n=a),a=Hl(s,n);var r=Hl(s,i);a&&r&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==r.node||e.focusOffset!==r.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),n>i?(e.addRange(t),e.extend(r.node,r.offset)):(t.setEnd(r.node,r.offset),e.addRange(t)))}for(t=[],e=s;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof s.focus&&s.focus(),s=0;s<t.length;s++)(e=t[s]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Wl=ja&&"documentMode"in document&&11>=document.documentMode,Ql=null,ql=null,Kl=null,Zl=!1;function Jl(e,t,s){var i=s.window===s?s.document:9===s.nodeType?s:s.ownerDocument;Zl||null==Ql||Ql!==Sn(i)||(i="selectionStart"in(i=Ql)&&Ul(i)?{start:i.selectionStart,end:i.selectionEnd}:{anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},Kl&&Il(Kl,i)||(Kl=i,0<(i=kc(ql,"onSelect")).length&&(t=new Ho("onSelect","select",null,t,s),e.push({event:t,listeners:i}),t.target=Ql)))}function Xl(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var $l={animationend:Xl("Animation","AnimationEnd"),animationiteration:Xl("Animation","AnimationIteration"),animationstart:Xl("Animation","AnimationStart"),transitionend:Xl("Transition","TransitionEnd")},Yl={},ec={};function tc(e){if(Yl[e])return Yl[e];if(!$l[e])return e;var t,s=$l[e];for(t in s)if(s.hasOwnProperty(t)&&t in ec)return Yl[e]=s[t];return e}ja&&(ec=document.createElement("div").style,"AnimationEvent"in window||(delete $l.animationend.animation,delete $l.animationiteration.animation,delete $l.animationstart.animation),"TransitionEvent"in window||delete $l.transitionend.transition);var sc=tc("animationend"),ic=tc("animationiteration"),ac=tc("animationstart"),nc=tc("transitionend"),rc=new Map,oc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function lc(e,t){rc.set(e,t),La(t,[e])}for(var cc=0;cc<oc.length;cc++){var hc=oc[cc];lc(hc.toLowerCase(),"on"+(hc[0].toUpperCase()+hc.slice(1)))}lc(sc,"onAnimationEnd"),lc(ic,"onAnimationIteration"),lc(ac,"onAnimationStart"),lc("dblclick","onDoubleClick"),lc("focusin","onFocus"),lc("focusout","onBlur"),lc(nc,"onTransitionEnd"),Ia("onMouseEnter",["mouseout","mouseover"]),Ia("onMouseLeave",["mouseout","mouseover"]),Ia("onPointerEnter",["pointerout","pointerover"]),Ia("onPointerLeave",["pointerout","pointerover"]),La("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),La("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),La("onBeforeInput",["compositionend","keypress","textInput","paste"]),La("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),La("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),La("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var uc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dc=new Set("cancel close invalid load scroll toggle".split(" ").concat(uc));function pc(e,t,s){var i=e.type||"unknown-event";e.currentTarget=s,function(e,t,s,i,a,n,r,o,l){if(yr.apply(this,arguments),dr){if(!dr)throw Error(_a(198));var c=pr;dr=!1,pr=null,fr||(fr=!0,mr=c)}}(i,t,void 0,e),e.currentTarget=null}function fc(e,t){t=!!(4&t);for(var s=0;s<e.length;s++){var i=e[s],a=i.event;i=i.listeners;e:{var n=void 0;if(t)for(var r=i.length-1;0<=r;r--){var o=i[r],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==n&&a.isPropagationStopped())break e;pc(a,o,c),n=l}else for(r=0;r<i.length;r++){if(l=(o=i[r]).instance,c=o.currentTarget,o=o.listener,l!==n&&a.isPropagationStopped())break e;pc(a,o,c),n=l}}}if(fr)throw e=mr,fr=!1,mr=null,e}function mc(e,t){var s=t[Wc];void 0===s&&(s=t[Wc]=new Set);var i=e+"__bubble";s.has(i)||(vc(t,e,2,!1),s.add(i))}function gc(e,t,s){var i=0;t&&(i|=4),vc(s,e,i,t)}var yc="_reactListening"+Math.random().toString(36).slice(2);function bc(e){if(!e[yc]){e[yc]=!0,Fa.forEach((function(t){"selectionchange"!==t&&(dc.has(t)||gc(t,!1,e),gc(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[yc]||(t[yc]=!0,gc("selectionchange",!1,t))}}function vc(e,t,s,i){switch(Po(t)){case 1:var a=ko;break;case 4:a=Ao;break;default:a=So}s=a.bind(null,t,s,e),a=void 0,!cr||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),i?void 0!==a?e.addEventListener(t,s,{capture:!0,passive:a}):e.addEventListener(t,s,!0):void 0!==a?e.addEventListener(t,s,{passive:a}):e.addEventListener(t,s,!1)}function wc(e,t,s,i,a){var n=i;if(!(1&t||2&t||null===i))e:for(;;){if(null===i)return;var r=i.tag;if(3===r||4===r){var o=i.stateNode.containerInfo;if(o===a||8===o.nodeType&&o.parentNode===a)break;if(4===r)for(r=i.return;null!==r;){var l=r.tag;if((3===l||4===l)&&((l=r.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;r=r.return}for(;null!==o;){if(null===(r=Kc(o)))return;if(5===(l=r.tag)||6===l){i=n=r;continue e}o=o.parentNode}}i=i.return}or((function(){var i=n,a=Xn(s),r=[];e:{var o=rc.get(e);if(void 0!==o){var l=Ho,c=e;switch(e){case"keypress":if(0===Do(s))break e;case"keydown":case"keyup":l=il;break;case"focusin":c="focus",l=Qo;break;case"focusout":c="blur",l=Qo;break;case"beforeblur":case"afterblur":l=Qo;break;case"click":if(2===s.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=zo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=Wo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=nl;break;case sc:case ic:case ac:l=qo;break;case nc:l=rl;break;case"scroll":l=Go;break;case"wheel":l=ll;break;case"copy":case"cut":case"paste":l=Zo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=al}var h=!!(4&t),u=!h&&"scroll"===e,d=h?null!==o?o+"Capture":null:o;h=[];for(var p,f=i;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==d&&null!=(m=lr(f,d))&&h.push(xc(f,m,p))),u)break;f=f.return}0<h.length&&(o=new l(o,c,null,s,a),r.push({event:o,listeners:h}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||s===Jn||!(c=s.relatedTarget||s.fromElement)||!Kc(c)&&!c[zc])&&(l||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=i,null!==(c=(c=s.relatedTarget||s.toElement)?Kc(c):null)&&(c!==(u=br(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(h=zo,m="onMouseLeave",d="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(h=al,m="onPointerLeave",d="onPointerEnter",f="pointer"),u=null==l?o:Jc(l),p=null==c?o:Jc(c),(o=new h(m,f+"leave",l,s,a)).target=u,o.relatedTarget=p,m=null,Kc(a)===i&&((h=new h(d,f+"enter",c,s,a)).target=p,h.relatedTarget=u,m=h),u=m,l&&c)e:{for(d=c,f=0,p=h=l;p;p=Ac(p))f++;for(p=0,m=d;m;m=Ac(m))p++;for(;0<f-p;)h=Ac(h),f--;for(;0<p-f;)d=Ac(d),p--;for(;f--;){if(h===d||null!==d&&h===d.alternate)break e;h=Ac(h),d=Ac(d)}h=null}else h=null;null!==l&&Sc(r,o,l,h,!1),null!==c&&null!==u&&Sc(r,u,c,h,!0)}if("select"===(l=(o=i?Jc(i):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Tl;else if(wl(o))if(Pl)g=Ol;else{g=_l;var y=Nl}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=Fl);switch(g&&(g=g(e,i))?xl(r,g,s,a):(y&&y(e,o,i),"focusout"===e&&(y=o._wrapperState)&&y.controlled&&"number"===o.type&&Bn(o,"number",o.value)),y=i?Jc(i):window,e){case"focusin":(wl(y)||"true"===y.contentEditable)&&(Ql=y,ql=i,Kl=null);break;case"focusout":Kl=ql=Ql=null;break;case"mousedown":Zl=!0;break;case"contextmenu":case"mouseup":case"dragend":Zl=!1,Jl(r,s,a);break;case"selectionchange":if(Wl)break;case"keydown":case"keyup":Jl(r,s,a)}var b;if(hl)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else bl?gl(e,s)&&(v="onCompositionEnd"):"keydown"===e&&229===s.keyCode&&(v="onCompositionStart");v&&(pl&&"ko"!==s.locale&&(bl||"onCompositionStart"!==v?"onCompositionEnd"===v&&bl&&(b=Ro()):(Mo="value"in(Co=a)?Co.value:Co.textContent,bl=!0)),0<(y=kc(i,v)).length&&(v=new Jo(v,e,null,s,a),r.push({event:v,listeners:y}),(b||null!==(b=yl(s)))&&(v.data=b))),(b=dl?function(e,t){switch(e){case"compositionend":return yl(t);case"keypress":return 32!==t.which?null:(ml=!0,fl);case"textInput":return(e=t.data)===fl&&ml?null:e;default:return null}}(e,s):function(e,t){if(bl)return"compositionend"===e||!hl&&gl(e,t)?(e=Ro(),Bo=Mo=Co=null,bl=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return pl&&"ko"!==t.locale?null:t.data}}(e,s))&&0<(i=kc(i,"onBeforeInput")).length&&(a=new Jo("onBeforeInput","beforeinput",null,s,a),r.push({event:a,listeners:i}),a.data=b)}fc(r,t)}))}function xc(e,t,s){return{instance:e,listener:t,currentTarget:s}}function kc(e,t){for(var s=t+"Capture",i=[];null!==e;){var a=e,n=a.stateNode;5===a.tag&&null!==n&&(a=n,null!=(n=lr(e,s))&&i.unshift(xc(e,n,a)),null!=(n=lr(e,t))&&i.push(xc(e,n,a))),e=e.return}return i}function Ac(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Sc(e,t,s,i,a){for(var n=t._reactName,r=[];null!==s&&s!==i;){var o=s,l=o.alternate,c=o.stateNode;if(null!==l&&l===i)break;5===o.tag&&null!==c&&(o=c,a?null!=(l=lr(s,n))&&r.unshift(xc(s,l,o)):a||null!=(l=lr(s,n))&&r.push(xc(s,l,o))),s=s.return}0!==r.length&&e.push({event:t,listeners:r})}var Ec=/\r\n?/g,Tc=/\u0000|\uFFFD/g;function Pc(e){return("string"==typeof e?e:""+e).replace(Ec,"\n").replace(Tc,"")}function Cc(e,t,s){if(t=Pc(t),Pc(e)!==t&&s)throw Error(_a(425))}function Mc(){}var Bc=null,Rc=null;function Dc(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Nc="function"==typeof setTimeout?setTimeout:void 0,_c="function"==typeof clearTimeout?clearTimeout:void 0,Fc="function"==typeof Promise?Promise:void 0,Oc="function"==typeof queueMicrotask?queueMicrotask:void 0!==Fc?function(e){return Fc.resolve(null).then(e).catch(Lc)}:Nc;function Lc(e){setTimeout((function(){throw e}))}function Ic(e,t){var s=t,i=0;do{var a=s.nextSibling;if(e.removeChild(s),a&&8===a.nodeType)if("/$"===(s=a.data)){if(0===i)return e.removeChild(a),void vo(t);i--}else"$"!==s&&"$?"!==s&&"$!"!==s||i++;s=a}while(s);vo(t)}function jc(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function Hc(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var s=e.data;if("$"===s||"$!"===s||"$?"===s){if(0===t)return e;t--}else"/$"===s&&t++}e=e.previousSibling}return null}var Vc=Math.random().toString(36).slice(2),Gc="__reactFiber$"+Vc,Uc="__reactProps$"+Vc,zc="__reactContainer$"+Vc,Wc="__reactEvents$"+Vc,Qc="__reactListeners$"+Vc,qc="__reactHandles$"+Vc;function Kc(e){var t=e[Gc];if(t)return t;for(var s=e.parentNode;s;){if(t=s[zc]||s[Gc]){if(s=t.alternate,null!==t.child||null!==s&&null!==s.child)for(e=Hc(e);null!==e;){if(s=e[Gc])return s;e=Hc(e)}return t}s=(e=s).parentNode}return null}function Zc(e){return!(e=e[Gc]||e[zc])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Jc(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(_a(33))}function Xc(e){return e[Uc]||null}var $c=[],Yc=-1;function eh(e){return{current:e}}function th(e){0>Yc||(e.current=$c[Yc],$c[Yc]=null,Yc--)}function sh(e,t){Yc++,$c[Yc]=e.current,e.current=t}var ih={},ah=eh(ih),nh=eh(!1),rh=ih;function oh(e,t){var s=e.type.contextTypes;if(!s)return ih;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var a,n={};for(a in s)n[a]=t[a];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function lh(e){return null!=e.childContextTypes}function ch(){th(nh),th(ah)}function hh(e,t,s){if(ah.current!==ih)throw Error(_a(168));sh(ah,t),sh(nh,s)}function uh(e,t,s){var i=e.stateNode;if(t=t.childContextTypes,"function"!=typeof i.getChildContext)return s;for(var a in i=i.getChildContext())if(!(a in t))throw Error(_a(108,vn(e)||"Unknown",a));return pn({},s,i)}function dh(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ih,rh=ah.current,sh(ah,e),sh(nh,nh.current),!0}function ph(e,t,s){var i=e.stateNode;if(!i)throw Error(_a(169));s?(e=uh(e,t,rh),i.__reactInternalMemoizedMergedChildContext=e,th(nh),th(ah),sh(ah,e)):th(nh),sh(nh,s)}var fh=null,mh=!1,gh=!1;function yh(e){null===fh?fh=[e]:fh.push(e)}function bh(){if(!gh&&null!==fh){gh=!0;var e=0,t=Zr;try{var s=fh;for(Zr=1;e<s.length;e++){var i=s[e];do{i=i(!0)}while(null!==i)}fh=null,mh=!1}catch(a){throw null!==fh&&(fh=fh.slice(e+1)),Ar(Mr,bh),a}finally{Zr=t,gh=!1}}return null}var vh=[],wh=0,xh=null,kh=0,Ah=[],Sh=0,Eh=null,Th=1,Ph="";function Ch(e,t){vh[wh++]=kh,vh[wh++]=xh,xh=e,kh=t}function Mh(e,t,s){Ah[Sh++]=Th,Ah[Sh++]=Ph,Ah[Sh++]=Eh,Eh=e;var i=Th;e=Ph;var a=32-Or(i)-1;i&=~(1<<a),s+=1;var n=32-Or(t)+a;if(30<n){var r=a-a%5;n=(i&(1<<r)-1).toString(32),i>>=r,a-=r,Th=1<<32-Or(t)+a|s<<a|i,Ph=n+e}else Th=1<<n|s<<a|i,Ph=e}function Bh(e){null!==e.return&&(Ch(e,1),Mh(e,1,0))}function Rh(e){for(;e===xh;)xh=vh[--wh],vh[wh]=null,kh=vh[--wh],vh[wh]=null;for(;e===Eh;)Eh=Ah[--Sh],Ah[Sh]=null,Ph=Ah[--Sh],Ah[Sh]=null,Th=Ah[--Sh],Ah[Sh]=null}var Dh=null,Nh=null,_h=!1,Fh=null;function Oh(e,t){var s=om(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,null===(t=e.deletions)?(e.deletions=[s],e.flags|=16):t.push(s)}function Lh(e,t){switch(e.tag){case 5:var s=e.type;return null!==(t=1!==t.nodeType||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,Dh=e,Nh=jc(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,Dh=e,Nh=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(s=null!==Eh?{id:Th,overflow:Ph}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},(s=om(18,null,null,0)).stateNode=t,s.return=e,e.child=s,Dh=e,Nh=null,!0);default:return!1}}function Ih(e){return!(!(1&e.mode)||128&e.flags)}function jh(e){if(_h){var t=Nh;if(t){var s=t;if(!Lh(e,t)){if(Ih(e))throw Error(_a(418));t=jc(s.nextSibling);var i=Dh;t&&Lh(e,t)?Oh(i,s):(e.flags=-4097&e.flags|2,_h=!1,Dh=e)}}else{if(Ih(e))throw Error(_a(418));e.flags=-4097&e.flags|2,_h=!1,Dh=e}}}function Hh(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Dh=e}function Vh(e){if(e!==Dh)return!1;if(!_h)return Hh(e),_h=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!Dc(e.type,e.memoizedProps)),t&&(t=Nh)){if(Ih(e))throw Gh(),Error(_a(418));for(;t;)Oh(e,t),t=jc(t.nextSibling)}if(Hh(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(_a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var s=e.data;if("/$"===s){if(0===t){Nh=jc(e.nextSibling);break e}t--}else"$"!==s&&"$!"!==s&&"$?"!==s||t++}e=e.nextSibling}Nh=null}}else Nh=Dh?jc(e.stateNode.nextSibling):null;return!0}function Gh(){for(var e=Nh;e;)e=jc(e.nextSibling)}function Uh(){Nh=Dh=null,_h=!1}function zh(e){null===Fh?Fh=[e]:Fh.push(e)}var Wh=Za.ReactCurrentBatchConfig;function Qh(e,t,s){if(null!==(e=s.ref)&&"function"!=typeof e&&"object"!=typeof e){if(s._owner){if(s=s._owner){if(1!==s.tag)throw Error(_a(309));var i=s.stateNode}if(!i)throw Error(_a(147,e));var a=i,n=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===n?t.ref:((t=function(e){var t=a.refs;null===e?delete t[n]:t[n]=e})._stringRef=n,t)}if("string"!=typeof e)throw Error(_a(284));if(!s._owner)throw Error(_a(290,e))}return e}function qh(e,t){throw e=Object.prototype.toString.call(t),Error(_a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Kh(e){return(0,e._init)(e._payload)}function Zh(e){function t(t,s){if(e){var i=t.deletions;null===i?(t.deletions=[s],t.flags|=16):i.push(s)}}function s(s,i){if(!e)return null;for(;null!==i;)t(s,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=cm(e,t)).index=0,e.sibling=null,e}function n(t,s,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<s?(t.flags|=2,s):i:(t.flags|=2,s):(t.flags|=1048576,s)}function r(t){return e&&null===t.alternate&&(t.flags|=2),t}function o(e,t,s,i){return null===t||6!==t.tag?((t=pm(s,e.mode,i)).return=e,t):((t=a(t,s)).return=e,t)}function l(e,t,s,i){var n=s.type;return n===$a?h(e,t,s.props.children,i,s.key):null!==t&&(t.elementType===n||"object"==typeof n&&null!==n&&n.$$typeof===ln&&Kh(n)===t.type)?((i=a(t,s.props)).ref=Qh(e,t,s),i.return=e,i):((i=hm(s.type,s.key,s.props,null,e.mode,i)).ref=Qh(e,t,s),i.return=e,i)}function c(e,t,s,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==s.containerInfo||t.stateNode.implementation!==s.implementation?((t=fm(s,e.mode,i)).return=e,t):((t=a(t,s.children||[])).return=e,t)}function h(e,t,s,i,n){return null===t||7!==t.tag?((t=um(s,e.mode,i,n)).return=e,t):((t=a(t,s)).return=e,t)}function u(e,t,s){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=pm(""+t,e.mode,s)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case Ja:return(s=hm(t.type,t.key,t.props,null,e.mode,s)).ref=Qh(e,null,t),s.return=e,s;case Xa:return(t=fm(t,e.mode,s)).return=e,t;case ln:return u(e,(0,t._init)(t._payload),s)}if(Rn(t)||un(t))return(t=um(t,e.mode,s,null)).return=e,t;qh(e,t)}return null}function d(e,t,s,i){var a=null!==t?t.key:null;if("string"==typeof s&&""!==s||"number"==typeof s)return null!==a?null:o(e,t,""+s,i);if("object"==typeof s&&null!==s){switch(s.$$typeof){case Ja:return s.key===a?l(e,t,s,i):null;case Xa:return s.key===a?c(e,t,s,i):null;case ln:return d(e,t,(a=s._init)(s._payload),i)}if(Rn(s)||un(s))return null!==a?null:h(e,t,s,i,null);qh(e,s)}return null}function p(e,t,s,i,a){if("string"==typeof i&&""!==i||"number"==typeof i)return o(t,e=e.get(s)||null,""+i,a);if("object"==typeof i&&null!==i){switch(i.$$typeof){case Ja:return l(t,e=e.get(null===i.key?s:i.key)||null,i,a);case Xa:return c(t,e=e.get(null===i.key?s:i.key)||null,i,a);case ln:return p(e,t,s,(0,i._init)(i._payload),a)}if(Rn(i)||un(i))return h(t,e=e.get(s)||null,i,a,null);qh(t,i)}return null}return function o(l,c,h,f){if("object"==typeof h&&null!==h&&h.type===$a&&null===h.key&&(h=h.props.children),"object"==typeof h&&null!==h){switch(h.$$typeof){case Ja:e:{for(var m=h.key,g=c;null!==g;){if(g.key===m){if((m=h.type)===$a){if(7===g.tag){s(l,g.sibling),(c=a(g,h.props.children)).return=l,l=c;break e}}else if(g.elementType===m||"object"==typeof m&&null!==m&&m.$$typeof===ln&&Kh(m)===g.type){s(l,g.sibling),(c=a(g,h.props)).ref=Qh(l,g,h),c.return=l,l=c;break e}s(l,g);break}t(l,g),g=g.sibling}h.type===$a?((c=um(h.props.children,l.mode,f,h.key)).return=l,l=c):((f=hm(h.type,h.key,h.props,null,l.mode,f)).ref=Qh(l,c,h),f.return=l,l=f)}return r(l);case Xa:e:{for(g=h.key;null!==c;){if(c.key===g){if(4===c.tag&&c.stateNode.containerInfo===h.containerInfo&&c.stateNode.implementation===h.implementation){s(l,c.sibling),(c=a(c,h.children||[])).return=l,l=c;break e}s(l,c);break}t(l,c),c=c.sibling}(c=fm(h,l.mode,f)).return=l,l=c}return r(l);case ln:return o(l,c,(g=h._init)(h._payload),f)}if(Rn(h))return function(a,r,o,l){for(var c=null,h=null,f=r,m=r=0,g=null;null!==f&&m<o.length;m++){f.index>m?(g=f,f=null):g=f.sibling;var y=d(a,f,o[m],l);if(null===y){null===f&&(f=g);break}e&&f&&null===y.alternate&&t(a,f),r=n(y,r,m),null===h?c=y:h.sibling=y,h=y,f=g}if(m===o.length)return s(a,f),_h&&Ch(a,m),c;if(null===f){for(;m<o.length;m++)null!==(f=u(a,o[m],l))&&(r=n(f,r,m),null===h?c=f:h.sibling=f,h=f);return _h&&Ch(a,m),c}for(f=i(a,f);m<o.length;m++)null!==(g=p(f,a,m,o[m],l))&&(e&&null!==g.alternate&&f.delete(null===g.key?m:g.key),r=n(g,r,m),null===h?c=g:h.sibling=g,h=g);return e&&f.forEach((function(e){return t(a,e)})),_h&&Ch(a,m),c}(l,c,h,f);if(un(h))return function(a,r,o,l){var c=un(o);if("function"!=typeof c)throw Error(_a(150));if(null==(o=c.call(o)))throw Error(_a(151));for(var h=c=null,f=r,m=r=0,g=null,y=o.next();null!==f&&!y.done;m++,y=o.next()){f.index>m?(g=f,f=null):g=f.sibling;var b=d(a,f,y.value,l);if(null===b){null===f&&(f=g);break}e&&f&&null===b.alternate&&t(a,f),r=n(b,r,m),null===h?c=b:h.sibling=b,h=b,f=g}if(y.done)return s(a,f),_h&&Ch(a,m),c;if(null===f){for(;!y.done;m++,y=o.next())null!==(y=u(a,y.value,l))&&(r=n(y,r,m),null===h?c=y:h.sibling=y,h=y);return _h&&Ch(a,m),c}for(f=i(a,f);!y.done;m++,y=o.next())null!==(y=p(f,a,m,y.value,l))&&(e&&null!==y.alternate&&f.delete(null===y.key?m:y.key),r=n(y,r,m),null===h?c=y:h.sibling=y,h=y);return e&&f.forEach((function(e){return t(a,e)})),_h&&Ch(a,m),c}(l,c,h,f);qh(l,h)}return"string"==typeof h&&""!==h||"number"==typeof h?(h=""+h,null!==c&&6===c.tag?(s(l,c.sibling),(c=a(c,h)).return=l,l=c):(s(l,c),(c=pm(h,l.mode,f)).return=l,l=c),r(l)):s(l,c)}}var Jh=Zh(!0),Xh=Zh(!1),$h=eh(null),Yh=null,eu=null,tu=null;function su(){tu=eu=Yh=null}function iu(e){var t=$h.current;th($h),e._currentValue=t}function au(e,t,s){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===s)break;e=e.return}}function nu(e,t){Yh=e,tu=eu=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(!!(e.lanes&t)&&(Kd=!0),e.firstContext=null)}function ru(e){var t=e._currentValue;if(tu!==e)if(e={context:e,memoizedValue:t,next:null},null===eu){if(null===Yh)throw Error(_a(308));eu=e,Yh.dependencies={lanes:0,firstContext:e}}else eu=eu.next=e;return t}var ou=null;function lu(e){null===ou?ou=[e]:ou.push(e)}function cu(e,t,s,i){var a=t.interleaved;return null===a?(s.next=s,lu(t)):(s.next=a.next,a.next=s),t.interleaved=s,hu(e,i)}function hu(e,t){e.lanes|=t;var s=e.alternate;for(null!==s&&(s.lanes|=t),s=e,e=e.return;null!==e;)e.childLanes|=t,null!==(s=e.alternate)&&(s.childLanes|=t),s=e,e=e.return;return 3===s.tag?s.stateNode:null}var uu=!1;function du(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pu(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function fu(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function mu(e,t,s){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,2&af){var a=i.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),i.pending=t,hu(e,s)}return null===(a=i.interleaved)?(t.next=t,lu(i)):(t.next=a.next,a.next=t),i.interleaved=t,hu(e,s)}function gu(e,t,s){if(null!==(t=t.updateQueue)&&(t=t.shared,4194240&s)){var i=t.lanes;s|=i&=e.pendingLanes,t.lanes=s,Kr(e,s)}}function yu(e,t){var s=e.updateQueue,i=e.alternate;if(null!==i&&s===(i=i.updateQueue)){var a=null,n=null;if(null!==(s=s.firstBaseUpdate)){do{var r={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};null===n?a=n=r:n=n.next=r,s=s.next}while(null!==s);null===n?a=n=t:n=n.next=t}else a=n=t;return s={baseState:i.baseState,firstBaseUpdate:a,lastBaseUpdate:n,shared:i.shared,effects:i.effects},void(e.updateQueue=s)}null===(e=s.lastBaseUpdate)?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function bu(e,t,s,i){var a=e.updateQueue;uu=!1;var n=a.firstBaseUpdate,r=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,c=l.next;l.next=null,null===r?n=c:r.next=c,r=l;var h=e.alternate;null!==h&&(o=(h=h.updateQueue).lastBaseUpdate)!==r&&(null===o?h.firstBaseUpdate=c:o.next=c,h.lastBaseUpdate=l)}if(null!==n){var u=a.baseState;for(r=0,h=c=l=null,o=n;;){var d=o.lane,p=o.eventTime;if((i&d)===d){null!==h&&(h=h.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,m=o;switch(d=t,p=s,m.tag){case 1:if("function"==typeof(f=m.payload)){u=f.call(p,u,d);break e}u=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(d="function"==typeof(f=m.payload)?f.call(p,u,d):f))break e;u=pn({},u,d);break e;case 2:uu=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(d=a.effects)?a.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===h?(c=h=p,l=u):h=h.next=p,r|=d;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(d=o).next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}if(null===h&&(l=u),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=h,null!==(t=a.shared.interleaved)){a=t;do{r|=a.lane,a=a.next}while(a!==t)}else null===n&&(a.shared.lanes=0);df|=r,e.lanes=r,e.memoizedState=u}}function vu(e,t,s){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],a=i.callback;if(null!==a){if(i.callback=null,i=s,"function"!=typeof a)throw Error(_a(191,a));a.call(i)}}}var wu={},xu=eh(wu),ku=eh(wu),Au=eh(wu);function Su(e){if(e===wu)throw Error(_a(174));return e}function Eu(e,t){switch(sh(Au,t),sh(ku,e),sh(xu,wu),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:In(null,"");break;default:t=In(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}th(xu),sh(xu,t)}function Tu(){th(xu),th(ku),th(Au)}function Pu(e){Su(Au.current);var t=Su(xu.current),s=In(t,e.type);t!==s&&(sh(ku,e),sh(xu,s))}function Cu(e){ku.current===e&&(th(xu),th(ku))}var Mu=eh(0);function Bu(e){for(var t=e;null!==t;){if(13===t.tag){var s=t.memoizedState;if(null!==s&&(null===(s=s.dehydrated)||"$?"===s.data||"$!"===s.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ru=[];function Du(){for(var e=0;e<Ru.length;e++)Ru[e]._workInProgressVersionPrimary=null;Ru.length=0}var Nu=Za.ReactCurrentDispatcher,_u=Za.ReactCurrentBatchConfig,Fu=0,Ou=null,Lu=null,Iu=null,ju=!1,Hu=!1,Vu=0,Gu=0;function Uu(){throw Error(_a(321))}function zu(e,t){if(null===t)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!Ll(e[s],t[s]))return!1;return!0}function Wu(e,t,s,i,a,n){if(Fu=n,Ou=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Nu.current=null===e||null===e.memoizedState?Cd:Md,e=s(i,a),Hu){n=0;do{if(Hu=!1,Vu=0,25<=n)throw Error(_a(301));n+=1,Iu=Lu=null,t.updateQueue=null,Nu.current=Bd,e=s(i,a)}while(Hu)}if(Nu.current=Pd,t=null!==Lu&&null!==Lu.next,Fu=0,Iu=Lu=Ou=null,ju=!1,t)throw Error(_a(300));return e}function Qu(){var e=0!==Vu;return Vu=0,e}function qu(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Iu?Ou.memoizedState=Iu=e:Iu=Iu.next=e,Iu}function Ku(){if(null===Lu){var e=Ou.alternate;e=null!==e?e.memoizedState:null}else e=Lu.next;var t=null===Iu?Ou.memoizedState:Iu.next;if(null!==t)Iu=t,Lu=e;else{if(null===e)throw Error(_a(310));e={memoizedState:(Lu=e).memoizedState,baseState:Lu.baseState,baseQueue:Lu.baseQueue,queue:Lu.queue,next:null},null===Iu?Ou.memoizedState=Iu=e:Iu=Iu.next=e}return Iu}function Zu(e,t){return"function"==typeof t?t(e):t}function Ju(e){var t=Ku(),s=t.queue;if(null===s)throw Error(_a(311));s.lastRenderedReducer=e;var i=Lu,a=i.baseQueue,n=s.pending;if(null!==n){if(null!==a){var r=a.next;a.next=n.next,n.next=r}i.baseQueue=a=n,s.pending=null}if(null!==a){n=a.next,i=i.baseState;var o=r=null,l=null,c=n;do{var h=c.lane;if((Fu&h)===h)null!==l&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:e(i,c.action);else{var u={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===l?(o=l=u,r=i):l=l.next=u,Ou.lanes|=h,df|=h}c=c.next}while(null!==c&&c!==n);null===l?r=i:l.next=o,Ll(i,t.memoizedState)||(Kd=!0),t.memoizedState=i,t.baseState=r,t.baseQueue=l,s.lastRenderedState=i}if(null!==(e=s.interleaved)){a=e;do{n=a.lane,Ou.lanes|=n,df|=n,a=a.next}while(a!==e)}else null===a&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function Xu(e){var t=Ku(),s=t.queue;if(null===s)throw Error(_a(311));s.lastRenderedReducer=e;var i=s.dispatch,a=s.pending,n=t.memoizedState;if(null!==a){s.pending=null;var r=a=a.next;do{n=e(n,r.action),r=r.next}while(r!==a);Ll(n,t.memoizedState)||(Kd=!0),t.memoizedState=n,null===t.baseQueue&&(t.baseState=n),s.lastRenderedState=n}return[n,i]}function $u(){}function Yu(e,t){var s=Ou,i=Ku(),a=t(),n=!Ll(i.memoizedState,a);if(n&&(i.memoizedState=a,Kd=!0),i=i.queue,ud(sd.bind(null,s,i,e),[e]),i.getSnapshot!==t||n||null!==Iu&&1&Iu.memoizedState.tag){if(s.flags|=2048,rd(9,td.bind(null,s,i,a,t),void 0,null),null===nf)throw Error(_a(349));30&Fu||ed(s,t,a)}return a}function ed(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},null===(t=Ou.updateQueue)?(t={lastEffect:null,stores:null},Ou.updateQueue=t,t.stores=[e]):null===(s=t.stores)?t.stores=[e]:s.push(e)}function td(e,t,s,i){t.value=s,t.getSnapshot=i,id(t)&&ad(e)}function sd(e,t,s){return s((function(){id(t)&&ad(e)}))}function id(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!Ll(e,s)}catch(i){return!0}}function ad(e){var t=hu(e,1);null!==t&&Df(t,e,1,-1)}function nd(e){var t=qu();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zu,lastRenderedState:e},t.queue=e,e=e.dispatch=Ad.bind(null,Ou,e),[t.memoizedState,e]}function rd(e,t,s,i){return e={tag:e,create:t,destroy:s,deps:i,next:null},null===(t=Ou.updateQueue)?(t={lastEffect:null,stores:null},Ou.updateQueue=t,t.lastEffect=e.next=e):null===(s=t.lastEffect)?t.lastEffect=e.next=e:(i=s.next,s.next=e,e.next=i,t.lastEffect=e),e}function od(){return Ku().memoizedState}function ld(e,t,s,i){var a=qu();Ou.flags|=e,a.memoizedState=rd(1|t,s,void 0,void 0===i?null:i)}function cd(e,t,s,i){var a=Ku();i=void 0===i?null:i;var n=void 0;if(null!==Lu){var r=Lu.memoizedState;if(n=r.destroy,null!==i&&zu(i,r.deps))return void(a.memoizedState=rd(t,s,n,i))}Ou.flags|=e,a.memoizedState=rd(1|t,s,n,i)}function hd(e,t){return ld(8390656,8,e,t)}function ud(e,t){return cd(2048,8,e,t)}function dd(e,t){return cd(4,2,e,t)}function pd(e,t){return cd(4,4,e,t)}function fd(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function md(e,t,s){return s=null!=s?s.concat([e]):null,cd(4,4,fd.bind(null,t,e),s)}function gd(){}function yd(e,t){var s=Ku();t=void 0===t?null:t;var i=s.memoizedState;return null!==i&&null!==t&&zu(t,i[1])?i[0]:(s.memoizedState=[e,t],e)}function bd(e,t){var s=Ku();t=void 0===t?null:t;var i=s.memoizedState;return null!==i&&null!==t&&zu(t,i[1])?i[0]:(e=e(),s.memoizedState=[e,t],e)}function vd(e,t,s){return 21&Fu?(Ll(s,t)||(s=Wr(),Ou.lanes|=s,df|=s,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Kd=!0),e.memoizedState=s)}function wd(e,t){var s=Zr;Zr=0!==s&&4>s?s:4,e(!0);var i=_u.transition;_u.transition={};try{e(!1),t()}finally{Zr=s,_u.transition=i}}function xd(){return Ku().memoizedState}function kd(e,t,s){var i=Rf(e);s={lane:i,action:s,hasEagerState:!1,eagerState:null,next:null},Sd(e)?Ed(t,s):null!==(s=cu(e,t,s,i))&&(Df(s,e,i,Bf()),Td(s,t,i))}function Ad(e,t,s){var i=Rf(e),a={lane:i,action:s,hasEagerState:!1,eagerState:null,next:null};if(Sd(e))Ed(t,a);else{var n=e.alternate;if(0===e.lanes&&(null===n||0===n.lanes)&&null!==(n=t.lastRenderedReducer))try{var r=t.lastRenderedState,o=n(r,s);if(a.hasEagerState=!0,a.eagerState=o,Ll(o,r)){var l=t.interleaved;return null===l?(a.next=a,lu(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(s=cu(e,t,a,i))&&(Df(s,e,i,a=Bf()),Td(s,t,i))}}function Sd(e){var t=e.alternate;return e===Ou||null!==t&&t===Ou}function Ed(e,t){Hu=ju=!0;var s=e.pending;null===s?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function Td(e,t,s){if(4194240&s){var i=t.lanes;s|=i&=e.pendingLanes,t.lanes=s,Kr(e,s)}}var Pd={readContext:ru,useCallback:Uu,useContext:Uu,useEffect:Uu,useImperativeHandle:Uu,useInsertionEffect:Uu,useLayoutEffect:Uu,useMemo:Uu,useReducer:Uu,useRef:Uu,useState:Uu,useDebugValue:Uu,useDeferredValue:Uu,useTransition:Uu,useMutableSource:Uu,useSyncExternalStore:Uu,useId:Uu,unstable_isNewReconciler:!1},Cd={readContext:ru,useCallback:function(e,t){return qu().memoizedState=[e,void 0===t?null:t],e},useContext:ru,useEffect:hd,useImperativeHandle:function(e,t,s){return s=null!=s?s.concat([e]):null,ld(4194308,4,fd.bind(null,t,e),s)},useLayoutEffect:function(e,t){return ld(4194308,4,e,t)},useInsertionEffect:function(e,t){return ld(4,2,e,t)},useMemo:function(e,t){var s=qu();return t=void 0===t?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var i=qu();return t=void 0!==s?s(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=kd.bind(null,Ou,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},qu().memoizedState=e},useState:nd,useDebugValue:gd,useDeferredValue:function(e){return qu().memoizedState=e},useTransition:function(){var e=nd(!1),t=e[0];return e=wd.bind(null,e[1]),qu().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var i=Ou,a=qu();if(_h){if(void 0===s)throw Error(_a(407));s=s()}else{if(s=t(),null===nf)throw Error(_a(349));30&Fu||ed(i,t,s)}a.memoizedState=s;var n={value:s,getSnapshot:t};return a.queue=n,hd(sd.bind(null,i,n,e),[e]),i.flags|=2048,rd(9,td.bind(null,i,n,s,t),void 0,null),s},useId:function(){var e=qu(),t=nf.identifierPrefix;if(_h){var s=Ph;t=":"+t+"R"+(s=(Th&~(1<<32-Or(Th)-1)).toString(32)+s),0<(s=Vu++)&&(t+="H"+s.toString(32)),t+=":"}else t=":"+t+"r"+(s=Gu++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Md={readContext:ru,useCallback:yd,useContext:ru,useEffect:ud,useImperativeHandle:md,useInsertionEffect:dd,useLayoutEffect:pd,useMemo:bd,useReducer:Ju,useRef:od,useState:function(){return Ju(Zu)},useDebugValue:gd,useDeferredValue:function(e){return vd(Ku(),Lu.memoizedState,e)},useTransition:function(){return[Ju(Zu)[0],Ku().memoizedState]},useMutableSource:$u,useSyncExternalStore:Yu,useId:xd,unstable_isNewReconciler:!1},Bd={readContext:ru,useCallback:yd,useContext:ru,useEffect:ud,useImperativeHandle:md,useInsertionEffect:dd,useLayoutEffect:pd,useMemo:bd,useReducer:Xu,useRef:od,useState:function(){return Xu(Zu)},useDebugValue:gd,useDeferredValue:function(e){var t=Ku();return null===Lu?t.memoizedState=e:vd(t,Lu.memoizedState,e)},useTransition:function(){return[Xu(Zu)[0],Ku().memoizedState]},useMutableSource:$u,useSyncExternalStore:Yu,useId:xd,unstable_isNewReconciler:!1};function Rd(e,t){if(e&&e.defaultProps){for(var s in t=pn({},t),e=e.defaultProps)void 0===t[s]&&(t[s]=e[s]);return t}return t}function Dd(e,t,s,i){s=null==(s=s(i,t=e.memoizedState))?t:pn({},t,s),e.memoizedState=s,0===e.lanes&&(e.updateQueue.baseState=s)}var Nd={isMounted:function(e){return!!(e=e._reactInternals)&&br(e)===e},enqueueSetState:function(e,t,s){e=e._reactInternals;var i=Bf(),a=Rf(e),n=fu(i,a);n.payload=t,null!=s&&(n.callback=s),null!==(t=mu(e,n,a))&&(Df(t,e,a,i),gu(t,e,a))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var i=Bf(),a=Rf(e),n=fu(i,a);n.tag=1,n.payload=t,null!=s&&(n.callback=s),null!==(t=mu(e,n,a))&&(Df(t,e,a,i),gu(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=Bf(),i=Rf(e),a=fu(s,i);a.tag=2,null!=t&&(a.callback=t),null!==(t=mu(e,a,i))&&(Df(t,e,i,s),gu(t,e,i))}};function _d(e,t,s,i,a,n,r){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,n,r):!(t.prototype&&t.prototype.isPureReactComponent&&Il(s,i)&&Il(a,n))}function Fd(e,t,s){var i=!1,a=ih,n=t.contextType;return"object"==typeof n&&null!==n?n=ru(n):(a=lh(t)?rh:ah.current,n=(i=null!=(i=t.contextTypes))?oh(e,a):ih),t=new t(s,n),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Nd,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=n),t}function Od(e,t,s,i){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(s,i),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(s,i),t.state!==e&&Nd.enqueueReplaceState(t,t.state,null)}function Ld(e,t,s,i){var a=e.stateNode;a.props=s,a.state=e.memoizedState,a.refs={},du(e);var n=t.contextType;"object"==typeof n&&null!==n?a.context=ru(n):(n=lh(t)?rh:ah.current,a.context=oh(e,n)),a.state=e.memoizedState,"function"==typeof(n=t.getDerivedStateFromProps)&&(Dd(e,t,n,s),a.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof a.getSnapshotBeforeUpdate||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||(t=a.state,"function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&Nd.enqueueReplaceState(a,a.state,null),bu(e,s,a,i),a.state=e.memoizedState),"function"==typeof a.componentDidMount&&(e.flags|=4194308)}function Id(e,t){try{var s="",i=t;do{s+=yn(i),i=i.return}while(i);var a=s}catch(n){a="\nError generating stack: "+n.message+"\n"+n.stack}return{value:e,source:t,stack:a,digest:null}}function jd(e,t,s){return{value:e,source:null,stack:null!=s?s:null,digest:null!=t?t:null}}function Hd(e,t){try{console.error(t.value)}catch(s){setTimeout((function(){throw s}))}}var Vd="function"==typeof WeakMap?WeakMap:Map;function Gd(e,t,s){(s=fu(-1,s)).tag=3,s.payload={element:null};var i=t.value;return s.callback=function(){wf||(wf=!0,xf=i),Hd(0,t)},s}function Ud(e,t,s){(s=fu(-1,s)).tag=3;var i=e.type.getDerivedStateFromError;if("function"==typeof i){var a=t.value;s.payload=function(){return i(a)},s.callback=function(){Hd(0,t)}}var n=e.stateNode;return null!==n&&"function"==typeof n.componentDidCatch&&(s.callback=function(){Hd(0,t),"function"!=typeof i&&(null===kf?kf=new Set([this]):kf.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),s}function zd(e,t,s){var i=e.pingCache;if(null===i){i=e.pingCache=new Vd;var a=new Set;i.set(t,a)}else void 0===(a=i.get(t))&&(a=new Set,i.set(t,a));a.has(s)||(a.add(s),e=tm.bind(null,e,t,s),t.then(e,e))}function Wd(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function Qd(e,t,s,i,a){return 1&e.mode?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,1===s.tag&&(null===s.alternate?s.tag=17:((t=fu(-1,1)).tag=2,mu(s,t,1))),s.lanes|=1),e)}var qd=Za.ReactCurrentOwner,Kd=!1;function Zd(e,t,s,i){t.child=null===e?Xh(t,null,s,i):Jh(t,e.child,s,i)}function Jd(e,t,s,i,a){s=s.render;var n=t.ref;return nu(t,a),i=Wu(e,t,s,i,n,a),s=Qu(),null===e||Kd?(_h&&s&&Bh(t),t.flags|=1,Zd(e,t,i,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,vp(e,t,a))}function Xd(e,t,s,i,a){if(null===e){var n=s.type;return"function"!=typeof n||lm(n)||void 0!==n.defaultProps||null!==s.compare||void 0!==s.defaultProps?((e=hm(s.type,null,i,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=n,$d(e,t,n,i,a))}if(n=e.child,!(e.lanes&a)){var r=n.memoizedProps;if((s=null!==(s=s.compare)?s:Il)(r,i)&&e.ref===t.ref)return vp(e,t,a)}return t.flags|=1,(e=cm(n,i)).ref=t.ref,e.return=t,t.child=e}function $d(e,t,s,i,a){if(null!==e){var n=e.memoizedProps;if(Il(n,i)&&e.ref===t.ref){if(Kd=!1,t.pendingProps=i=n,!(e.lanes&a))return t.lanes=e.lanes,vp(e,t,a);131072&e.flags&&(Kd=!0)}}return tp(e,t,s,i,a)}function Yd(e,t,s){var i=t.pendingProps,a=i.children,n=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(1&t.mode){if(!(1073741824&s))return e=null!==n?n.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,sh(cf,lf),lf|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==n?n.baseLanes:s,sh(cf,lf),lf|=i}else t.memoizedState={baseLanes:0,cachePool:null,transitions:null},sh(cf,lf),lf|=s;else null!==n?(i=n.baseLanes|s,t.memoizedState=null):i=s,sh(cf,lf),lf|=i;return Zd(e,t,a,s),t.child}function ep(e,t){var s=t.ref;(null===e&&null!==s||null!==e&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function tp(e,t,s,i,a){var n=lh(s)?rh:ah.current;return n=oh(t,n),nu(t,a),s=Wu(e,t,s,i,n,a),i=Qu(),null===e||Kd?(_h&&i&&Bh(t),t.flags|=1,Zd(e,t,s,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,vp(e,t,a))}function sp(e,t,s,i,a){if(lh(s)){var n=!0;dh(t)}else n=!1;if(nu(t,a),null===t.stateNode)bp(e,t),Fd(t,s,i),Ld(t,s,i,a),i=!0;else if(null===e){var r=t.stateNode,o=t.memoizedProps;r.props=o;var l=r.context,c=s.contextType;c="object"==typeof c&&null!==c?ru(c):oh(t,c=lh(s)?rh:ah.current);var h=s.getDerivedStateFromProps,u="function"==typeof h||"function"==typeof r.getSnapshotBeforeUpdate;u||"function"!=typeof r.UNSAFE_componentWillReceiveProps&&"function"!=typeof r.componentWillReceiveProps||(o!==i||l!==c)&&Od(t,r,i,c),uu=!1;var d=t.memoizedState;r.state=d,bu(t,i,r,a),l=t.memoizedState,o!==i||d!==l||nh.current||uu?("function"==typeof h&&(Dd(t,s,h,i),l=t.memoizedState),(o=uu||_d(t,s,o,i,d,l,c))?(u||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||("function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount()),"function"==typeof r.componentDidMount&&(t.flags|=4194308)):("function"==typeof r.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),r.props=i,r.state=l,r.context=c,i=o):("function"==typeof r.componentDidMount&&(t.flags|=4194308),i=!1)}else{r=t.stateNode,pu(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Rd(t.type,o),r.props=c,u=t.pendingProps,d=r.context,l="object"==typeof(l=s.contextType)&&null!==l?ru(l):oh(t,l=lh(s)?rh:ah.current);var p=s.getDerivedStateFromProps;(h="function"==typeof p||"function"==typeof r.getSnapshotBeforeUpdate)||"function"!=typeof r.UNSAFE_componentWillReceiveProps&&"function"!=typeof r.componentWillReceiveProps||(o!==u||d!==l)&&Od(t,r,i,l),uu=!1,d=t.memoizedState,r.state=d,bu(t,i,r,a);var f=t.memoizedState;o!==u||d!==f||nh.current||uu?("function"==typeof p&&(Dd(t,s,p,i),f=t.memoizedState),(c=uu||_d(t,s,c,i,d,f,l)||!1)?(h||"function"!=typeof r.UNSAFE_componentWillUpdate&&"function"!=typeof r.componentWillUpdate||("function"==typeof r.componentWillUpdate&&r.componentWillUpdate(i,f,l),"function"==typeof r.UNSAFE_componentWillUpdate&&r.UNSAFE_componentWillUpdate(i,f,l)),"function"==typeof r.componentDidUpdate&&(t.flags|=4),"function"==typeof r.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof r.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof r.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=f),r.props=i,r.state=f,r.context=l,i=c):("function"!=typeof r.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof r.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return ip(e,t,s,i,n,a)}function ip(e,t,s,i,a,n){ep(e,t);var r=!!(128&t.flags);if(!i&&!r)return a&&ph(t,s,!1),vp(e,t,n);i=t.stateNode,qd.current=t;var o=r&&"function"!=typeof s.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&r?(t.child=Jh(t,e.child,null,n),t.child=Jh(t,null,o,n)):Zd(e,t,o,n),t.memoizedState=i.state,a&&ph(t,s,!0),t.child}function ap(e){var t=e.stateNode;t.pendingContext?hh(0,t.pendingContext,t.pendingContext!==t.context):t.context&&hh(0,t.context,!1),Eu(e,t.containerInfo)}function np(e,t,s,i,a){return Uh(),zh(a),t.flags|=256,Zd(e,t,s,i),t.child}var rp,op,lp,cp,hp={dehydrated:null,treeContext:null,retryLane:0};function up(e){return{baseLanes:e,cachePool:null,transitions:null}}function dp(e,t,s){var i,a=t.pendingProps,n=Mu.current,r=!1,o=!!(128&t.flags);if((i=o)||(i=(null===e||null!==e.memoizedState)&&!!(2&n)),i?(r=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(n|=1),sh(Mu,1&n),null===e)return jh(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(1&t.mode?"$!"===e.data?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=a.children,e=a.fallback,r?(a=t.mode,r=t.child,o={mode:"hidden",children:o},1&a||null===r?r=dm(o,a,0,null):(r.childLanes=0,r.pendingProps=o),e=um(e,a,s,null),r.return=t,e.return=t,r.sibling=e,t.child=r,t.child.memoizedState=up(s),t.memoizedState=hp,e):pp(t,o));if(null!==(n=e.memoizedState)&&null!==(i=n.dehydrated))return function(e,t,s,i,a,n,r){if(s)return 256&t.flags?(t.flags&=-257,fp(e,t,r,i=jd(Error(_a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(n=i.fallback,a=t.mode,i=dm({mode:"visible",children:i.children},a,0,null),(n=um(n,a,r,null)).flags|=2,i.return=t,n.return=t,i.sibling=n,t.child=i,1&t.mode&&Jh(t,e.child,null,r),t.child.memoizedState=up(r),t.memoizedState=hp,n);if(!(1&t.mode))return fp(e,t,r,null);if("$!"===a.data){if(i=a.nextSibling&&a.nextSibling.dataset)var o=i.dgst;return i=o,fp(e,t,r,i=jd(n=Error(_a(419)),i,void 0))}if(o=!!(r&e.childLanes),Kd||o){if(null!==(i=nf)){switch(r&-r){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=a&(i.suspendedLanes|r)?0:a)&&a!==n.retryLane&&(n.retryLane=a,hu(e,a),Df(i,e,a,-1))}return Wf(),fp(e,t,r,i=jd(Error(_a(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=im.bind(null,e),a._reactRetry=t,null):(e=n.treeContext,Nh=jc(a.nextSibling),Dh=t,_h=!0,Fh=null,null!==e&&(Ah[Sh++]=Th,Ah[Sh++]=Ph,Ah[Sh++]=Eh,Th=e.id,Ph=e.overflow,Eh=t),(t=pp(t,i.children)).flags|=4096,t)}(e,t,o,a,i,n,s);if(r){r=a.fallback,o=t.mode,i=(n=e.child).sibling;var l={mode:"hidden",children:a.children};return 1&o||t.child===n?(a=cm(n,l)).subtreeFlags=14680064&n.subtreeFlags:((a=t.child).childLanes=0,a.pendingProps=l,t.deletions=null),null!==i?r=cm(i,r):(r=um(r,o,s,null)).flags|=2,r.return=t,a.return=t,a.sibling=r,t.child=a,a=r,r=t.child,o=null===(o=e.child.memoizedState)?up(s):{baseLanes:o.baseLanes|s,cachePool:null,transitions:o.transitions},r.memoizedState=o,r.childLanes=e.childLanes&~s,t.memoizedState=hp,a}return e=(r=e.child).sibling,a=cm(r,{mode:"visible",children:a.children}),!(1&t.mode)&&(a.lanes=s),a.return=t,a.sibling=null,null!==e&&(null===(s=t.deletions)?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=a,t.memoizedState=null,a}function pp(e,t){return(t=dm({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function fp(e,t,s,i){return null!==i&&zh(i),Jh(t,e.child,null,s),(e=pp(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function mp(e,t,s){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),au(e.return,t,s)}function gp(e,t,s,i,a){var n=e.memoizedState;null===n?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:s,tailMode:a}:(n.isBackwards=t,n.rendering=null,n.renderingStartTime=0,n.last=i,n.tail=s,n.tailMode=a)}function yp(e,t,s){var i=t.pendingProps,a=i.revealOrder,n=i.tail;if(Zd(e,t,i.children,s),2&(i=Mu.current))i=1&i|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&mp(e,s,t);else if(19===e.tag)mp(e,s,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(sh(Mu,i),1&t.mode)switch(a){case"forwards":for(s=t.child,a=null;null!==s;)null!==(e=s.alternate)&&null===Bu(e)&&(a=s),s=s.sibling;null===(s=a)?(a=t.child,t.child=null):(a=s.sibling,s.sibling=null),gp(t,!1,a,s,n);break;case"backwards":for(s=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===Bu(e)){t.child=a;break}e=a.sibling,a.sibling=s,s=a,a=e}gp(t,!0,s,null,n);break;case"together":gp(t,!1,null,null,void 0);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function bp(e,t){!(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function vp(e,t,s){if(null!==e&&(t.dependencies=e.dependencies),df|=t.lanes,!(s&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(_a(153));if(null!==t.child){for(s=cm(e=t.child,e.pendingProps),t.child=s,s.return=t;null!==e.sibling;)e=e.sibling,(s=s.sibling=cm(e,e.pendingProps)).return=t;s.sibling=null}return t.child}function wp(e,t){if(!_h)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;null!==t;)null!==t.alternate&&(s=t),t=t.sibling;null===s?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var i=null;null!==s;)null!==s.alternate&&(i=s),s=s.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function xp(e){var t=null!==e.alternate&&e.alternate.child===e.child,s=0,i=0;if(t)for(var a=e.child;null!==a;)s|=a.lanes|a.childLanes,i|=14680064&a.subtreeFlags,i|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)s|=a.lanes|a.childLanes,i|=a.subtreeFlags,i|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=i,e.childLanes=s,t}function kp(e,t,s){var i=t.pendingProps;switch(Rh(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xp(t),null;case 1:case 17:return lh(t.type)&&ch(),xp(t),null;case 3:return i=t.stateNode,Tu(),th(nh),th(ah),Du(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(Vh(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==Fh&&(Of(Fh),Fh=null))),op(e,t),xp(t),null;case 5:Cu(t);var a=Su(Au.current);if(s=t.type,null!==e&&null!=t.stateNode)lp(e,t,s,i,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(_a(166));return xp(t),null}if(e=Su(xu.current),Vh(t)){i=t.stateNode,s=t.type;var n=t.memoizedProps;switch(i[Gc]=t,i[Uc]=n,e=!!(1&t.mode),s){case"dialog":mc("cancel",i),mc("close",i);break;case"iframe":case"object":case"embed":mc("load",i);break;case"video":case"audio":for(a=0;a<uc.length;a++)mc(uc[a],i);break;case"source":mc("error",i);break;case"img":case"image":case"link":mc("error",i),mc("load",i);break;case"details":mc("toggle",i);break;case"input":Tn(i,n),mc("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!n.multiple},mc("invalid",i);break;case"textarea":_n(i,n),mc("invalid",i)}for(var r in Kn(s,n),a=null,n)if(n.hasOwnProperty(r)){var o=n[r];"children"===r?"string"==typeof o?i.textContent!==o&&(!0!==n.suppressHydrationWarning&&Cc(i.textContent,o,e),a=["children",o]):"number"==typeof o&&i.textContent!==""+o&&(!0!==n.suppressHydrationWarning&&Cc(i.textContent,o,e),a=["children",""+o]):Oa.hasOwnProperty(r)&&null!=o&&"onScroll"===r&&mc("scroll",i)}switch(s){case"input":kn(i),Mn(i,n,!0);break;case"textarea":kn(i),On(i);break;case"select":case"option":break;default:"function"==typeof n.onClick&&(i.onclick=Mc)}i=a,t.updateQueue=i,null!==i&&(t.flags|=4)}else{r=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=Ln(s)),"http://www.w3.org/1999/xhtml"===e?"script"===s?((e=r.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof i.is?e=r.createElement(s,{is:i.is}):(e=r.createElement(s),"select"===s&&(r=e,i.multiple?r.multiple=!0:i.size&&(r.size=i.size))):e=r.createElementNS(e,s),e[Gc]=t,e[Uc]=i,rp(e,t,!1,!1),t.stateNode=e;e:{switch(r=Zn(s,i),s){case"dialog":mc("cancel",e),mc("close",e),a=i;break;case"iframe":case"object":case"embed":mc("load",e),a=i;break;case"video":case"audio":for(a=0;a<uc.length;a++)mc(uc[a],e);a=i;break;case"source":mc("error",e),a=i;break;case"img":case"image":case"link":mc("error",e),mc("load",e),a=i;break;case"details":mc("toggle",e),a=i;break;case"input":Tn(e,i),a=En(e,i),mc("invalid",e);break;case"option":default:a=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},a=pn({},i,{value:void 0}),mc("invalid",e);break;case"textarea":_n(e,i),a=Nn(e,i),mc("invalid",e)}for(n in Kn(s,a),o=a)if(o.hasOwnProperty(n)){var l=o[n];"style"===n?Qn(e,l):"dangerouslySetInnerHTML"===n?null!=(l=l?l.__html:void 0)&&Vn(e,l):"children"===n?"string"==typeof l?("textarea"!==s||""!==l)&&Gn(e,l):"number"==typeof l&&Gn(e,""+l):"suppressContentEditableWarning"!==n&&"suppressHydrationWarning"!==n&&"autoFocus"!==n&&(Oa.hasOwnProperty(n)?null!=l&&"onScroll"===n&&mc("scroll",e):null!=l&&Ka(e,n,l,r))}switch(s){case"input":kn(e),Mn(e,i,!1);break;case"textarea":kn(e),On(e);break;case"option":null!=i.value&&e.setAttribute("value",""+wn(i.value));break;case"select":e.multiple=!!i.multiple,null!=(n=i.value)?Dn(e,!!i.multiple,n,!1):null!=i.defaultValue&&Dn(e,!!i.multiple,i.defaultValue,!0);break;default:"function"==typeof a.onClick&&(e.onclick=Mc)}switch(s){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return xp(t),null;case 6:if(e&&null!=t.stateNode)cp(e,t,e.memoizedProps,i);else{if("string"!=typeof i&&null===t.stateNode)throw Error(_a(166));if(s=Su(Au.current),Su(xu.current),Vh(t)){if(i=t.stateNode,s=t.memoizedProps,i[Gc]=t,(n=i.nodeValue!==s)&&null!==(e=Dh))switch(e.tag){case 3:Cc(i.nodeValue,s,!!(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Cc(i.nodeValue,s,!!(1&e.mode))}n&&(t.flags|=4)}else(i=(9===s.nodeType?s:s.ownerDocument).createTextNode(i))[Gc]=t,t.stateNode=i}return xp(t),null;case 13:if(th(Mu),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(_h&&null!==Nh&&1&t.mode&&!(128&t.flags))Gh(),Uh(),t.flags|=98560,n=!1;else if(n=Vh(t),null!==i&&null!==i.dehydrated){if(null===e){if(!n)throw Error(_a(318));if(!(n=null!==(n=t.memoizedState)?n.dehydrated:null))throw Error(_a(317));n[Gc]=t}else Uh(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;xp(t),n=!1}else null!==Fh&&(Of(Fh),Fh=null),n=!0;if(!n)return 65536&t.flags?t:null}return 128&t.flags?(t.lanes=s,t):((i=null!==i)!=(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,1&t.mode&&(null===e||1&Mu.current?0===hf&&(hf=3):Wf())),null!==t.updateQueue&&(t.flags|=4),xp(t),null);case 4:return Tu(),op(e,t),null===e&&bc(t.stateNode.containerInfo),xp(t),null;case 10:return iu(t.type._context),xp(t),null;case 19:if(th(Mu),null===(n=t.memoizedState))return xp(t),null;if(i=!!(128&t.flags),null===(r=n.rendering))if(i)wp(n,!1);else{if(0!==hf||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(r=Bu(e))){for(t.flags|=128,wp(n,!1),null!==(i=r.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=s,s=t.child;null!==s;)e=i,(n=s).flags&=14680066,null===(r=n.alternate)?(n.childLanes=0,n.lanes=e,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=r.childLanes,n.lanes=r.lanes,n.child=r.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=r.memoizedProps,n.memoizedState=r.memoizedState,n.updateQueue=r.updateQueue,n.type=r.type,e=r.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return sh(Mu,1&Mu.current|2),t.child}e=e.sibling}null!==n.tail&&Pr()>bf&&(t.flags|=128,i=!0,wp(n,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=Bu(r))){if(t.flags|=128,i=!0,null!==(s=e.updateQueue)&&(t.updateQueue=s,t.flags|=4),wp(n,!0),null===n.tail&&"hidden"===n.tailMode&&!r.alternate&&!_h)return xp(t),null}else 2*Pr()-n.renderingStartTime>bf&&1073741824!==s&&(t.flags|=128,i=!0,wp(n,!1),t.lanes=4194304);n.isBackwards?(r.sibling=t.child,t.child=r):(null!==(s=n.last)?s.sibling=r:t.child=r,n.last=r)}return null!==n.tail?(t=n.tail,n.rendering=t,n.tail=t.sibling,n.renderingStartTime=Pr(),t.sibling=null,s=Mu.current,sh(Mu,i?1&s|2:1&s),t):(xp(t),null);case 22:case 23:return Vf(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&1&t.mode?!!(1073741824&lf)&&(xp(t),6&t.subtreeFlags&&(t.flags|=8192)):xp(t),null;case 24:case 25:return null}throw Error(_a(156,t.tag))}function Ap(e,t){switch(Rh(t),t.tag){case 1:return lh(t.type)&&ch(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Tu(),th(nh),th(ah),Du(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Cu(t),null;case 13:if(th(Mu),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(_a(340));Uh()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return th(Mu),null;case 4:return Tu(),null;case 10:return iu(t.type._context),null;case 22:case 23:return Vf(),null;default:return null}}rp=function(e,t){for(var s=t.child;null!==s;){if(5===s.tag||6===s.tag)e.appendChild(s.stateNode);else if(4!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break;for(;null===s.sibling;){if(null===s.return||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}},op=function(){},lp=function(e,t,s,i){var a=e.memoizedProps;if(a!==i){e=t.stateNode,Su(xu.current);var n,r=null;switch(s){case"input":a=En(e,a),i=En(e,i),r=[];break;case"select":a=pn({},a,{value:void 0}),i=pn({},i,{value:void 0}),r=[];break;case"textarea":a=Nn(e,a),i=Nn(e,i),r=[];break;default:"function"!=typeof a.onClick&&"function"==typeof i.onClick&&(e.onclick=Mc)}for(c in Kn(s,i),s=null,a)if(!i.hasOwnProperty(c)&&a.hasOwnProperty(c)&&null!=a[c])if("style"===c){var o=a[c];for(n in o)o.hasOwnProperty(n)&&(s||(s={}),s[n]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(Oa.hasOwnProperty(c)?r||(r=[]):(r=r||[]).push(c,null));for(c in i){var l=i[c];if(o=null!=a?a[c]:void 0,i.hasOwnProperty(c)&&l!==o&&(null!=l||null!=o))if("style"===c)if(o){for(n in o)!o.hasOwnProperty(n)||l&&l.hasOwnProperty(n)||(s||(s={}),s[n]="");for(n in l)l.hasOwnProperty(n)&&o[n]!==l[n]&&(s||(s={}),s[n]=l[n])}else s||(r||(r=[]),r.push(c,s)),s=l;else"dangerouslySetInnerHTML"===c?(l=l?l.__html:void 0,o=o?o.__html:void 0,null!=l&&o!==l&&(r=r||[]).push(c,l)):"children"===c?"string"!=typeof l&&"number"!=typeof l||(r=r||[]).push(c,""+l):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(Oa.hasOwnProperty(c)?(null!=l&&"onScroll"===c&&mc("scroll",e),r||o===l||(r=[])):(r=r||[]).push(c,l))}s&&(r=r||[]).push("style",s);var c=r;(t.updateQueue=c)&&(t.flags|=4)}},cp=function(e,t,s,i){s!==i&&(t.flags|=4)};var Sp=!1,Ep=!1,Tp="function"==typeof WeakSet?WeakSet:Set,Pp=null;function Cp(e,t){var s=e.ref;if(null!==s)if("function"==typeof s)try{s(null)}catch(i){em(e,t,i)}else s.current=null}function Mp(e,t,s){try{s()}catch(i){em(e,t,i)}}var Bp=!1;function Rp(e,t,s){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var a=i=i.next;do{if((a.tag&e)===e){var n=a.destroy;a.destroy=void 0,void 0!==n&&Mp(t,s,n)}a=a.next}while(a!==i)}}function Dp(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var s=t=t.next;do{if((s.tag&e)===e){var i=s.create;s.destroy=i()}s=s.next}while(s!==t)}}function Np(e){var t=e.ref;if(null!==t){var s=e.stateNode;e.tag,e=s,"function"==typeof t?t(e):t.current=e}}function _p(e){var t=e.alternate;null!==t&&(e.alternate=null,_p(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&(delete t[Gc],delete t[Uc],delete t[Wc],delete t[Qc],delete t[qc]),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Fp(e){return 5===e.tag||3===e.tag||4===e.tag}function Op(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Fp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Lp(e,t,s){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===s.nodeType?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(8===s.nodeType?(t=s.parentNode).insertBefore(e,s):(t=s).appendChild(e),null!=(s=s._reactRootContainer)||null!==t.onclick||(t.onclick=Mc));else if(4!==i&&null!==(e=e.child))for(Lp(e,t,s),e=e.sibling;null!==e;)Lp(e,t,s),e=e.sibling}function Ip(e,t,s){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(4!==i&&null!==(e=e.child))for(Ip(e,t,s),e=e.sibling;null!==e;)Ip(e,t,s),e=e.sibling}var jp=null,Hp=!1;function Vp(e,t,s){for(s=s.child;null!==s;)Gp(e,t,s),s=s.sibling}function Gp(e,t,s){if(Fr&&"function"==typeof Fr.onCommitFiberUnmount)try{Fr.onCommitFiberUnmount(_r,s)}catch(o){}switch(s.tag){case 5:Ep||Cp(s,t);case 6:var i=jp,a=Hp;jp=null,Vp(e,t,s),Hp=a,null!==(jp=i)&&(Hp?(e=jp,s=s.stateNode,8===e.nodeType?e.parentNode.removeChild(s):e.removeChild(s)):jp.removeChild(s.stateNode));break;case 18:null!==jp&&(Hp?(e=jp,s=s.stateNode,8===e.nodeType?Ic(e.parentNode,s):1===e.nodeType&&Ic(e,s),vo(e)):Ic(jp,s.stateNode));break;case 4:i=jp,a=Hp,jp=s.stateNode.containerInfo,Hp=!0,Vp(e,t,s),jp=i,Hp=a;break;case 0:case 11:case 14:case 15:if(!Ep&&null!==(i=s.updateQueue)&&null!==(i=i.lastEffect)){a=i=i.next;do{var n=a,r=n.destroy;n=n.tag,void 0!==r&&(2&n||4&n)&&Mp(s,t,r),a=a.next}while(a!==i)}Vp(e,t,s);break;case 1:if(!Ep&&(Cp(s,t),"function"==typeof(i=s.stateNode).componentWillUnmount))try{i.props=s.memoizedProps,i.state=s.memoizedState,i.componentWillUnmount()}catch(o){em(s,t,o)}Vp(e,t,s);break;case 21:Vp(e,t,s);break;case 22:1&s.mode?(Ep=(i=Ep)||null!==s.memoizedState,Vp(e,t,s),Ep=i):Vp(e,t,s);break;default:Vp(e,t,s)}}function Up(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var s=e.stateNode;null===s&&(s=e.stateNode=new Tp),t.forEach((function(t){var i=am.bind(null,e,t);s.has(t)||(s.add(t),t.then(i,i))}))}}function zp(e,t){var s=t.deletions;if(null!==s)for(var i=0;i<s.length;i++){var a=s[i];try{var n=e,r=t,o=r;e:for(;null!==o;){switch(o.tag){case 5:jp=o.stateNode,Hp=!1;break e;case 3:case 4:jp=o.stateNode.containerInfo,Hp=!0;break e}o=o.return}if(null===jp)throw Error(_a(160));Gp(n,r,a),jp=null,Hp=!1;var l=a.alternate;null!==l&&(l.return=null),a.return=null}catch(c){em(a,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)Wp(t,e),t=t.sibling}function Wp(e,t){var s=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(zp(t,e),Qp(e),4&i){try{Rp(3,e,e.return),Dp(3,e)}catch(m){em(e,e.return,m)}try{Rp(5,e,e.return)}catch(m){em(e,e.return,m)}}break;case 1:zp(t,e),Qp(e),512&i&&null!==s&&Cp(s,s.return);break;case 5:if(zp(t,e),Qp(e),512&i&&null!==s&&Cp(s,s.return),32&e.flags){var a=e.stateNode;try{Gn(a,"")}catch(m){em(e,e.return,m)}}if(4&i&&null!=(a=e.stateNode)){var n=e.memoizedProps,r=null!==s?s.memoizedProps:n,o=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===o&&"radio"===n.type&&null!=n.name&&Pn(a,n),Zn(o,r);var c=Zn(o,n);for(r=0;r<l.length;r+=2){var h=l[r],u=l[r+1];"style"===h?Qn(a,u):"dangerouslySetInnerHTML"===h?Vn(a,u):"children"===h?Gn(a,u):Ka(a,h,u,c)}switch(o){case"input":Cn(a,n);break;case"textarea":Fn(a,n);break;case"select":var d=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!n.multiple;var p=n.value;null!=p?Dn(a,!!n.multiple,p,!1):d!==!!n.multiple&&(null!=n.defaultValue?Dn(a,!!n.multiple,n.defaultValue,!0):Dn(a,!!n.multiple,n.multiple?[]:"",!1))}a[Uc]=n}catch(m){em(e,e.return,m)}}break;case 6:if(zp(t,e),Qp(e),4&i){if(null===e.stateNode)throw Error(_a(162));a=e.stateNode,n=e.memoizedProps;try{a.nodeValue=n}catch(m){em(e,e.return,m)}}break;case 3:if(zp(t,e),Qp(e),4&i&&null!==s&&s.memoizedState.isDehydrated)try{vo(t.containerInfo)}catch(m){em(e,e.return,m)}break;case 4:default:zp(t,e),Qp(e);break;case 13:zp(t,e),Qp(e),8192&(a=e.child).flags&&(n=null!==a.memoizedState,a.stateNode.isHidden=n,!n||null!==a.alternate&&null!==a.alternate.memoizedState||(yf=Pr())),4&i&&Up(e);break;case 22:if(h=null!==s&&null!==s.memoizedState,1&e.mode?(Ep=(c=Ep)||h,zp(t,e),Ep=c):zp(t,e),Qp(e),8192&i){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!h&&1&e.mode)for(Pp=e,h=e.child;null!==h;){for(u=Pp=h;null!==Pp;){switch(p=(d=Pp).child,d.tag){case 0:case 11:case 14:case 15:Rp(4,d,d.return);break;case 1:Cp(d,d.return);var f=d.stateNode;if("function"==typeof f.componentWillUnmount){i=d,s=d.return;try{t=i,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(m){em(i,s,m)}}break;case 5:Cp(d,d.return);break;case 22:if(null!==d.memoizedState){Jp(u);continue}}null!==p?(p.return=d,Pp=p):Jp(u)}h=h.sibling}e:for(h=null,u=e;;){if(5===u.tag){if(null===h){h=u;try{a=u.stateNode,c?"function"==typeof(n=a.style).setProperty?n.setProperty("display","none","important"):n.display="none":(o=u.stateNode,r=null!=(l=u.memoizedProps.style)&&l.hasOwnProperty("display")?l.display:null,o.style.display=Wn("display",r))}catch(m){em(e,e.return,m)}}}else if(6===u.tag){if(null===h)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(m){em(e,e.return,m)}}else if((22!==u.tag&&23!==u.tag||null===u.memoizedState||u===e)&&null!==u.child){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;null===u.sibling;){if(null===u.return||u.return===e)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:zp(t,e),Qp(e),4&i&&Up(e);case 21:}}function Qp(e){var t=e.flags;if(2&t){try{e:{for(var s=e.return;null!==s;){if(Fp(s)){var i=s;break e}s=s.return}throw Error(_a(160))}switch(i.tag){case 5:var a=i.stateNode;32&i.flags&&(Gn(a,""),i.flags&=-33),Ip(e,Op(e),a);break;case 3:case 4:var n=i.stateNode.containerInfo;Lp(e,Op(e),n);break;default:throw Error(_a(161))}}catch(r){em(e,e.return,r)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function qp(e,t,s){Pp=e,Kp(e)}function Kp(e,t,s){for(var i=!!(1&e.mode);null!==Pp;){var a=Pp,n=a.child;if(22===a.tag&&i){var r=null!==a.memoizedState||Sp;if(!r){var o=a.alternate,l=null!==o&&null!==o.memoizedState||Ep;o=Sp;var c=Ep;if(Sp=r,(Ep=l)&&!c)for(Pp=a;null!==Pp;)l=(r=Pp).child,22===r.tag&&null!==r.memoizedState?Xp(a):null!==l?(l.return=r,Pp=l):Xp(a);for(;null!==n;)Pp=n,Kp(n),n=n.sibling;Pp=a,Sp=o,Ep=c}Zp(e)}else 8772&a.subtreeFlags&&null!==n?(n.return=a,Pp=n):Zp(e)}}function Zp(e){for(;null!==Pp;){var t=Pp;if(8772&t.flags){var s=t.alternate;try{if(8772&t.flags)switch(t.tag){case 0:case 11:case 15:Ep||Dp(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Ep)if(null===s)i.componentDidMount();else{var a=t.elementType===t.type?s.memoizedProps:Rd(t.type,s.memoizedProps);i.componentDidUpdate(a,s.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var n=t.updateQueue;null!==n&&vu(t,n,i);break;case 3:var r=t.updateQueue;if(null!==r){if(s=null,null!==t.child)switch(t.child.tag){case 5:case 1:s=t.child.stateNode}vu(t,r,s)}break;case 5:var o=t.stateNode;if(null===s&&4&t.flags){s=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&s.focus();break;case"img":l.src&&(s.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var h=c.memoizedState;if(null!==h){var u=h.dehydrated;null!==u&&vo(u)}}}break;default:throw Error(_a(163))}Ep||512&t.flags&&Np(t)}catch(d){em(t,t.return,d)}}if(t===e){Pp=null;break}if(null!==(s=t.sibling)){s.return=t.return,Pp=s;break}Pp=t.return}}function Jp(e){for(;null!==Pp;){var t=Pp;if(t===e){Pp=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Pp=s;break}Pp=t.return}}function Xp(e){for(;null!==Pp;){var t=Pp;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{Dp(4,t)}catch(l){em(t,s,l)}break;case 1:var i=t.stateNode;if("function"==typeof i.componentDidMount){var a=t.return;try{i.componentDidMount()}catch(l){em(t,a,l)}}var n=t.return;try{Np(t)}catch(l){em(t,n,l)}break;case 5:var r=t.return;try{Np(t)}catch(l){em(t,r,l)}}}catch(l){em(t,t.return,l)}if(t===e){Pp=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Pp=o;break}Pp=t.return}}var $p,Yp=Math.ceil,ef=Za.ReactCurrentDispatcher,tf=Za.ReactCurrentOwner,sf=Za.ReactCurrentBatchConfig,af=0,nf=null,rf=null,of=0,lf=0,cf=eh(0),hf=0,uf=null,df=0,pf=0,ff=0,mf=null,gf=null,yf=0,bf=1/0,vf=null,wf=!1,xf=null,kf=null,Af=!1,Sf=null,Ef=0,Tf=0,Pf=null,Cf=-1,Mf=0;function Bf(){return 6&af?Pr():-1!==Cf?Cf:Cf=Pr()}function Rf(e){return 1&e.mode?2&af&&0!==of?of&-of:null!==Wh.transition?(0===Mf&&(Mf=Wr()),Mf):0!==(e=Zr)?e:e=void 0===(e=window.event)?16:Po(e.type):1}function Df(e,t,s,i){if(50<Tf)throw Tf=0,Pf=null,Error(_a(185));qr(e,s,i),2&af&&e===nf||(e===nf&&(!(2&af)&&(pf|=s),4===hf&&Lf(e,of)),Nf(e,i),1===s&&0===af&&!(1&t.mode)&&(bf=Pr()+500,mh&&bh()))}function Nf(e,t){var s=e.callbackNode;!function(e,t){for(var s=e.suspendedLanes,i=e.pingedLanes,a=e.expirationTimes,n=e.pendingLanes;0<n;){var r=31-Or(n),o=1<<r,l=a[r];-1===l?o&s&&!(o&i)||(a[r]=Ur(o,t)):l<=t&&(e.expiredLanes|=o),n&=~o}}(e,t);var i=Gr(e,e===nf?of:0);if(0===i)null!==s&&Sr(s),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=s&&Sr(s),1===t)0===e.tag?function(e){mh=!0,yh(e)}(If.bind(null,e)):yh(If.bind(null,e)),Oc((function(){!(6&af)&&bh()})),s=null;else{switch(Jr(i)){case 1:s=Mr;break;case 4:s=Br;break;case 16:default:s=Rr;break;case 536870912:s=Nr}s=nm(s,_f.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function _f(e,t){if(Cf=-1,Mf=0,6&af)throw Error(_a(327));var s=e.callbackNode;if($f()&&e.callbackNode!==s)return null;var i=Gr(e,e===nf?of:0);if(0===i)return null;if(30&i||i&e.expiredLanes||t)t=Qf(e,i);else{t=i;var a=af;af|=2;var n=zf();for(nf===e&&of===t||(vf=null,bf=Pr()+500,Gf(e,t));;)try{Kf();break}catch(o){Uf(e,o)}su(),ef.current=n,af=a,null!==rf?t=0:(nf=null,of=0,t=hf)}if(0!==t){if(2===t&&0!==(a=zr(e))&&(i=a,t=Ff(e,a)),1===t)throw s=uf,Gf(e,0),Lf(e,i),Nf(e,Pr()),s;if(6===t)Lf(e,i);else{if(a=e.current.alternate,!(30&i||function(e){for(var t=e;;){if(16384&t.flags){var s=t.updateQueue;if(null!==s&&null!==(s=s.stores))for(var i=0;i<s.length;i++){var a=s[i],n=a.getSnapshot;a=a.value;try{if(!Ll(n(),a))return!1}catch(r){return!1}}}if(s=t.child,16384&t.subtreeFlags&&null!==s)s.return=t,t=s;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)||(t=Qf(e,i),2===t&&(n=zr(e),0!==n&&(i=n,t=Ff(e,n))),1!==t)))throw s=uf,Gf(e,0),Lf(e,i),Nf(e,Pr()),s;switch(e.finishedWork=a,e.finishedLanes=i,t){case 0:case 1:throw Error(_a(345));case 2:case 5:Xf(e,gf,vf);break;case 3:if(Lf(e,i),(130023424&i)===i&&10<(t=yf+500-Pr())){if(0!==Gr(e,0))break;if(((a=e.suspendedLanes)&i)!==i){Bf(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Nc(Xf.bind(null,e,gf,vf),t);break}Xf(e,gf,vf);break;case 4:if(Lf(e,i),(4194240&i)===i)break;for(t=e.eventTimes,a=-1;0<i;){var r=31-Or(i);n=1<<r,(r=t[r])>a&&(a=r),i&=~n}if(i=a,10<(i=(120>(i=Pr()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Yp(i/1960))-i)){e.timeoutHandle=Nc(Xf.bind(null,e,gf,vf),i);break}Xf(e,gf,vf);break;default:throw Error(_a(329))}}}return Nf(e,Pr()),e.callbackNode===s?_f.bind(null,e):null}function Ff(e,t){var s=mf;return e.current.memoizedState.isDehydrated&&(Gf(e,t).flags|=256),2!==(e=Qf(e,t))&&(t=gf,gf=s,null!==t&&Of(t)),e}function Of(e){null===gf?gf=e:gf.push.apply(gf,e)}function Lf(e,t){for(t&=~ff,t&=~pf,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-Or(t),i=1<<s;e[s]=-1,t&=~i}}function If(e){if(6&af)throw Error(_a(327));$f();var t=Gr(e,0);if(!(1&t))return Nf(e,Pr()),null;var s=Qf(e,t);if(0!==e.tag&&2===s){var i=zr(e);0!==i&&(t=i,s=Ff(e,i))}if(1===s)throw s=uf,Gf(e,0),Lf(e,t),Nf(e,Pr()),s;if(6===s)throw Error(_a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Xf(e,gf,vf),Nf(e,Pr()),null}function jf(e,t){var s=af;af|=1;try{return e(t)}finally{0===(af=s)&&(bf=Pr()+500,mh&&bh())}}function Hf(e){null!==Sf&&0===Sf.tag&&!(6&af)&&$f();var t=af;af|=1;var s=sf.transition,i=Zr;try{if(sf.transition=null,Zr=1,e)return e()}finally{Zr=i,sf.transition=s,!(6&(af=t))&&bh()}}function Vf(){lf=cf.current,th(cf)}function Gf(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(-1!==s&&(e.timeoutHandle=-1,_c(s)),null!==rf)for(s=rf.return;null!==s;){var i=s;switch(Rh(i),i.tag){case 1:null!=(i=i.type.childContextTypes)&&ch();break;case 3:Tu(),th(nh),th(ah),Du();break;case 5:Cu(i);break;case 4:Tu();break;case 13:case 19:th(Mu);break;case 10:iu(i.type._context);break;case 22:case 23:Vf()}s=s.return}if(nf=e,rf=e=cm(e.current,null),of=lf=t,hf=0,uf=null,ff=pf=df=0,gf=mf=null,null!==ou){for(t=0;t<ou.length;t++)if(null!==(i=(s=ou[t]).interleaved)){s.interleaved=null;var a=i.next,n=s.pending;if(null!==n){var r=n.next;n.next=a,i.next=r}s.pending=i}ou=null}return e}function Uf(e,t){for(;;){var s=rf;try{if(su(),Nu.current=Pd,ju){for(var i=Ou.memoizedState;null!==i;){var a=i.queue;null!==a&&(a.pending=null),i=i.next}ju=!1}if(Fu=0,Iu=Lu=Ou=null,Hu=!1,Vu=0,tf.current=null,null===s||null===s.return){hf=1,uf=t,rf=null;break}e:{var n=e,r=s.return,o=s,l=t;if(t=of,o.flags|=32768,null!==l&&"object"==typeof l&&"function"==typeof l.then){var c=l,h=o,u=h.tag;if(!(1&h.mode||0!==u&&11!==u&&15!==u)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=Wd(r);if(null!==p){p.flags&=-257,Qd(p,r,o,0,t),1&p.mode&&zd(n,c,t),l=c;var f=(t=p).updateQueue;if(null===f){var m=new Set;m.add(l),t.updateQueue=m}else f.add(l);break e}if(!(1&t)){zd(n,c,t),Wf();break e}l=Error(_a(426))}else if(_h&&1&o.mode){var g=Wd(r);if(null!==g){!(65536&g.flags)&&(g.flags|=256),Qd(g,r,o,0,t),zh(Id(l,o));break e}}n=l=Id(l,o),4!==hf&&(hf=2),null===mf?mf=[n]:mf.push(n),n=r;do{switch(n.tag){case 3:n.flags|=65536,t&=-t,n.lanes|=t,yu(n,Gd(0,l,t));break e;case 1:o=l;var y=n.type,b=n.stateNode;if(!(128&n.flags||"function"!=typeof y.getDerivedStateFromError&&(null===b||"function"!=typeof b.componentDidCatch||null!==kf&&kf.has(b)))){n.flags|=65536,t&=-t,n.lanes|=t,yu(n,Ud(n,o,t));break e}}n=n.return}while(null!==n)}Jf(s)}catch(v){t=v,rf===s&&null!==s&&(rf=s=s.return);continue}break}}function zf(){var e=ef.current;return ef.current=Pd,null===e?Pd:e}function Wf(){0!==hf&&3!==hf&&2!==hf||(hf=4),null===nf||!(268435455&df)&&!(268435455&pf)||Lf(nf,of)}function Qf(e,t){var s=af;af|=2;var i=zf();for(nf===e&&of===t||(vf=null,Gf(e,t));;)try{qf();break}catch(a){Uf(e,a)}if(su(),af=s,ef.current=i,null!==rf)throw Error(_a(261));return nf=null,of=0,hf}function qf(){for(;null!==rf;)Zf(rf)}function Kf(){for(;null!==rf&&!Er();)Zf(rf)}function Zf(e){var t=$p(e.alternate,e,lf);e.memoizedProps=e.pendingProps,null===t?Jf(e):rf=t,tf.current=null}function Jf(e){var t=e;do{var s=t.alternate;if(e=t.return,32768&t.flags){if(null!==(s=Ap(s,t)))return s.flags&=32767,void(rf=s);if(null===e)return hf=6,void(rf=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}else if(null!==(s=kp(s,t,lf)))return void(rf=s);if(null!==(t=t.sibling))return void(rf=t);rf=t=e}while(null!==t);0===hf&&(hf=5)}function Xf(e,t,s){var i=Zr,a=sf.transition;try{sf.transition=null,Zr=1,function(e,t,s,i){do{$f()}while(null!==Sf);if(6&af)throw Error(_a(327));s=e.finishedWork;var a=e.finishedLanes;if(null===s)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(_a(177));e.callbackNode=null,e.callbackPriority=0;var n=s.lanes|s.childLanes;if(function(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<s;){var a=31-Or(s),n=1<<a;t[a]=0,i[a]=-1,e[a]=-1,s&=~n}}(e,n),e===nf&&(rf=nf=null,of=0),!(2064&s.subtreeFlags)&&!(2064&s.flags)||Af||(Af=!0,nm(Rr,(function(){return $f(),null}))),n=!!(15990&s.flags),15990&s.subtreeFlags||n){n=sf.transition,sf.transition=null;var r=Zr;Zr=1;var o=af;af|=4,tf.current=null,function(e,t){if(Bc=xo,Ul(e=Gl())){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(s=(s=e.ownerDocument)&&s.defaultView||window).getSelection&&s.getSelection();if(i&&0!==i.rangeCount){s=i.anchorNode;var a=i.anchorOffset,n=i.focusNode;i=i.focusOffset;try{s.nodeType,n.nodeType}catch(w){s=null;break e}var r=0,o=-1,l=-1,c=0,h=0,u=e,d=null;t:for(;;){for(var p;u!==s||0!==a&&3!==u.nodeType||(o=r+a),u!==n||0!==i&&3!==u.nodeType||(l=r+i),3===u.nodeType&&(r+=u.nodeValue.length),null!==(p=u.firstChild);)d=u,u=p;for(;;){if(u===e)break t;if(d===s&&++c===a&&(o=r),d===n&&++h===i&&(l=r),null!==(p=u.nextSibling))break;d=(u=d).parentNode}u=p}s=-1===o||-1===l?null:{start:o,end:l}}else s=null}s=s||{start:0,end:0}}else s=null;for(Rc={focusedElem:e,selectionRange:s},xo=!1,Pp=t;null!==Pp;)if(e=(t=Pp).child,1028&t.subtreeFlags&&null!==e)e.return=t,Pp=e;else for(;null!==Pp;){t=Pp;try{var f=t.alternate;if(1024&t.flags)switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var m=f.memoizedProps,g=f.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:Rd(t.type,m),g);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var v=t.stateNode.containerInfo;1===v.nodeType?v.textContent="":9===v.nodeType&&v.documentElement&&v.removeChild(v.documentElement);break;default:throw Error(_a(163))}}catch(w){em(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Pp=e;break}Pp=t.return}f=Bp,Bp=!1}(e,s),Wp(s,e),zl(Rc),xo=!!Bc,Rc=Bc=null,e.current=s,qp(s),Tr(),af=o,Zr=r,sf.transition=n}else e.current=s;if(Af&&(Af=!1,Sf=e,Ef=a),0===(n=e.pendingLanes)&&(kf=null),function(e){if(Fr&&"function"==typeof Fr.onCommitFiberRoot)try{Fr.onCommitFiberRoot(_r,e,void 0,!(128&~e.current.flags))}catch(t){}}(s.stateNode),Nf(e,Pr()),null!==t)for(i=e.onRecoverableError,s=0;s<t.length;s++)i((a=t[s]).value,{componentStack:a.stack,digest:a.digest});if(wf)throw wf=!1,e=xf,xf=null,e;!!(1&Ef)&&0!==e.tag&&$f(),1&(n=e.pendingLanes)?e===Pf?Tf++:(Tf=0,Pf=e):Tf=0,bh()}(e,t,s,i)}finally{sf.transition=a,Zr=i}return null}function $f(){if(null!==Sf){var e=Jr(Ef),t=sf.transition,s=Zr;try{if(sf.transition=null,Zr=16>e?16:e,null===Sf)var i=!1;else{if(e=Sf,Sf=null,Ef=0,6&af)throw Error(_a(331));var a=af;for(af|=4,Pp=e.current;null!==Pp;){var n=Pp,r=n.child;if(16&Pp.flags){var o=n.deletions;if(null!==o){for(var l=0;l<o.length;l++){var c=o[l];for(Pp=c;null!==Pp;){var h=Pp;switch(h.tag){case 0:case 11:case 15:Rp(8,h,n)}var u=h.child;if(null!==u)u.return=h,Pp=u;else for(;null!==Pp;){var d=(h=Pp).sibling,p=h.return;if(_p(h),h===c){Pp=null;break}if(null!==d){d.return=p,Pp=d;break}Pp=p}}}var f=n.alternate;if(null!==f){var m=f.child;if(null!==m){f.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(null!==m)}}Pp=n}}if(2064&n.subtreeFlags&&null!==r)r.return=n,Pp=r;else e:for(;null!==Pp;){if(2048&(n=Pp).flags)switch(n.tag){case 0:case 11:case 15:Rp(9,n,n.return)}var y=n.sibling;if(null!==y){y.return=n.return,Pp=y;break e}Pp=n.return}}var b=e.current;for(Pp=b;null!==Pp;){var v=(r=Pp).child;if(2064&r.subtreeFlags&&null!==v)v.return=r,Pp=v;else e:for(r=b;null!==Pp;){if(2048&(o=Pp).flags)try{switch(o.tag){case 0:case 11:case 15:Dp(9,o)}}catch(x){em(o,o.return,x)}if(o===r){Pp=null;break e}var w=o.sibling;if(null!==w){w.return=o.return,Pp=w;break e}Pp=o.return}}if(af=a,bh(),Fr&&"function"==typeof Fr.onPostCommitFiberRoot)try{Fr.onPostCommitFiberRoot(_r,e)}catch(x){}i=!0}return i}finally{Zr=s,sf.transition=t}}return!1}function Yf(e,t,s){e=mu(e,t=Gd(0,t=Id(s,t),1),1),t=Bf(),null!==e&&(qr(e,1,t),Nf(e,t))}function em(e,t,s){if(3===e.tag)Yf(e,e,s);else for(;null!==t;){if(3===t.tag){Yf(t,e,s);break}if(1===t.tag){var i=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===kf||!kf.has(i))){t=mu(t,e=Ud(t,e=Id(s,e),1),1),e=Bf(),null!==t&&(qr(t,1,e),Nf(t,e));break}}t=t.return}}function tm(e,t,s){var i=e.pingCache;null!==i&&i.delete(t),t=Bf(),e.pingedLanes|=e.suspendedLanes&s,nf===e&&(of&s)===s&&(4===hf||3===hf&&(130023424&of)===of&&500>Pr()-yf?Gf(e,0):ff|=s),Nf(e,t)}function sm(e,t){0===t&&(1&e.mode?(t=Hr,!(130023424&(Hr<<=1))&&(Hr=4194304)):t=1);var s=Bf();null!==(e=hu(e,t))&&(qr(e,t,s),Nf(e,s))}function im(e){var t=e.memoizedState,s=0;null!==t&&(s=t.retryLane),sm(e,s)}function am(e,t){var s=0;switch(e.tag){case 13:var i=e.stateNode,a=e.memoizedState;null!==a&&(s=a.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(_a(314))}null!==i&&i.delete(t),sm(e,s)}function nm(e,t){return Ar(e,t)}function rm(e,t,s,i){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function om(e,t,s,i){return new rm(e,t,s,i)}function lm(e){return!(!(e=e.prototype)||!e.isReactComponent)}function cm(e,t){var s=e.alternate;return null===s?((s=om(e.tag,t,e.key,e.mode)).elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=14680064&e.flags,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function hm(e,t,s,i,a,n){var r=2;if(i=e,"function"==typeof e)lm(e)&&(r=1);else if("string"==typeof e)r=5;else e:switch(e){case $a:return um(s.children,a,n,t);case Ya:r=8,a|=8;break;case en:return(e=om(12,s,t,2|a)).elementType=en,e.lanes=n,e;case nn:return(e=om(13,s,t,a)).elementType=nn,e.lanes=n,e;case rn:return(e=om(19,s,t,a)).elementType=rn,e.lanes=n,e;case cn:return dm(s,a,n,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case tn:r=10;break e;case sn:r=9;break e;case an:r=11;break e;case on:r=14;break e;case ln:r=16,i=null;break e}throw Error(_a(130,null==e?e:typeof e,""))}return(t=om(r,s,t,a)).elementType=e,t.type=i,t.lanes=n,t}function um(e,t,s,i){return(e=om(7,e,i,t)).lanes=s,e}function dm(e,t,s,i){return(e=om(22,e,i,t)).elementType=cn,e.lanes=s,e.stateNode={isHidden:!1},e}function pm(e,t,s){return(e=om(6,e,null,t)).lanes=s,e}function fm(e,t,s){return(t=om(4,null!==e.children?e.children:[],e.key,t)).lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function mm(e,t,s,i,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Qr(0),this.expirationTimes=Qr(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qr(0),this.identifierPrefix=i,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function gm(e,t,s,i,a,n,r,o,l){return e=new mm(e,t,s,o,l),1===t?(t=1,!0===n&&(t|=8)):t=0,n=om(3,null,null,t),e.current=n,n.stateNode=e,n.memoizedState={element:i,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},du(n),e}function ym(e){if(!e)return ih;e:{if(br(e=e._reactInternals)!==e||1!==e.tag)throw Error(_a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(lh(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(_a(171))}if(1===e.tag){var s=e.type;if(lh(s))return uh(e,s,t)}return t}function bm(e,t,s,i,a,n,r,o,l){return(e=gm(s,i,!0,e,0,n,0,o,l)).context=ym(null),s=e.current,(n=fu(i=Bf(),a=Rf(s))).callback=null!=t?t:null,mu(s,n,a),e.current.lanes=a,qr(e,a,i),Nf(e,i),e}function vm(e,t,s,i){var a=t.current,n=Bf(),r=Rf(a);return s=ym(s),null===t.context?t.context=s:t.pendingContext=s,(t=fu(n,r)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=mu(a,t,r))&&(Df(e,a,r,n),gu(e,a,r)),r}function wm(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function xm(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var s=e.retryLane;e.retryLane=0!==s&&s<t?s:t}}function km(e,t){xm(e,t),(e=e.alternate)&&xm(e,t)}$p=function(e,t,s){if(null!==e)if(e.memoizedProps!==t.pendingProps||nh.current)Kd=!0;else{if(!(e.lanes&s||128&t.flags))return Kd=!1,function(e,t,s){switch(t.tag){case 3:ap(t),Uh();break;case 5:Pu(t);break;case 1:lh(t.type)&&dh(t);break;case 4:Eu(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,a=t.memoizedProps.value;sh($h,i._currentValue),i._currentValue=a;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(sh(Mu,1&Mu.current),t.flags|=128,null):s&t.child.childLanes?dp(e,t,s):(sh(Mu,1&Mu.current),null!==(e=vp(e,t,s))?e.sibling:null);sh(Mu,1&Mu.current);break;case 19:if(i=!!(s&t.childLanes),128&e.flags){if(i)return yp(e,t,s);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),sh(Mu,Mu.current),i)break;return null;case 22:case 23:return t.lanes=0,Yd(e,t,s)}return vp(e,t,s)}(e,t,s);Kd=!!(131072&e.flags)}else Kd=!1,_h&&1048576&t.flags&&Mh(t,kh,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;bp(e,t),e=t.pendingProps;var a=oh(t,ah.current);nu(t,s),a=Wu(null,t,i,e,a,s);var n=Qu();return t.flags|=1,"object"==typeof a&&null!==a&&"function"==typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,lh(i)?(n=!0,dh(t)):n=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,du(t),a.updater=Nd,t.stateNode=a,a._reactInternals=t,Ld(t,i,e,s),t=ip(null,t,i,!0,n,s)):(t.tag=0,_h&&n&&Bh(t),Zd(null,t,a,s),t=t.child),t;case 16:i=t.elementType;e:{switch(bp(e,t),e=t.pendingProps,i=(a=i._init)(i._payload),t.type=i,a=t.tag=function(e){if("function"==typeof e)return lm(e)?1:0;if(null!=e){if((e=e.$$typeof)===an)return 11;if(e===on)return 14}return 2}(i),e=Rd(i,e),a){case 0:t=tp(null,t,i,e,s);break e;case 1:t=sp(null,t,i,e,s);break e;case 11:t=Jd(null,t,i,e,s);break e;case 14:t=Xd(null,t,i,Rd(i.type,e),s);break e}throw Error(_a(306,i,""))}return t;case 0:return i=t.type,a=t.pendingProps,tp(e,t,i,a=t.elementType===i?a:Rd(i,a),s);case 1:return i=t.type,a=t.pendingProps,sp(e,t,i,a=t.elementType===i?a:Rd(i,a),s);case 3:e:{if(ap(t),null===e)throw Error(_a(387));i=t.pendingProps,a=(n=t.memoizedState).element,pu(e,t),bu(t,i,null,s);var r=t.memoizedState;if(i=r.element,n.isDehydrated){if(n={element:i,isDehydrated:!1,cache:r.cache,pendingSuspenseBoundaries:r.pendingSuspenseBoundaries,transitions:r.transitions},t.updateQueue.baseState=n,t.memoizedState=n,256&t.flags){t=np(e,t,i,s,a=Id(Error(_a(423)),t));break e}if(i!==a){t=np(e,t,i,s,a=Id(Error(_a(424)),t));break e}for(Nh=jc(t.stateNode.containerInfo.firstChild),Dh=t,_h=!0,Fh=null,s=Xh(t,null,i,s),t.child=s;s;)s.flags=-3&s.flags|4096,s=s.sibling}else{if(Uh(),i===a){t=vp(e,t,s);break e}Zd(e,t,i,s)}t=t.child}return t;case 5:return Pu(t),null===e&&jh(t),i=t.type,a=t.pendingProps,n=null!==e?e.memoizedProps:null,r=a.children,Dc(i,a)?r=null:null!==n&&Dc(i,n)&&(t.flags|=32),ep(e,t),Zd(e,t,r,s),t.child;case 6:return null===e&&jh(t),null;case 13:return dp(e,t,s);case 4:return Eu(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=Jh(t,null,i,s):Zd(e,t,i,s),t.child;case 11:return i=t.type,a=t.pendingProps,Jd(e,t,i,a=t.elementType===i?a:Rd(i,a),s);case 7:return Zd(e,t,t.pendingProps,s),t.child;case 8:case 12:return Zd(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(i=t.type._context,a=t.pendingProps,n=t.memoizedProps,r=a.value,sh($h,i._currentValue),i._currentValue=r,null!==n)if(Ll(n.value,r)){if(n.children===a.children&&!nh.current){t=vp(e,t,s);break e}}else for(null!==(n=t.child)&&(n.return=t);null!==n;){var o=n.dependencies;if(null!==o){r=n.child;for(var l=o.firstContext;null!==l;){if(l.context===i){if(1===n.tag){(l=fu(-1,s&-s)).tag=2;var c=n.updateQueue;if(null!==c){var h=(c=c.shared).pending;null===h?l.next=l:(l.next=h.next,h.next=l),c.pending=l}}n.lanes|=s,null!==(l=n.alternate)&&(l.lanes|=s),au(n.return,s,t),o.lanes|=s;break}l=l.next}}else if(10===n.tag)r=n.type===t.type?null:n.child;else if(18===n.tag){if(null===(r=n.return))throw Error(_a(341));r.lanes|=s,null!==(o=r.alternate)&&(o.lanes|=s),au(r,s,t),r=n.sibling}else r=n.child;if(null!==r)r.return=n;else for(r=n;null!==r;){if(r===t){r=null;break}if(null!==(n=r.sibling)){n.return=r.return,r=n;break}r=r.return}n=r}Zd(e,t,a.children,s),t=t.child}return t;case 9:return a=t.type,i=t.pendingProps.children,nu(t,s),i=i(a=ru(a)),t.flags|=1,Zd(e,t,i,s),t.child;case 14:return a=Rd(i=t.type,t.pendingProps),Xd(e,t,i,a=Rd(i.type,a),s);case 15:return $d(e,t,t.type,t.pendingProps,s);case 17:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:Rd(i,a),bp(e,t),t.tag=1,lh(i)?(e=!0,dh(t)):e=!1,nu(t,s),Fd(t,i,a),Ld(t,i,a,s),ip(null,t,i,!0,e,s);case 19:return yp(e,t,s);case 22:return Yd(e,t,s)}throw Error(_a(156,t.tag))};var Am="function"==typeof reportError?reportError:function(e){console.error(e)};function Sm(e){this._internalRoot=e}function Em(e){this._internalRoot=e}function Tm(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Pm(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Cm(){}function Mm(e,t,s,i,a){var n=s._reactRootContainer;if(n){var r=n;if("function"==typeof a){var o=a;a=function(){var e=wm(r);o.call(e)}}vm(t,r,e,a)}else r=function(e,t,s,i,a){if(a){if("function"==typeof i){var n=i;i=function(){var e=wm(r);n.call(e)}}var r=bm(t,i,e,0,null,!1,0,"",Cm);return e._reactRootContainer=r,e[zc]=r.current,bc(8===e.nodeType?e.parentNode:e),Hf(),r}for(;a=e.lastChild;)e.removeChild(a);if("function"==typeof i){var o=i;i=function(){var e=wm(l);o.call(e)}}var l=gm(e,0,!1,null,0,!1,0,"",Cm);return e._reactRootContainer=l,e[zc]=l.current,bc(8===e.nodeType?e.parentNode:e),Hf((function(){vm(t,l,s,i)})),l}(s,t,e,a,i);return wm(r)}Em.prototype.render=Sm.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(_a(409));vm(e,t,null,null)},Em.prototype.unmount=Sm.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Hf((function(){vm(null,e,null,null)})),t[zc]=null}},Em.prototype.unstable_scheduleHydration=function(e){if(e){var t=eo();e={blockedOn:null,target:e,priority:t};for(var s=0;s<co.length&&0!==t&&t<co[s].priority;s++);co.splice(s,0,e),0===s&&fo(e)}},Xr=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=Vr(t.pendingLanes);0!==s&&(Kr(t,1|s),Nf(t,Pr()),!(6&af)&&(bf=Pr()+500,bh()))}break;case 13:Hf((function(){var t=hu(e,1);if(null!==t){var s=Bf();Df(t,e,1,s)}})),km(e,1)}},$r=function(e){if(13===e.tag){var t=hu(e,134217728);null!==t&&Df(t,e,134217728,Bf()),km(e,134217728)}},Yr=function(e){if(13===e.tag){var t=Rf(e),s=hu(e,t);null!==s&&Df(s,e,t,Bf()),km(e,t)}},eo=function(){return Zr},to=function(e,t){var s=Zr;try{return Zr=e,t()}finally{Zr=s}},$n=function(e,t,s){switch(t){case"input":if(Cn(e,s),t=s.name,"radio"===s.type&&null!=t){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var i=s[t];if(i!==e&&i.form===e.form){var a=Xc(i);if(!a)throw Error(_a(90));An(i),Cn(i,a)}}}break;case"textarea":Fn(e,s);break;case"select":null!=(t=s.value)&&Dn(e,!!s.multiple,t,!1)}},ar=jf,nr=Hf;var Bm={usingClientEntryPoint:!1,Events:[Zc,Jc,Xc,sr,ir,jf]},Rm={findFiberByHostInstance:Kc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Dm={bundleType:Rm.bundleType,version:Rm.version,rendererPackageName:Rm.rendererPackageName,rendererConfig:Rm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Za.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=xr(e))?null:e.stateNode},findFiberByHostInstance:Rm.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Nm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nm.isDisabled&&Nm.supportsFiber)try{_r=Nm.inject(Dm),Fr=Nm}catch(Hn){}}Ca.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Bm,Ca.createPortal=function(e,t){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Tm(t))throw Error(_a(200));return function(e,t,s){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:Xa,key:null==i?null:""+i,children:e,containerInfo:t,implementation:s}}(e,t,null,s)},Ca.createRoot=function(e,t){if(!Tm(e))throw Error(_a(299));var s=!1,i="",a=Am;return null!=t&&(!0===t.unstable_strictMode&&(s=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=gm(e,1,!1,null,0,s,0,i,a),e[zc]=t.current,bc(8===e.nodeType?e.parentNode:e),new Sm(t)},Ca.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(_a(188));throw e=Object.keys(e).join(","),Error(_a(268,e))}return null===(e=xr(t))?null:e.stateNode},Ca.flushSync=function(e){return Hf(e)},Ca.hydrate=function(e,t,s){if(!Pm(t))throw Error(_a(200));return Mm(null,e,t,!0,s)},Ca.hydrateRoot=function(e,t,s){if(!Tm(e))throw Error(_a(405));var i=null!=s&&s.hydratedSources||null,a=!1,n="",r=Am;if(null!=s&&(!0===s.unstable_strictMode&&(a=!0),void 0!==s.identifierPrefix&&(n=s.identifierPrefix),void 0!==s.onRecoverableError&&(r=s.onRecoverableError)),t=bm(t,null,e,1,null!=s?s:null,a,0,n,r),e[zc]=t.current,bc(e),i)for(e=0;e<i.length;e++)a=(a=(s=i[e])._getVersion)(s._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[s,a]:t.mutableSourceEagerHydrationData.push(s,a);return new Em(t)},Ca.render=function(e,t,s){if(!Pm(t))throw Error(_a(200));return Mm(null,e,t,!1,s)},Ca.unmountComponentAtNode=function(e){if(!Pm(e))throw Error(_a(40));return!!e._reactRootContainer&&(Hf((function(){Mm(null,null,e,!1,(function(){e._reactRootContainer=null,e[zc]=null}))})),!0)},Ca.unstable_batchedUpdates=jf,Ca.unstable_renderSubtreeIntoContainer=function(e,t,s,i){if(!Pm(s))throw Error(_a(200));if(null==e||void 0===e._reactInternals)throw Error(_a(38));return Mm(e,t,s,!1,i)},Ca.version="18.3.1-next-f1338f8080-20240426",function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),Pa.exports=Ca;var _m=Pa.exports;Ta.createRoot=_m.createRoot,Ta.hydrateRoot=_m.hydrateRoot;var Fm={};Object.defineProperty(Fm,"__esModule",{value:!0}),Fm.parse=function(e,t){const s=new Vm,i=e.length;if(i<2)return s;const a=(null==t?void 0:t.decode)||zm;let n=0;do{const t=e.indexOf("=",n);if(-1===t)break;const r=e.indexOf(";",n),o=-1===r?i:r;if(t>o){n=e.lastIndexOf(";",t-1)+1;continue}const l=Gm(e,n,t),c=Um(e,t,l),h=e.slice(l,c);if(void 0===s[h]){let i=Gm(e,t+1,o),n=Um(e,o,i);const r=a(e.slice(i,n));s[h]=r}n=o+1}while(n<i);return s},Fm.serialize=function(e,t,s){const i=(null==s?void 0:s.encode)||encodeURIComponent;if(!Om.test(e))throw new TypeError(`argument name is invalid: ${e}`);const a=i(t);if(!Lm.test(a))throw new TypeError(`argument val is invalid: ${t}`);let n=e+"="+a;if(!s)return n;if(void 0!==s.maxAge){if(!Number.isInteger(s.maxAge))throw new TypeError(`option maxAge is invalid: ${s.maxAge}`);n+="; Max-Age="+s.maxAge}if(s.domain){if(!Im.test(s.domain))throw new TypeError(`option domain is invalid: ${s.domain}`);n+="; Domain="+s.domain}if(s.path){if(!jm.test(s.path))throw new TypeError(`option path is invalid: ${s.path}`);n+="; Path="+s.path}if(s.expires){if(!function(e){return"[object Date]"===Hm.call(e)}(s.expires)||!Number.isFinite(s.expires.valueOf()))throw new TypeError(`option expires is invalid: ${s.expires}`);n+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(n+="; HttpOnly"),s.secure&&(n+="; Secure"),s.partitioned&&(n+="; Partitioned"),s.priority)switch("string"==typeof s.priority?s.priority.toLowerCase():void 0){case"low":n+="; Priority=Low";break;case"medium":n+="; Priority=Medium";break;case"high":n+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${s.priority}`)}if(s.sameSite)switch("string"==typeof s.sameSite?s.sameSite.toLowerCase():s.sameSite){case!0:case"strict":n+="; SameSite=Strict";break;case"lax":n+="; SameSite=Lax";break;case"none":n+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${s.sameSite}`)}return n};const Om=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,Lm=/^[\u0021-\u003A\u003C-\u007E]*$/,Im=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,jm=/^[\u0020-\u003A\u003D-\u007E]*$/,Hm=Object.prototype.toString,Vm=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function Gm(e,t,s){do{const s=e.charCodeAt(t);if(32!==s&&9!==s)return t}while(++t<s);return s}function Um(e,t,s){for(;t>s;){const s=e.charCodeAt(--t);if(32!==s&&9!==s)return t+1}return s}function zm(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}var Wm="popstate";function Qm(e,t){if(!1===e||null==e)throw new Error(t)}function qm(e,t){if(!e){"undefined"!=typeof console&&console.warn(t);try{throw new Error(t)}catch(s){}}}function Km(e,t){return{usr:e.state,key:e.key,idx:t}}function Zm(e,t,s=null,i){return{pathname:"string"==typeof e?e:e.pathname,search:"",hash:"",..."string"==typeof t?Xm(t):t,state:s,key:t&&t.key||i||Math.random().toString(36).substring(2,10)}}function Jm({pathname:e="/",search:t="",hash:s=""}){return t&&"?"!==t&&(e+="?"===t.charAt(0)?t:"?"+t),s&&"#"!==s&&(e+="#"===s.charAt(0)?s:"#"+s),e}function Xm(e){let t={};if(e){let s=e.indexOf("#");s>=0&&(t.hash=e.substring(s),e=e.substring(0,s));let i=e.indexOf("?");i>=0&&(t.search=e.substring(i),e=e.substring(0,i)),e&&(t.pathname=e)}return t}function $m(e,t,s="/"){return function(e,t,s){let i=dg(("string"==typeof t?Xm(t):t).pathname||"/",s);if(null==i)return null;let a=Ym(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){return e.length===t.length&&e.slice(0,-1).every(((e,s)=>e===t[s]))?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(a);let n=null;for(let r=0;null==n&&r<a.length;++r){let e=ug(i);n=cg(a[r],e,false)}return n}(e,t,s)}function Ym(e,t=[],s=[],i=""){let a=(e,a,n)=>{let r={relativePath:void 0===n?e.path||"":n,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};r.relativePath.startsWith("/")&&(Qm(r.relativePath.startsWith(i),`Absolute route path "${r.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),r.relativePath=r.relativePath.slice(i.length));let o=gg([i,r.relativePath]),l=s.concat(r);e.children&&e.children.length>0&&(Qm(!0!==e.index,`Index routes must not have child routes. Please remove all child routes from route path "${o}".`),Ym(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:lg(o,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var s;if(""!==e.path&&(null==(s=e.path)?void 0:s.includes("?")))for(let i of eg(e.path))a(e,t,i);else a(e,t)})),t}function eg(e){let t=e.split("/");if(0===t.length)return[];let[s,...i]=t,a=s.endsWith("?"),n=s.replace(/\?$/,"");if(0===i.length)return a?[n,""]:[n];let r=eg(i.join("/")),o=[];return o.push(...r.map((e=>""===e?n:[n,e].join("/")))),a&&o.push(...r),o.map((t=>e.startsWith("/")&&""===t?"/":t))}var tg=/^:[\w-]+$/,sg=3,ig=2,ag=1,ng=10,rg=-2,og=e=>"*"===e;function lg(e,t){let s=e.split("/"),i=s.length;return s.some(og)&&(i+=rg),t&&(i+=ig),s.filter((e=>!og(e))).reduce(((e,t)=>e+(tg.test(t)?sg:""===t?ag:ng)),i)}function cg(e,t,s=!1){let{routesMeta:i}=e,a={},n="/",r=[];for(let o=0;o<i.length;++o){let e=i[o],l=o===i.length-1,c="/"===n?t:t.slice(n.length)||"/",h=hg({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!h&&l&&s&&!i[i.length-1].route.index&&(h=hg({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!h)return null;Object.assign(a,h.params),r.push({params:a,pathname:gg([n,h.pathname]),pathnameBase:yg(gg([n,h.pathnameBase])),route:u}),"/"!==h.pathnameBase&&(n=gg([n,h.pathnameBase]))}return r}function hg(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[s,i]=function(e,t=!1,s=!0){qm("*"===e||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let i=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,s)=>(i.push({paramName:t,isOptional:null!=s}),s?"/?([^\\/]+)?":"/([^\\/]+)")));return e.endsWith("*")?(i.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),i]}(e.path,e.caseSensitive,e.end),a=t.match(s);if(!a)return null;let n=a[0],r=n.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:i.reduce(((e,{paramName:t,isOptional:s},i)=>{if("*"===t){let e=o[i]||"";r=n.slice(0,n.length-e.length).replace(/(.)\/+$/,"$1")}const a=o[i];return e[t]=s&&!a?void 0:(a||"").replace(/%2F/g,"/"),e}),{}),pathname:n,pathnameBase:r,pattern:e}}function ug(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return qm(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function dg(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let s=t.endsWith("/")?t.length-1:t.length,i=e.charAt(s);return i&&"/"!==i?null:e.slice(s)||"/"}function pg(e,t,s,i){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${s}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function fg(e){let t=function(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}(e);return t.map(((e,s)=>s===t.length-1?e.pathname:e.pathnameBase))}function mg(e,t,s,i=!1){let a;"string"==typeof e?a=Xm(e):(a={...e},Qm(!a.pathname||!a.pathname.includes("?"),pg("?","pathname","search",a)),Qm(!a.pathname||!a.pathname.includes("#"),pg("#","pathname","hash",a)),Qm(!a.search||!a.search.includes("#"),pg("#","search","hash",a)));let n,r=""===e||""===a.pathname,o=r?"/":a.pathname;if(null==o)n=s;else{let e=t.length-1;if(!i&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}n=e>=0?t[e]:"/"}let l=function(e,t="/"){let{pathname:s,search:i="",hash:a=""}="string"==typeof e?Xm(e):e,n=s?s.startsWith("/")?s:function(e,t){let s=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?s.length>1&&s.pop():"."!==e&&s.push(e)})),s.length>1?s.join("/"):"/"}(s,t):t;return{pathname:n,search:bg(i),hash:vg(a)}}(a,n),c=o&&"/"!==o&&o.endsWith("/"),h=(r||"."===o)&&s.endsWith("/");return l.pathname.endsWith("/")||!c&&!h||(l.pathname+="/"),l}var gg=e=>e.join("/").replace(/\/\/+/g,"/"),yg=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),bg=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",vg=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"",wg=["POST","PUT","PATCH","DELETE"];new Set(wg);var xg=["GET",...wg];new Set(xg);var kg=ga.createContext(null);kg.displayName="DataRouter";var Ag=ga.createContext(null);Ag.displayName="DataRouterState";var Sg=ga.createContext({isTransitioning:!1});Sg.displayName="ViewTransition",ga.createContext(new Map).displayName="Fetchers",ga.createContext(null).displayName="Await";var Eg=ga.createContext(null);Eg.displayName="Navigation";var Tg=ga.createContext(null);Tg.displayName="Location";var Pg=ga.createContext({outlet:null,matches:[],isDataRoute:!1});Pg.displayName="Route";var Cg=ga.createContext(null);function Mg(){return null!=ga.useContext(Tg)}function Bg(){return Qm(Mg(),"useLocation() may be used only in the context of a <Router> component."),ga.useContext(Tg).location}Cg.displayName="RouteError";var Rg="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Dg(e){ga.useContext(Eg).static||ga.useLayoutEffect(e)}function Ng(){let{isDataRoute:e}=ga.useContext(Pg);return e?function(){let{router:e}=function(){let e=ga.useContext(kg);return Qm(e,Vg("useNavigate")),e}(),t=Gg("useNavigate"),s=ga.useRef(!1);return Dg((()=>{s.current=!0})),ga.useCallback((async(i,a={})=>{qm(s.current,Rg),s.current&&("number"==typeof i?e.navigate(i):await e.navigate(i,{fromRouteId:t,...a}))}),[e,t])}():function(){Qm(Mg(),"useNavigate() may be used only in the context of a <Router> component.");let e=ga.useContext(kg),{basename:t,navigator:s}=ga.useContext(Eg),{matches:i}=ga.useContext(Pg),{pathname:a}=Bg(),n=JSON.stringify(fg(i)),r=ga.useRef(!1);return Dg((()=>{r.current=!0})),ga.useCallback(((i,o={})=>{if(qm(r.current,Rg),!r.current)return;if("number"==typeof i)return void s.go(i);let l=mg(i,JSON.parse(n),a,"path"===o.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:gg([t,l.pathname])),(o.replace?s.replace:s.push)(l,o.state,o)}),[t,s,n,a,e])}()}var _g=ga.createContext(null);function Fg(e,{relative:t}={}){let{matches:s}=ga.useContext(Pg),{pathname:i}=Bg(),a=JSON.stringify(fg(s));return ga.useMemo((()=>mg(e,JSON.parse(a),i,"path"===t)),[e,a,i,t])}function Og(e,t,s,i){var a;Qm(Mg(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:n,static:r}=ga.useContext(Eg),{matches:o}=ga.useContext(Pg),l=o[o.length-1],c=l?l.params:{},h=l?l.pathname:"/",u=l?l.pathnameBase:"/",d=l&&l.route;{let e=d&&d.path||"";zg(h,!d||e.endsWith("*")||e.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="${e}"> to <Route path="${"/"===e?"*":`${e}/*`}">.`)}let p,f=Bg();if(t){let e="string"==typeof t?Xm(t):t;Qm("/"===u||(null==(a=e.pathname)?void 0:a.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${e.pathname}" was given in the \`location\` prop.`),p=e}else p=f;let m=p.pathname||"/",g=m;if("/"!==u){let e=u.replace(/^\//,"").split("/");g="/"+m.replace(/^\//,"").split("/").slice(e.length).join("/")}let y=!r&&s&&s.matches&&s.matches.length>0?s.matches:$m(e,{pathname:g});qm(d||null!=y,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),qm(null==y||void 0!==y[y.length-1].route.element||void 0!==y[y.length-1].route.Component||void 0!==y[y.length-1].route.lazy,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let b=function(e,t=[],s=null){if(null==e){if(!s)return null;if(s.errors)e=s.matches;else{if(0!==t.length||s.initialized||!(s.matches.length>0))return null;e=s.matches}}let i=e,a=null==s?void 0:s.errors;if(null!=a){let e=i.findIndex((e=>e.route.id&&void 0!==(null==a?void 0:a[e.route.id])));Qm(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),i=i.slice(0,Math.min(i.length,e+1))}let n=!1,r=-1;if(s)for(let o=0;o<i.length;o++){let e=i[o];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(r=o),e.route.id){let{loaderData:t,errors:a}=s,o=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!a||void 0===a[e.route.id]);if(e.route.lazy||o){n=!0,i=r>=0?i.slice(0,r+1):[i[0]];break}}}return i.reduceRight(((e,o,l)=>{let c,h=!1,u=null,d=null;s&&(c=a&&o.route.id?a[o.route.id]:void 0,u=o.route.errorElement||Ig,n&&(r<0&&0===l?(zg("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,d=null):r===l&&(h=!0,d=o.route.hydrateFallbackElement||null)));let p=t.concat(i.slice(0,l+1)),f=()=>{let t;return t=c?u:h?d:o.route.Component?ga.createElement(o.route.Component,null):o.route.element?o.route.element:e,ga.createElement(Hg,{match:o,routeContext:{outlet:e,matches:p,isDataRoute:null!=s},children:t})};return s&&(o.route.ErrorBoundary||o.route.errorElement||0===l)?ga.createElement(jg,{location:s.location,revalidation:s.revalidation,component:u,error:c,children:f(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):f()}),null)}(y&&y.map((e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:gg([u,n.encodeLocation?n.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:gg([u,n.encodeLocation?n.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),o,s);return t&&b?ga.createElement(Tg.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...p},navigationType:"POP"}},b):b}function Lg(){let e=function(){var e;let t=ga.useContext(Cg),s=function(){let e=ga.useContext(Ag);return Qm(e,Vg("useRouteError")),e}(),i=Gg("useRouteError");return void 0!==t?t:null==(e=s.errors)?void 0:e[i]}(),t=function(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},n={padding:"2px 4px",backgroundColor:i},r=null;return console.error("Error handled by React Router default ErrorBoundary:",e),r=ga.createElement(ga.Fragment,null,ga.createElement("p",null," Hey developer "),ga.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ga.createElement("code",{style:n},"ErrorBoundary")," or"," ",ga.createElement("code",{style:n},"errorElement")," prop on your route.")),ga.createElement(ga.Fragment,null,ga.createElement("h2",null,"Unexpected Application Error!"),ga.createElement("h3",{style:{fontStyle:"italic"}},t),s?ga.createElement("pre",{style:a},s):null,r)}var Ig=ga.createElement(Lg,null),jg=class extends ga.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?ga.createElement(Pg.Provider,{value:this.props.routeContext},ga.createElement(Cg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Hg({routeContext:e,match:t,children:s}){let i=ga.useContext(kg);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),ga.createElement(Pg.Provider,{value:e},s)}function Vg(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Gg(e){let t=function(e){let t=ga.useContext(Pg);return Qm(t,Vg(e)),t}(e),s=t.matches[t.matches.length-1];return Qm(s.route.id,`${e} can only be used on routes that contain a unique "id"`),s.route.id}var Ug={};function zg(e,t,s){t||Ug[e]||(Ug[e]=!0,qm(!1,s))}function Wg({to:e,replace:t,state:s,relative:i}){Qm(Mg(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=ga.useContext(Eg);qm(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:n}=ga.useContext(Pg),{pathname:r}=Bg(),o=Ng(),l=mg(e,fg(n),r,"path"===i),c=JSON.stringify(l);return ga.useEffect((()=>{o(JSON.parse(c),{replace:t,state:s,relative:i})}),[o,c,i,t,s]),null}function Qg(e){return function(e){let t=ga.useContext(Pg).outlet;return t?ga.createElement(_g.Provider,{value:e},t):t}(e.context)}function qg(e){Qm(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Kg({basename:e="/",children:t=null,location:s,navigationType:i="POP",navigator:a,static:n=!1}){Qm(!Mg(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let r=e.replace(/^\/*/,"/"),o=ga.useMemo((()=>({basename:r,navigator:a,static:n,future:{}})),[r,a,n]);"string"==typeof s&&(s=Xm(s));let{pathname:l="/",search:c="",hash:h="",state:u=null,key:d="default"}=s,p=ga.useMemo((()=>{let e=dg(l,r);return null==e?null:{location:{pathname:e,search:c,hash:h,state:u,key:d},navigationType:i}}),[r,l,c,h,u,d,i]);return qm(null!=p,`<Router basename="${r}"> is not able to match the URL "${l}${c}${h}" because it does not start with the basename, so the <Router> won't render anything.`),null==p?null:ga.createElement(Eg.Provider,{value:o},ga.createElement(Tg.Provider,{children:t,value:p}))}function Zg({children:e,location:t}){return Og(Jg(e),t)}function Jg(e,t=[]){let s=[];return ga.Children.forEach(e,((e,i)=>{if(!ga.isValidElement(e))return;let a=[...t,i];if(e.type===ga.Fragment)return void s.push.apply(s,Jg(e.props.children,a));Qm(e.type===qg,`[${"string"==typeof e.type?e.type:e.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Qm(!e.props.index||!e.props.children,"An index route cannot have child routes.");let n={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(n.children=Jg(e.props.children,a)),s.push(n)})),s}ga.memo((function({routes:e,future:t,state:s}){return Og(e,void 0,s)}));var Xg="get",$g="application/x-www-form-urlencoded";function Yg(e){return null!=e&&"string"==typeof e.tagName}var ey=null,ty=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function sy(e){return null==e||ty.has(e)?e:(qm(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${$g}"`),null)}function iy(e,t){if(!1===e||null==e)throw new Error(t)}function ay(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"==typeof e.imageSrcSet&&"string"==typeof e.imageSizes:"string"==typeof e.rel&&"string"==typeof e.href)}function ny(e,t,s,i,a,n){let r=(e,t)=>!s[t]||e.route.id!==s[t].route.id,o=(e,t)=>{var i;return s[t].pathname!==e.pathname||(null==(i=s[t].route.path)?void 0:i.endsWith("*"))&&s[t].params["*"]!==e.params["*"]};return"assets"===n?t.filter(((e,t)=>r(e,t)||o(e,t))):"data"===n?t.filter(((t,n)=>{var l;let c=i.routes[t.route.id];if(!c||!c.hasLoader)return!1;if(r(t,n)||o(t,n))return!0;if(t.route.shouldRevalidate){let i=t.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:(null==(l=s[0])?void 0:l.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"==typeof i)return i}return!0})):[]}function ry(){let e=ga.useContext(kg);return iy(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var oy=ga.createContext(void 0);function ly(){let e=ga.useContext(oy);return iy(e,"You must render this element inside a <HydratedRouter> element"),e}function cy(e,t){return s=>{e&&e(s),s.defaultPrevented||t(s)}}function hy({page:e,...t}){let{router:s}=ry(),i=ga.useMemo((()=>$m(s.routes,e,s.basename)),[s.routes,e,s.basename]);return i?ga.createElement(uy,{page:e,matches:i,...t}):null}function uy({page:e,matches:t,...s}){let i=Bg(),{manifest:a,routeModules:n}=ly(),{basename:r}=ry(),{loaderData:o,matches:l}=function(){let e=ga.useContext(Ag);return iy(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}(),c=ga.useMemo((()=>ny(e,t,l,a,i,"data")),[e,t,l,a,i]),h=ga.useMemo((()=>ny(e,t,l,a,i,"assets")),[e,t,l,a,i]),u=ga.useMemo((()=>{if(e===i.pathname+i.search+i.hash)return[];let s=new Set,l=!1;if(t.forEach((e=>{var t;let i=a.routes[e.route.id];i&&i.hasLoader&&(!c.some((t=>t.route.id===e.route.id))&&e.route.id in o&&(null==(t=n[e.route.id])?void 0:t.shouldRevalidate)||i.hasClientLoader?l=!0:s.add(e.route.id))})),0===s.size)return[];let h=function(e,t){let s="string"==typeof e?new URL(e,"undefined"==typeof window?"server://singlefetch/":window.location.origin):e;return"/"===s.pathname?s.pathname="_root.data":t&&"/"===dg(s.pathname,t)?s.pathname=`${t.replace(/\/$/,"")}/_root.data`:s.pathname=`${s.pathname.replace(/\/$/,"")}.data`,s}(e,r);return l&&s.size>0&&h.searchParams.set("_routes",t.filter((e=>s.has(e.route.id))).map((e=>e.route.id)).join(",")),[h.pathname+h.search]}),[r,o,i,a,c,t,e,n]),d=ga.useMemo((()=>function(e,t,{includeHydrateFallback:s}={}){return i=e.map((e=>{let i=t.routes[e.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),s&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a})).flat(1),[...new Set(i)];var i}(h,a)),[h,a]),p=function(e){let{manifest:t,routeModules:s}=ly(),[i,a]=ga.useState([]);return ga.useEffect((()=>{let i=!1;return async function(e,t,s){return function(e){let t=new Set;return new Set(void 0),e.reduce(((e,s)=>{let i=JSON.stringify(function(e){let t={},s=Object.keys(e).sort();for(let i of s)t[i]=e[i];return t}(s));return t.has(i)||(t.add(i),e.push({key:i,link:s})),e}),[])}((await Promise.all(e.map((async e=>{let i=t.routes[e.route.id];if(i){let e=await async function(e,t){if(e.id in t)return t[e.id];try{let s=await import(e.module);return t[e.id]=s,s}catch(s){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(s),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise((()=>{}))}}(i,s);return e.links?e.links():[]}return[]})))).flat(1).filter(ay).filter((e=>"stylesheet"===e.rel||"preload"===e.rel)).map((e=>"stylesheet"===e.rel?{...e,rel:"prefetch",as:"style"}:{...e,rel:"prefetch"})))}(e,t,s).then((e=>{i||a(e)})),()=>{i=!0}}),[e,t,s]),i}(h);return ga.createElement(ga.Fragment,null,u.map((e=>ga.createElement("link",{key:e,rel:"prefetch",as:"fetch",href:e,...s}))),d.map((e=>ga.createElement("link",{key:e,rel:"modulepreload",href:e,...s}))),p.map((({key:e,link:t})=>ga.createElement("link",{key:e,...t}))))}function dy(...e){return t=>{e.forEach((e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)}))}}oy.displayName="FrameworkContext";var py="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;try{py&&(window.__reactRouterVersion="7.6.0")}catch(SD){}function fy({basename:e,children:t,window:s}){let i=ga.useRef();null==i.current&&(i.current=function(e={}){return function(e,t,s,i={}){let{window:a=document.defaultView,v5Compat:n=!1}=i,r=a.history,o="POP",l=null,c=h();function h(){return(r.state||{idx:null}).idx}function u(){o="POP";let e=h(),t=null==e?null:e-c;c=e,l&&l({action:o,location:p.location,delta:t})}function d(e){return function(e,t=!1){let s="http://localhost";"undefined"!=typeof window&&(s="null"!==window.location.origin?window.location.origin:window.location.href),Qm(s,"No window.location.(origin|href) available to create URL");let i="string"==typeof e?e:Jm(e);return i=i.replace(/ $/,"%20"),!t&&i.startsWith("//")&&(i=s+i),new URL(i,s)}(e)}null==c&&(c=0,r.replaceState({...r.state,idx:c},""));let p={get action(){return o},get location(){return e(a,r)},listen(e){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(Wm,u),l=e,()=>{a.removeEventListener(Wm,u),l=null}},createHref:e=>t(a,e),createURL:d,encodeLocation(e){let t=d(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o="PUSH";let s=Zm(p.location,e,t);c=h()+1;let i=Km(s,c),u=p.createHref(s);try{r.pushState(i,"",u)}catch(d){if(d instanceof DOMException&&"DataCloneError"===d.name)throw d;a.location.assign(u)}n&&l&&l({action:o,location:p.location,delta:1})},replace:function(e,t){o="REPLACE";let s=Zm(p.location,e,t);c=h();let i=Km(s,c),a=p.createHref(s);r.replaceState(i,"",a),n&&l&&l({action:o,location:p.location,delta:0})},go:e=>r.go(e)};return p}((function(e,t){let{pathname:s,search:i,hash:a}=e.location;return Zm("",{pathname:s,search:i,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"==typeof t?t:Jm(t)}),0,e)}({window:s,v5Compat:!0}));let a=i.current,[n,r]=ga.useState({action:a.action,location:a.location}),o=ga.useCallback((e=>{ga.startTransition((()=>r(e)))}),[r]);return ga.useLayoutEffect((()=>a.listen(o)),[a,o]),ga.createElement(Kg,{basename:e,children:t,location:n.location,navigationType:n.action,navigator:a})}var my=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gy=ga.forwardRef((function({onClick:e,discover:t="render",prefetch:s="none",relative:i,reloadDocument:a,replace:n,state:r,target:o,to:l,preventScrollReset:c,viewTransition:h,...u},d){let p,{basename:f}=ga.useContext(Eg),m="string"==typeof l&&my.test(l),g=!1;if("string"==typeof l&&m&&(p=l,py))try{let e=new URL(window.location.href),t=l.startsWith("//")?new URL(e.protocol+l):new URL(l),s=dg(t.pathname,f);t.origin===e.origin&&null!=s?l=s+t.search+t.hash:g=!0}catch(SD){qm(!1,`<Link to="${l}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=function(e,{relative:t}={}){Qm(Mg(),"useHref() may be used only in the context of a <Router> component.");let{basename:s,navigator:i}=ga.useContext(Eg),{hash:a,pathname:n,search:r}=Fg(e,{relative:t}),o=n;return"/"!==s&&(o="/"===n?s:gg([s,n])),i.createHref({pathname:o,search:r,hash:a})}(l,{relative:i}),[b,v,w]=function(e,t){let s=ga.useContext(oy),[i,a]=ga.useState(!1),[n,r]=ga.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:c,onMouseLeave:h,onTouchStart:u}=t,d=ga.useRef(null);ga.useEffect((()=>{if("render"===e&&r(!0),"viewport"===e){let e=new IntersectionObserver((e=>{e.forEach((e=>{r(e.isIntersecting)}))}),{threshold:.5});return d.current&&e.observe(d.current),()=>{e.disconnect()}}}),[e]),ga.useEffect((()=>{if(i){let e=setTimeout((()=>{r(!0)}),100);return()=>{clearTimeout(e)}}}),[i]);let p=()=>{a(!0)},f=()=>{a(!1),r(!1)};return s?"intent"!==e?[n,d,{}]:[n,d,{onFocus:cy(o,p),onBlur:cy(l,f),onMouseEnter:cy(c,p),onMouseLeave:cy(h,f),onTouchStart:cy(u,p)}]:[!1,d,{}]}(s,u),x=function(e,{target:t,replace:s,state:i,preventScrollReset:a,relative:n,viewTransition:r}={}){let o=Ng(),l=Bg(),c=Fg(e,{relative:n});return ga.useCallback((h=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(h,t)){h.preventDefault();let t=void 0!==s?s:Jm(l)===Jm(c);o(e,{replace:t,state:i,preventScrollReset:a,relative:n,viewTransition:r})}}),[l,o,c,s,i,t,e,a,n,r])}(l,{replace:n,state:r,target:o,preventScrollReset:c,relative:i,viewTransition:h}),k=ga.createElement("a",{...u,...w,href:p||y,onClick:g||a?e:function(t){e&&e(t),t.defaultPrevented||x(t)},ref:dy(d,v),target:o,"data-discover":m||"render"!==t?void 0:"true"});return b&&!m?ga.createElement(ga.Fragment,null,k,ga.createElement(hy,{page:y})):k}));function yy(e){let t=ga.useContext(kg);return Qm(t,function(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}(e)),t}gy.displayName="Link",ga.forwardRef((function({"aria-current":e="page",caseSensitive:t=!1,className:s="",end:i=!1,style:a,to:n,viewTransition:r,children:o,...l},c){let h=Fg(n,{relative:l.relative}),u=Bg(),d=ga.useContext(Ag),{navigator:p,basename:f}=ga.useContext(Eg),m=null!=d&&function(e,t={}){let s=ga.useContext(Sg);Qm(null!=s,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=yy("useViewTransitionState"),a=Fg(e,{relative:t.relative});if(!s.isTransitioning)return!1;let n=dg(s.currentLocation.pathname,i)||s.currentLocation.pathname,r=dg(s.nextLocation.pathname,i)||s.nextLocation.pathname;return null!=hg(a.pathname,r)||null!=hg(a.pathname,n)}(h)&&!0===r,g=p.encodeLocation?p.encodeLocation(h).pathname:h.pathname,y=u.pathname,b=d&&d.navigation&&d.navigation.location?d.navigation.location.pathname:null;t||(y=y.toLowerCase(),b=b?b.toLowerCase():null,g=g.toLowerCase()),b&&f&&(b=dg(b,f)||b);const v="/"!==g&&g.endsWith("/")?g.length-1:g.length;let w,x=y===g||!i&&y.startsWith(g)&&"/"===y.charAt(v),k=null!=b&&(b===g||!i&&b.startsWith(g)&&"/"===b.charAt(g.length)),A={isActive:x,isPending:k,isTransitioning:m},S=x?e:void 0;w="function"==typeof s?s(A):[s,x?"active":null,k?"pending":null,m?"transitioning":null].filter(Boolean).join(" ");let E="function"==typeof a?a(A):a;return ga.createElement(gy,{...l,"aria-current":S,className:w,ref:c,style:E,to:n,viewTransition:r},"function"==typeof o?o(A):o)})).displayName="NavLink",ga.forwardRef((({discover:e="render",fetcherKey:t,navigate:s,reloadDocument:i,replace:a,state:n,method:r=Xg,action:o,onSubmit:l,relative:c,preventScrollReset:h,viewTransition:u,...d},p)=>{let f=function(){let{router:e}=yy("useSubmit"),{basename:t}=ga.useContext(Eg),s=Gg("useRouteId");return ga.useCallback((async(i,a={})=>{let{action:n,method:r,encType:o,formData:l,body:c}=function(e,t){let s,i,a,n,r;if(Yg(o=e)&&"form"===o.tagName.toLowerCase()){let r=e.getAttribute("action");i=r?dg(r,t):null,s=e.getAttribute("method")||Xg,a=sy(e.getAttribute("enctype"))||$g,n=new FormData(e)}else if(function(e){return Yg(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Yg(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let r=e.form;if(null==r)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||r.getAttribute("action");if(i=o?dg(o,t):null,s=e.getAttribute("formmethod")||r.getAttribute("method")||Xg,a=sy(e.getAttribute("formenctype"))||sy(r.getAttribute("enctype"))||$g,n=new FormData(r,e),!function(){if(null===ey)try{new FormData(document.createElement("form"),0),ey=!1}catch(SD){ey=!0}return ey}()){let{name:t,type:s,value:i}=e;if("image"===s){let e=t?`${t}.`:"";n.append(`${e}x`,"0"),n.append(`${e}y`,"0")}else t&&n.append(t,i)}}else{if(Yg(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');s=Xg,i=null,a=$g,r=e}var o;return n&&"text/plain"===a&&(r=n,n=void 0),{action:i,method:s.toLowerCase(),encType:a,formData:n,body:r}}(i,t);if(!1===a.navigate){let t=a.fetcherKey||vy();await e.fetch(t,s,a.action||n,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||r,formEncType:a.encType||o,flushSync:a.flushSync})}else await e.navigate(a.action||n,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||r,formEncType:a.encType||o,replace:a.replace,state:a.state,fromRouteId:s,flushSync:a.flushSync,viewTransition:a.viewTransition})}),[e,t,s])}(),m=function(e,{relative:t}={}){let{basename:s}=ga.useContext(Eg),i=ga.useContext(Pg);Qm(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),n={...Fg(e||".",{relative:t})},r=Bg();if(null==e){n.search=r.search;let e=new URLSearchParams(n.search),t=e.getAll("index");if(t.some((e=>""===e))){e.delete("index"),t.filter((e=>e)).forEach((t=>e.append("index",t)));let s=e.toString();n.search=s?`?${s}`:""}}return e&&"."!==e||!a.route.index||(n.search=n.search?n.search.replace(/^\?/,"?index&"):"?index"),"/"!==s&&(n.pathname="/"===n.pathname?s:gg([s,n.pathname])),Jm(n)}(o,{relative:c}),g="get"===r.toLowerCase()?"get":"post",y="string"==typeof o&&my.test(o);return ga.createElement("form",{ref:p,method:g,action:m,onSubmit:i?l:e=>{if(l&&l(e),e.defaultPrevented)return;e.preventDefault();let i=e.nativeEvent.submitter,o=(null==i?void 0:i.getAttribute("formmethod"))||r;f(i||e.currentTarget,{fetcherKey:t,method:o,navigate:s,replace:a,state:n,relative:c,preventScrollReset:h,viewTransition:u})},...d,"data-discover":y||"render"!==e?void 0:"true"})})).displayName="Form";var by=0,vy=()=>`__${String(++by)}__`;function wy(e,t){return function(){return e.apply(t,arguments)}}const{toString:xy}=Object.prototype,{getPrototypeOf:ky}=Object,{iterator:Ay,toStringTag:Sy}=Symbol,Ey=(e=>t=>{const s=xy.call(t);return e[s]||(e[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),Ty=e=>(e=e.toLowerCase(),t=>Ey(t)===e),Py=e=>t=>typeof t===e,{isArray:Cy}=Array,My=Py("undefined"),By=Ty("ArrayBuffer"),Ry=Py("string"),Dy=Py("function"),Ny=Py("number"),_y=e=>null!==e&&"object"==typeof e,Fy=e=>{if("object"!==Ey(e))return!1;const t=ky(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Sy in e||Ay in e)},Oy=Ty("Date"),Ly=Ty("File"),Iy=Ty("Blob"),jy=Ty("FileList"),Hy=Ty("URLSearchParams"),[Vy,Gy,Uy,zy]=["ReadableStream","Request","Response","Headers"].map(Ty);function Wy(e,t,{allOwnKeys:s=!1}={}){if(null==e)return;let i,a;if("object"!=typeof e&&(e=[e]),Cy(e))for(i=0,a=e.length;i<a;i++)t.call(null,e[i],i,e);else{const a=s?Object.getOwnPropertyNames(e):Object.keys(e),n=a.length;let r;for(i=0;i<n;i++)r=a[i],t.call(null,e[r],r,e)}}function Qy(e,t){t=t.toLowerCase();const s=Object.keys(e);let i,a=s.length;for(;a-- >0;)if(i=s[a],t===i.toLowerCase())return i;return null}const qy="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,Ky=e=>!My(e)&&e!==qy,Zy=(e=>t=>e&&t instanceof e)("undefined"!=typeof Uint8Array&&ky(Uint8Array)),Jy=Ty("HTMLFormElement"),Xy=(({hasOwnProperty:e})=>(t,s)=>e.call(t,s))(Object.prototype),$y=Ty("RegExp"),Yy=(e,t)=>{const s=Object.getOwnPropertyDescriptors(e),i={};Wy(s,((s,a)=>{let n;!1!==(n=t(s,a,e))&&(i[a]=n||s)})),Object.defineProperties(e,i)},eb=Ty("AsyncFunction"),tb=(sb="function"==typeof setImmediate,ib=Dy(qy.postMessage),sb?setImmediate:ib?(ab=`axios@${Math.random()}`,nb=[],qy.addEventListener("message",(({source:e,data:t})=>{e===qy&&t===ab&&nb.length&&nb.shift()()}),!1),e=>{nb.push(e),qy.postMessage(ab,"*")}):e=>setTimeout(e));var sb,ib,ab,nb;const rb="undefined"!=typeof queueMicrotask?queueMicrotask.bind(qy):"undefined"!=typeof process&&process.nextTick||tb,ob={isArray:Cy,isArrayBuffer:By,isBuffer:function(e){return null!==e&&!My(e)&&null!==e.constructor&&!My(e.constructor)&&Dy(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||Dy(e.append)&&("formdata"===(t=Ey(e))||"object"===t&&Dy(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&By(e.buffer),t},isString:Ry,isNumber:Ny,isBoolean:e=>!0===e||!1===e,isObject:_y,isPlainObject:Fy,isReadableStream:Vy,isRequest:Gy,isResponse:Uy,isHeaders:zy,isUndefined:My,isDate:Oy,isFile:Ly,isBlob:Iy,isRegExp:$y,isFunction:Dy,isStream:e=>_y(e)&&Dy(e.pipe),isURLSearchParams:Hy,isTypedArray:Zy,isFileList:jy,forEach:Wy,merge:function e(){const{caseless:t}=Ky(this)&&this||{},s={},i=(i,a)=>{const n=t&&Qy(s,a)||a;Fy(s[n])&&Fy(i)?s[n]=e(s[n],i):Fy(i)?s[n]=e({},i):Cy(i)?s[n]=i.slice():s[n]=i};for(let a=0,n=arguments.length;a<n;a++)arguments[a]&&Wy(arguments[a],i);return s},extend:(e,t,s,{allOwnKeys:i}={})=>(Wy(t,((t,i)=>{s&&Dy(t)?e[i]=wy(t,s):e[i]=t}),{allOwnKeys:i}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,s,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),s&&Object.assign(e.prototype,s)},toFlatObject:(e,t,s,i)=>{let a,n,r;const o={};if(t=t||{},null==e)return t;do{for(a=Object.getOwnPropertyNames(e),n=a.length;n-- >0;)r=a[n],i&&!i(r,e,t)||o[r]||(t[r]=e[r],o[r]=!0);e=!1!==s&&ky(e)}while(e&&(!s||s(e,t))&&e!==Object.prototype);return t},kindOf:Ey,kindOfTest:Ty,endsWith:(e,t,s)=>{e=String(e),(void 0===s||s>e.length)&&(s=e.length),s-=t.length;const i=e.indexOf(t,s);return-1!==i&&i===s},toArray:e=>{if(!e)return null;if(Cy(e))return e;let t=e.length;if(!Ny(t))return null;const s=new Array(t);for(;t-- >0;)s[t]=e[t];return s},forEachEntry:(e,t)=>{const s=(e&&e[Ay]).call(e);let i;for(;(i=s.next())&&!i.done;){const s=i.value;t.call(e,s[0],s[1])}},matchAll:(e,t)=>{let s;const i=[];for(;null!==(s=e.exec(t));)i.push(s);return i},isHTMLForm:Jy,hasOwnProperty:Xy,hasOwnProp:Xy,reduceDescriptors:Yy,freezeMethods:e=>{Yy(e,((t,s)=>{if(Dy(e)&&-1!==["arguments","caller","callee"].indexOf(s))return!1;const i=e[s];Dy(i)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")}))}))},toObjectSet:(e,t)=>{const s={},i=e=>{e.forEach((e=>{s[e]=!0}))};return Cy(e)?i(e):i(String(e).split(t)),s},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,s){return t.toUpperCase()+s})),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:Qy,global:qy,isContextDefined:Ky,isSpecCompliantForm:function(e){return!!(e&&Dy(e.append)&&"FormData"===e[Sy]&&e[Ay])},toJSONObject:e=>{const t=new Array(10),s=(e,i)=>{if(_y(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[i]=e;const a=Cy(e)?[]:{};return Wy(e,((e,t)=>{const n=s(e,i+1);!My(n)&&(a[t]=n)})),t[i]=void 0,a}}return e};return s(e,0)},isAsyncFn:eb,isThenable:e=>e&&(_y(e)||Dy(e))&&Dy(e.then)&&Dy(e.catch),setImmediate:tb,asap:rb,isIterable:e=>null!=e&&Dy(e[Ay])};function lb(e,t,s,i,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),s&&(this.config=s),i&&(this.request=i),a&&(this.response=a,this.status=a.status?a.status:null)}ob.inherits(lb,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ob.toJSONObject(this.config),code:this.code,status:this.status}}});const cb=lb.prototype,hb={};function ub(e){return ob.isPlainObject(e)||ob.isArray(e)}function db(e){return ob.endsWith(e,"[]")?e.slice(0,-2):e}function pb(e,t,s){return e?e.concat(t).map((function(e,t){return e=db(e),!s&&t?"["+e+"]":e})).join(s?".":""):t}["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{hb[e]={value:e}})),Object.defineProperties(lb,hb),Object.defineProperty(cb,"isAxiosError",{value:!0}),lb.from=(e,t,s,i,a,n)=>{const r=Object.create(cb);return ob.toFlatObject(e,r,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),lb.call(r,e.message,t,s,i,a),r.cause=e,r.name=e.name,n&&Object.assign(r,n),r};const fb=ob.toFlatObject(ob,{},null,(function(e){return/^is[A-Z]/.test(e)}));function mb(e,t,s){if(!ob.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const i=(s=ob.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!ob.isUndefined(t[e])}))).metaTokens,a=s.visitor||c,n=s.dots,r=s.indexes,o=(s.Blob||"undefined"!=typeof Blob&&Blob)&&ob.isSpecCompliantForm(t);if(!ob.isFunction(a))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(ob.isDate(e))return e.toISOString();if(ob.isBoolean(e))return e.toString();if(!o&&ob.isBlob(e))throw new lb("Blob is not supported. Use a Buffer instead.");return ob.isArrayBuffer(e)||ob.isTypedArray(e)?o&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,s,a){let o=e;if(e&&!a&&"object"==typeof e)if(ob.endsWith(s,"{}"))s=i?s:s.slice(0,-2),e=JSON.stringify(e);else if(ob.isArray(e)&&function(e){return ob.isArray(e)&&!e.some(ub)}(e)||(ob.isFileList(e)||ob.endsWith(s,"[]"))&&(o=ob.toArray(e)))return s=db(s),o.forEach((function(e,i){!ob.isUndefined(e)&&null!==e&&t.append(!0===r?pb([s],i,n):null===r?s:s+"[]",l(e))})),!1;return!!ub(e)||(t.append(pb(a,s,n),l(e)),!1)}const h=[],u=Object.assign(fb,{defaultVisitor:c,convertValue:l,isVisitable:ub});if(!ob.isObject(e))throw new TypeError("data must be an object");return function e(s,i){if(!ob.isUndefined(s)){if(-1!==h.indexOf(s))throw Error("Circular reference detected in "+i.join("."));h.push(s),ob.forEach(s,(function(s,n){!0===(!(ob.isUndefined(s)||null===s)&&a.call(t,s,ob.isString(n)?n.trim():n,i,u))&&e(s,i?i.concat(n):[n])})),h.pop()}}(e),t}function gb(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function yb(e,t){this._pairs=[],e&&mb(e,this,t)}const bb=yb.prototype;function vb(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function wb(e,t,s){if(!t)return e;const i=s&&s.encode||vb;ob.isFunction(s)&&(s={serialize:s});const a=s&&s.serialize;let n;if(n=a?a(t,s):ob.isURLSearchParams(t)?t.toString():new yb(t,s).toString(i),n){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+n}return e}bb.append=function(e,t){this._pairs.push([e,t])},bb.toString=function(e){const t=e?function(t){return e.call(this,t,gb)}:gb;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};class xb{constructor(){this.handlers=[]}use(e,t,s){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!s&&s.synchronous,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ob.forEach(this.handlers,(function(t){null!==t&&e(t)}))}}const kb={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ab={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:yb,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},Sb="undefined"!=typeof window&&"undefined"!=typeof document,Eb="object"==typeof navigator&&navigator||void 0,Tb=Sb&&(!Eb||["ReactNative","NativeScript","NS"].indexOf(Eb.product)<0),Pb="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,Cb=Sb&&window.location.href||"http://localhost",Mb={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Sb,hasStandardBrowserEnv:Tb,hasStandardBrowserWebWorkerEnv:Pb,navigator:Eb,origin:Cb},Symbol.toStringTag,{value:"Module"})),...Ab};function Bb(e){function t(e,s,i,a){let n=e[a++];if("__proto__"===n)return!0;const r=Number.isFinite(+n),o=a>=e.length;return n=!n&&ob.isArray(i)?i.length:n,o?(ob.hasOwnProp(i,n)?i[n]=[i[n],s]:i[n]=s,!r):(i[n]&&ob.isObject(i[n])||(i[n]=[]),t(e,s,i[n],a)&&ob.isArray(i[n])&&(i[n]=function(e){const t={},s=Object.keys(e);let i;const a=s.length;let n;for(i=0;i<a;i++)n=s[i],t[n]=e[n];return t}(i[n])),!r)}if(ob.isFormData(e)&&ob.isFunction(e.entries)){const s={};return ob.forEachEntry(e,((e,i)=>{t(function(e){return ob.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),i,s,0)})),s}return null}const Rb={transitional:kb,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const s=t.getContentType()||"",i=s.indexOf("application/json")>-1,a=ob.isObject(e);if(a&&ob.isHTMLForm(e)&&(e=new FormData(e)),ob.isFormData(e))return i?JSON.stringify(Bb(e)):e;if(ob.isArrayBuffer(e)||ob.isBuffer(e)||ob.isStream(e)||ob.isFile(e)||ob.isBlob(e)||ob.isReadableStream(e))return e;if(ob.isArrayBufferView(e))return e.buffer;if(ob.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let n;if(a){if(s.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return mb(e,new Mb.classes.URLSearchParams,Object.assign({visitor:function(e,t,s,i){return Mb.isNode&&ob.isBuffer(e)?(this.append(t,e.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((n=ob.isFileList(e))||s.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return mb(n?{"files[]":e}:e,t&&new t,this.formSerializer)}}return a||i?(t.setContentType("application/json",!1),function(e){if(ob.isString(e))try{return(0,JSON.parse)(e),ob.trim(e)}catch(SD){if("SyntaxError"!==SD.name)throw SD}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||Rb.transitional,s=t&&t.forcedJSONParsing,i="json"===this.responseType;if(ob.isResponse(e)||ob.isReadableStream(e))return e;if(e&&ob.isString(e)&&(s&&!this.responseType||i)){const s=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(SD){if(s){if("SyntaxError"===SD.name)throw lb.from(SD,lb.ERR_BAD_RESPONSE,this,null,this.response);throw SD}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Mb.classes.FormData,Blob:Mb.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ob.forEach(["delete","get","head","post","put","patch"],(e=>{Rb.headers[e]={}}));const Db=ob.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Nb=Symbol("internals");function _b(e){return e&&String(e).trim().toLowerCase()}function Fb(e){return!1===e||null==e?e:ob.isArray(e)?e.map(Fb):String(e)}function Ob(e,t,s,i,a){return ob.isFunction(i)?i.call(this,t,s):(a&&(t=s),ob.isString(t)?ob.isString(i)?-1!==t.indexOf(i):ob.isRegExp(i)?i.test(t):void 0:void 0)}let Lb=class{constructor(e){e&&this.set(e)}set(e,t,s){const i=this;function a(e,t,s){const a=_b(t);if(!a)throw new Error("header name must be a non-empty string");const n=ob.findKey(i,a);(!n||void 0===i[n]||!0===s||void 0===s&&!1!==i[n])&&(i[n||t]=Fb(e))}const n=(e,t)=>ob.forEach(e,((e,s)=>a(e,s,t)));if(ob.isPlainObject(e)||e instanceof this.constructor)n(e,t);else if(ob.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))n((e=>{const t={};let s,i,a;return e&&e.split("\n").forEach((function(e){a=e.indexOf(":"),s=e.substring(0,a).trim().toLowerCase(),i=e.substring(a+1).trim(),!s||t[s]&&Db[s]||("set-cookie"===s?t[s]?t[s].push(i):t[s]=[i]:t[s]=t[s]?t[s]+", "+i:i)})),t})(e),t);else if(ob.isObject(e)&&ob.isIterable(e)){let s,i,a={};for(const t of e){if(!ob.isArray(t))throw TypeError("Object iterator must return a key-value pair");a[i=t[0]]=(s=a[i])?ob.isArray(s)?[...s,t[1]]:[s,t[1]]:t[1]}n(a,t)}else null!=e&&a(t,e,s);return this}get(e,t){if(e=_b(e)){const s=ob.findKey(this,e);if(s){const e=this[s];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=s.exec(e);)t[i[1]]=i[2];return t}(e);if(ob.isFunction(t))return t.call(this,e,s);if(ob.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=_b(e)){const s=ob.findKey(this,e);return!(!s||void 0===this[s]||t&&!Ob(0,this[s],s,t))}return!1}delete(e,t){const s=this;let i=!1;function a(e){if(e=_b(e)){const a=ob.findKey(s,e);!a||t&&!Ob(0,s[a],a,t)||(delete s[a],i=!0)}}return ob.isArray(e)?e.forEach(a):a(e),i}clear(e){const t=Object.keys(this);let s=t.length,i=!1;for(;s--;){const a=t[s];e&&!Ob(0,this[a],a,e,!0)||(delete this[a],i=!0)}return i}normalize(e){const t=this,s={};return ob.forEach(this,((i,a)=>{const n=ob.findKey(s,a);if(n)return t[n]=Fb(i),void delete t[a];const r=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,s)=>t.toUpperCase()+s))}(a):String(a).trim();r!==a&&delete t[a],t[r]=Fb(i),s[r]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return ob.forEach(this,((s,i)=>{null!=s&&!1!==s&&(t[i]=e&&ob.isArray(s)?s.join(", "):s)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const s=new this(e);return t.forEach((e=>s.set(e))),s}static accessor(e){const t=(this[Nb]=this[Nb]={accessors:{}}).accessors,s=this.prototype;function i(e){const i=_b(e);t[i]||(function(e,t){const s=ob.toCamelCase(" "+t);["get","set","has"].forEach((i=>{Object.defineProperty(e,i+s,{value:function(e,s,a){return this[i].call(this,t,e,s,a)},configurable:!0})}))}(s,e),t[i]=!0)}return ob.isArray(e)?e.forEach(i):i(e),this}};function Ib(e,t){const s=this||Rb,i=t||s,a=Lb.from(i.headers);let n=i.data;return ob.forEach(e,(function(e){n=e.call(s,n,a.normalize(),t?t.status:void 0)})),a.normalize(),n}function jb(e){return!(!e||!e.__CANCEL__)}function Hb(e,t,s){lb.call(this,null==e?"canceled":e,lb.ERR_CANCELED,t,s),this.name="CanceledError"}function Vb(e,t,s){const i=s.config.validateStatus;s.status&&i&&!i(s.status)?t(new lb("Request failed with status code "+s.status,[lb.ERR_BAD_REQUEST,lb.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s)):e(s)}Lb.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),ob.reduceDescriptors(Lb.prototype,(({value:e},t)=>{let s=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[s]=e}}})),ob.freezeMethods(Lb),ob.inherits(Hb,lb,{__CANCEL__:!0});const Gb=(e,t,s=3)=>{let i=0;const a=function(e,t){e=e||10;const s=new Array(e),i=new Array(e);let a,n=0,r=0;return t=void 0!==t?t:1e3,function(o){const l=Date.now(),c=i[r];a||(a=l),s[n]=o,i[n]=l;let h=r,u=0;for(;h!==n;)u+=s[h++],h%=e;if(n=(n+1)%e,n===r&&(r=(r+1)%e),l-a<t)return;const d=c&&l-c;return d?Math.round(1e3*u/d):void 0}}(50,250);return function(e,t){let s,i,a=0,n=1e3/t;const r=(t,n=Date.now())=>{a=n,s=null,i&&(clearTimeout(i),i=null),e.apply(null,t)};return[(...e)=>{const t=Date.now(),o=t-a;o>=n?r(e,t):(s=e,i||(i=setTimeout((()=>{i=null,r(s)}),n-o)))},()=>s&&r(s)]}((s=>{const n=s.loaded,r=s.lengthComputable?s.total:void 0,o=n-i,l=a(o);i=n,e({loaded:n,total:r,progress:r?n/r:void 0,bytes:o,rate:l||void 0,estimated:l&&r&&n<=r?(r-n)/l:void 0,event:s,lengthComputable:null!=r,[t?"download":"upload"]:!0})}),s)},Ub=(e,t)=>{const s=null!=e;return[i=>t[0]({lengthComputable:s,total:e,loaded:i}),t[1]]},zb=e=>(...t)=>ob.asap((()=>e(...t))),Wb=Mb.hasStandardBrowserEnv?((e,t)=>s=>(s=new URL(s,Mb.origin),e.protocol===s.protocol&&e.host===s.host&&(t||e.port===s.port)))(new URL(Mb.origin),Mb.navigator&&/(msie|trident)/i.test(Mb.navigator.userAgent)):()=>!0,Qb=Mb.hasStandardBrowserEnv?{write(e,t,s,i,a,n){const r=[e+"="+encodeURIComponent(t)];ob.isNumber(s)&&r.push("expires="+new Date(s).toGMTString()),ob.isString(i)&&r.push("path="+i),ob.isString(a)&&r.push("domain="+a),!0===n&&r.push("secure"),document.cookie=r.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function qb(e,t,s){let i=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(i||0==s)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const Kb=e=>e instanceof Lb?{...e}:e;function Zb(e,t){t=t||{};const s={};function i(e,t,s,i){return ob.isPlainObject(e)&&ob.isPlainObject(t)?ob.merge.call({caseless:i},e,t):ob.isPlainObject(t)?ob.merge({},t):ob.isArray(t)?t.slice():t}function a(e,t,s,a){return ob.isUndefined(t)?ob.isUndefined(e)?void 0:i(void 0,e,0,a):i(e,t,0,a)}function n(e,t){if(!ob.isUndefined(t))return i(void 0,t)}function r(e,t){return ob.isUndefined(t)?ob.isUndefined(e)?void 0:i(void 0,e):i(void 0,t)}function o(s,a,n){return n in t?i(s,a):n in e?i(void 0,s):void 0}const l={url:n,method:n,data:n,baseURL:r,transformRequest:r,transformResponse:r,paramsSerializer:r,timeout:r,timeoutMessage:r,withCredentials:r,withXSRFToken:r,adapter:r,responseType:r,xsrfCookieName:r,xsrfHeaderName:r,onUploadProgress:r,onDownloadProgress:r,decompress:r,maxContentLength:r,maxBodyLength:r,beforeRedirect:r,transport:r,httpAgent:r,httpsAgent:r,cancelToken:r,socketPath:r,responseEncoding:r,validateStatus:o,headers:(e,t,s)=>a(Kb(e),Kb(t),0,!0)};return ob.forEach(Object.keys(Object.assign({},e,t)),(function(i){const n=l[i]||a,r=n(e[i],t[i],i);ob.isUndefined(r)&&n!==o||(s[i]=r)})),s}const Jb=e=>{const t=Zb({},e);let s,{data:i,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:r,headers:o,auth:l}=t;if(t.headers=o=Lb.from(o),t.url=wb(qb(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),ob.isFormData(i))if(Mb.hasStandardBrowserEnv||Mb.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(!1!==(s=o.getContentType())){const[e,...t]=s?s.split(";").map((e=>e.trim())).filter(Boolean):[];o.setContentType([e||"multipart/form-data",...t].join("; "))}if(Mb.hasStandardBrowserEnv&&(a&&ob.isFunction(a)&&(a=a(t)),a||!1!==a&&Wb(t.url))){const e=n&&r&&Qb.read(r);e&&o.set(n,e)}return t},Xb="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,s){const i=Jb(e);let a=i.data;const n=Lb.from(i.headers).normalize();let r,o,l,c,h,{responseType:u,onUploadProgress:d,onDownloadProgress:p}=i;function f(){c&&c(),h&&h(),i.cancelToken&&i.cancelToken.unsubscribe(r),i.signal&&i.signal.removeEventListener("abort",r)}let m=new XMLHttpRequest;function g(){if(!m)return;const i=Lb.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());Vb((function(e){t(e),f()}),(function(e){s(e),f()}),{data:u&&"text"!==u&&"json"!==u?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:i,config:e,request:m}),m=null}m.open(i.method.toUpperCase(),i.url,!0),m.timeout=i.timeout,"onloadend"in m?m.onloadend=g:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(g)},m.onabort=function(){m&&(s(new lb("Request aborted",lb.ECONNABORTED,e,m)),m=null)},m.onerror=function(){s(new lb("Network Error",lb.ERR_NETWORK,e,m)),m=null},m.ontimeout=function(){let t=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const a=i.transitional||kb;i.timeoutErrorMessage&&(t=i.timeoutErrorMessage),s(new lb(t,a.clarifyTimeoutError?lb.ETIMEDOUT:lb.ECONNABORTED,e,m)),m=null},void 0===a&&n.setContentType(null),"setRequestHeader"in m&&ob.forEach(n.toJSON(),(function(e,t){m.setRequestHeader(t,e)})),ob.isUndefined(i.withCredentials)||(m.withCredentials=!!i.withCredentials),u&&"json"!==u&&(m.responseType=i.responseType),p&&([l,h]=Gb(p,!0),m.addEventListener("progress",l)),d&&m.upload&&([o,c]=Gb(d),m.upload.addEventListener("progress",o),m.upload.addEventListener("loadend",c)),(i.cancelToken||i.signal)&&(r=t=>{m&&(s(!t||t.type?new Hb(null,e,m):t),m.abort(),m=null)},i.cancelToken&&i.cancelToken.subscribe(r),i.signal&&(i.signal.aborted?r():i.signal.addEventListener("abort",r)));const y=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(i.url);y&&-1===Mb.protocols.indexOf(y)?s(new lb("Unsupported protocol "+y+":",lb.ERR_BAD_REQUEST,e)):m.send(a||null)}))},$b=(e,t)=>{const{length:s}=e=e?e.filter(Boolean):[];if(t||s){let s,i=new AbortController;const a=function(e){if(!s){s=!0,r();const t=e instanceof Error?e:this.reason;i.abort(t instanceof lb?t:new Hb(t instanceof Error?t.message:t))}};let n=t&&setTimeout((()=>{n=null,a(new lb(`timeout ${t} of ms exceeded`,lb.ETIMEDOUT))}),t);const r=()=>{e&&(n&&clearTimeout(n),n=null,e.forEach((e=>{e.unsubscribe?e.unsubscribe(a):e.removeEventListener("abort",a)})),e=null)};e.forEach((e=>e.addEventListener("abort",a)));const{signal:o}=i;return o.unsubscribe=()=>ob.asap(r),o}},Yb=function*(e,t){let s=e.byteLength;if(s<t)return void(yield e);let i,a=0;for(;a<s;)i=a+t,yield e.slice(a,i),a=i},ev=(e,t,s,i)=>{const a=async function*(e,t){for await(const s of async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:s}=await t.read();if(e)break;yield s}}finally{await t.cancel()}}(e))yield*Yb(s,t)}(e,t);let n,r=0,o=e=>{n||(n=!0,i&&i(e))};return new ReadableStream({async pull(e){try{const{done:t,value:i}=await a.next();if(t)return o(),void e.close();let n=i.byteLength;if(s){let e=r+=n;s(e)}e.enqueue(new Uint8Array(i))}catch(t){throw o(t),t}},cancel:e=>(o(e),a.return())},{highWaterMark:2})},tv="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,sv=tv&&"function"==typeof ReadableStream,iv=tv&&("function"==typeof TextEncoder?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),av=(e,...t)=>{try{return!!e(...t)}catch(SD){return!1}},nv=sv&&av((()=>{let e=!1;const t=new Request(Mb.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),rv=sv&&av((()=>ob.isReadableStream(new Response("").body))),ov={stream:rv&&(e=>e.body)};var lv;tv&&(lv=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((e=>{!ov[e]&&(ov[e]=ob.isFunction(lv[e])?t=>t[e]():(t,s)=>{throw new lb(`Response type '${e}' is not supported`,lb.ERR_NOT_SUPPORT,s)})})));const cv={http:null,xhr:Xb,fetch:tv&&(async e=>{let{url:t,method:s,data:i,signal:a,cancelToken:n,timeout:r,onDownloadProgress:o,onUploadProgress:l,responseType:c,headers:h,withCredentials:u="same-origin",fetchOptions:d}=Jb(e);c=c?(c+"").toLowerCase():"text";let p,f=$b([a,n&&n.toAbortSignal()],r);const m=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let g;try{if(l&&nv&&"get"!==s&&"head"!==s&&0!==(g=await(async(e,t)=>{const s=ob.toFiniteNumber(e.getContentLength());return null==s?(async e=>{if(null==e)return 0;if(ob.isBlob(e))return e.size;if(ob.isSpecCompliantForm(e)){const t=new Request(Mb.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return ob.isArrayBufferView(e)||ob.isArrayBuffer(e)?e.byteLength:(ob.isURLSearchParams(e)&&(e+=""),ob.isString(e)?(await iv(e)).byteLength:void 0)})(t):s})(h,i))){let e,s=new Request(t,{method:"POST",body:i,duplex:"half"});if(ob.isFormData(i)&&(e=s.headers.get("content-type"))&&h.setContentType(e),s.body){const[e,t]=Ub(g,Gb(zb(l)));i=ev(s.body,65536,e,t)}}ob.isString(u)||(u=u?"include":"omit");const a="credentials"in Request.prototype;p=new Request(t,{...d,signal:f,method:s.toUpperCase(),headers:h.normalize().toJSON(),body:i,duplex:"half",credentials:a?u:void 0});let n=await fetch(p,d);const r=rv&&("stream"===c||"response"===c);if(rv&&(o||r&&m)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=n[t]}));const t=ob.toFiniteNumber(n.headers.get("content-length")),[s,i]=o&&Ub(t,Gb(zb(o),!0))||[];n=new Response(ev(n.body,65536,s,(()=>{i&&i(),m&&m()})),e)}c=c||"text";let y=await ov[ob.findKey(ov,c)||"text"](n,e);return!r&&m&&m(),await new Promise(((t,s)=>{Vb(t,s,{data:y,headers:Lb.from(n.headers),status:n.status,statusText:n.statusText,config:e,request:p})}))}catch(y){if(m&&m(),y&&"TypeError"===y.name&&/Load failed|fetch/i.test(y.message))throw Object.assign(new lb("Network Error",lb.ERR_NETWORK,e,p),{cause:y.cause||y});throw lb.from(y,y&&y.code,e,p)}})};ob.forEach(cv,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(SD){}Object.defineProperty(e,"adapterName",{value:t})}}));const hv=e=>`- ${e}`,uv=e=>ob.isFunction(e)||null===e||!1===e,dv=e=>{e=ob.isArray(e)?e:[e];const{length:t}=e;let s,i;const a={};for(let n=0;n<t;n++){let t;if(s=e[n],i=s,!uv(s)&&(i=cv[(t=String(s)).toLowerCase()],void 0===i))throw new lb(`Unknown adapter '${t}'`);if(i)break;a[t||"#"+n]=i}if(!i){const e=Object.entries(a).map((([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build")));throw new lb("There is no suitable adapter to dispatch the request "+(t?e.length>1?"since :\n"+e.map(hv).join("\n"):" "+hv(e[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return i};function pv(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Hb(null,e)}function fv(e){return pv(e),e.headers=Lb.from(e.headers),e.data=Ib.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),dv(e.adapter||Rb.adapter)(e).then((function(t){return pv(e),t.data=Ib.call(e,e.transformResponse,t),t.headers=Lb.from(t.headers),t}),(function(t){return jb(t)||(pv(e),t&&t.response&&(t.response.data=Ib.call(e,e.transformResponse,t.response),t.response.headers=Lb.from(t.response.headers))),Promise.reject(t)}))}const mv="1.10.0",gv={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{gv[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}}));const yv={};gv.transitional=function(e,t,s){function i(e,t){return"[Axios v"+mv+"] Transitional option '"+e+"'"+t+(s?". "+s:"")}return(s,a,n)=>{if(!1===e)throw new lb(i(a," has been removed"+(t?" in "+t:"")),lb.ERR_DEPRECATED);return t&&!yv[a]&&(yv[a]=!0,console.warn(i(a," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(s,a,n)}},gv.spelling=function(e){return(t,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};const bv={assertOptions:function(e,t,s){if("object"!=typeof e)throw new lb("options must be an object",lb.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let a=i.length;for(;a-- >0;){const n=i[a],r=t[n];if(r){const t=e[n],s=void 0===t||r(t,n,e);if(!0!==s)throw new lb("option "+n+" must be "+s,lb.ERR_BAD_OPTION_VALUE)}else if(!0!==s)throw new lb("Unknown option "+n,lb.ERR_BAD_OPTION)}},validators:gv},vv=bv.validators;let wv=class{constructor(e){this.defaults=e||{},this.interceptors={request:new xb,response:new xb}}async request(e,t){try{return await this._request(e,t)}catch(s){if(s instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{s.stack?t&&!String(s.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(s.stack+="\n"+t):s.stack=t}catch(SD){}}throw s}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=Zb(this.defaults,t);const{transitional:s,paramsSerializer:i,headers:a}=t;void 0!==s&&bv.assertOptions(s,{silentJSONParsing:vv.transitional(vv.boolean),forcedJSONParsing:vv.transitional(vv.boolean),clarifyTimeoutError:vv.transitional(vv.boolean)},!1),null!=i&&(ob.isFunction(i)?t.paramsSerializer={serialize:i}:bv.assertOptions(i,{encode:vv.function,serialize:vv.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),bv.assertOptions(t,{baseUrl:vv.spelling("baseURL"),withXsrfToken:vv.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let n=a&&ob.merge(a.common,a[t.method]);a&&ob.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete a[e]})),t.headers=Lb.concat(n,a);const r=[];let o=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(o=o&&e.synchronous,r.unshift(e.fulfilled,e.rejected))}));const l=[];let c;this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)}));let h,u=0;if(!o){const e=[fv.bind(this),void 0];for(e.unshift.apply(e,r),e.push.apply(e,l),h=e.length,c=Promise.resolve(t);u<h;)c=c.then(e[u++],e[u++]);return c}h=r.length;let d=t;for(u=0;u<h;){const e=r[u++],t=r[u++];try{d=e(d)}catch(p){t.call(this,p);break}}try{c=fv.call(this,d)}catch(p){return Promise.reject(p)}for(u=0,h=l.length;u<h;)c=c.then(l[u++],l[u++]);return c}getUri(e){return wb(qb((e=Zb(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}};ob.forEach(["delete","get","head","options"],(function(e){wv.prototype[e]=function(t,s){return this.request(Zb(s||{},{method:e,url:t,data:(s||{}).data}))}})),ob.forEach(["post","put","patch"],(function(e){function t(t){return function(s,i,a){return this.request(Zb(a||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:s,data:i}))}}wv.prototype[e]=t(),wv.prototype[e+"Form"]=t(!0)}));const xv={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(xv).forEach((([e,t])=>{xv[t]=e}));const kv=function e(t){const s=new wv(t),i=wy(wv.prototype.request,s);return ob.extend(i,wv.prototype,s,{allOwnKeys:!0}),ob.extend(i,s,null,{allOwnKeys:!0}),i.create=function(s){return e(Zb(t,s))},i}(Rb);kv.Axios=wv,kv.CanceledError=Hb,kv.CancelToken=class e{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const s=this;this.promise.then((e=>{if(!s._listeners)return;let t=s._listeners.length;for(;t-- >0;)s._listeners[t](e);s._listeners=null})),this.promise.then=e=>{let t;const i=new Promise((e=>{s.subscribe(e),t=e})).then(e);return i.cancel=function(){s.unsubscribe(t)},i},e((function(e,i,a){s.reason||(s.reason=new Hb(e,i,a),t(s.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let t;return{token:new e((function(e){t=e})),cancel:t}}},kv.isCancel=jb,kv.VERSION=mv,kv.toFormData=mb,kv.AxiosError=lb,kv.Cancel=kv.CanceledError,kv.all=function(e){return Promise.all(e)},kv.spread=function(e){return function(t){return e.apply(null,t)}},kv.isAxiosError=function(e){return ob.isObject(e)&&!0===e.isAxiosError},kv.mergeConfig=Zb,kv.AxiosHeaders=Lb,kv.formToJSON=e=>Bb(ob.isHTMLForm(e)?new FormData(e):e),kv.getAdapter=dv,kv.HttpStatusCode=xv,kv.default=kv;const{Axios:Av,AxiosError:Sv,CanceledError:Ev,isCancel:Tv,CancelToken:Pv,VERSION:Cv,all:Mv,Cancel:Bv,isAxiosError:Rv,spread:Dv,toFormData:Nv,AxiosHeaders:_v,HttpStatusCode:Fv,formToJSON:Ov,getAdapter:Lv,mergeConfig:Iv}=kv,jv=kv.create({baseURL:"https://insomnus-backend-aa250a74a37c.herokuapp.com/api",withCredentials:!0});let Hv=!1,Vv=[];const Gv=(e,t=null)=>{Vv.forEach((s=>{e?s.reject(e):s.resolve(t)})),Vv=[]};jv.interceptors.request.use((e=>{var t;const s=null==(t=e.url)?void 0:t.includes("/auth/"),i=localStorage.getItem("access_token");return i&&!s&&(e.headers.Authorization=`Bearer ${i}`),e})),jv.interceptors.response.use((e=>e),(async e=>{var t;const s=e.config;if(401===(null==(t=e.response)?void 0:t.status)&&!s._retry){if(Hv)return new Promise(((e,t)=>{Vv.push({resolve:e,reject:t})})).then((e=>(s.headers.Authorization=`Bearer ${e}`,jv(s)))).catch((e=>Promise.reject(e)));s._retry=!0,Hv=!0;try{const{accessToken:e}=await Uv();return localStorage.setItem("access_token",e),Gv(null,e),jv(s)}catch(i){return Gv(i,null),localStorage.removeItem("access_token"),window.location.href="/login",Promise.reject(i)}finally{Hv=!1}}return Promise.reject(e)}));const Uv=async()=>(await jv.post("/auth/refresh")).data,zv=ga.createContext(),Wv=({children:e})=>{const[t,s]=ga.useState(null),[i,a]=ga.useState(!0);return ga.useEffect((()=>{const e=localStorage.getItem("access_token"),t=localStorage.getItem("user_data");e&&t&&s({...JSON.parse(t),token:e}),a(!1)}),[]),i?Ea.jsx("div",{children:"Loading..."}):Ea.jsx(zv.Provider,{value:{user:t,login:async({walletAddress:e,signature:t,message:i})=>{try{const a=await(async({walletAddress:e,signature:t,message:s})=>(await jv.post("/auth/connect",{walletAddress:e,signature:t,message:s})).data)({walletAddress:e,signature:t,message:i});if(console.log(a.data.token),(null==a?void 0:a.data.token)&&(null==a?void 0:a.data.user))return localStorage.setItem("access_token",a.data.token),localStorage.setItem("user_data",JSON.stringify(a.data.user)),s({...a.data.user,token:a.data.token}),a.data;throw new Error("Invalid login response")}catch(a){throw console.error("Login error:",a),a}},logout:()=>{localStorage.removeItem("access_token"),localStorage.removeItem("user_data"),s(null)},isLoading:i},children:e})},Qv=()=>ga.useContext(zv),qv=ga.createContext(),Kv=()=>ga.useContext(qv)||{},Zv=({children:e})=>{const[t,s]=ga.useState({}),i={gameControls:t,setGameControls:s};return Ea.jsx(qv.Provider,{value:i,children:e})};function Jv(e,t,s){const i=t.split("|").map((e=>e.trim()));for(let n=0;n<i.length;n++)switch(t){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof e===t)return}const a=new Error(`invalid value for type ${t}`);throw a.code="INVALID_ARGUMENT",a.argument=`value.${s}`,a.value=e,a}async function Xv(e){const t=Object.keys(e);return(await Promise.all(t.map((t=>Promise.resolve(e[t]))))).reduce(((e,s,i)=>(e[t[i]]=s,e)),{})}function $v(e,t,s){for(let i in t){let a=t[i];const n=s?s[i]:null;n&&Jv(a,n,i),Object.defineProperty(e,i,{enumerable:!0,value:a,writable:!1})}}function Yv(e){if(null==e)return"null";if(Array.isArray(e))return"[ "+e.map(Yv).join(", ")+" ]";if(e instanceof Uint8Array){const t="0123456789abcdef";let s="0x";for(let i=0;i<e.length;i++)s+=t[e[i]>>4],s+=t[15&e[i]];return s}if("object"==typeof e&&"function"==typeof e.toJSON)return Yv(e.toJSON());switch(typeof e){case"boolean":case"symbol":case"number":return e.toString();case"bigint":return BigInt(e).toString();case"string":return JSON.stringify(e);case"object":{const t=Object.keys(e);return t.sort(),"{ "+t.map((t=>`${Yv(t)}: ${Yv(e[t])}`)).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function ew(e,t){return e&&e.code===t}function tw(e){return ew(e,"CALL_EXCEPTION")}function sw(e,t,s){let i,a=e;{const i=[];if(s){if("message"in s||"code"in s||"name"in s)throw new Error(`value will overwrite populated values: ${Yv(s)}`);for(const e in s){if("shortMessage"===e)continue;const t=s[e];i.push(e+"="+Yv(t))}}i.push(`code=${t}`),i.push("version=6.13.5"),i.length&&(e+=" ("+i.join(", ")+")")}switch(t){case"INVALID_ARGUMENT":i=new TypeError(e);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":i=new RangeError(e);break;default:i=new Error(e)}return $v(i,{code:t}),s&&Object.assign(i,s),null==i.shortMessage&&$v(i,{shortMessage:a}),i}function iw(e,t,s,i){if(!e)throw sw(t,s,i)}function aw(e,t,s,i){iw(e,t,"INVALID_ARGUMENT",{argument:s,value:i})}function nw(e,t,s){null==s&&(s=""),s&&(s=": "+s),iw(e>=t,"missing argument"+s,"MISSING_ARGUMENT",{count:e,expectedCount:t}),iw(e<=t,"too many arguments"+s,"UNEXPECTED_ARGUMENT",{count:e,expectedCount:t})}function rw(e,t,s){if(null==s&&(s=""),e!==t){let e=s,t="new";s&&(e+=".",t+=" "+s),iw(!1,`private constructor; use ${e}from* methods`,"UNSUPPORTED_OPERATION",{operation:t})}}function ow(e,t,s){if(e instanceof Uint8Array)return s?new Uint8Array(e):e;if("string"==typeof e&&e.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const t=new Uint8Array((e.length-2)/2);let s=2;for(let i=0;i<t.length;i++)t[i]=parseInt(e.substring(s,s+2),16),s+=2;return t}aw(!1,"invalid BytesLike value",t||"value",e)}function lw(e,t){return ow(e,t,!1)}function cw(e,t){return ow(e,t,!0)}function hw(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/)||"number"==typeof t&&e.length!==2+2*t||!0===t&&e.length%2!=0)}function uw(e){return hw(e,!0)||e instanceof Uint8Array}["NFD","NFC","NFKD","NFKC"].reduce(((e,t)=>{try{if("test"!=="test".normalize(t))throw new Error("bad");if("NFD"===t){if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw new Error("broken")}e.push(t)}catch(s){}return e}),[]);const dw="0123456789abcdef";function pw(e){const t=lw(e);let s="0x";for(let i=0;i<t.length;i++){const e=t[i];s+=dw[(240&e)>>4]+dw[15&e]}return s}function fw(e){return"0x"+e.map((e=>pw(e).substring(2))).join("")}function mw(e){return hw(e,!0)?(e.length-2)/2:lw(e).length}function gw(e,t,s){const i=lw(e);return null!=s&&s>i.length&&iw(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:i,length:i.length,offset:s}),pw(i.slice(null==t?0:t,null==s?i.length:s))}function yw(e,t,s){const i=lw(e);iw(t>=i.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(i),length:t,offset:t+1});const a=new Uint8Array(t);return a.fill(0),s?a.set(i,t-i.length):a.set(i,0),pw(a)}function bw(e,t){return yw(e,t,!0)}const vw=BigInt(0),ww=BigInt(1),xw=9007199254740991;function kw(e,t){let s=Sw(e,"value");const i=BigInt(Cw(t,"width")),a=ww<<i-ww;return s<vw?(s=-s,iw(s<=a,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:e}),(~s&(ww<<i)-ww)+ww):(iw(s<a,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:e}),s)}function Aw(e,t){const s=Ew(e,"value"),i=BigInt(Cw(t,"bits"));return s&(ww<<i)-ww}function Sw(e,t){switch(typeof e){case"bigint":return e;case"number":return aw(Number.isInteger(e),"underflow",t||"value",e),aw(e>=-9007199254740991&&e<=xw,"overflow",t||"value",e),BigInt(e);case"string":try{if(""===e)throw new Error("empty string");return"-"===e[0]&&"-"!==e[1]?-BigInt(e.substring(1)):BigInt(e)}catch(SD){aw(!1,`invalid BigNumberish string: ${SD.message}`,t||"value",e)}}aw(!1,"invalid BigNumberish value",t||"value",e)}function Ew(e,t){const s=Sw(e,t);return iw(s>=vw,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:e}),s}const Tw="0123456789abcdef";function Pw(e){if(e instanceof Uint8Array){let t="0x0";for(const s of e)t+=Tw[s>>4],t+=Tw[15&s];return BigInt(t)}return Sw(e)}function Cw(e,t){switch(typeof e){case"bigint":return aw(e>=-9007199254740991&&e<=xw,"overflow",t||"value",e),Number(e);case"number":return aw(Number.isInteger(e),"underflow",t||"value",e),aw(e>=-9007199254740991&&e<=xw,"overflow",t||"value",e),e;case"string":try{if(""===e)throw new Error("empty string");return Cw(BigInt(e),t)}catch(SD){aw(!1,`invalid numeric string: ${SD.message}`,t||"value",e)}}aw(!1,"invalid numeric value",t||"value",e)}function Mw(e,t){let s=Ew(e,"value").toString(16);if(null==t)s.length%2&&(s="0"+s);else{const i=Cw(t,"width");for(iw(2*i>=s.length,`value exceeds width (${i} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:e});s.length<2*i;)s="0"+s}return"0x"+s}function Bw(e){const t=Ew(e,"value");if(t===vw)return new Uint8Array([]);let s=t.toString(16);s.length%2&&(s="0"+s);const i=new Uint8Array(s.length/2);for(let a=0;a<i.length;a++){const e=2*a;i[a]=parseInt(s.substring(e,e+2),16)}return i}function Rw(e){let t=pw(uw(e)?e:Bw(e)).substring(2);for(;t.startsWith("0");)t=t.substring(1);return""===t&&(t="0"),"0x"+t}const Dw="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const Nw=BigInt(58);class _w{constructor(t,s,i){Ai(this,"filter"),Ai(this,"emitter"),Ti(this,e),Pi(this,e,s),$v(this,{emitter:t,filter:i})}async removeListener(){null!=Ei(this,e)&&await this.emitter.off(this.filter,Ei(this,e))}}function Fw(e,t,s,i,a){if("BAD_PREFIX"===e||"UNEXPECTED_CONTINUE"===e){let e=0;for(let i=t+1;i<s.length&&s[i]>>6==2;i++)e++;return e}return"OVERRUN"===e?s.length-t-1:0}e=new WeakMap;const Ow=Object.freeze({error:function(e,t,s,i,a){aw(!1,`invalid codepoint at offset ${t}; ${e}`,"bytes",s)},ignore:Fw,replace:function(e,t,s,i,a){return"OVERLONG"===e?(aw("number"==typeof a,"invalid bad code point for replacement","badCodepoint",a),i.push(a),0):(i.push(65533),Fw(e,t,s))}});function Lw(e,t){aw("string"==typeof e,"invalid string value","str",e);let s=[];for(let i=0;i<e.length;i++){const t=e.charCodeAt(i);if(t<128)s.push(t);else if(t<2048)s.push(t>>6|192),s.push(63&t|128);else if(55296==(64512&t)){i++;const a=e.charCodeAt(i);aw(i<e.length&&56320==(64512&a),"invalid surrogate pair","str",e);const n=65536+((1023&t)<<10)+(1023&a);s.push(n>>18|240),s.push(n>>12&63|128),s.push(n>>6&63|128),s.push(63&n|128)}else s.push(t>>12|224),s.push(t>>6&63|128),s.push(63&t|128)}return new Uint8Array(s)}function Iw(e,t){return s=function(e,t){null==t&&(t=Ow.error);const s=lw(e,"bytes"),i=[];let a=0;for(;a<s.length;){const e=s[a++];if(!(e>>7)){i.push(e);continue}let n=null,r=null;if(192==(224&e))n=1,r=127;else if(224==(240&e))n=2,r=2047;else{if(240!=(248&e)){a+=t(128==(192&e)?"UNEXPECTED_CONTINUE":"BAD_PREFIX",a-1,s,i);continue}n=3,r=65535}if(a-1+n>=s.length){a+=t("OVERRUN",a-1,s,i);continue}let o=e&(1<<8-n-1)-1;for(let l=0;l<n;l++){let e=s[a];if(128!=(192&e)){a+=t("MISSING_CONTINUE",a,s,i),o=null;break}o=o<<6|63&e,a++}null!==o&&(o>1114111?a+=t("OUT_OF_RANGE",a-1-n,s,i,o):o>=55296&&o<=57343?a+=t("UTF16_SURROGATE",a-1-n,s,i,o):o<=r?a+=t("OVERLONG",a-1-n,s,i,o):i.push(o))}return i}(e,t),s.map((e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10&1023),56320+(1023&e))))).join("");var s}function jw(e){return async function(e,t){iw(null==t||!t.cancelled,"request cancelled before sending","CANCELLED");const s=e.url.split(":")[0].toLowerCase();iw("http"===s||"https"===s,`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),iw("https"===s||!e.credentials||e.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let i=null;const a=new AbortController,n=setTimeout((()=>{i=sw("request timeout","TIMEOUT"),a.abort()}),e.timeout);t&&t.addListener((()=>{i=sw("request cancelled","CANCELLED"),a.abort()}));const r={method:e.method,headers:new Headers(Array.from(e)),body:e.body||void 0,signal:a.signal};let o;try{o=await fetch(e.url,r)}catch(u){if(clearTimeout(n),i)throw i;throw u}clearTimeout(n);const l={};o.headers.forEach(((e,t)=>{l[t.toLowerCase()]=e}));const c=await o.arrayBuffer(),h=null==c?null:new Uint8Array(c);return{statusCode:o.status,statusMessage:o.statusText,headers:l,body:h}}}let Hw=jw();const Vw=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),Gw=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let Uw=!1;async function zw(e,t){try{const t=e.match(Vw);if(!t)throw new Error("invalid data");return new Yw(200,"OK",{"content-type":t[1]||"text/plain"},t[2]?function(e){e=atob(e);const t=new Uint8Array(e.length);for(let s=0;s<e.length;s++)t[s]=e.charCodeAt(s);return lw(t)}(t[3]):Lw(t[3].replace(/%([0-9a-f][0-9a-f])/gi,((e,t)=>String.fromCharCode(parseInt(t,16))))))}catch(s){return new Yw(599,"BAD REQUEST (invalid data: URI)",{},null,new Xw(e))}}function Ww(e){return async function(t,s){try{const s=t.match(Gw);if(!s)throw new Error("invalid link");return new Xw(`${e}${s[2]}`)}catch(i){return new Yw(599,"BAD REQUEST (invalid IPFS URI)",{},null,new Xw(t))}}}const Qw={data:zw,ipfs:Ww("https://gateway.ipfs.io/ipfs/")},qw=new WeakMap;class Kw{constructor(e){Ti(this,t),Ti(this,s),Pi(this,t,[]),Pi(this,s,!1),qw.set(e,(()=>{if(!Ei(this,s)){Pi(this,s,!0);for(const e of Ei(this,t))setTimeout((()=>{e()}),0);Pi(this,t,[])}}))}addListener(e){iw(!Ei(this,s),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),Ei(this,t).push(e)}get cancelled(){return Ei(this,s)}checkSignal(){iw(!this.cancelled,"cancelled","CANCELLED",{})}}function Zw(e){if(null==e)throw new Error("missing signal; should not happen");return e.checkSignal(),e}t=new WeakMap,s=new WeakMap;const Jw=class e{constructor(e){Ti(this,b),Ti(this,i),Ti(this,a),Ti(this,n),Ti(this,r),Ti(this,o),Ti(this,l),Ti(this,c),Ti(this,h),Ti(this,u),Ti(this,d),Ti(this,p),Ti(this,f),Ti(this,m),Ti(this,g),Ti(this,y),Pi(this,l,String(e)),Pi(this,i,!1),Pi(this,a,!0),Pi(this,n,{}),Pi(this,r,""),Pi(this,o,3e5),Pi(this,g,{slotInterval:250,maxAttempts:12}),Pi(this,y,null)}get url(){return Ei(this,l)}set url(e){Pi(this,l,String(e))}get body(){return null==Ei(this,c)?null:new Uint8Array(Ei(this,c))}set body(e){if(null==e)Pi(this,c,void 0),Pi(this,h,void 0);else if("string"==typeof e)Pi(this,c,Lw(e)),Pi(this,h,"text/plain");else if(e instanceof Uint8Array)Pi(this,c,e),Pi(this,h,"application/octet-stream");else{if("object"!=typeof e)throw new Error("invalid body");Pi(this,c,Lw(JSON.stringify(e))),Pi(this,h,"application/json")}}hasBody(){return null!=Ei(this,c)}get method(){return Ei(this,r)?Ei(this,r):this.hasBody()?"POST":"GET"}set method(e){null==e&&(e=""),Pi(this,r,String(e).toUpperCase())}get headers(){const e=Object.assign({},Ei(this,n));return Ei(this,u)&&(e.authorization=`Basic ${function(e){const t=lw(e);let s="";for(let i=0;i<t.length;i++)s+=String.fromCharCode(t[i]);return btoa(s)}(Lw(Ei(this,u)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),null==e["content-type"]&&Ei(this,h)&&(e["content-type"]=Ei(this,h)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,t){Ei(this,n)[String(e).toLowerCase()]=String(t)}clearHeaders(){Pi(this,n,{})}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let s=0;return{next:()=>{if(s<t.length){const i=t[s++];return{value:[i,e[i]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return Ei(this,u)||null}setCredentials(e,t){aw(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),Pi(this,u,`${e}:${t}`)}get allowGzip(){return Ei(this,a)}set allowGzip(e){Pi(this,a,!!e)}get allowInsecureAuthentication(){return!!Ei(this,i)}set allowInsecureAuthentication(e){Pi(this,i,!!e)}get timeout(){return Ei(this,o)}set timeout(e){aw(e>=0,"timeout must be non-zero","timeout",e),Pi(this,o,e)}get preflightFunc(){return Ei(this,d)||null}set preflightFunc(e){Pi(this,d,e)}get processFunc(){return Ei(this,p)||null}set processFunc(e){Pi(this,p,e)}get retryFunc(){return Ei(this,f)||null}set retryFunc(e){Pi(this,f,e)}get getUrlFunc(){return Ei(this,y)||Hw}set getUrlFunc(e){Pi(this,y,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${Ei(this,c)?pw(Ei(this,c)):"null"}>`}setThrottleParams(e){null!=e.slotInterval&&(Ei(this,g).slotInterval=e.slotInterval),null!=e.maxAttempts&&(Ei(this,g).maxAttempts=e.maxAttempts)}send(){return iw(null==Ei(this,m),"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),Pi(this,m,new Kw(this)),Ci(this,b,v).call(this,0,ex()+this.timeout,0,this,new Yw(0,"",{},null,this))}cancel(){iw(null!=Ei(this,m),"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=qw.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(t){const s=this.url.split(":")[0].toLowerCase(),i=t.split(":")[0].toLowerCase();iw("GET"===this.method&&("https"!==s||"http"!==i)&&t.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(t)})`});const a=new e(t);return a.method="GET",a.allowGzip=this.allowGzip,a.timeout=this.timeout,Pi(a,n,Object.assign({},Ei(this,n))),Ei(this,c)&&Pi(a,c,new Uint8Array(Ei(this,c))),Pi(a,h,Ei(this,h)),a}clone(){const t=new e(this.url);return Pi(t,r,Ei(this,r)),Ei(this,c)&&Pi(t,c,Ei(this,c)),Pi(t,h,Ei(this,h)),Pi(t,n,Object.assign({},Ei(this,n))),Pi(t,u,Ei(this,u)),this.allowGzip&&(t.allowGzip=!0),t.timeout=this.timeout,this.allowInsecureAuthentication&&(t.allowInsecureAuthentication=!0),Pi(t,d,Ei(this,d)),Pi(t,p,Ei(this,p)),Pi(t,f,Ei(this,f)),Pi(t,g,Object.assign({},Ei(this,g))),Pi(t,y,Ei(this,y)),t}static lockConfig(){Uw=!0}static getGateway(e){return Qw[e.toLowerCase()]||null}static registerGateway(e,t){if("http"===(e=e.toLowerCase())||"https"===e)throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(Uw)throw new Error("gateways locked");Qw[e]=t}static registerGetUrl(e){if(Uw)throw new Error("gateways locked");Hw=e}static createGetUrlFunc(e){return jw()}static createDataGateway(){return zw}static createIpfsGatewayFunc(e){return Ww(e)}};i=new WeakMap,a=new WeakMap,n=new WeakMap,r=new WeakMap,o=new WeakMap,l=new WeakMap,c=new WeakMap,h=new WeakMap,u=new WeakMap,d=new WeakMap,p=new WeakMap,f=new WeakMap,m=new WeakMap,g=new WeakMap,y=new WeakMap,b=new WeakSet,v=async function(e,t,s,i,a){var n,r,o;if(e>=Ei(this,g).maxAttempts)return a.makeServerError("exceeded maximum retry limit");iw(ex()<=t,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:i}),s>0&&await function(e){return new Promise((t=>setTimeout(t,e)))}(s);let l=this.clone();const c=(l.url.split(":")[0]||"").toLowerCase();if(c in Qw){const e=await Qw[c](l.url,Zw(Ei(i,m)));if(e instanceof Yw){let t=e;if(this.processFunc){Zw(Ei(i,m));try{t=await this.processFunc(l,t)}catch(d){null!=d.throttle&&"number"==typeof d.stall||t.makeServerError("error in post-processing function",d).assertOk()}}return t}l=e}this.preflightFunc&&(l=await this.preflightFunc(l));const h=await this.getUrlFunc(l,Zw(Ei(i,m)));let u=new Yw(h.statusCode,h.statusMessage,h.headers,h.body,i);if(301===u.statusCode||302===u.statusCode){try{const s=u.headers.location||"";return Ci(n=l.redirect(s),b,v).call(n,e+1,t,0,i,u)}catch(d){}return u}if(429===u.statusCode&&(null==this.retryFunc||await this.retryFunc(l,u,e))){const s=u.headers["retry-after"];let a=Ei(this,g).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return"string"==typeof s&&s.match(/^[1-9][0-9]*$/)&&(a=parseInt(s)),Ci(r=l.clone(),b,v).call(r,e+1,t,a,i,u)}if(this.processFunc){Zw(Ei(i,m));try{u=await this.processFunc(l,u)}catch(d){null!=d.throttle&&"number"==typeof d.stall||u.makeServerError("error in post-processing function",d).assertOk();let s=Ei(this,g).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return d.stall>=0&&(s=d.stall),Ci(o=l.clone(),b,v).call(o,e+1,t,s,i,u)}}return u};let Xw=Jw;const $w=class e{constructor(e,t,s,i,a){Ti(this,w),Ti(this,x),Ti(this,k),Ti(this,A),Ti(this,S),Ti(this,E),Pi(this,w,e),Pi(this,x,t),Pi(this,k,Object.keys(s).reduce(((e,t)=>(e[t.toLowerCase()]=String(s[t]),e)),{})),Pi(this,A,null==i?null:new Uint8Array(i)),Pi(this,S,a||null),Pi(this,E,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${Ei(this,A)?pw(Ei(this,A)):"null"}>`}get statusCode(){return Ei(this,w)}get statusMessage(){return Ei(this,x)}get headers(){return Object.assign({},Ei(this,k))}get body(){return null==Ei(this,A)?null:new Uint8Array(Ei(this,A))}get bodyText(){try{return null==Ei(this,A)?"":Iw(Ei(this,A))}catch(e){iw(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch(e){iw(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let s=0;return{next:()=>{if(s<t.length){const i=t[s++];return{value:[i,e[i]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(t,s){let i;i=t?`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${t})`:`CLIENT ESCALATED SERVER ERROR (${t=`${this.statusCode} ${this.statusMessage}`})`;const a=new e(599,i,this.headers,this.body,Ei(this,S)||void 0);return Pi(a,E,{message:t,error:s}),a}throwThrottleError(e,t){null==t?t=-1:aw(Number.isInteger(t)&&t>=0,"invalid stall timeout","stall",t);const s=new Error(e||"throttling requests");throw $v(s,{stall:t,throttle:!0}),s}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return null!=Ei(this,A)}get request(){return Ei(this,S)}ok(){return""===Ei(this,E).message&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:t}=Ei(this,E);""===e&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let s=null;this.request&&(s=this.request.url);let i=null;try{Ei(this,A)&&(i=Iw(Ei(this,A)))}catch(SD){}iw(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:t,info:{requestUrl:s,responseBody:i,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};w=new WeakMap,x=new WeakMap,k=new WeakMap,A=new WeakMap,S=new WeakMap,E=new WeakMap;let Yw=$w;function ex(){return(new Date).getTime()}function tx(e){let t=e.toString(16);for(;t.length<2;)t="0"+t;return"0x"+t}function sx(e,t,s){let i=0;for(let a=0;a<s;a++)i=256*i+e[t+a];return i}function ix(e,t,s,i){const a=[];for(;s<t+1+i;){const n=ax(e,s);a.push(n.result),iw((s+=n.consumed)<=t+1+i,"child data too short","BUFFER_OVERRUN",{buffer:e,length:i,offset:t})}return{consumed:1+i,result:a}}function ax(e,t){iw(0!==e.length,"data too short","BUFFER_OVERRUN",{buffer:e,length:0,offset:1});const s=t=>{iw(t<=e.length,"data short segment too short","BUFFER_OVERRUN",{buffer:e,length:e.length,offset:t})};if(e[t]>=248){const i=e[t]-247;s(t+1+i);const a=sx(e,t+1,i);return s(t+1+i+a),ix(e,t,t+1+i,i+a)}if(e[t]>=192){const i=e[t]-192;return s(t+1+i),ix(e,t,t+1,i)}if(e[t]>=184){const i=e[t]-183;s(t+1+i);const a=sx(e,t+1,i);return s(t+1+i+a),{consumed:1+i+a,result:pw(e.slice(t+1+i,t+1+i+a))}}if(e[t]>=128){const i=e[t]-128;return s(t+1+i),{consumed:1+i,result:pw(e.slice(t+1,t+1+i))}}return{consumed:1,result:tx(e[t])}}function nx(e){const t=lw(e,"data"),s=ax(t,0);return aw(s.consumed===t.length,"unexpected junk after rlp payload","data",e),s.result}function rx(e){const t=[];for(;e;)t.unshift(255&e),e>>=8;return t}function ox(e){if(Array.isArray(e)){let t=[];if(e.forEach((function(e){t=t.concat(ox(e))})),t.length<=55)return t.unshift(192+t.length),t;const s=rx(t.length);return s.unshift(247+s.length),s.concat(t)}const t=Array.prototype.slice.call(lw(e,"object"));if(1===t.length&&t[0]<=127)return t;if(t.length<=55)return t.unshift(128+t.length),t;const s=rx(t.length);return s.unshift(183+s.length),s.concat(t)}const lx="0123456789abcdef";function cx(e){let t="0x";for(const s of ox(e))t+=lx[s>>4],t+=lx[15&s];return t}const hx=32,ux=new Uint8Array(hx),dx=["then"],px={},fx=new WeakMap;function mx(e){return fx.get(e)}function gx(e,t){fx.set(e,t)}function yx(e,t){const s=new Error(`deferred error during ABI decoding triggered accessing ${e}`);throw s.error=t,s}function bx(e,t,s){return e.indexOf(null)>=0?t.map(((e,t)=>e instanceof vx?bx(mx(e),e,s):e)):e.reduce(((e,i,a)=>{let n=t.getValue(i);return i in e||(s&&n instanceof vx&&(n=bx(mx(n),n,s)),e[i]=n),e}),{})}T=new WeakMap;let vx=class e extends Array{constructor(...e){const t=e[0];let s=e[1],i=(e[2]||[]).slice(),a=!0;t!==px&&(s=e,i=[],a=!1),super(s.length),Ti(this,T),s.forEach(((e,t)=>{this[t]=e}));const n=i.reduce(((e,t)=>("string"==typeof t&&e.set(t,(e.get(t)||0)+1),e)),new Map);if(gx(this,Object.freeze(s.map(((e,t)=>{const s=i[t];return null!=s&&1===n.get(s)?s:null})))),Pi(this,T,[]),null==Ei(this,T)&&Ei(this,T),!a)return;Object.freeze(this);const r=new Proxy(this,{get:(e,t,s)=>{if("string"==typeof t){if(t.match(/^[0-9]+$/)){const s=Cw(t,"%index");if(s<0||s>=this.length)throw new RangeError("out of result range");const i=e[s];return i instanceof Error&&yx(`index ${s}`,i),i}if(dx.indexOf(t)>=0)return Reflect.get(e,t,s);const i=e[t];if(i instanceof Function)return function(...t){return i.apply(this===s?e:this,t)};if(!(t in e))return e.getValue.apply(this===s?e:this,[t])}return Reflect.get(e,t,s)}});return gx(r,mx(this)),r}toArray(t){const s=[];return this.forEach(((i,a)=>{i instanceof Error&&yx(`index ${a}`,i),t&&i instanceof e&&(i=i.toArray(t)),s.push(i)})),s}toObject(e){const t=mx(this);return t.reduce(((s,i,a)=>(iw(null!=i,`value at index ${a} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),bx(t,this,e))),{})}slice(t,s){null==t&&(t=0),t<0&&(t+=this.length)<0&&(t=0),null==s&&(s=this.length),s<0&&(s+=this.length)<0&&(s=0),s>this.length&&(s=this.length);const i=mx(this),a=[],n=[];for(let e=t;e<s;e++)a.push(this[e]),n.push(i[e]);return new e(px,a,n)}filter(t,s){const i=mx(this),a=[],n=[];for(let e=0;e<this.length;e++){const r=this[e];r instanceof Error&&yx(`index ${e}`,r),t.call(s,r,e,this)&&(a.push(r),n.push(i[e]))}return new e(px,a,n)}map(e,t){const s=[];for(let i=0;i<this.length;i++){const a=this[i];a instanceof Error&&yx(`index ${i}`,a),s.push(e.call(t,a,i,this))}return s}getValue(e){const t=mx(this).indexOf(e);if(-1===t)return;const s=this[t];return s instanceof Error&&yx(`property ${JSON.stringify(e)}`,s.error),s}static fromItems(t,s){return new e(px,t,s)}};function wx(e){let t=Bw(e);return iw(t.length<=hx,"value out-of-bounds","BUFFER_OVERRUN",{buffer:t,length:hx,offset:t.length}),t.length!==hx&&(t=cw(fw([ux.slice(t.length%hx),t]))),t}class xx{constructor(e,t,s,i){Ai(this,"name"),Ai(this,"type"),Ai(this,"localName"),Ai(this,"dynamic"),$v(this,{name:e,type:t,localName:s,dynamic:i},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,t){aw(!1,e,this.localName,t)}}class kx{constructor(){Ti(this,M),Ti(this,P),Ti(this,C),Pi(this,P,[]),Pi(this,C,0)}get data(){return fw(Ei(this,P))}get length(){return Ei(this,C)}appendWriter(e){return Ci(this,M,B).call(this,cw(e.data))}writeBytes(e){let t=cw(e);const s=t.length%hx;return s&&(t=cw(fw([t,ux.slice(s)]))),Ci(this,M,B).call(this,t)}writeValue(e){return Ci(this,M,B).call(this,wx(e))}writeUpdatableValue(){const e=Ei(this,P).length;return Ei(this,P).push(ux),Pi(this,C,Ei(this,C)+hx),t=>{Ei(this,P)[e]=wx(t)}}}P=new WeakMap,C=new WeakMap,M=new WeakSet,B=function(e){return Ei(this,P).push(e),Pi(this,C,Ei(this,C)+e.length),e.length},R=new WeakMap,D=new WeakMap,N=new WeakMap,_=new WeakMap,F=new WeakMap,O=new WeakSet,L=function(e){var t;if(Ei(this,_))return Ci(t=Ei(this,_),O,L).call(t,e);Pi(this,N,Ei(this,N)+e),iw(Ei(this,F)<1||Ei(this,N)<=Ei(this,F)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${Ei(this,F)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:cw(Ei(this,R)),offset:Ei(this,D),length:e,info:{bytesRead:Ei(this,N),dataLength:this.dataLength}})},I=function(e,t,s){let i=Math.ceil(t/hx)*hx;return Ei(this,D)+i>Ei(this,R).length&&(this.allowLoose&&s&&Ei(this,D)+t<=Ei(this,R).length?i=t:iw(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:cw(Ei(this,R)),length:Ei(this,R).length,offset:Ei(this,D)+i})),Ei(this,R).slice(Ei(this,D),Ei(this,D)+i)};let Ax=class e{constructor(e,t,s){Ti(this,O),Ai(this,"allowLoose"),Ti(this,R),Ti(this,D),Ti(this,N),Ti(this,_),Ti(this,F),$v(this,{allowLoose:!!t}),Pi(this,R,cw(e)),Pi(this,N,0),Pi(this,_,null),Pi(this,F,null!=s?s:1024),Pi(this,D,0)}get data(){return pw(Ei(this,R))}get dataLength(){return Ei(this,R).length}get consumed(){return Ei(this,D)}get bytes(){return new Uint8Array(Ei(this,R))}subReader(t){const s=new e(Ei(this,R).slice(Ei(this,D)+t),this.allowLoose,Ei(this,F));return Pi(s,_,this),s}readBytes(e,t){let s=Ci(this,O,I).call(this,0,e,!!t);return Ci(this,O,L).call(this,e),Pi(this,D,Ei(this,D)+s.length),s.slice(0,e)}readValue(){return Pw(this.readBytes(hx))}readIndex(){return Cw(Pw(this.readBytes(hx)))}};function Sx(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function Ex(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function Tx(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Px(e,t){Ex(e);const s=t.outputLen;if(e.length<s)throw new Error(`digestInto() expects output buffer of length at least ${s}`)}const Cx="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,Mx=e=>e instanceof Uint8Array,Bx=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Rx=(e,t)=>e<<32-t|e>>>t;if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");function Dx(e){if("string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),!Mx(e))throw new Error("expected Uint8Array, got "+typeof e);return e}class Nx{clone(){return this._cloneInto()}}function _x(e){const t=t=>e().update(Dx(t)).digest(),s=e();return t.outputLen=s.outputLen,t.blockLen=s.blockLen,t.create=()=>e(),t}function Fx(e=32){if(Cx&&"function"==typeof Cx.getRandomValues)return Cx.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}class Ox extends Nx{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");Sx(e.outputLen),Sx(e.blockLen)}(e);const s=Dx(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,a=new Uint8Array(i);a.set(s.length>i?e.create().update(s).digest():s);for(let n=0;n<a.length;n++)a[n]^=54;this.iHash.update(a),this.oHash=e.create();for(let n=0;n<a.length;n++)a[n]^=106;this.oHash.update(a),a.fill(0)}update(e){return Tx(this),this.iHash.update(e),this}digestInto(e){Tx(this),Ex(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:s,finished:i,destroyed:a,blockLen:n,outputLen:r}=this;return e.finished=i,e.destroyed=a,e.blockLen=n,e.outputLen=r,e.oHash=t._cloneInto(e.oHash),e.iHash=s._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Lx=(e,t,s)=>new Ox(e,t).update(s).digest();Lx.create=(e,t)=>new Ox(e,t);class Ix extends Nx{constructor(e,t,s,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=s,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Bx(this.buffer)}update(e){Tx(this);const{view:t,buffer:s,blockLen:i}=this,a=(e=Dx(e)).length;for(let n=0;n<a;){const r=Math.min(i-this.pos,a-n);if(r!==i)s.set(e.subarray(n,n+r),this.pos),this.pos+=r,n+=r,this.pos===i&&(this.process(t,0),this.pos=0);else{const t=Bx(e);for(;i<=a-n;n+=i)this.process(t,n)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){Tx(this),Px(e,this),this.finished=!0;const{buffer:t,view:s,blockLen:i,isLE:a}=this;let{pos:n}=this;t[n++]=128,this.buffer.subarray(n).fill(0),this.padOffset>i-n&&(this.process(s,0),n=0);for(let h=n;h<i;h++)t[h]=0;!function(e,t,s,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,s,i);const a=BigInt(32),n=BigInt(4294967295),r=Number(s>>a&n),o=Number(s&n),l=i?4:0,c=i?0:4;e.setUint32(t+l,r,i),e.setUint32(t+c,o,i)}(s,i-8,BigInt(8*this.length),a),this.process(s,0);const r=Bx(e),o=this.outputLen;if(o%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=o/4,c=this.get();if(l>c.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)r.setUint32(4*h,c[h],a)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const s=e.slice(0,t);return this.destroy(),s}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:s,length:i,finished:a,destroyed:n,pos:r}=this;return e.length=i,e.pos=r,e.finished=a,e.destroyed=n,i%t&&e.buffer.set(s),e}}const jx=(e,t,s)=>e&t^~e&s,Hx=(e,t,s)=>e&t^e&s^t&s,Vx=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Gx=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ux=new Uint32Array(64);class zx extends Ix{constructor(){super(64,32,8,!1),this.A=0|Gx[0],this.B=0|Gx[1],this.C=0|Gx[2],this.D=0|Gx[3],this.E=0|Gx[4],this.F=0|Gx[5],this.G=0|Gx[6],this.H=0|Gx[7]}get(){const{A:e,B:t,C:s,D:i,E:a,F:n,G:r,H:o}=this;return[e,t,s,i,a,n,r,o]}set(e,t,s,i,a,n,r,o){this.A=0|e,this.B=0|t,this.C=0|s,this.D=0|i,this.E=0|a,this.F=0|n,this.G=0|r,this.H=0|o}process(e,t){for(let h=0;h<16;h++,t+=4)Ux[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const e=Ux[h-15],t=Ux[h-2],s=Rx(e,7)^Rx(e,18)^e>>>3,i=Rx(t,17)^Rx(t,19)^t>>>10;Ux[h]=i+Ux[h-7]+s+Ux[h-16]|0}let{A:s,B:i,C:a,D:n,E:r,F:o,G:l,H:c}=this;for(let h=0;h<64;h++){const e=c+(Rx(r,6)^Rx(r,11)^Rx(r,25))+jx(r,o,l)+Vx[h]+Ux[h]|0,t=(Rx(s,2)^Rx(s,13)^Rx(s,22))+Hx(s,i,a)|0;c=l,l=o,o=r,r=n+e|0,n=a,a=i,i=s,s=e+t|0}s=s+this.A|0,i=i+this.B|0,a=a+this.C|0,n=n+this.D|0,r=r+this.E|0,o=o+this.F|0,l=l+this.G|0,c=c+this.H|0,this.set(s,i,a,n,r,o,l,c)}roundClean(){Ux.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Wx=_x((()=>new zx)),Qx=BigInt(2**32-1),qx=BigInt(32);function Kx(e,t=!1){return t?{h:Number(e&Qx),l:Number(e>>qx&Qx)}:{h:0|Number(e>>qx&Qx),l:0|Number(e&Qx)}}function Zx(e,t=!1){let s=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let a=0;a<e.length;a++){const{h:n,l:r}=Kx(e[a],t);[s[a],i[a]]=[n,r]}return[s,i]}const Jx=(e,t,s)=>e<<s|t>>>32-s,Xx=(e,t,s)=>t<<s|e>>>32-s,$x=(e,t,s)=>t<<s-32|e>>>64-s,Yx=(e,t,s)=>e<<s-32|t>>>64-s,ek={fromBig:Kx,split:Zx,toBig:(e,t)=>BigInt(e>>>0)<<qx|BigInt(t>>>0),shrSH:(e,t,s)=>e>>>s,shrSL:(e,t,s)=>e<<32-s|t>>>s,rotrSH:(e,t,s)=>e>>>s|t<<32-s,rotrSL:(e,t,s)=>e<<32-s|t>>>s,rotrBH:(e,t,s)=>e<<64-s|t>>>s-32,rotrBL:(e,t,s)=>e>>>s-32|t<<64-s,rotr32H:(e,t)=>t,rotr32L:(e,t)=>e,rotlSH:Jx,rotlSL:Xx,rotlBH:$x,rotlBL:Yx,add:function(e,t,s,i){const a=(t>>>0)+(i>>>0);return{h:e+s+(a/2**32|0)|0,l:0|a}},add3L:(e,t,s)=>(e>>>0)+(t>>>0)+(s>>>0),add3H:(e,t,s,i)=>t+s+i+(e/2**32|0)|0,add4L:(e,t,s,i)=>(e>>>0)+(t>>>0)+(s>>>0)+(i>>>0),add4H:(e,t,s,i,a)=>t+s+i+a+(e/2**32|0)|0,add5H:(e,t,s,i,a,n)=>t+s+i+a+n+(e/2**32|0)|0,add5L:(e,t,s,i,a)=>(e>>>0)+(t>>>0)+(s>>>0)+(i>>>0)+(a>>>0)},[tk,sk]=(()=>ek.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))))(),ik=new Uint32Array(80),ak=new Uint32Array(80);class nk extends Ix{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:s,Bl:i,Ch:a,Cl:n,Dh:r,Dl:o,Eh:l,El:c,Fh:h,Fl:u,Gh:d,Gl:p,Hh:f,Hl:m}=this;return[e,t,s,i,a,n,r,o,l,c,h,u,d,p,f,m]}set(e,t,s,i,a,n,r,o,l,c,h,u,d,p,f,m){this.Ah=0|e,this.Al=0|t,this.Bh=0|s,this.Bl=0|i,this.Ch=0|a,this.Cl=0|n,this.Dh=0|r,this.Dl=0|o,this.Eh=0|l,this.El=0|c,this.Fh=0|h,this.Fl=0|u,this.Gh=0|d,this.Gl=0|p,this.Hh=0|f,this.Hl=0|m}process(e,t){for(let b=0;b<16;b++,t+=4)ik[b]=e.getUint32(t),ak[b]=e.getUint32(t+=4);for(let b=16;b<80;b++){const e=0|ik[b-15],t=0|ak[b-15],s=ek.rotrSH(e,t,1)^ek.rotrSH(e,t,8)^ek.shrSH(e,t,7),i=ek.rotrSL(e,t,1)^ek.rotrSL(e,t,8)^ek.shrSL(e,t,7),a=0|ik[b-2],n=0|ak[b-2],r=ek.rotrSH(a,n,19)^ek.rotrBH(a,n,61)^ek.shrSH(a,n,6),o=ek.rotrSL(a,n,19)^ek.rotrBL(a,n,61)^ek.shrSL(a,n,6),l=ek.add4L(i,o,ak[b-7],ak[b-16]),c=ek.add4H(l,s,r,ik[b-7],ik[b-16]);ik[b]=0|c,ak[b]=0|l}let{Ah:s,Al:i,Bh:a,Bl:n,Ch:r,Cl:o,Dh:l,Dl:c,Eh:h,El:u,Fh:d,Fl:p,Gh:f,Gl:m,Hh:g,Hl:y}=this;for(let b=0;b<80;b++){const e=ek.rotrSH(h,u,14)^ek.rotrSH(h,u,18)^ek.rotrBH(h,u,41),t=ek.rotrSL(h,u,14)^ek.rotrSL(h,u,18)^ek.rotrBL(h,u,41),v=h&d^~h&f,w=u&p^~u&m,x=ek.add5L(y,t,w,sk[b],ak[b]),k=ek.add5H(x,g,e,v,tk[b],ik[b]),A=0|x,S=ek.rotrSH(s,i,28)^ek.rotrBH(s,i,34)^ek.rotrBH(s,i,39),E=ek.rotrSL(s,i,28)^ek.rotrBL(s,i,34)^ek.rotrBL(s,i,39),T=s&a^s&r^a&r,P=i&n^i&o^n&o;g=0|f,y=0|m,f=0|d,m=0|p,d=0|h,p=0|u,({h:h,l:u}=ek.add(0|l,0|c,0|k,0|A)),l=0|r,c=0|o,r=0|a,o=0|n,a=0|s,n=0|i;const C=ek.add3L(A,E,P);s=ek.add3H(C,k,S,T),i=0|C}({h:s,l:i}=ek.add(0|this.Ah,0|this.Al,0|s,0|i)),({h:a,l:n}=ek.add(0|this.Bh,0|this.Bl,0|a,0|n)),({h:r,l:o}=ek.add(0|this.Ch,0|this.Cl,0|r,0|o)),({h:l,l:c}=ek.add(0|this.Dh,0|this.Dl,0|l,0|c)),({h:h,l:u}=ek.add(0|this.Eh,0|this.El,0|h,0|u)),({h:d,l:p}=ek.add(0|this.Fh,0|this.Fl,0|d,0|p)),({h:f,l:m}=ek.add(0|this.Gh,0|this.Gl,0|f,0|m)),({h:g,l:y}=ek.add(0|this.Hh,0|this.Hl,0|g,0|y)),this.set(s,i,a,n,r,o,l,c,h,u,d,p,f,m,g,y)}roundClean(){ik.fill(0),ak.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const rk=_x((()=>new nk)),ok=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();ok.crypto||ok.msCrypto;const[lk,ck,hk]=[[],[],[]],uk=BigInt(0),dk=BigInt(1),pk=BigInt(2),fk=BigInt(7),mk=BigInt(256),gk=BigInt(113);for(let ED=0,TD=dk,PD=1,CD=0;ED<24;ED++){[PD,CD]=[CD,(2*PD+3*CD)%5],lk.push(2*(5*CD+PD)),ck.push((ED+1)*(ED+2)/2%64);let e=uk;for(let t=0;t<7;t++)TD=(TD<<dk^(TD>>fk)*gk)%mk,TD&pk&&(e^=dk<<(dk<<BigInt(t))-dk);hk.push(e)}const[yk,bk]=Zx(hk,!0),vk=(e,t,s)=>s>32?$x(e,t,s):Jx(e,t,s),wk=(e,t,s)=>s>32?Yx(e,t,s):Xx(e,t,s);class xk extends Nx{constructor(e,t,s,i=!1,a=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=s,this.enableXOF=i,this.rounds=a,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Sx(s),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");var n;this.state=new Uint8Array(200),this.state32=(n=this.state,new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4)))}keccak(){!function(e,t=24){const s=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let i=0;i<10;i++)s[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(let i=0;i<10;i+=2){const t=(i+8)%10,a=(i+2)%10,n=s[a],r=s[a+1],o=vk(n,r,1)^s[t],l=wk(n,r,1)^s[t+1];for(let s=0;s<50;s+=10)e[i+s]^=o,e[i+s+1]^=l}let t=e[2],a=e[3];for(let s=0;s<24;s++){const i=ck[s],n=vk(t,a,i),r=wk(t,a,i),o=lk[s];t=e[o],a=e[o+1],e[o]=n,e[o+1]=r}for(let i=0;i<50;i+=10){for(let t=0;t<10;t++)s[t]=e[i+t];for(let t=0;t<10;t++)e[i+t]^=~s[(t+2)%10]&s[(t+4)%10]}e[0]^=yk[i],e[1]^=bk[i]}s.fill(0)}(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){Tx(this);const{blockLen:t,state:s}=this,i=(e=Dx(e)).length;for(let a=0;a<i;){const n=Math.min(t-this.pos,i-a);for(let t=0;t<n;t++)s[this.pos++]^=e[a++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:s,blockLen:i}=this;e[s]^=t,128&t&&s===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){Tx(this,!1),Ex(e),this.finish();const t=this.state,{blockLen:s}=this;for(let i=0,a=e.length;i<a;){this.posOut>=s&&this.keccak();const n=Math.min(s-this.posOut,a-i);e.set(t.subarray(this.posOut,this.posOut+n),i),this.posOut+=n,i+=n}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Sx(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Px(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:s,outputLen:i,rounds:a,enableXOF:n}=this;return e||(e=new xk(t,s,i,n,a)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=a,e.suffix=s,e.outputLen=i,e.enableXOF=n,e.destroyed=this.destroyed,e}}const kk=(()=>_x((()=>new xk(136,1,32))))();let Ak=!1;const Sk=function(e){return kk(e)};let Ek=Sk;function Tk(e){const t=lw(e,"data");return pw(Ek(t))}Tk._=Sk,Tk.lock=function(){Ak=!0},Tk.register=function(e){if(Ak)throw new TypeError("keccak256 is locked");Ek=e},Object.freeze(Tk);const Pk=function(e){return function(e){switch(e){case"sha256":return Wx.create();case"sha512":return rk.create()}aw(!1,"invalid hashing algorithm name","algorithm",e)}("sha256").update(e).digest()};let Ck=Pk,Mk=!1;function Bk(e){const t=lw(e,"data");return pw(Ck(t))}Bk._=Pk,Bk.lock=function(){Mk=!0},Bk.register=function(e){if(Mk)throw new Error("sha256 is locked");Ck=e},Object.freeze(Bk),Object.freeze(Bk);const Rk=BigInt(0),Dk=BigInt(1),Nk=BigInt(2),_k=e=>e instanceof Uint8Array,Fk=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function Ok(e){if(!_k(e))throw new Error("Uint8Array expected");let t="";for(let s=0;s<e.length;s++)t+=Fk[e[s]];return t}function Lk(e){const t=e.toString(16);return 1&t.length?`0${t}`:t}function Ik(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return BigInt(""===e?"0":`0x${e}`)}function jk(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const s=new Uint8Array(t/2);for(let i=0;i<s.length;i++){const t=2*i,a=e.slice(t,t+2),n=Number.parseInt(a,16);if(Number.isNaN(n)||n<0)throw new Error("Invalid byte sequence");s[i]=n}return s}function Hk(e){return Ik(Ok(e))}function Vk(e){if(!_k(e))throw new Error("Uint8Array expected");return Ik(Ok(Uint8Array.from(e).reverse()))}function Gk(e,t){return jk(e.toString(16).padStart(2*t,"0"))}function Uk(e,t){return Gk(e,t).reverse()}function zk(e,t,s){let i;if("string"==typeof t)try{i=jk(t)}catch(SD){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${SD}`)}else{if(!_k(t))throw new Error(`${e} must be hex string or Uint8Array`);i=Uint8Array.from(t)}const a=i.length;if("number"==typeof s&&a!==s)throw new Error(`${e} expected ${s} bytes, got ${a}`);return i}function Wk(...e){const t=new Uint8Array(e.reduce(((e,t)=>e+t.length),0));let s=0;return e.forEach((e=>{if(!_k(e))throw new Error("Uint8Array expected");t.set(e,s),s+=e.length})),t}const Qk=e=>(Nk<<BigInt(e-1))-Dk,qk=e=>new Uint8Array(e),Kk=e=>Uint8Array.from(e);function Zk(e,t,s){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof s)throw new Error("hmacFn must be a function");let i=qk(e),a=qk(e),n=0;const r=()=>{i.fill(1),a.fill(0),n=0},o=(...e)=>s(a,i,...e),l=(e=qk())=>{a=o(Kk([0]),e),i=o(),0!==e.length&&(a=o(Kk([1]),e),i=o())},c=()=>{if(n++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const s=[];for(;e<t;){i=o();const t=i.slice();s.push(t),e+=i.length}return Wk(...s)};return(e,t)=>{let s;for(r(),l(e);!(s=t(c()));)l();return r(),s}}const Jk={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||e instanceof Uint8Array,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function Xk(e,t,s={}){const i=(t,s,i)=>{const a=Jk[s];if("function"!=typeof a)throw new Error(`Invalid validator "${s}", expected function`);const n=e[t];if(!(i&&void 0===n||a(n,e)))throw new Error(`Invalid param ${String(t)}=${n} (${typeof n}), expected ${s}`)};for(const[a,n]of Object.entries(t))i(a,n,!1);for(const[a,n]of Object.entries(s))i(a,n,!0);return e}const $k=Object.freeze(Object.defineProperty({__proto__:null,bitGet:function(e,t){return e>>BigInt(t)&Dk},bitLen:function(e){let t;for(t=0;e>Rk;e>>=Dk,t+=1);return t},bitMask:Qk,bitSet:(e,t,s)=>e|(s?Dk:Rk)<<BigInt(t),bytesToHex:Ok,bytesToNumberBE:Hk,bytesToNumberLE:Vk,concatBytes:Wk,createHmacDrbg:Zk,ensureBytes:zk,equalBytes:function(e,t){if(e.length!==t.length)return!1;for(let s=0;s<e.length;s++)if(e[s]!==t[s])return!1;return!0},hexToBytes:jk,hexToNumber:Ik,numberToBytesBE:Gk,numberToBytesLE:Uk,numberToHexUnpadded:Lk,numberToVarBytesBE:function(e){return jk(Lk(e))},utf8ToBytes:function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))},validateObject:Xk},Symbol.toStringTag,{value:"Module"})),Yk=BigInt(0),eA=BigInt(1),tA=BigInt(2),sA=BigInt(3),iA=BigInt(4),aA=BigInt(5),nA=BigInt(8);function rA(e,t){const s=e%t;return s>=Yk?s:t+s}function oA(e,t,s){if(s<=Yk||t<Yk)throw new Error("Expected power/modulo > 0");if(s===eA)return Yk;let i=eA;for(;t>Yk;)t&eA&&(i=i*e%s),e=e*e%s,t>>=eA;return i}function lA(e,t,s){let i=e;for(;t-- >Yk;)i*=i,i%=s;return i}function cA(e,t){if(e===Yk||t<=Yk)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let s=rA(e,t),i=t,a=Yk,n=eA;for(;s!==Yk;){const e=i%s,t=a-n*(i/s);i=s,s=e,a=n,n=t}if(i!==eA)throw new Error("invert: does not exist");return rA(a,t)}BigInt(9),BigInt(16);const hA=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function uA(e,t){const s=void 0!==t?t:e.toString(2).length;return{nBitLength:s,nByteLength:Math.ceil(s/8)}}function dA(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function pA(e){const t=dA(e);return t+Math.ceil(t/2)}const fA=BigInt(0),mA=BigInt(1);function gA(e){return Xk(e.Fp,hA.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),Xk(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...uA(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}const{bytesToNumberBE:yA,hexToBytes:bA}=$k,vA={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(e){const{Err:t}=vA;if(e.length<2||2!==e[0])throw new t("Invalid signature integer tag");const s=e[1],i=e.subarray(2,s+2);if(!s||i.length!==s)throw new t("Invalid signature integer: wrong length");if(128&i[0])throw new t("Invalid signature integer: negative");if(0===i[0]&&!(128&i[1]))throw new t("Invalid signature integer: unnecessary leading zero");return{d:yA(i),l:e.subarray(s+2)}},toSig(e){const{Err:t}=vA,s="string"==typeof e?bA(e):e;if(!(s instanceof Uint8Array))throw new Error("ui8a expected");let i=s.length;if(i<2||48!=s[0])throw new t("Invalid signature tag");if(s[1]!==i-2)throw new t("Invalid signature: incorrect length");const{d:a,l:n}=vA._parseInt(s.subarray(2)),{d:r,l:o}=vA._parseInt(n);if(o.length)throw new t("Invalid signature: left bytes after parsing");return{r:a,s:r}},hexFromSig(e){const t=e=>8&Number.parseInt(e[0],16)?"00"+e:e,s=e=>{const t=e.toString(16);return 1&t.length?`0${t}`:t},i=t(s(e.s)),a=t(s(e.r)),n=i.length/2,r=a.length/2,o=s(n),l=s(r);return`30${s(r+n+4)}02${l}${a}02${o}${i}`}},wA=BigInt(0),xA=BigInt(1);BigInt(2);const kA=BigInt(3);function AA(e){const t=function(e){const t=gA(e);return Xk(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}(e),{Fp:s,n:i}=t,a=s.BYTES+1,n=2*s.BYTES+1;function r(e){return rA(e,i)}function o(e){return cA(e,i)}const{ProjectivePoint:l,normPrivateKeyToScalar:c,weierstrassEquation:h,isWithinCurveOrder:u}=function(e){const t=function(e){const t=gA(e);Xk(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:s,Fp:i,a:a}=t;if(s){if(!i.eql(a,i.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof s||"bigint"!=typeof s.beta||"function"!=typeof s.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:s}=t,i=t.toBytes||((e,t,i)=>{const a=t.toAffine();return Wk(Uint8Array.from([4]),s.toBytes(a.x),s.toBytes(a.y))}),a=t.fromBytes||(e=>{const t=e.subarray(1);return{x:s.fromBytes(t.subarray(0,s.BYTES)),y:s.fromBytes(t.subarray(s.BYTES,2*s.BYTES))}});function n(e){const{a:i,b:a}=t,n=s.sqr(e),r=s.mul(n,e);return s.add(s.add(r,s.mul(e,i)),a)}if(!s.eql(s.sqr(t.Gy),n(t.Gx)))throw new Error("bad generator point: equation left != right");function r(e){return"bigint"==typeof e&&wA<e&&e<t.n}function o(e){if(!r(e))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function l(e){const{allowedPrivateKeyLengths:s,nByteLength:i,wrapPrivateKey:a,n:n}=t;if(s&&"bigint"!=typeof e){if(e instanceof Uint8Array&&(e=Ok(e)),"string"!=typeof e||!s.includes(e.length))throw new Error("Invalid key");e=e.padStart(2*i,"0")}let r;try{r="bigint"==typeof e?e:Hk(zk("private key",e,i))}catch(l){throw new Error(`private key must be ${i} bytes, hex or bigint, not ${typeof e}`)}return a&&(r=rA(r,n)),o(r),r}const c=new Map;function h(e){if(!(e instanceof u))throw new Error("ProjectivePoint expected")}class u{constructor(e,t,i){if(this.px=e,this.py=t,this.pz=i,null==e||!s.isValid(e))throw new Error("x required");if(null==t||!s.isValid(t))throw new Error("y required");if(null==i||!s.isValid(i))throw new Error("z required")}static fromAffine(e){const{x:t,y:i}=e||{};if(!e||!s.isValid(t)||!s.isValid(i))throw new Error("invalid affine point");if(e instanceof u)throw new Error("projective point not allowed");const a=e=>s.eql(e,s.ZERO);return a(t)&&a(i)?u.ZERO:new u(t,i,s.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=s.invertBatch(e.map((e=>e.pz)));return e.map(((e,s)=>e.toAffine(t[s]))).map(u.fromAffine)}static fromHex(e){const t=u.fromAffine(a(zk("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return u.BASE.multiply(l(e))}_setWindowSize(e){this._WINDOW_SIZE=e,c.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!s.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:e,y:i}=this.toAffine();if(!s.isValid(e)||!s.isValid(i))throw new Error("bad point: x or y not FE");const a=s.sqr(i),r=n(e);if(!s.eql(a,r))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:e}=this.toAffine();if(s.isOdd)return!s.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){h(e);const{px:t,py:i,pz:a}=this,{px:n,py:r,pz:o}=e,l=s.eql(s.mul(t,o),s.mul(n,a)),c=s.eql(s.mul(i,o),s.mul(r,a));return l&&c}negate(){return new u(this.px,s.neg(this.py),this.pz)}double(){const{a:e,b:i}=t,a=s.mul(i,kA),{px:n,py:r,pz:o}=this;let l=s.ZERO,c=s.ZERO,h=s.ZERO,d=s.mul(n,n),p=s.mul(r,r),f=s.mul(o,o),m=s.mul(n,r);return m=s.add(m,m),h=s.mul(n,o),h=s.add(h,h),l=s.mul(e,h),c=s.mul(a,f),c=s.add(l,c),l=s.sub(p,c),c=s.add(p,c),c=s.mul(l,c),l=s.mul(m,l),h=s.mul(a,h),f=s.mul(e,f),m=s.sub(d,f),m=s.mul(e,m),m=s.add(m,h),h=s.add(d,d),d=s.add(h,d),d=s.add(d,f),d=s.mul(d,m),c=s.add(c,d),f=s.mul(r,o),f=s.add(f,f),d=s.mul(f,m),l=s.sub(l,d),h=s.mul(f,p),h=s.add(h,h),h=s.add(h,h),new u(l,c,h)}add(e){h(e);const{px:i,py:a,pz:n}=this,{px:r,py:o,pz:l}=e;let c=s.ZERO,d=s.ZERO,p=s.ZERO;const f=t.a,m=s.mul(t.b,kA);let g=s.mul(i,r),y=s.mul(a,o),b=s.mul(n,l),v=s.add(i,a),w=s.add(r,o);v=s.mul(v,w),w=s.add(g,y),v=s.sub(v,w),w=s.add(i,n);let x=s.add(r,l);return w=s.mul(w,x),x=s.add(g,b),w=s.sub(w,x),x=s.add(a,n),c=s.add(o,l),x=s.mul(x,c),c=s.add(y,b),x=s.sub(x,c),p=s.mul(f,w),c=s.mul(m,b),p=s.add(c,p),c=s.sub(y,p),p=s.add(y,p),d=s.mul(c,p),y=s.add(g,g),y=s.add(y,g),b=s.mul(f,b),w=s.mul(m,w),y=s.add(y,b),b=s.sub(g,b),b=s.mul(f,b),w=s.add(w,b),g=s.mul(y,w),d=s.add(d,g),g=s.mul(x,w),c=s.mul(v,c),c=s.sub(c,g),g=s.mul(v,y),p=s.mul(x,p),p=s.add(p,g),new u(c,d,p)}subtract(e){return this.add(e.negate())}is0(){return this.equals(u.ZERO)}wNAF(e){return p.wNAFCached(this,c,e,(e=>{const t=s.invertBatch(e.map((e=>e.pz)));return e.map(((e,s)=>e.toAffine(t[s]))).map(u.fromAffine)}))}multiplyUnsafe(e){const i=u.ZERO;if(e===wA)return i;if(o(e),e===xA)return this;const{endo:a}=t;if(!a)return p.unsafeLadder(this,e);let{k1neg:n,k1:r,k2neg:l,k2:c}=a.splitScalar(e),h=i,d=i,f=this;for(;r>wA||c>wA;)r&xA&&(h=h.add(f)),c&xA&&(d=d.add(f)),f=f.double(),r>>=xA,c>>=xA;return n&&(h=h.negate()),l&&(d=d.negate()),d=new u(s.mul(d.px,a.beta),d.py,d.pz),h.add(d)}multiply(e){o(e);let i,a,n=e;const{endo:r}=t;if(r){const{k1neg:e,k1:t,k2neg:o,k2:l}=r.splitScalar(n);let{p:c,f:h}=this.wNAF(t),{p:d,f:f}=this.wNAF(l);c=p.constTimeNegate(e,c),d=p.constTimeNegate(o,d),d=new u(s.mul(d.px,r.beta),d.py,d.pz),i=c.add(d),a=h.add(f)}else{const{p:e,f:t}=this.wNAF(n);i=e,a=t}return u.normalizeZ([i,a])[0]}multiplyAndAddUnsafe(e,t,s){const i=u.BASE,a=(e,t)=>t!==wA&&t!==xA&&e.equals(i)?e.multiply(t):e.multiplyUnsafe(t),n=a(this,t).add(a(e,s));return n.is0()?void 0:n}toAffine(e){const{px:t,py:i,pz:a}=this,n=this.is0();null==e&&(e=n?s.ONE:s.inv(a));const r=s.mul(t,e),o=s.mul(i,e),l=s.mul(a,e);if(n)return{x:s.ZERO,y:s.ZERO};if(!s.eql(l,s.ONE))throw new Error("invZ was invalid");return{x:r,y:o}}isTorsionFree(){const{h:e,isTorsionFree:s}=t;if(e===xA)return!0;if(s)return s(u,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:s}=t;return e===xA?this:s?s(u,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return this.assertValidity(),i(u,this,e)}toHex(e=!0){return Ok(this.toRawBytes(e))}}u.BASE=new u(t.Gx,t.Gy,s.ONE),u.ZERO=new u(s.ZERO,s.ONE,s.ZERO);const d=t.nBitLength,p=function(e,t){const s=(e,t)=>{const s=t.negate();return e?s:t},i=e=>({windows:Math.ceil(t/e)+1,windowSize:2**(e-1)});return{constTimeNegate:s,unsafeLadder(t,s){let i=e.ZERO,a=t;for(;s>fA;)s&mA&&(i=i.add(a)),a=a.double(),s>>=mA;return i},precomputeWindow(e,t){const{windows:s,windowSize:a}=i(t),n=[];let r=e,o=r;for(let i=0;i<s;i++){o=r,n.push(o);for(let e=1;e<a;e++)o=o.add(r),n.push(o);r=o.double()}return n},wNAF(t,a,n){const{windows:r,windowSize:o}=i(t);let l=e.ZERO,c=e.BASE;const h=BigInt(2**t-1),u=2**t,d=BigInt(t);for(let e=0;e<r;e++){const t=e*o;let i=Number(n&h);n>>=d,i>o&&(i-=u,n+=mA);const r=t,p=t+Math.abs(i)-1,f=e%2!=0,m=i<0;0===i?c=c.add(s(f,a[r])):l=l.add(s(m,a[p]))}return{p:l,f:c}},wNAFCached(e,t,s,i){const a=e._WINDOW_SIZE||1;let n=t.get(e);return n||(n=this.precomputeWindow(e,a),1!==a&&t.set(e,i(n))),this.wNAF(a,n,s)}}}(u,t.endo?Math.ceil(d/2):d);return{CURVE:t,ProjectivePoint:u,normPrivateKeyToScalar:l,weierstrassEquation:n,isWithinCurveOrder:r}}({...t,toBytes(e,t,i){const a=t.toAffine(),n=s.toBytes(a.x),r=Wk;return i?r(Uint8Array.from([t.hasEvenY()?2:3]),n):r(Uint8Array.from([4]),n,s.toBytes(a.y))},fromBytes(e){const t=e.length,i=e[0],r=e.subarray(1);if(t!==a||2!==i&&3!==i){if(t===n&&4===i)return{x:s.fromBytes(r.subarray(0,s.BYTES)),y:s.fromBytes(r.subarray(s.BYTES,2*s.BYTES))};throw new Error(`Point of length ${t} was invalid. Expected ${a} compressed bytes or ${n} uncompressed bytes`)}{const e=Hk(r);if(!(wA<(o=e)&&o<s.ORDER))throw new Error("Point is not on curve");const t=h(e);let a=s.sqrt(t);return!(1&~i)!=((a&xA)===xA)&&(a=s.neg(a)),{x:e,y:a}}var o}}),d=e=>Ok(Gk(e,t.nByteLength));function p(e){return e>i>>xA}const f=(e,t,s)=>Hk(e.slice(t,s));class m{constructor(e,t,s){this.r=e,this.s=t,this.recovery=s,this.assertValidity()}static fromCompact(e){const s=t.nByteLength;return e=zk("compactSignature",e,2*s),new m(f(e,0,s),f(e,s,2*s))}static fromDER(e){const{r:t,s:s}=vA.toSig(zk("DER",e));return new m(t,s)}assertValidity(){if(!u(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!u(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(e){return new m(this.r,this.s,e)}recoverPublicKey(e){const{r:i,s:a,recovery:n}=this,c=v(zk("msgHash",e));if(null==n||![0,1,2,3].includes(n))throw new Error("recovery id invalid");const h=2===n||3===n?i+t.n:i;if(h>=s.ORDER)throw new Error("recovery id 2 or 3 invalid");const u=1&n?"03":"02",p=l.fromHex(u+d(h)),f=o(h),m=r(-c*f),g=r(a*f),y=l.BASE.multiplyAndAddUnsafe(p,m,g);if(!y)throw new Error("point at infinify");return y.assertValidity(),y}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,r(-this.s),this.recovery):this}toDERRawBytes(){return jk(this.toDERHex())}toDERHex(){return vA.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return jk(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const g={isValidPrivateKey(e){try{return c(e),!0}catch(t){return!1}},normPrivateKeyToScalar:c,randomPrivateKey:()=>{const e=pA(t.n);return function(e,t,s=!1){const i=e.length,a=dA(t),n=pA(t);if(i<16||i<n||i>1024)throw new Error(`expected ${n}-1024 bytes of input, got ${i}`);const r=rA(s?Hk(e):Vk(e),t-eA)+eA;return s?Uk(r,a):Gk(r,a)}(t.randomBytes(e),t.n)},precompute:(e=8,t=l.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)};function y(e){const t=e instanceof Uint8Array,s="string"==typeof e,i=(t||s)&&e.length;return t?i===a||i===n:s?i===2*a||i===2*n:e instanceof l}const b=t.bits2int||function(e){const s=Hk(e),i=8*e.length-t.nBitLength;return i>0?s>>BigInt(i):s},v=t.bits2int_modN||function(e){return r(b(e))},w=Qk(t.nBitLength);function x(e){if("bigint"!=typeof e)throw new Error("bigint expected");if(!(wA<=e&&e<w))throw new Error(`bigint expected < 2^${t.nBitLength}`);return Gk(e,t.nByteLength)}const k={lowS:t.lowS,prehash:!1},A={lowS:t.lowS,prehash:!1};return l.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e,t=!0){return l.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,s=!0){if(y(e))throw new Error("first arg must be private key");if(!y(t))throw new Error("second arg must be public key");return l.fromHex(t).multiply(c(e)).toRawBytes(s)},sign:function(e,i,a=k){const{seed:n,k2sig:h}=function(e,i,a=k){if(["recovered","canonical"].some((e=>e in a)))throw new Error("sign() legacy options not supported");const{hash:n,randomBytes:h}=t;let{lowS:d,prehash:f,extraEntropy:g}=a;null==d&&(d=!0),e=zk("msgHash",e),f&&(e=zk("prehashed msgHash",n(e)));const y=v(e),w=c(i),A=[x(w),x(y)];if(null!=g){const e=!0===g?h(s.BYTES):g;A.push(zk("extraEntropy",e))}const S=Wk(...A),E=y;return{seed:S,k2sig:function(e){const t=b(e);if(!u(t))return;const s=o(t),i=l.BASE.multiply(t).toAffine(),a=r(i.x);if(a===wA)return;const n=r(s*r(E+a*w));if(n===wA)return;let c=(i.x===a?0:2)|Number(i.y&xA),h=n;return d&&p(n)&&(h=function(e){return p(e)?r(-e):e}(n),c^=1),new m(a,h,c)}}}(e,i,a),d=t;return Zk(d.hash.outputLen,d.nByteLength,d.hmac)(n,h)},verify:function(e,s,i,a=A){var n;const c=e;if(s=zk("msgHash",s),i=zk("publicKey",i),"strict"in a)throw new Error("options.strict was renamed to lowS");const{lowS:h,prehash:u}=a;let d,p;try{if("string"==typeof c||c instanceof Uint8Array)try{d=m.fromDER(c)}catch(S){if(!(S instanceof vA.Err))throw S;d=m.fromCompact(c)}else{if("object"!=typeof c||"bigint"!=typeof c.r||"bigint"!=typeof c.s)throw new Error("PARSE");{const{r:e,s:t}=c;d=new m(e,t)}}p=l.fromHex(i)}catch(E){if("PARSE"===E.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(h&&d.hasHighS())return!1;u&&(s=t.hash(s));const{r:f,s:g}=d,y=v(s),b=o(g),w=r(y*b),x=r(f*b),k=null==(n=l.BASE.multiplyAndAddUnsafe(p,w,x))?void 0:n.toAffine();return!!k&&r(k.x)===f},ProjectivePoint:l,Signature:m,utils:g}}function SA(e){return{hash:e,hmac:(t,...s)=>Lx(e,t,function(...e){const t=new Uint8Array(e.reduce(((e,t)=>e+t.length),0));let s=0;return e.forEach((e=>{if(!Mx(e))throw new Error("Uint8Array expected");t.set(e,s),s+=e.length})),t}(...s)),randomBytes:Fx}}BigInt(4);const EA=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),TA=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),PA=BigInt(1),CA=BigInt(2),MA=(e,t)=>(e+t/CA)/t,BA=function(e,t,s=!1,i={}){if(e<=Yk)throw new Error(`Expected Field ORDER > 0, got ${e}`);const{nBitLength:a,nByteLength:n}=uA(e,t);if(n>2048)throw new Error("Field lengths over 2048 bytes are not supported");const r=function(e){if(e%iA===sA){const t=(e+eA)/iA;return function(e,s){const i=e.pow(s,t);if(!e.eql(e.sqr(i),s))throw new Error("Cannot find square root");return i}}if(e%nA===aA){const t=(e-aA)/nA;return function(e,s){const i=e.mul(s,tA),a=e.pow(i,t),n=e.mul(s,a),r=e.mul(e.mul(n,tA),a),o=e.mul(n,e.sub(r,e.ONE));if(!e.eql(e.sqr(o),s))throw new Error("Cannot find square root");return o}}return function(e){const t=(e-eA)/tA;let s,i,a;for(s=e-eA,i=0;s%tA===Yk;s/=tA,i++);for(a=tA;a<e&&oA(a,t,e)!==e-eA;a++);if(1===i){const t=(e+eA)/iA;return function(e,s){const i=e.pow(s,t);if(!e.eql(e.sqr(i),s))throw new Error("Cannot find square root");return i}}const n=(s+eA)/tA;return function(e,r){if(e.pow(r,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let o=i,l=e.pow(e.mul(e.ONE,a),s),c=e.pow(r,n),h=e.pow(r,s);for(;!e.eql(h,e.ONE);){if(e.eql(h,e.ZERO))return e.ZERO;let t=1;for(let i=e.sqr(h);t<o&&!e.eql(i,e.ONE);t++)i=e.sqr(i);const s=e.pow(l,eA<<BigInt(o-t-1));l=e.sqr(s),c=e.mul(c,s),h=e.mul(h,l),o=t}return c}}(e)}(e),o=Object.freeze({ORDER:e,BITS:a,BYTES:n,MASK:Qk(a),ZERO:Yk,ONE:eA,create:t=>rA(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("Invalid field element: expected bigint, got "+typeof t);return Yk<=t&&t<e},is0:e=>e===Yk,isOdd:e=>(e&eA)===eA,neg:t=>rA(-t,e),eql:(e,t)=>e===t,sqr:t=>rA(t*t,e),add:(t,s)=>rA(t+s,e),sub:(t,s)=>rA(t-s,e),mul:(t,s)=>rA(t*s,e),pow:(e,t)=>function(e,t,s){if(s<Yk)throw new Error("Expected power > 0");if(s===Yk)return e.ONE;if(s===eA)return t;let i=e.ONE,a=t;for(;s>Yk;)s&eA&&(i=e.mul(i,a)),a=e.sqr(a),s>>=eA;return i}(o,e,t),div:(t,s)=>rA(t*cA(s,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>cA(t,e),sqrt:i.sqrt||(e=>r(o,e)),invertBatch:e=>function(e,t){const s=new Array(t.length),i=t.reduce(((t,i,a)=>e.is0(i)?t:(s[a]=t,e.mul(t,i))),e.ONE),a=e.inv(i);return t.reduceRight(((t,i,a)=>e.is0(i)?t:(s[a]=e.mul(t,s[a]),e.mul(t,i))),a),s}(o,e),cmov:(e,t,s)=>s?t:e,toBytes:e=>s?Uk(e,n):Gk(e,n),fromBytes:e=>{if(e.length!==n)throw new Error(`Fp.fromBytes: expected ${n}, got ${e.length}`);return s?Vk(e):Hk(e)}});return Object.freeze(o)}(EA,void 0,void 0,{sqrt:function(e){const t=EA,s=BigInt(3),i=BigInt(6),a=BigInt(11),n=BigInt(22),r=BigInt(23),o=BigInt(44),l=BigInt(88),c=e*e*e%t,h=c*c*e%t,u=lA(h,s,t)*h%t,d=lA(u,s,t)*h%t,p=lA(d,CA,t)*c%t,f=lA(p,a,t)*p%t,m=lA(f,n,t)*f%t,g=lA(m,o,t)*m%t,y=lA(g,l,t)*g%t,b=lA(y,o,t)*m%t,v=lA(b,s,t)*h%t,w=lA(v,r,t)*f%t,x=lA(w,i,t)*c%t,k=lA(x,CA,t);if(!BA.eql(BA.sqr(k),e))throw new Error("Cannot find square root");return k}}),RA=function(e,t){const s=t=>AA({...e,...SA(t)});return Object.freeze({...s(t),create:s})}({a:BigInt(0),b:BigInt(7),Fp:BA,n:TA,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=TA,s=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),i=-PA*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),a=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),n=s,r=BigInt("0x100000000000000000000000000000000"),o=MA(n*e,t),l=MA(-i*e,t);let c=rA(e-o*s-l*a,t),h=rA(-o*i-l*n,t);const u=c>r,d=h>r;if(u&&(c=t-c),d&&(h=t-h),c>r||h>r)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:u,k1:c,k2neg:d,k2:h}}}},Wx);BigInt(0),RA.ProjectivePoint;const DA="0x0000000000000000000000000000000000000000",NA="0x0000000000000000000000000000000000000000000000000000000000000000",_A=BigInt(0),FA=BigInt(1),OA=BigInt(2),LA=BigInt(27),IA=BigInt(28),jA=BigInt(35),HA={};function VA(e){return bw(Bw(e),32)}const GA=class e{constructor(e,t,s,i){Ti(this,j),Ti(this,H),Ti(this,V),Ti(this,G),rw(e,HA,"Signature"),Pi(this,j,t),Pi(this,H,s),Pi(this,V,i),Pi(this,G,null)}get r(){return Ei(this,j)}set r(e){aw(32===mw(e),"invalid r","value",e),Pi(this,j,pw(e))}get s(){return Ei(this,H)}set s(e){aw(32===mw(e),"invalid s","value",e);const t=pw(e);aw(parseInt(t.substring(0,3))<8,"non-canonical s","value",t),Pi(this,H,t)}get v(){return Ei(this,V)}set v(e){const t=Cw(e,"value");aw(27===t||28===t,"invalid v","v",e),Pi(this,V,t)}get networkV(){return Ei(this,G)}get legacyChainId(){const t=this.networkV;return null==t?null:e.getChainId(t)}get yParity(){return 27===this.v?0:1}get yParityAndS(){const e=lw(this.s);return this.yParity&&(e[0]|=128),pw(e)}get compactSerialized(){return fw([this.r,this.yParityAndS])}get serialized(){return fw([this.r,this.s,this.yParity?"0x1c":"0x1b"])}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this.s}", yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const t=new e(HA,this.r,this.s,this.v);return this.networkV&&Pi(t,G,this.networkV),t}toJSON(){const e=this.networkV;return{_type:"signature",networkV:null!=e?e.toString():null,r:this.r,s:this.s,v:this.v}}static getChainId(e){const t=Sw(e,"v");return t==LA||t==IA?_A:(aw(t>=jA,"invalid EIP-155 v","v",e),(t-jA)/OA)}static getChainIdV(e,t){return Sw(e)*OA+BigInt(35+t-27)}static getNormalizedV(e){const t=Sw(e);return t===_A||t===LA?27:t===FA||t===IA?28:(aw(t>=jA,"invalid v","v",e),t&FA?27:28)}static from(t){function s(e,s){aw(e,s,"signature",t)}if(null==t)return new e(HA,NA,NA,27);if("string"==typeof t){const i=lw(t,"signature");if(64===i.length){const t=pw(i.slice(0,32)),s=i.slice(32,64),a=128&s[0]?28:27;return s[0]&=127,new e(HA,t,pw(s),a)}if(65===i.length){const t=pw(i.slice(0,32)),a=i.slice(32,64);s(!(128&a[0]),"non-canonical s");const n=e.getNormalizedV(i[64]);return new e(HA,t,pw(a),n)}s(!1,"invalid raw signature length")}if(t instanceof e)return t.clone();const i=t.r;s(null!=i,"missing r");const a=VA(i),n=function(e,t){if(null!=e)return VA(e);if(null!=t){s(hw(t,32),"invalid yParityAndS");const e=lw(t);return e[0]&=127,pw(e)}s(!1,"missing s")}(t.s,t.yParityAndS);s(!(128&lw(n)[0]),"non-canonical s");const{networkV:r,v:o}=function(t,i,a){if(null!=t){const s=Sw(t);return{networkV:s>=jA?s:void 0,v:e.getNormalizedV(s)}}if(null!=i)return s(hw(i,32),"invalid yParityAndS"),{v:128&lw(i)[0]?28:27};if(null!=a){switch(Cw(a,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}s(!1,"invalid yParity")}s(!1,"missing v")}(t.v,t.yParityAndS,t.yParity),l=new e(HA,a,n,o);return r&&Pi(l,G,r),s(null==t.yParity||Cw(t.yParity,"sig.yParity")===l.yParity,"yParity mismatch"),s(null==t.yParityAndS||t.yParityAndS===l.yParityAndS,"yParityAndS mismatch"),l}};j=new WeakMap,H=new WeakMap,V=new WeakMap,G=new WeakMap;let UA=GA;U=new WeakMap;let zA=class e{constructor(e){Ti(this,U),aw(32===mw(e),"invalid private key","privateKey","[REDACTED]"),Pi(this,U,pw(e))}get privateKey(){return Ei(this,U)}get publicKey(){return e.computePublicKey(Ei(this,U))}get compressedPublicKey(){return e.computePublicKey(Ei(this,U),!0)}sign(e){aw(32===mw(e),"invalid digest length","digest",e);const t=RA.sign(cw(e),cw(Ei(this,U)),{lowS:!0});return UA.from({r:Mw(t.r,32),s:Mw(t.s,32),v:t.recovery?28:27})}computeSharedSecret(t){const s=e.computePublicKey(t);return pw(RA.getSharedSecret(cw(Ei(this,U)),lw(s),!1))}static computePublicKey(e,t){let s=lw(e,"key");if(32===s.length)return pw(RA.getPublicKey(s,!!t));if(64===s.length){const e=new Uint8Array(65);e[0]=4,e.set(s,1),s=e}return pw(RA.ProjectivePoint.fromHex(s).toRawBytes(t))}static recoverPublicKey(e,t){aw(32===mw(e),"invalid digest length","digest",e);const s=UA.from(t);let i=RA.Signature.fromCompact(cw(fw([s.r,s.s])));i=i.addRecoveryBit(s.yParity);const a=i.recoverPublicKey(cw(e));return aw(null!=a,"invalid signautre for digest","signature",t),"0x"+a.toHex(!1)}static addPoints(t,s,i){const a=RA.ProjectivePoint.fromHex(e.computePublicKey(t).substring(2)),n=RA.ProjectivePoint.fromHex(e.computePublicKey(s).substring(2));return"0x"+a.add(n).toHex(!!i)}};const WA=BigInt(0),QA=BigInt(36);function qA(e){const t=(e=e.toLowerCase()).substring(2).split(""),s=new Uint8Array(40);for(let a=0;a<40;a++)s[a]=t[a].charCodeAt(0);const i=lw(Tk(s));for(let a=0;a<40;a+=2)i[a>>1]>>4>=8&&(t[a]=t[a].toUpperCase()),(15&i[a>>1])>=8&&(t[a+1]=t[a+1].toUpperCase());return"0x"+t.join("")}const KA={};for(let ED=0;ED<10;ED++)KA[String(ED)]=String(ED);for(let ED=0;ED<26;ED++)KA[String.fromCharCode(65+ED)]=String(10+ED);const ZA=function(){const e={};for(let t=0;t<36;t++)e["0123456789abcdefghijklmnopqrstuvwxyz"[t]]=BigInt(t);return e}();function JA(e){if(aw("string"==typeof e,"invalid address","address",e),e.match(/^(0x)?[0-9a-fA-F]{40}$/)){e.startsWith("0x")||(e="0x"+e);const t=qA(e);return aw(!e.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||t===e,"bad address checksum","address",e),t}if(e.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){aw(e.substring(2,4)===function(e){let t=(e=(e=e.toUpperCase()).substring(4)+e.substring(0,2)+"00").split("").map((e=>KA[e])).join("");for(;t.length>=15;){let e=t.substring(0,15);t=parseInt(e,10)%97+t.substring(e.length)}let s=String(98-parseInt(t,10)%97);for(;s.length<2;)s="0"+s;return s}(e),"bad icap checksum","address",e);let t=function(e){e=e.toLowerCase();let t=WA;for(let s=0;s<e.length;s++)t=t*QA+ZA[e[s]];return t}(e.substring(4)).toString(16);for(;t.length<40;)t="0"+t;return qA("0x"+t)}aw(!1,"invalid address","address",e)}function XA(e){return e&&"function"==typeof e.getAddress}async function $A(e,t){const s=await t;return null!=s&&"0x0000000000000000000000000000000000000000"!==s||(iw("string"!=typeof e,"unconfigured name","UNCONFIGURED_NAME",{value:e}),aw(!1,"invalid AddressLike value; did not resolve to a value address","target",e)),JA(s)}function YA(e,t){return"string"==typeof e?e.match(/^0x[0-9a-f]{40}$/i)?JA(e):(iw(null!=t,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),$A(e,t.resolveName(e))):XA(e)?$A(e,e.getAddress()):e&&"function"==typeof e.then?$A(e,e):void aw(!1,"unsupported addressable value","target",e)}const eS={};function tS(e,t){let s=!1;return t<0&&(s=!0,t*=-1),new aS(eS,`${s?"":"u"}int${t}`,e,{signed:s,width:t})}function sS(e,t){return new aS(eS,`bytes${t||""}`,e,{size:t})}const iS=Symbol.for("_ethers_typed");z=new WeakMap;let aS=class e{constructor(e,t,s,i){Ai(this,"type"),Ai(this,"value"),Ti(this,z),Ai(this,"_typedSymbol"),null==i&&(i=null),rw(eS,e,"Typed"),$v(this,{_typedSymbol:iS,type:t,value:s}),Pi(this,z,i),this.format()}format(){if("array"===this.type)throw new Error("");if("dynamicArray"===this.type)throw new Error("");return"tuple"===this.type?`tuple(${this.value.map((e=>e.format())).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return"string"===this.type}get tupleName(){if("tuple"!==this.type)throw TypeError("not a tuple");return Ei(this,z)}get arrayLength(){if("array"!==this.type)throw TypeError("not an array");return!0===Ei(this,z)?-1:!1===Ei(this,z)?this.value.length:null}static from(t,s){return new e(eS,t,s)}static uint8(e){return tS(e,8)}static uint16(e){return tS(e,16)}static uint24(e){return tS(e,24)}static uint32(e){return tS(e,32)}static uint40(e){return tS(e,40)}static uint48(e){return tS(e,48)}static uint56(e){return tS(e,56)}static uint64(e){return tS(e,64)}static uint72(e){return tS(e,72)}static uint80(e){return tS(e,80)}static uint88(e){return tS(e,88)}static uint96(e){return tS(e,96)}static uint104(e){return tS(e,104)}static uint112(e){return tS(e,112)}static uint120(e){return tS(e,120)}static uint128(e){return tS(e,128)}static uint136(e){return tS(e,136)}static uint144(e){return tS(e,144)}static uint152(e){return tS(e,152)}static uint160(e){return tS(e,160)}static uint168(e){return tS(e,168)}static uint176(e){return tS(e,176)}static uint184(e){return tS(e,184)}static uint192(e){return tS(e,192)}static uint200(e){return tS(e,200)}static uint208(e){return tS(e,208)}static uint216(e){return tS(e,216)}static uint224(e){return tS(e,224)}static uint232(e){return tS(e,232)}static uint240(e){return tS(e,240)}static uint248(e){return tS(e,248)}static uint256(e){return tS(e,256)}static uint(e){return tS(e,256)}static int8(e){return tS(e,-8)}static int16(e){return tS(e,-16)}static int24(e){return tS(e,-24)}static int32(e){return tS(e,-32)}static int40(e){return tS(e,-40)}static int48(e){return tS(e,-48)}static int56(e){return tS(e,-56)}static int64(e){return tS(e,-64)}static int72(e){return tS(e,-72)}static int80(e){return tS(e,-80)}static int88(e){return tS(e,-88)}static int96(e){return tS(e,-96)}static int104(e){return tS(e,-104)}static int112(e){return tS(e,-112)}static int120(e){return tS(e,-120)}static int128(e){return tS(e,-128)}static int136(e){return tS(e,-136)}static int144(e){return tS(e,-144)}static int152(e){return tS(e,-152)}static int160(e){return tS(e,-160)}static int168(e){return tS(e,-168)}static int176(e){return tS(e,-176)}static int184(e){return tS(e,-184)}static int192(e){return tS(e,-192)}static int200(e){return tS(e,-200)}static int208(e){return tS(e,-208)}static int216(e){return tS(e,-216)}static int224(e){return tS(e,-224)}static int232(e){return tS(e,-232)}static int240(e){return tS(e,-240)}static int248(e){return tS(e,-248)}static int256(e){return tS(e,-256)}static int(e){return tS(e,-256)}static bytes1(e){return sS(e,1)}static bytes2(e){return sS(e,2)}static bytes3(e){return sS(e,3)}static bytes4(e){return sS(e,4)}static bytes5(e){return sS(e,5)}static bytes6(e){return sS(e,6)}static bytes7(e){return sS(e,7)}static bytes8(e){return sS(e,8)}static bytes9(e){return sS(e,9)}static bytes10(e){return sS(e,10)}static bytes11(e){return sS(e,11)}static bytes12(e){return sS(e,12)}static bytes13(e){return sS(e,13)}static bytes14(e){return sS(e,14)}static bytes15(e){return sS(e,15)}static bytes16(e){return sS(e,16)}static bytes17(e){return sS(e,17)}static bytes18(e){return sS(e,18)}static bytes19(e){return sS(e,19)}static bytes20(e){return sS(e,20)}static bytes21(e){return sS(e,21)}static bytes22(e){return sS(e,22)}static bytes23(e){return sS(e,23)}static bytes24(e){return sS(e,24)}static bytes25(e){return sS(e,25)}static bytes26(e){return sS(e,26)}static bytes27(e){return sS(e,27)}static bytes28(e){return sS(e,28)}static bytes29(e){return sS(e,29)}static bytes30(e){return sS(e,30)}static bytes31(e){return sS(e,31)}static bytes32(e){return sS(e,32)}static address(t){return new e(eS,"address",t)}static bool(t){return new e(eS,"bool",!!t)}static bytes(t){return new e(eS,"bytes",t)}static string(t){return new e(eS,"string",t)}static array(e,t){throw new Error("not implemented yet")}static tuple(e,t){throw new Error("not implemented yet")}static overrides(t){return new e(eS,"overrides",Object.assign({},t))}static isTyped(e){return e&&"object"==typeof e&&"_typedSymbol"in e&&e._typedSymbol===iS}static dereference(t,s){if(e.isTyped(t)){if(t.type!==s)throw new Error(`invalid type: expecetd ${s}, got ${t.type}`);return t.value}return t}};class nS extends xx{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){let s=aS.dereference(t,"string");try{s=JA(s)}catch(i){return this._throwError(i.message,t)}return e.writeValue(s)}decode(e){return JA(Mw(e.readValue(),20))}}class rS extends xx{constructor(e){super(e.name,e.type,"_",e.dynamic),Ai(this,"coder"),this.coder=e}defaultValue(){return this.coder.defaultValue()}encode(e,t){return this.coder.encode(e,t)}decode(e){return this.coder.decode(e)}}function oS(e,t,s){let i=[];if(Array.isArray(s))i=s;else if(s&&"object"==typeof s){let e={};i=t.map((t=>{const i=t.localName;return iw(i,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:t},value:s}),iw(!e[i],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:t},value:s}),e[i]=!0,s[i]}))}else aw(!1,"invalid tuple value","tuple",s);aw(t.length===i.length,"types/value length mismatch","tuple",s);let a=new kx,n=new kx,r=[];t.forEach(((e,t)=>{let s=i[t];if(e.dynamic){let t=n.length;e.encode(n,s);let i=a.writeUpdatableValue();r.push((e=>{i(e+t)}))}else e.encode(a,s)})),r.forEach((e=>{e(a.length)}));let o=e.appendWriter(a);return o+=e.appendWriter(n),o}function lS(e,t){let s=[],i=[],a=e.subReader(0);return t.forEach((t=>{let n=null;if(t.dynamic){let s=e.readIndex(),i=a.subReader(s);try{n=t.decode(i)}catch(r){if(ew(r,"BUFFER_OVERRUN"))throw r;n=r,n.baseType=t.name,n.name=t.localName,n.type=t.type}}else try{n=t.decode(e)}catch(r){if(ew(r,"BUFFER_OVERRUN"))throw r;n=r,n.baseType=t.name,n.name=t.localName,n.type=t.type}if(null==n)throw new Error("investigate");s.push(n),i.push(t.localName||null)})),vx.fromItems(s,i)}class cS extends xx{constructor(e,t,s){super("array",e.type+"["+(t>=0?t:"")+"]",s,-1===t||e.dynamic),Ai(this,"coder"),Ai(this,"length"),$v(this,{coder:e,length:t})}defaultValue(){const e=this.coder.defaultValue(),t=[];for(let s=0;s<this.length;s++)t.push(e);return t}encode(e,t){const s=aS.dereference(t,"array");Array.isArray(s)||this._throwError("expected array value",s);let i=this.length;-1===i&&(i=s.length,e.writeValue(s.length)),nw(s.length,i,"coder array"+(this.localName?" "+this.localName:""));let a=[];for(let n=0;n<s.length;n++)a.push(this.coder);return oS(e,a,s)}decode(e){let t=this.length;-1===t&&(t=e.readIndex(),iw(t*hx<=e.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:e.bytes,offset:t*hx,length:e.dataLength}));let s=[];for(let i=0;i<t;i++)s.push(new rS(this.coder));return lS(e,s)}}class hS extends xx{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){const s=aS.dereference(t,"bool");return e.writeValue(s?1:0)}decode(e){return!!e.readValue()}}class uS extends xx{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=cw(t);let s=e.writeValue(t.length);return s+=e.writeBytes(t),s}decode(e){return e.readBytes(e.readIndex(),!0)}}class dS extends uS{constructor(e){super("bytes",e)}decode(e){return pw(super.decode(e))}}class pS extends xx{constructor(e,t){let s="bytes"+String(e);super(s,s,t,!1),Ai(this,"size"),$v(this,{size:e},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+2*this.size)}encode(e,t){let s=cw(aS.dereference(t,this.type));return s.length!==this.size&&this._throwError("incorrect data length",t),e.writeBytes(s)}decode(e){return pw(e.readBytes(this.size))}}const fS=new Uint8Array([]);class mS extends xx{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return null!=t&&this._throwError("not null",t),e.writeBytes(fS)}decode(e){return e.readBytes(0),null}}const gS=BigInt(0),yS=BigInt(1),bS=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class vS extends xx{constructor(e,t,s){const i=(t?"int":"uint")+8*e;super(i,i,s,!1),Ai(this,"size"),Ai(this,"signed"),$v(this,{size:e,signed:t},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(e,t){let s=Sw(aS.dereference(t,this.type)),i=Aw(bS,256);if(this.signed){let e=Aw(i,8*this.size-1);(s>e||s<-(e+yS))&&this._throwError("value out-of-bounds",t),s=kw(s,256)}else(s<gS||s>Aw(i,8*this.size))&&this._throwError("value out-of-bounds",t);return e.writeValue(s)}decode(e){let t=Aw(e.readValue(),8*this.size);return this.signed&&(t=function(e,t){const s=Ew(e,"value"),i=BigInt(Cw(t,"width"));return iw(s>>i===vw,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:e}),s>>i-ww?-((~s&(ww<<i)-ww)+ww):s}(t,8*this.size)),t}}class wS extends uS{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,Lw(aS.dereference(t,"string")))}decode(e){return Iw(super.decode(e))}}class xS extends xx{constructor(e,t){let s=!1;const i=[];e.forEach((e=>{e.dynamic&&(s=!0),i.push(e.type)})),super("tuple","tuple("+i.join(",")+")",t,s),Ai(this,"coders"),$v(this,{coders:Object.freeze(e.slice())})}defaultValue(){const e=[];this.coders.forEach((t=>{e.push(t.defaultValue())}));const t=this.coders.reduce(((e,t)=>{const s=t.localName;return s&&(e[s]||(e[s]=0),e[s]++),e}),{});return this.coders.forEach(((s,i)=>{let a=s.localName;a&&1===t[a]&&("length"===a&&(a="_length"),null==e[a]&&(e[a]=e[i]))})),Object.freeze(e)}encode(e,t){const s=aS.dereference(t,"tuple");return oS(e,this.coders,s)}decode(e){return lS(e,this.coders)}}function kS(e){return Tk(Lw(e))}const AS=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]);function SS(e){return function(e){let t=0;return()=>e[t++]}(function(e){let t=0;function s(){return e[t++]<<8|e[t++]}let i=s(),a=1,n=[0,1];for(let w=1;w<i;w++)n.push(a+=s());let r=s(),o=t;t+=r;let l=0,c=0;function h(){return 0==l&&(c=c<<8|e[t++],l=8),c>>--l&1}const u=2**31,d=u>>>1,p=d>>1,f=u-1;let m=0;for(let w=0;w<31;w++)m=m<<1|h();let g=[],y=0,b=u;for(;;){let e=Math.floor(((m-y+1)*a-1)/b),t=0,s=i;for(;s-t>1;){let i=t+s>>>1;e<n[i]?s=i:t=i}if(0==t)break;g.push(t);let r=y+Math.floor(b*n[t]/a),o=y+Math.floor(b*n[t+1]/a)-1;for(;!((r^o)&d);)m=m<<1&f|h(),r=r<<1&f,o=o<<1&f|1;for(;r&~o&p;)m=m&d|m<<1&f>>>1|h(),r=r<<1^d,o=(o^d)<<1|d|1;y=r,b=1+o-r}let v=i-4;return g.map((t=>{switch(t-v){case 3:return v+65792+(e[o++]<<16|e[o++]<<8|e[o++]);case 2:return v+256+(e[o++]<<8|e[o++]);case 1:return v+e[o++];default:return t-1}}))}(function(e){let t=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach(((e,s)=>t[e.charCodeAt(0)]=s));let s=e.length,i=new Uint8Array(6*s>>3);for(let a=0,n=0,r=0,o=0;a<s;a++)o=o<<6|t[e.charCodeAt(a)],r+=6,r>=8&&(i[n++]=o>>(r-=8));return i}(e)))}function ES(e){return 1&e?~e>>1:e>>1}function TS(e,t){let s=Array(e);for(let i=0,a=0;i<e;i++)s[i]=a+=ES(t());return s}function PS(e,t=0){let s=[];for(;;){let i=e(),a=e();if(!a)break;t+=i;for(let e=0;e<a;e++)s.push(t+e);t+=a+1}return s}function CS(e){return BS((()=>{let t=PS(e);if(t.length)return t}))}function MS(e){let t=[];for(;;){let s=e();if(0==s)break;t.push(DS(s,e))}for(;;){let s=e()-1;if(s<0)break;t.push(NS(s,e))}return t.flat()}function BS(e){let t=[];for(;;){let s=e(t.length);if(!s)break;t.push(s)}return t}function RS(e,t,s){let i=Array(e).fill().map((()=>[]));for(let a=0;a<t;a++)TS(e,s).forEach(((e,t)=>i[t].push(e)));return i}function DS(e,t){let s=1+t(),i=t(),a=BS(t);return RS(a.length,1+e,t).flatMap(((e,t)=>{let[n,...r]=e;return Array(a[t]).fill().map(((e,t)=>{let a=t*i;return[n+t*s,r.map((e=>e+a))]}))}))}function NS(e,t){return RS(1+t(),1+e,t).map((e=>[e[0],e.slice(1)]))}function _S(e){return`{${function(e){return e.toString(16).toUpperCase().padStart(2,"0")}(e)}}`}function FS(e){let t=e.length;if(t<4096)return String.fromCodePoint(...e);let s=[];for(let i=0;i<t;)s.push(String.fromCodePoint(...e.slice(i,i+=4096)));return s.join("")}function OS(e,t){let s=e.length,i=s-t.length;for(let a=0;0==i&&a<s;a++)i=e[a]-t[a];return i}const LS=44032,IS=4352,jS=4449,HS=4519;function VS(e){return e>>24&255}function GS(e){return 16777215&e}let US,zS,WS,QS;function qS(e){return e>=LS&&e<55204}function KS(e,t){if(e>=IS&&e<4371&&t>=jS&&t<4470)return LS+588*(e-IS)+28*(t-jS);if(qS(e)&&t>HS&&t<4547&&(e-LS)%28==0)return e+(t-HS);{let s=QS.get(e);return s&&(s=s.get(t),s)?s:-1}}function ZS(e){US||function(){let e=SS("AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g");US=new Map(CS(e).flatMap(((e,t)=>e.map((e=>[e,t+1<<24]))))),zS=new Set(PS(e)),WS=new Map,QS=new Map;for(let[t,s]of MS(e)){if(!zS.has(t)&&2==s.length){let[e,i]=s,a=QS.get(e);a||(a=new Map,QS.set(e,a)),a.set(i,t)}WS.set(t,s.reverse())}}();let t=[],s=[],i=!1;function a(e){let s=US.get(e);s&&(i=!0,e|=s),t.push(e)}for(let n of e)for(;;){if(n<128)t.push(n);else if(qS(n)){let e=n-LS,t=e%588/28|0,s=e%28;a(IS+(e/588|0)),a(jS+t),s>0&&a(HS+s)}else{let e=WS.get(n);e?s.push(...e):a(n)}if(!s.length)break;n=s.pop()}if(i&&t.length>1){let e=VS(t[0]);for(let s=1;s<t.length;s++){let i=VS(t[s]);if(0==i||e<=i){e=i;continue}let a=s-1;for(;;){let s=t[a+1];if(t[a+1]=t[a],t[a]=s,!a)break;if(e=VS(t[--a]),e<=i)break}e=VS(t[s])}}return t}function JS(e){return ZS(e).map(GS)}function XS(e){return function(e){let t=[],s=[],i=-1,a=0;for(let n of e){let e=VS(n),r=GS(n);if(-1==i)0==e?i=r:t.push(r);else if(a>0&&a>=e)0==e?(t.push(i,...s),s.length=0,i=r):s.push(r),a=e;else{let n=KS(i,r);n>=0?i=n:0==a&&0==e?(t.push(i),i=r):(s.push(r),a=e)}}return i>=0&&t.push(i,...s),t}(ZS(e))}const $S=e=>Array.from(e);function YS(e,t){return e.P.has(t)||e.Q.has(t)}class eE extends Array{get is_emoji(){return!0}}let tE,sE,iE,aE,nE,rE,oE,lE,cE,hE,uE;function dE(){if(tE)return;let e=SS("AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI");const t=()=>PS(e),s=()=>new Set(t()),i=(e,t)=>t.forEach((t=>e.add(t)));tE=new Map(MS(e)),sE=s(),iE=t(),aE=new Set(t().map((e=>iE[e]))),iE=new Set(iE),nE=s(),s();let a=CS(e),n=e();const r=()=>{let e=new Set;return t().forEach((t=>i(e,a[t]))),i(e,t()),e};rE=BS((t=>{let s=BS(e).map((e=>e+96));if(s.length){let i=t>=n;return s[0]-=32,s=FS(s),i&&(s=`Restricted[${s}]`),{N:s,P:r(),Q:r(),M:!e(),R:i}}})),oE=s(),lE=new Map;let o=t().concat($S(oE)).sort(((e,t)=>e-t));o.forEach(((t,s)=>{let i=e(),a=o[s]=i?o[s-i]:{V:[],M:new Map};a.V.push(t),oE.has(t)||lE.set(t,a)}));for(let{V:h,M:u}of new Set(lE.values())){let e=[];for(let s of h){let t=rE.filter((e=>YS(e,s))),a=e.find((({G:e})=>t.some((t=>e.has(t)))));a||(a={G:new Set,V:[]},e.push(a)),a.V.push(s),i(a.G,t)}let t=e.flatMap((e=>$S(e.G)));for(let{G:s,V:i}of e){let e=new Set(t.filter((e=>!s.has(e))));for(let t of i)u.set(t,e)}}cE=new Set;let l=new Set;const c=e=>cE.has(e)?l.add(e):cE.add(e);for(let h of rE){for(let e of h.P)c(e);for(let e of h.Q)c(e)}for(let h of cE)lE.has(h)||l.has(h)||lE.set(h,1);i(cE,JS(cE)),hE=function(e){let t=[],s=PS(e);return function e({S:s,B:i},a,n){if(!(4&s&&n===a[a.length-1])){2&s&&(n=a[a.length-1]),1&s&&t.push(a);for(let t of i)for(let s of t.Q)e(t,[...a,s],n)}}(function t(i){return{S:e(),B:BS((()=>{let i=PS(e).map((e=>s[e]));if(i.length)return t(i)})),Q:i}}([]),[]),t}(e).map((e=>eE.from(e))).sort(OS),uE=new Map;for(let h of hE){let e=[uE];for(let t of h){let s=e.map((e=>{let s=e.get(t);return s||(s=new Map,e.set(t,s)),s}));65039===t?e.push(...s):e=s}for(let t of e)t.V=h}}function pE(e){return(gE(e)?"":`${fE(mE([e]))} `)+_S(e)}function fE(e){return`"${e}"`}function mE(e,t=1/0,s=_S){let i=[];var a;a=e[0],dE(),iE.has(a)&&i.push(""),e.length>t&&(t>>=1,e=[...e.slice(0,t),8230,...e.slice(-t)]);let n=0,r=e.length;for(let o=0;o<r;o++){let t=e[o];gE(t)&&(i.push(FS(e.slice(n,o))),i.push(s(t)),n=o+1)}return i.push(FS(e.slice(n,r))),i.join("")}function gE(e){return dE(),nE.has(e)}function yE(e){return new Error(`disallowed character: ${pE(e)}`)}function bE(e,t){let s=pE(t),i=rE.find((e=>e.P.has(t)));return i&&(s=`${i.N} ${s}`),new Error(`illegal mixture: ${e.N} + ${s}`)}function vE(e){return new Error(`illegal placement: ${e}`)}function wE(e){return e.filter((e=>65039!=e))}function xE(e,t){let s,i=uE,a=e.length;for(;a&&(i=i.get(e[--a]),i);){let{V:t}=i;t&&(s=t,e.length=a)}return s}const kE=new Uint8Array(32);function AE(e){return aw(0!==e.length,"invalid ENS name; empty component","comp",e),e}function SE(e){const t=Lw(function(e){try{if(0===e.length)throw new Error("empty label");return function(e){return t=function(e,t,s){if(!e)return[];dE();let i=0;return e.split(".").map((e=>{let a=function(e){let t=[];for(let s=0,i=e.length;s<i;){let i=e.codePointAt(s);s+=i<65536?1:2,t.push(i)}return t}(e),n={input:a,offset:i};i+=a.length+1;try{let e,i=n.tokens=function(e,t,s){let i=[],a=[];for(e=e.slice().reverse();e.length;){let n=xE(e);if(n)a.length&&(i.push(t(a)),a=[]),i.push(s(n));else{let t=e.pop();if(cE.has(t))a.push(t);else{let e=tE.get(t);if(e)a.push(...e);else if(!sE.has(t))throw yE(t)}}}return a.length&&i.push(t(a)),i}(a,t,s),r=i.length;if(!r)throw new Error("empty label");let o=n.output=i.flat();if(function(e){for(let t=e.lastIndexOf(95);t>0;)if(95!==e[--t])throw new Error("underscore allowed only at start")}(o),!(n.emoji=r>1||i[0].is_emoji)&&o.every((e=>e<128)))!function(e){if(e.length>=4&&45==e[2]&&45==e[3])throw new Error(`invalid label extension: "${FS(e.slice(0,4))}"`)}(o),e="ASCII";else{let t=i.flatMap((e=>e.is_emoji?[]:e));if(t.length){if(iE.has(o[0]))throw vE("leading combining mark");for(let e=1;e<r;e++){let t=i[e];if(!t.is_emoji&&iE.has(t[0]))throw vE(`emoji + combining mark: "${FS(i[e-1])} + ${mE([t[0]])}"`)}!function(e){let t=e[0],s=AS.get(t);if(s)throw vE(`leading ${s}`);let i=e.length,a=-1;for(let n=1;n<i;n++){t=e[n];let i=AS.get(t);if(i){if(a==n)throw vE(`${s} + ${i}`);a=n+1,s=i}}if(a==i)throw vE(`trailing ${s}`)}(o);let s=$S(new Set(t)),[a]=function(e){let t=rE;for(let s of e){let e=t.filter((e=>YS(e,s)));if(!e.length)throw rE.some((e=>YS(e,s)))?bE(t[0],s):yE(s);if(t=e,1==e.length)break}return t}(s);!function(e,t){for(let s of t)if(!YS(e,s))throw bE(e,s);if(e.M){let e=JS(t);for(let t=1,s=e.length;t<s;t++)if(aE.has(e[t])){let i=t+1;for(let a;i<s&&aE.has(a=e[i]);i++)for(let s=t;s<i;s++)if(e[s]==a)throw new Error(`duplicate non-spacing marks: ${pE(a)}`);if(i-t>4)throw new Error(`excessive non-spacing marks: ${fE(mE(e.slice(t-1,i)))} (${i-t}/4)`);t=i}}}(a,t),function(e,t){let s,i=[];for(let a of t){let e=lE.get(a);if(1===e)return;if(e){let t=e.M.get(a);if(s=s?s.filter((e=>t.has(e))):$S(t),!s.length)return}else i.push(a)}if(s)for(let a of s)if(i.every((e=>YS(a,e))))throw new Error(`whole-script confusable: ${e.N}/${a.N}`)}(a,s),e=a.N}else e="Emoji"}n.type=e}catch(r){n.error=r}return n}))}(e,XS,wE),t.map((({input:e,error:s,output:i})=>{if(s){let i=s.message;throw new Error(1==t.length?i:`Invalid label ${fE(mE(e,63))}: ${i}`)}return FS(i)})).join(".");var t}(e)}catch(t){aw(!1,`invalid ENS name (${t.message})`,"name",e)}}(e)),s=[];if(0===e.length)return s;let i=0;for(let a=0;a<t.length;a++)46===t[a]&&(s.push(AE(t.slice(i,a))),i=a+1);return aw(i<t.length,"invalid ENS name; empty component","name",e),s.push(AE(t.slice(i))),s}function EE(e){aw("string"==typeof e,"invalid ENS name; not a string","name",e),aw(e.length,"invalid ENS name (empty label)","name",e);let t=kE;const s=SE(e);for(;s.length;)t=Tk(fw([t,Tk(s.pop())]));return pw(t)}function TE(e,t){const s=t;return aw(s<=255,"DNS encoded label cannot exceed 255","length",s),pw(fw(SE(e).map((t=>{aw(t.length<=s,`label ${JSON.stringify(e)} exceeds ${s} bytes`,"name",e);const i=new Uint8Array(t.length+1);return i.set(t,1),i[0]=i.length-1,i}))))+"00"}function PE(e,t){return{address:JA(e),storageKeys:t.map(((e,t)=>(aw(hw(e,32),"invalid slot",`storageKeys[${t}]`,e),e.toLowerCase())))}}function CE(e){if(Array.isArray(e))return e.map(((t,s)=>Array.isArray(t)?(aw(2===t.length,"invalid slot set",`value[${s}]`,t),PE(t[0],t[1])):(aw(null!=t&&"object"==typeof t,"invalid address-slot set","value",e),PE(t.address,t.storageKeys))));aw(null!=e&&"object"==typeof e,"invalid access list","value",e);const t=Object.keys(e).map((t=>{const s=e[t].reduce(((e,t)=>(e[t]=!0,e)),{});return PE(t,Object.keys(s).sort())}));return t.sort(((e,t)=>e.address.localeCompare(t.address))),t}kE.fill(0);const ME=BigInt(0),BE=BigInt(2),RE=BigInt(27),DE=BigInt(28),NE=BigInt(35),_E=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),FE=131072;function OE(e,t){let s=e.toString(16);for(;s.length<2;)s="0"+s;return s+=Bk(t).substring(4),"0x"+s}function LE(e){return"0x"===e?null:JA(e)}function IE(e,t){try{return CE(e)}catch(s){aw(!1,s.message,t,e)}}function jE(e,t){return"0x"===e?0:Cw(e,t)}function HE(e,t){if("0x"===e)return ME;const s=Sw(e,t);return aw(s<=_E,"value exceeds uint size",t,s),s}function VE(e,t){const s=Sw(e,"value"),i=Bw(s);return aw(i.length<=32,"value too large",`tx.${t}`,s),i}function GE(e){return CE(e).map((e=>[e.address,e.storageKeys]))}function UE(e,t){aw(Array.isArray(e),`invalid ${t}`,"value",e);for(let s=0;s<e.length;s++)aw(hw(e[s],32),"invalid ${ param } hash",`value[${s}]`,e[s]);return e}function zE(e,t){let s;try{if(s=jE(t[0],"yParity"),0!==s&&1!==s)throw new Error("bad yParity")}catch(r){aw(!1,"invalid yParity","yParity",t[0])}const i=bw(t[1],32),a=bw(t[2],32),n=UA.from({r:i,s:a,yParity:s});e.signature=n}W=new WeakMap,Q=new WeakMap,q=new WeakMap,K=new WeakMap,Z=new WeakMap,J=new WeakMap,X=new WeakMap,$=new WeakMap,Y=new WeakMap,ee=new WeakMap,te=new WeakMap,se=new WeakMap,ie=new WeakMap,ae=new WeakMap,ne=new WeakMap,re=new WeakMap,oe=new WeakSet,le=function(e,t){iw(!e||null!=this.signature,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const s=e?this.signature:null;switch(this.inferType()){case 0:return function(e,t){const s=[VE(e.nonce,"nonce"),VE(e.gasPrice||0,"gasPrice"),VE(e.gasLimit,"gasLimit"),e.to||"0x",VE(e.value,"value"),e.data];let i=ME;if(e.chainId!=ME)i=Sw(e.chainId,"tx.chainId"),aw(!t||null==t.networkV||t.legacyChainId===i,"tx.chainId/sig.v mismatch","sig",t);else if(e.signature){const t=e.signature.legacyChainId;null!=t&&(i=t)}if(!t)return i!==ME&&(s.push(Bw(i)),s.push("0x"),s.push("0x")),cx(s);let a=BigInt(27+t.yParity);return i!==ME?a=UA.getChainIdV(i,t.v):BigInt(t.v)!==a&&aw(!1,"tx.chainId/sig.v mismatch","sig",t),s.push(Bw(a)),s.push(Bw(t.r)),s.push(Bw(t.s)),cx(s)}(this,s);case 1:return function(e,t){const s=[VE(e.chainId,"chainId"),VE(e.nonce,"nonce"),VE(e.gasPrice||0,"gasPrice"),VE(e.gasLimit,"gasLimit"),e.to||"0x",VE(e.value,"value"),e.data,GE(e.accessList||[])];return t&&(s.push(VE(t.yParity,"recoveryParam")),s.push(Bw(t.r)),s.push(Bw(t.s))),fw(["0x01",cx(s)])}(this,s);case 2:return function(e,t){const s=[VE(e.chainId,"chainId"),VE(e.nonce,"nonce"),VE(e.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),VE(e.maxFeePerGas||0,"maxFeePerGas"),VE(e.gasLimit,"gasLimit"),e.to||"0x",VE(e.value,"value"),e.data,GE(e.accessList||[])];return t&&(s.push(VE(t.yParity,"yParity")),s.push(Bw(t.r)),s.push(Bw(t.s))),fw(["0x02",cx(s)])}(this,s);case 3:return function(e,t,s){const i=[VE(e.chainId,"chainId"),VE(e.nonce,"nonce"),VE(e.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),VE(e.maxFeePerGas||0,"maxFeePerGas"),VE(e.gasLimit,"gasLimit"),e.to||DA,VE(e.value,"value"),e.data,GE(e.accessList||[]),VE(e.maxFeePerBlobGas||0,"maxFeePerBlobGas"),UE(e.blobVersionedHashes||[],"blobVersionedHashes")];return t&&(i.push(VE(t.yParity,"yParity")),i.push(Bw(t.r)),i.push(Bw(t.s)),s)?fw(["0x03",cx([i,s.map((e=>e.data)),s.map((e=>e.commitment)),s.map((e=>e.proof))])]):fw(["0x03",cx(i)])}(this,s,t?this.blobs:null)}iw(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})};let WE=class e{constructor(){Ti(this,oe),Ti(this,W),Ti(this,Q),Ti(this,q),Ti(this,K),Ti(this,Z),Ti(this,J),Ti(this,X),Ti(this,$),Ti(this,Y),Ti(this,ee),Ti(this,te),Ti(this,se),Ti(this,ie),Ti(this,ae),Ti(this,ne),Ti(this,re),Pi(this,W,null),Pi(this,Q,null),Pi(this,K,0),Pi(this,Z,ME),Pi(this,J,null),Pi(this,X,null),Pi(this,$,null),Pi(this,q,"0x"),Pi(this,Y,ME),Pi(this,ee,ME),Pi(this,te,null),Pi(this,se,null),Pi(this,ie,null),Pi(this,ae,null),Pi(this,re,null),Pi(this,ne,null)}get type(){return Ei(this,W)}set type(e){switch(e){case null:Pi(this,W,null);break;case 0:case"legacy":Pi(this,W,0);break;case 1:case"berlin":case"eip-2930":Pi(this,W,1);break;case 2:case"london":case"eip-1559":Pi(this,W,2);break;case 3:case"cancun":case"eip-4844":Pi(this,W,3);break;default:aw(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844"}return null}get to(){const e=Ei(this,Q);return null==e&&3===this.type?DA:e}set to(e){Pi(this,Q,null==e?null:JA(e))}get nonce(){return Ei(this,K)}set nonce(e){Pi(this,K,Cw(e,"value"))}get gasLimit(){return Ei(this,Z)}set gasLimit(e){Pi(this,Z,Sw(e))}get gasPrice(){const e=Ei(this,J);return null!=e||0!==this.type&&1!==this.type?e:ME}set gasPrice(e){Pi(this,J,null==e?null:Sw(e,"gasPrice"))}get maxPriorityFeePerGas(){const e=Ei(this,X);return null==e?2===this.type||3===this.type?ME:null:e}set maxPriorityFeePerGas(e){Pi(this,X,null==e?null:Sw(e,"maxPriorityFeePerGas"))}get maxFeePerGas(){const e=Ei(this,$);return null==e?2===this.type||3===this.type?ME:null:e}set maxFeePerGas(e){Pi(this,$,null==e?null:Sw(e,"maxFeePerGas"))}get data(){return Ei(this,q)}set data(e){Pi(this,q,pw(e))}get value(){return Ei(this,Y)}set value(e){Pi(this,Y,Sw(e,"value"))}get chainId(){return Ei(this,ee)}set chainId(e){Pi(this,ee,Sw(e))}get signature(){return Ei(this,te)||null}set signature(e){Pi(this,te,null==e?null:UA.from(e))}get accessList(){const e=Ei(this,se)||null;return null==e?1===this.type||2===this.type||3===this.type?[]:null:e}set accessList(e){Pi(this,se,null==e?null:CE(e))}get maxFeePerBlobGas(){const e=Ei(this,ie);return null==e&&3===this.type?ME:e}set maxFeePerBlobGas(e){Pi(this,ie,null==e?null:Sw(e,"maxFeePerBlobGas"))}get blobVersionedHashes(){let e=Ei(this,ae);return null==e&&3===this.type?[]:e}set blobVersionedHashes(e){if(null!=e){aw(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let t=0;t<e.length;t++)aw(hw(e[t],32),"invalid blobVersionedHash",`value[${t}]`,e[t])}Pi(this,ae,e)}get blobs(){return null==Ei(this,re)?null:Ei(this,re).map((e=>Object.assign({},e)))}set blobs(e){if(null==e)return void Pi(this,re,null);const t=[],s=[];for(let i=0;i<e.length;i++){const a=e[i];if(uw(a)){iw(Ei(this,ne),"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let e=lw(a);if(aw(e.length<=FE,"blob is too large",`blobs[${i}]`,a),e.length!==FE){const t=new Uint8Array(FE);t.set(e),e=t}const n=Ei(this,ne).blobToKzgCommitment(e),r=pw(Ei(this,ne).computeBlobKzgProof(e,n));t.push({data:pw(e),commitment:pw(n),proof:r}),s.push(OE(1,n))}else{const e=pw(a.commitment);t.push({data:pw(a.data),commitment:e,proof:pw(a.proof)}),s.push(OE(1,e))}}Pi(this,re,t),Pi(this,ae,s)}get kzg(){return Ei(this,ne)}set kzg(e){Pi(this,ne,e)}get hash(){return null==this.signature?null:Tk(Ci(this,oe,le).call(this,!0,!1))}get unsignedHash(){return Tk(this.unsignedSerialized)}get from(){return null==this.signature?null:(e=this.unsignedHash,t=this.signature,function(e){let t;return t="string"==typeof e?zA.computePublicKey(e,!1):e.publicKey,JA(Tk("0x"+t.substring(4)).substring(26))}(zA.recoverPublicKey(e,t)));var e,t}get fromPublicKey(){return null==this.signature?null:zA.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return null!=this.signature}get serialized(){return Ci(this,oe,le).call(this,!0,!0)}get unsignedSerialized(){return Ci(this,oe,le).call(this,!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=null!=this.gasPrice,t=null!=this.maxFeePerGas||null!=this.maxPriorityFeePerGas,s=null!=this.accessList,i=null!=Ei(this,ie)||Ei(this,ae);null!=this.maxFeePerGas&&null!=this.maxPriorityFeePerGas&&iw(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),iw(!t||0!==this.type&&1!==this.type,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),iw(0!==this.type||!s,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const a=[];return null!=this.type?a.push(this.type):t?a.push(2):e?(a.push(1),s||a.push(0)):s?(a.push(1),a.push(2)):(i&&this.to||(a.push(0),a.push(1),a.push(2)),a.push(3)),a.sort(),a}isLegacy(){return 0===this.type}isBerlin(){return 1===this.type}isLondon(){return 2===this.type}isCancun(){return 3===this.type}clone(){return e.from(this)}toJSON(){const e=e=>null==e?null:e.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(t){if(null==t)return new e;if("string"==typeof t){const s=lw(t);if(s[0]>=127)return e.from(function(e){const t=nx(e);aw(Array.isArray(t)&&(9===t.length||6===t.length),"invalid field count for legacy transaction","data",e);const s={type:0,nonce:jE(t[0],"nonce"),gasPrice:HE(t[1],"gasPrice"),gasLimit:HE(t[2],"gasLimit"),to:LE(t[3]),value:HE(t[4],"value"),data:pw(t[5]),chainId:ME};if(6===t.length)return s;const i=HE(t[6],"v"),a=HE(t[7],"r"),n=HE(t[8],"s");if(a===ME&&n===ME)s.chainId=i;else{let e=(i-NE)/BE;e<ME&&(e=ME),s.chainId=e,aw(e!==ME||i===RE||i===DE,"non-canonical legacy v","v",t[6]),s.signature=UA.from({r:bw(t[7],32),s:bw(t[8],32),v:i})}return s}(s));switch(s[0]){case 1:return e.from(function(e){const t=nx(lw(e).slice(1));aw(Array.isArray(t)&&(8===t.length||11===t.length),"invalid field count for transaction type: 1","data",pw(e));const s={type:1,chainId:HE(t[0],"chainId"),nonce:jE(t[1],"nonce"),gasPrice:HE(t[2],"gasPrice"),gasLimit:HE(t[3],"gasLimit"),to:LE(t[4]),value:HE(t[5],"value"),data:pw(t[6]),accessList:IE(t[7],"accessList")};return 8===t.length||zE(s,t.slice(8)),s}(s));case 2:return e.from(function(e){const t=nx(lw(e).slice(1));aw(Array.isArray(t)&&(9===t.length||12===t.length),"invalid field count for transaction type: 2","data",pw(e));const s={type:2,chainId:HE(t[0],"chainId"),nonce:jE(t[1],"nonce"),maxPriorityFeePerGas:HE(t[2],"maxPriorityFeePerGas"),maxFeePerGas:HE(t[3],"maxFeePerGas"),gasPrice:null,gasLimit:HE(t[4],"gasLimit"),to:LE(t[5]),value:HE(t[6],"value"),data:pw(t[7]),accessList:IE(t[8],"accessList")};return 9===t.length||zE(s,t.slice(9)),s}(s));case 3:return e.from(function(e){let t=nx(lw(e).slice(1)),s="3",i=null;if(4===t.length&&Array.isArray(t[0])){s="3 (network format)";const e=t[1],a=t[2],n=t[3];aw(Array.isArray(e),"invalid network format: blobs not an array","fields[1]",e),aw(Array.isArray(a),"invalid network format: commitments not an array","fields[2]",a),aw(Array.isArray(n),"invalid network format: proofs not an array","fields[3]",n),aw(e.length===a.length,"invalid network format: blobs/commitments length mismatch","fields",t),aw(e.length===n.length,"invalid network format: blobs/proofs length mismatch","fields",t),i=[];for(let s=0;s<t[1].length;s++)i.push({data:e[s],commitment:a[s],proof:n[s]});t=t[0]}aw(Array.isArray(t)&&(11===t.length||14===t.length),`invalid field count for transaction type: ${s}`,"data",pw(e));const a={type:3,chainId:HE(t[0],"chainId"),nonce:jE(t[1],"nonce"),maxPriorityFeePerGas:HE(t[2],"maxPriorityFeePerGas"),maxFeePerGas:HE(t[3],"maxFeePerGas"),gasPrice:null,gasLimit:HE(t[4],"gasLimit"),to:LE(t[5]),value:HE(t[6],"value"),data:pw(t[7]),accessList:IE(t[8],"accessList"),maxFeePerBlobGas:HE(t[9],"maxFeePerBlobGas"),blobVersionedHashes:t[10]};i&&(a.blobs=i),aw(null!=a.to,`invalid address for transaction type: ${s}`,"data",e),aw(Array.isArray(a.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",e);for(let n=0;n<a.blobVersionedHashes.length;n++)aw(hw(a.blobVersionedHashes[n],32),`invalid blobVersionedHash at index ${n}: must be length 32`,"data",e);return 11===t.length||zE(a,t.slice(11)),a}(s))}iw(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const s=new e;return null!=t.type&&(s.type=t.type),null!=t.to&&(s.to=t.to),null!=t.nonce&&(s.nonce=t.nonce),null!=t.gasLimit&&(s.gasLimit=t.gasLimit),null!=t.gasPrice&&(s.gasPrice=t.gasPrice),null!=t.maxPriorityFeePerGas&&(s.maxPriorityFeePerGas=t.maxPriorityFeePerGas),null!=t.maxFeePerGas&&(s.maxFeePerGas=t.maxFeePerGas),null!=t.maxFeePerBlobGas&&(s.maxFeePerBlobGas=t.maxFeePerBlobGas),null!=t.data&&(s.data=t.data),null!=t.value&&(s.value=t.value),null!=t.chainId&&(s.chainId=t.chainId),null!=t.signature&&(s.signature=UA.from(t.signature)),null!=t.accessList&&(s.accessList=t.accessList),null!=t.blobVersionedHashes&&(s.blobVersionedHashes=t.blobVersionedHashes),null!=t.kzg&&(s.kzg=t.kzg),null!=t.blobs&&(s.blobs=t.blobs),null!=t.hash&&(aw(s.isSigned(),"unsigned transaction cannot define '.hash'","tx",t),aw(s.hash===t.hash,"hash mismatch","tx",t)),null!=t.from&&(aw(s.isSigned(),"unsigned transaction cannot define '.from'","tx",t),aw(s.from.toLowerCase()===(t.from||"").toLowerCase(),"from mismatch","tx",t)),s}};const QE=new Uint8Array(32);QE.fill(0);const qE=BigInt(-1),KE=BigInt(0),ZE=BigInt(1),JE=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),XE=Mw(ZE,32),$E=Mw(KE,32),YE={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},eT=["name","version","chainId","verifyingContract","salt"];function tT(e){return function(t){return aw("string"==typeof t,`invalid domain value for ${JSON.stringify(e)}`,`domain.${e}`,t),t}}const sT={name:tT("name"),version:tT("version"),chainId:function(e){const t=Sw(e,"domain.chainId");return aw(t>=0,"invalid chain ID","domain.chainId",e),Number.isSafeInteger(t)?Number(t):Rw(t)},verifyingContract:function(e){try{return JA(e).toLowerCase()}catch(t){}aw(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",e)},salt:function(e){const t=lw(e,"domain.salt");return aw(32===t.length,'invalid domain value "salt"',"domain.salt",e),pw(t)}};function iT(e){{const t=e.match(/^(u?)int(\d+)$/);if(t){const s=""===t[1],i=parseInt(t[2]);aw(i%8==0&&0!==i&&i<=256&&t[2]===String(i),"invalid numeric width","type",e);const a=Aw(JE,s?i-1:i),n=s?(a+ZE)*qE:KE;return function(t){const i=Sw(t,"value");return aw(i>=n&&i<=a,`value out-of-bounds for ${e}`,"value",i),Mw(s?kw(i,256):i,32)}}}{const t=e.match(/^bytes(\d+)$/);if(t){const s=parseInt(t[1]);return aw(0!==s&&s<=32&&t[1]===String(s),"invalid bytes width","type",e),function(t){return aw(lw(t).length===s,`invalid length for ${e}`,"value",t),function(e){const t=lw(e),s=t.length%32;return s?fw([t,QE.slice(s)]):pw(t)}(t)}}}switch(e){case"address":return function(e){return bw(JA(e),32)};case"bool":return function(e){return e?XE:$E};case"bytes":return function(e){return Tk(e)};case"string":return function(e){return kS(e)}}return null}function aT(e,t){return`${e}(${t.map((({name:e,type:t})=>t+" "+e)).join(",")})`}function nT(e){const t=e.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return t?{base:t[1],index:t[2]+t[4],array:{base:t[1],prefix:t[1]+t[2],count:t[5]?parseInt(t[5]):-1}}:{base:e}}ce=new WeakMap,he=new WeakMap,ue=new WeakMap,de=new WeakSet,pe=function(e){{const t=iT(e);if(t)return t}const t=nT(e).array;if(t){const e=t.prefix,s=this.getEncoder(e);return i=>{aw(-1===t.count||t.count===i.length,`array length mismatch; expected length ${t.count}`,"value",i);let a=i.map(s);return Ei(this,he).has(e)&&(a=a.map(Tk)),Tk(fw(a))}}const s=this.types[e];if(s){const t=kS(Ei(this,he).get(e));return e=>{const i=s.map((({name:t,type:s})=>{const i=this.getEncoder(s)(e[t]);return Ei(this,he).has(s)?Tk(i):i}));return i.unshift(t),fw(i)}}aw(!1,`unknown type: ${e}`,"type",e)};let rT=class e{constructor(e){Ti(this,de),Ai(this,"primaryType"),Ti(this,ce),Ti(this,he),Ti(this,ue),Pi(this,he,new Map),Pi(this,ue,new Map);const t=new Map,s=new Map,i=new Map,a={};Object.keys(e).forEach((n=>{a[n]=e[n].map((({name:t,type:s})=>{let{base:i,index:a}=nT(s);return"int"!==i||e.int||(i="int256"),"uint"!==i||e.uint||(i="uint256"),{name:t,type:i+(a||"")}})),t.set(n,new Set),s.set(n,[]),i.set(n,new Set)})),Pi(this,ce,JSON.stringify(a));for(const r in a){const i=new Set;for(const n of a[r]){aw(!i.has(n.name),`duplicate variable name ${JSON.stringify(n.name)} in ${JSON.stringify(r)}`,"types",e),i.add(n.name);const a=nT(n.type).base;aw(a!==r,`circular type reference to ${JSON.stringify(a)}`,"types",e),iT(a)||(aw(s.has(a),`unknown type ${JSON.stringify(a)}`,"types",e),s.get(a).push(r),t.get(r).add(a))}}const n=Array.from(s.keys()).filter((e=>0===s.get(e).length));aw(0!==n.length,"missing primary type","types",e),aw(1===n.length,`ambiguous primary types or unused types: ${n.map((e=>JSON.stringify(e))).join(", ")}`,"types",e),$v(this,{primaryType:n[0]}),function a(n,r){aw(!r.has(n),`circular type reference to ${JSON.stringify(n)}`,"types",e),r.add(n);for(const e of t.get(n))if(s.has(e)){a(e,r);for(const t of r)i.get(t).add(e)}r.delete(n)}(this.primaryType,new Set);for(const[r,o]of i){const e=Array.from(o);e.sort(),Ei(this,he).set(r,aT(r,a[r])+e.map((e=>aT(e,a[e]))).join(""))}}get types(){return JSON.parse(Ei(this,ce))}getEncoder(e){let t=Ei(this,ue).get(e);return t||(t=Ci(this,de,pe).call(this,e),Ei(this,ue).set(e,t)),t}encodeType(e){const t=Ei(this,he).get(e);return aw(t,`unknown type: ${JSON.stringify(e)}`,"name",e),t}encodeData(e,t){return this.getEncoder(e)(t)}hashStruct(e,t){return Tk(this.encodeData(e,t))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,t,s){if(iT(e))return s(e,t);const i=nT(e).array;if(i)return aw(-1===i.count||i.count===t.length,`array length mismatch; expected length ${i.count}`,"value",t),t.map((e=>this._visit(i.prefix,e,s)));const a=this.types[e];if(a)return a.reduce(((e,{name:i,type:a})=>(e[i]=this._visit(a,t[i],s),e)),{});aw(!1,`unknown type: ${e}`,"type",e)}visit(e,t){return this._visit(this.primaryType,e,t)}static from(t){return new e(t)}static getPrimaryType(t){return e.from(t).primaryType}static hashStruct(t,s,i){return e.from(s).hashStruct(t,i)}static hashDomain(t){const s=[];for(const e in t){if(null==t[e])continue;const i=YE[e];aw(i,`invalid typed-data domain key: ${JSON.stringify(e)}`,"domain",t),s.push({name:e,type:i})}return s.sort(((e,t)=>eT.indexOf(e.name)-eT.indexOf(t.name))),e.hashStruct("EIP712Domain",{EIP712Domain:s},t)}static encode(t,s,i){return fw(["0x1901",e.hashDomain(t),e.from(s).hash(i)])}static hash(t,s,i){return Tk(e.encode(t,s,i))}static async resolveNames(t,s,i,a){t=Object.assign({},t);for(const e in t)null==t[e]&&delete t[e];const n={};t.verifyingContract&&!hw(t.verifyingContract,20)&&(n[t.verifyingContract]="0x");const r=e.from(s);r.visit(i,((e,t)=>("address"!==e||hw(t,20)||(n[t]="0x"),t)));for(const e in n)n[e]=await a(e);return t.verifyingContract&&n[t.verifyingContract]&&(t.verifyingContract=n[t.verifyingContract]),{domain:t,value:i=r.visit(i,((e,t)=>"address"===e&&n[t]?n[t]:t))}}static getPayload(t,s,i){e.hashDomain(t);const a={},n=[];eT.forEach((e=>{const s=t[e];null!=s&&(a[e]=sT[e](s),n.push({name:e,type:YE[e]}))}));const r=e.from(s);s=r.types;const o=Object.assign({},s);return aw(null==o.EIP712Domain,"types must not contain EIP712Domain type","types.EIP712Domain",s),o.EIP712Domain=n,r.encode(i),{types:o,domain:a,primaryType:r.primaryType,message:r.visit(i,((e,t)=>{if(e.match(/^bytes(\d*)/))return pw(lw(t));if(e.match(/^u?int/))return Sw(t).toString();switch(e){case"address":return t.toLowerCase();case"bool":return!!t;case"string":return aw("string"==typeof t,"invalid string","value",t),t}aw(!1,"unsupported type","type",e)}))}}};function oT(e){const t=new Set;return e.forEach((e=>t.add(e))),Object.freeze(t)}const lT=oT("external public payable override".split(" ")),cT="constant external internal payable private public pure view override",hT=oT(cT.split(" ")),uT="constructor error event fallback function receive struct",dT=oT(uT.split(" ")),pT="calldata memory storage payable indexed",fT=oT(pT.split(" ")),mT=oT([uT,pT,"tuple returns",cT].join(" ").split(" ")),gT={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},yT=new RegExp("^(\\s*)"),bT=new RegExp("^([0-9]+)"),vT=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),wT=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),xT=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$"),kT=class e{constructor(e){Ti(this,ge),Ti(this,fe),Ti(this,me),Pi(this,fe,0),Pi(this,me,e.slice())}get offset(){return Ei(this,fe)}get length(){return Ei(this,me).length-Ei(this,fe)}clone(){return new e(Ei(this,me))}reset(){Pi(this,fe,0)}popKeyword(e){const t=this.peek();if("KEYWORD"!==t.type||!e.has(t.text))throw new Error(`expected keyword ${t.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const t=this.peek();throw new Error(`expected ${e}; got ${t.type} ${JSON.stringify(t.text)}`)}return this.pop().text}popParen(){const e=this.peek();if("OPEN_PAREN"!==e.type)throw new Error("bad start");const t=Ci(this,ge,ye).call(this,Ei(this,fe)+1,e.match+1);return Pi(this,fe,e.match+1),t}popParams(){const e=this.peek();if("OPEN_PAREN"!==e.type)throw new Error("bad start");const t=[];for(;Ei(this,fe)<e.match-1;){const e=this.peek().linkNext;t.push(Ci(this,ge,ye).call(this,Ei(this,fe)+1,e)),Pi(this,fe,e)}return Pi(this,fe,e.match+1),t}peek(){if(Ei(this,fe)>=Ei(this,me).length)throw new Error("out-of-bounds");return Ei(this,me)[Ei(this,fe)]}peekKeyword(e){const t=this.peekType("KEYWORD");return null!=t&&e.has(t)?t:null}peekType(e){if(0===this.length)return null;const t=this.peek();return t.type===e?t.text:null}pop(){const e=this.peek();return Mi(this,fe)._++,e}toString(){const e=[];for(let t=Ei(this,fe);t<Ei(this,me).length;t++){const s=Ei(this,me)[t];e.push(`${s.type}:${s.text}`)}return`<TokenString ${e.join(" ")}>`}};fe=new WeakMap,me=new WeakMap,ge=new WeakSet,ye=function(e=0,t=0){return new kT(Ei(this,me).slice(e,t).map((t=>Object.freeze(Object.assign({},t,{match:t.match-e,linkBack:t.linkBack-e,linkNext:t.linkNext-e})))))};let AT=kT;function ST(e){const t=[],s=t=>{const s=n<e.length?JSON.stringify(e[n]):"$EOI";throw new Error(`invalid token ${s} at ${n}: ${t}`)};let i=[],a=[],n=0;for(;n<e.length;){let r=e.substring(n),o=r.match(yT);o&&(n+=o[1].length,r=e.substring(n));const l={depth:i.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:n,value:-1};t.push(l);let c=gT[r[0]]||"";if(c){if(l.type=c,l.text=r[0],n++,"OPEN_PAREN"===c)i.push(t.length-1),a.push(t.length-1);else if("CLOSE_PAREN"==c)0===i.length&&s("no matching open bracket"),l.match=i.pop(),t[l.match].match=t.length-1,l.depth--,l.linkBack=a.pop(),t[l.linkBack].linkNext=t.length-1;else if("COMMA"===c)l.linkBack=a.pop(),t[l.linkBack].linkNext=t.length-1,a.push(t.length-1);else if("OPEN_BRACKET"===c)l.type="BRACKET";else if("CLOSE_BRACKET"===c){let e=t.pop().text;if(t.length>0&&"NUMBER"===t[t.length-1].type){const s=t.pop().text;e=s+e,t[t.length-1].value=Cw(s)}if(0===t.length||"BRACKET"!==t[t.length-1].type)throw new Error("missing opening bracket");t[t.length-1].text+=e}}else if(o=r.match(vT),o){if(l.text=o[1],n+=l.text.length,mT.has(l.text)){l.type="KEYWORD";continue}if(l.text.match(xT)){l.type="TYPE";continue}l.type="ID"}else{if(o=r.match(bT),!o)throw new Error(`unexpected token ${JSON.stringify(r[0])} at position ${n}`);l.text=o[1],l.type="NUMBER",n+=l.text.length}}return new AT(t.map((e=>Object.freeze(e))))}function ET(e,t){let s=[];for(const i in t.keys())e.has(i)&&s.push(i);if(s.length>1)throw new Error(`conflicting types: ${s.join(", ")}`)}function TT(e,t){if(t.peekKeyword(dT)){const s=t.pop().text;if(s!==e)throw new Error(`expected ${e}, got ${s}`)}return t.popType("ID")}function PT(e,t){const s=new Set;for(;;){const i=e.peekType("KEYWORD");if(null==i||t&&!t.has(i))break;if(e.pop(),s.has(i))throw new Error(`duplicate keywords: ${JSON.stringify(i)}`);s.add(i)}return Object.freeze(s)}function CT(e){let t=PT(e,hT);return ET(t,oT("constant payable nonpayable".split(" "))),ET(t,oT("pure view payable nonpayable".split(" "))),t.has("view")?"view":t.has("pure")?"pure":t.has("payable")?"payable":t.has("nonpayable")?"nonpayable":t.has("constant")?"view":"nonpayable"}function MT(e,t){return e.popParams().map((e=>UT.from(e,t)))}function BT(e){if(e.peekType("AT")){if(e.pop(),e.peekType("NUMBER"))return Sw(e.pop().text);throw new Error("invalid gas")}return null}function RT(e){if(e.length)throw new Error(`unexpected tokens at offset ${e.offset}: ${e.toString()}`)}const DT=new RegExp(/^(.*)\[([0-9]*)\]$/);function NT(e){const t=e.match(xT);if(aw(t,"invalid type","type",e),"uint"===e)return"uint256";if("int"===e)return"int256";if(t[2]){const s=parseInt(t[2]);aw(0!==s&&s<=32,"invalid bytes length","type",e)}else if(t[3]){const s=parseInt(t[3]);aw(0!==s&&s<=256&&s%8==0,"invalid numeric width","type",e)}return e}const _T={},FT=Symbol.for("_ethers_internal"),OT="_ParamTypeInternal",LT="_ErrorInternal",IT="_EventInternal",jT="_ConstructorInternal",HT="_FallbackInternal",VT="_FunctionInternal",GT="_StructInternal";be=new WeakSet,ve=function(e,t,s,i){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(-1!==this.arrayLength&&t.length!==this.arrayLength)throw new Error("array is wrong length");const a=this.arrayChildren,n=t.slice();return n.forEach(((t,i)=>{var r;Ci(r=a,be,ve).call(r,e,t,s,(e=>{n[i]=e}))})),void i(n)}if(this.isTuple()){const a=this.components;let n;if(Array.isArray(t))n=t.slice();else{if(null==t||"object"!=typeof t)throw new Error("invalid tuple value");n=a.map((e=>{if(!e.name)throw new Error("cannot use object value with unnamed components");if(!(e.name in t))throw new Error(`missing value for component ${e.name}`);return t[e.name]}))}if(n.length!==this.components.length)throw new Error("array is wrong length");return n.forEach(((t,i)=>{var r;Ci(r=a[i],be,ve).call(r,e,t,s,(e=>{n[i]=e}))})),void i(n)}const a=s(this.type,t);a.then?e.push(async function(){i(await a)}()):i(a)};let UT=class e{constructor(e,t,s,i,a,n,r,o){if(Ti(this,be),Ai(this,"name"),Ai(this,"type"),Ai(this,"baseType"),Ai(this,"indexed"),Ai(this,"components"),Ai(this,"arrayLength"),Ai(this,"arrayChildren"),rw(e,_T,"ParamType"),Object.defineProperty(this,FT,{value:OT}),n&&(n=Object.freeze(n.slice())),"array"===i){if(null==r||null==o)throw new Error("")}else if(null!=r||null!=o)throw new Error("");if("tuple"===i){if(null==n)throw new Error("")}else if(null!=n)throw new Error("");$v(this,{name:t,type:s,baseType:i,indexed:a,components:n,arrayLength:r,arrayChildren:o})}format(e){if(null==e&&(e="sighash"),"json"===e){const t=this.name||"";if(this.isArray()){const e=JSON.parse(this.arrayChildren.format("json"));return e.name=t,e.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(e)}const s={type:"tuple"===this.baseType?"tuple":this.type,name:t};return"boolean"==typeof this.indexed&&(s.indexed=this.indexed),this.isTuple()&&(s.components=this.components.map((t=>JSON.parse(t.format(e))))),JSON.stringify(s)}let t="";return this.isArray()?(t+=this.arrayChildren.format(e),t+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?t+="("+this.components.map((t=>t.format(e))).join("full"===e?", ":",")+")":t+=this.type,"sighash"!==e&&(!0===this.indexed&&(t+=" indexed"),"full"===e&&this.name&&(t+=" "+this.name)),t}isArray(){return"array"===this.baseType}isTuple(){return"tuple"===this.baseType}isIndexable(){return null!=this.indexed}walk(e,t){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(-1!==this.arrayLength&&e.length!==this.arrayLength)throw new Error("array is wrong length");const s=this;return e.map((e=>s.arrayChildren.walk(e,t)))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const s=this;return e.map(((e,i)=>s.components[i].walk(e,t)))}return t(this.type,e)}async walkAsync(e,t){const s=[],i=[e];return Ci(this,be,ve).call(this,s,e,t,(e=>{i[0]=e})),s.length&&await Promise.all(s),i[0]}static from(t,s){if(e.isParamType(t))return t;if("string"==typeof t)try{return e.from(ST(t),s)}catch(o){aw(!1,"invalid param type","obj",t)}else if(t instanceof AT){let i="",a="",n=null;PT(t,oT(["tuple"])).has("tuple")||t.peekType("OPEN_PAREN")?(a="tuple",n=t.popParams().map((t=>e.from(t))),i=`tuple(${n.map((e=>e.format())).join(",")})`):(i=NT(t.popType("TYPE")),a=i);let r=null,o=null;for(;t.length&&t.peekType("BRACKET");){const s=t.pop();r=new e(_T,"",i,a,null,n,o,r),o=s.value,i+=s.text,a="array",n=null}let l=null;if(PT(t,fT).has("indexed")){if(!s)throw new Error("");l=!0}const c=t.peekType("ID")?t.pop().text:"";if(t.length)throw new Error("leftover tokens");return new e(_T,c,i,a,l,n,o,r)}const i=t.name;aw(!i||"string"==typeof i&&i.match(wT),"invalid name","obj.name",i);let a=t.indexed;null!=a&&(aw(s,"parameter cannot be indexed","obj.indexed",t.indexed),a=!!a);let n=t.type,r=n.match(DT);if(r){const s=parseInt(r[2]||"-1"),o=e.from({type:r[1],components:t.components});return new e(_T,i||"",n,"array",a,null,s,o)}if("tuple"===n||n.startsWith("tuple(")||n.startsWith("(")){const s=null!=t.components?t.components.map((t=>e.from(t))):null;return new e(_T,i||"",n,"tuple",a,s,null,null)}return n=NT(t.type),new e(_T,i||"",n,n,a,null,null,null)}static isParamType(e){return e&&e[FT]===OT}};class zT{constructor(e,t,s){Ai(this,"type"),Ai(this,"inputs"),rw(e,_T,"Fragment"),$v(this,{type:t,inputs:s=Object.freeze(s.slice())})}static from(e){if("string"==typeof e){try{zT.from(JSON.parse(e))}catch(SD){}return zT.from(ST(e))}if(e instanceof AT)switch(e.peekKeyword(dT)){case"constructor":return ZT.from(e);case"error":return qT.from(e);case"event":return KT.from(e);case"fallback":case"receive":return JT.from(e);case"function":return XT.from(e);case"struct":return $T.from(e)}else if("object"==typeof e){switch(e.type){case"constructor":return ZT.from(e);case"error":return qT.from(e);case"event":return KT.from(e);case"fallback":case"receive":return JT.from(e);case"function":return XT.from(e);case"struct":return $T.from(e)}iw(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}aw(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return ZT.isFragment(e)}static isError(e){return qT.isFragment(e)}static isEvent(e){return KT.isFragment(e)}static isFunction(e){return XT.isFragment(e)}static isStruct(e){return $T.isFragment(e)}}class WT extends zT{constructor(e,t,s,i){super(e,t,i),Ai(this,"name"),aw("string"==typeof s&&s.match(wT),"invalid identifier","name",s),i=Object.freeze(i.slice()),$v(this,{name:s})}}function QT(e,t){return"("+t.map((t=>t.format(e))).join("full"===e?", ":",")+")"}class qT extends WT{constructor(e,t,s){super(e,"error",t,s),Object.defineProperty(this,FT,{value:LT})}get selector(){return kS(this.format("sighash")).substring(0,10)}format(e){if(null==e&&(e="sighash"),"json"===e)return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map((t=>JSON.parse(t.format(e))))});const t=[];return"sighash"!==e&&t.push("error"),t.push(this.name+QT(e,this.inputs)),t.join(" ")}static from(e){if(qT.isFragment(e))return e;if("string"==typeof e)return qT.from(ST(e));if(e instanceof AT){const t=TT("error",e),s=MT(e);return RT(e),new qT(_T,t,s)}return new qT(_T,e.name,e.inputs?e.inputs.map(UT.from):[])}static isFragment(e){return e&&e[FT]===LT}}class KT extends WT{constructor(e,t,s,i){super(e,"event",t,s),Ai(this,"anonymous"),Object.defineProperty(this,FT,{value:IT}),$v(this,{anonymous:i})}get topicHash(){return kS(this.format("sighash"))}format(e){if(null==e&&(e="sighash"),"json"===e)return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map((t=>JSON.parse(t.format(e))))});const t=[];return"sighash"!==e&&t.push("event"),t.push(this.name+QT(e,this.inputs)),"sighash"!==e&&this.anonymous&&t.push("anonymous"),t.join(" ")}static getTopicHash(e,t){return t=(t||[]).map((e=>UT.from(e))),new KT(_T,e,t,!1).topicHash}static from(e){if(KT.isFragment(e))return e;if("string"==typeof e)try{return KT.from(ST(e))}catch(t){aw(!1,"invalid event fragment","obj",e)}else if(e instanceof AT){const t=TT("event",e),s=MT(e,!0),i=!!PT(e,oT(["anonymous"])).has("anonymous");return RT(e),new KT(_T,t,s,i)}return new KT(_T,e.name,e.inputs?e.inputs.map((e=>UT.from(e,!0))):[],!!e.anonymous)}static isFragment(e){return e&&e[FT]===IT}}class ZT extends zT{constructor(e,t,s,i,a){super(e,t,s),Ai(this,"payable"),Ai(this,"gas"),Object.defineProperty(this,FT,{value:jT}),$v(this,{payable:i,gas:a})}format(e){if(iw(null!=e&&"sighash"!==e,"cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),"json"===e)return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:null!=this.gas?this.gas:void 0,inputs:this.inputs.map((t=>JSON.parse(t.format(e))))});const t=[`constructor${QT(e,this.inputs)}`];return this.payable&&t.push("payable"),null!=this.gas&&t.push(`@${this.gas.toString()}`),t.join(" ")}static from(e){if(ZT.isFragment(e))return e;if("string"==typeof e)try{return ZT.from(ST(e))}catch(t){aw(!1,"invalid constuctor fragment","obj",e)}else if(e instanceof AT){PT(e,oT(["constructor"]));const t=MT(e),s=!!PT(e,lT).has("payable"),i=BT(e);return RT(e),new ZT(_T,"constructor",t,s,i)}return new ZT(_T,"constructor",e.inputs?e.inputs.map(UT.from):[],!!e.payable,null!=e.gas?e.gas:null)}static isFragment(e){return e&&e[FT]===jT}}class JT extends zT{constructor(e,t,s){super(e,"fallback",t),Ai(this,"payable"),Object.defineProperty(this,FT,{value:HT}),$v(this,{payable:s})}format(e){const t=0===this.inputs.length?"receive":"fallback";if("json"===e){const e=this.payable?"payable":"nonpayable";return JSON.stringify({type:t,stateMutability:e})}return`${t}()${this.payable?" payable":""}`}static from(e){if(JT.isFragment(e))return e;if("string"==typeof e)try{return JT.from(ST(e))}catch(t){aw(!1,"invalid fallback fragment","obj",e)}else if(e instanceof AT){const t=e.toString();if(aw(e.peekKeyword(oT(["fallback","receive"])),"type must be fallback or receive","obj",t),"receive"===e.popKeyword(oT(["fallback","receive"]))){const t=MT(e);return aw(0===t.length,"receive cannot have arguments","obj.inputs",t),PT(e,oT(["payable"])),RT(e),new JT(_T,[],!0)}let s=MT(e);s.length?aw(1===s.length&&"bytes"===s[0].type,"invalid fallback inputs","obj.inputs",s.map((e=>e.format("minimal"))).join(", ")):s=[UT.from("bytes")];const i=CT(e);if(aw("nonpayable"===i||"payable"===i,"fallback cannot be constants","obj.stateMutability",i),PT(e,oT(["returns"])).has("returns")){const t=MT(e);aw(1===t.length&&"bytes"===t[0].type,"invalid fallback outputs","obj.outputs",t.map((e=>e.format("minimal"))).join(", "))}return RT(e),new JT(_T,s,"payable"===i)}if("receive"===e.type)return new JT(_T,[],!0);if("fallback"===e.type){const t=[UT.from("bytes")],s="payable"===e.stateMutability;return new JT(_T,t,s)}aw(!1,"invalid fallback description","obj",e)}static isFragment(e){return e&&e[FT]===HT}}class XT extends WT{constructor(e,t,s,i,a,n){super(e,"function",t,i),Ai(this,"constant"),Ai(this,"outputs"),Ai(this,"stateMutability"),Ai(this,"payable"),Ai(this,"gas"),Object.defineProperty(this,FT,{value:VT}),$v(this,{constant:"view"===s||"pure"===s,gas:n,outputs:a=Object.freeze(a.slice()),payable:"payable"===s,stateMutability:s})}get selector(){return kS(this.format("sighash")).substring(0,10)}format(e){if(null==e&&(e="sighash"),"json"===e)return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:"nonpayable"!==this.stateMutability?this.stateMutability:void 0,payable:this.payable,gas:null!=this.gas?this.gas:void 0,inputs:this.inputs.map((t=>JSON.parse(t.format(e)))),outputs:this.outputs.map((t=>JSON.parse(t.format(e))))});const t=[];return"sighash"!==e&&t.push("function"),t.push(this.name+QT(e,this.inputs)),"sighash"!==e&&("nonpayable"!==this.stateMutability&&t.push(this.stateMutability),this.outputs&&this.outputs.length&&(t.push("returns"),t.push(QT(e,this.outputs))),null!=this.gas&&t.push(`@${this.gas.toString()}`)),t.join(" ")}static getSelector(e,t){return t=(t||[]).map((e=>UT.from(e))),new XT(_T,e,"view",t,[],null).selector}static from(e){if(XT.isFragment(e))return e;if("string"==typeof e)try{return XT.from(ST(e))}catch(s){aw(!1,"invalid function fragment","obj",e)}else if(e instanceof AT){const t=TT("function",e),s=MT(e),i=CT(e);let a=[];PT(e,oT(["returns"])).has("returns")&&(a=MT(e));const n=BT(e);return RT(e),new XT(_T,t,i,s,a,n)}let t=e.stateMutability;return null==t&&(t="payable","boolean"==typeof e.constant?(t="view",e.constant||(t="payable","boolean"!=typeof e.payable||e.payable||(t="nonpayable"))):"boolean"!=typeof e.payable||e.payable||(t="nonpayable")),new XT(_T,e.name,t,e.inputs?e.inputs.map(UT.from):[],e.outputs?e.outputs.map(UT.from):[],null!=e.gas?e.gas:null)}static isFragment(e){return e&&e[FT]===VT}}class $T extends WT{constructor(e,t,s){super(e,"struct",t,s),Object.defineProperty(this,FT,{value:GT})}format(){throw new Error("@TODO")}static from(e){if("string"==typeof e)try{return $T.from(ST(e))}catch(t){aw(!1,"invalid struct fragment","obj",e)}else if(e instanceof AT){const t=TT("struct",e),s=MT(e);return RT(e),new $T(_T,t,s)}return new $T(_T,e.name,e.inputs?e.inputs.map(UT.from):[])}static isFragment(e){return e&&e[FT]===GT}}const YT=new Map;YT.set(0,"GENERIC_PANIC"),YT.set(1,"ASSERT_FALSE"),YT.set(17,"OVERFLOW"),YT.set(18,"DIVIDE_BY_ZERO"),YT.set(33,"ENUM_RANGE_ERROR"),YT.set(34,"BAD_STORAGE_DATA"),YT.set(49,"STACK_UNDERFLOW"),YT.set(50,"ARRAY_RANGE_ERROR"),YT.set(65,"OUT_OF_MEMORY"),YT.set(81,"UNINITIALIZED_FUNCTION_CALL");const eP=new RegExp(/^bytes([0-9]*)$/),tP=new RegExp(/^(u?int)([0-9]*)$/);let sP=null,iP=1024;we=new WeakSet,xe=function(e){if(e.isArray())return new cS(Ci(this,we,xe).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new xS(e.components.map((e=>Ci(this,we,xe).call(this,e))),e.name);switch(e.baseType){case"address":return new nS(e.name);case"bool":return new hS(e.name);case"string":return new wS(e.name);case"bytes":return new dS(e.name);case"":return new mS(e.name)}let t=e.type.match(tP);if(t){let s=parseInt(t[2]||"256");return aw(0!==s&&s<=256&&s%8==0,"invalid "+t[1]+" bit length","param",e),new vS(s/8,"int"===t[1],e.name)}if(t=e.type.match(eP),t){let s=parseInt(t[1]);return aw(0!==s&&s<=32,"invalid bytes length","param",e),new pS(s,e.name)}aw(!1,"invalid type","type",e.type)};let aP=class e{constructor(){Ti(this,we)}getDefaultValue(e){const t=e.map((e=>Ci(this,we,xe).call(this,UT.from(e))));return new xS(t,"_").defaultValue()}encode(e,t){nw(t.length,e.length,"types/values length mismatch");const s=e.map((e=>Ci(this,we,xe).call(this,UT.from(e)))),i=new xS(s,"_"),a=new kx;return i.encode(a,t),a.data}decode(e,t,s){const i=e.map((e=>Ci(this,we,xe).call(this,UT.from(e))));return new xS(i,"_").decode(new Ax(t,s,iP))}static _setDefaultMaxInflation(e){aw("number"==typeof e&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),iP=e}static defaultAbiCoder(){return null==sP&&(sP=new e),sP}static getBuiltinCallException(t,s,i){return function(e,t,s,i){let a="missing revert data",n=null,r=null;if(s){a="execution reverted";const e=lw(s);if(s=pw(s),0===e.length)a+=" (no data present; likely require(false) occurred",n="require(false)";else if(e.length%32!=4)a+=" (could not decode reason; invalid data length)";else if("0x08c379a0"===pw(e.slice(0,4)))try{n=i.decode(["string"],e.slice(4))[0],r={signature:"Error(string)",name:"Error",args:[n]},a+=`: ${JSON.stringify(n)}`}catch(l){a+=" (could not decode reason; invalid string data)"}else if("0x4e487b71"===pw(e.slice(0,4)))try{const t=Number(i.decode(["uint256"],e.slice(4))[0]);r={signature:"Panic(uint256)",name:"Panic",args:[t]},n=`Panic due to ${YT.get(t)||"UNKNOWN"}(${t})`,a+=`: ${n}`}catch(l){a+=" (could not decode panic code)"}else a+=" (unknown custom error)"}const o={to:t.to?JA(t.to):null,data:t.data||"0x"};return t.from&&(o.from=JA(t.from)),sw(a,"CALL_EXCEPTION",{action:e,data:s,reason:n,transaction:o,invocation:null,revert:r})}(t,s,i,e.defaultAbiCoder())}};class nP{constructor(e,t,s){Ai(this,"fragment"),Ai(this,"name"),Ai(this,"signature"),Ai(this,"topic"),Ai(this,"args");const i=e.name,a=e.format();$v(this,{fragment:e,name:i,signature:a,topic:t,args:s})}}class rP{constructor(e,t,s,i){Ai(this,"fragment"),Ai(this,"name"),Ai(this,"args"),Ai(this,"signature"),Ai(this,"selector"),Ai(this,"value");const a=e.name,n=e.format();$v(this,{fragment:e,name:a,args:s,signature:n,selector:t,value:i})}}class oP{constructor(e,t,s){Ai(this,"fragment"),Ai(this,"name"),Ai(this,"args"),Ai(this,"signature"),Ai(this,"selector");const i=e.name,a=e.format();$v(this,{fragment:e,name:i,args:s,signature:a,selector:t})}}class lP{constructor(e){Ai(this,"hash"),Ai(this,"_isIndexed"),$v(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!(!e||!e._isIndexed)}}const cP={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},hP={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:e=>`reverted with reason string ${JSON.stringify(e)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:e=>{let t="unknown panic code";return e>=0&&e<=255&&cP[e.toString()]&&(t=cP[e.toString()]),`reverted with panic code 0x${e.toString(16)} (${t})`}}};ke=new WeakMap,Ae=new WeakMap,Se=new WeakMap,Ee=new WeakMap,Te=new WeakSet,Pe=function(e,t,s){if(hw(e)){const t=e.toLowerCase();for(const e of Ei(this,Se).values())if(t===e.selector)return e;return null}if(-1===e.indexOf("(")){const i=[];for(const[t,s]of Ei(this,Se))t.split("(")[0]===e&&i.push(s);if(t){const e=t.length>0?t[t.length-1]:null;let s=t.length,a=!0;aS.isTyped(e)&&"overrides"===e.type&&(a=!1,s--);for(let t=i.length-1;t>=0;t--){const e=i[t].inputs.length;e===s||a&&e===s-1||i.splice(t,1)}for(let n=i.length-1;n>=0;n--){const e=i[n].inputs;for(let s=0;s<t.length;s++)if(aS.isTyped(t[s])){if(s>=e.length){if("overrides"===t[s].type)continue;i.splice(n,1);break}if(t[s].type!==e[s].baseType){i.splice(n,1);break}}}}if(1===i.length&&t&&t.length!==i[0].inputs.length){const e=t[t.length-1];(null==e||Array.isArray(e)||"object"!=typeof e)&&i.splice(0,1)}return 0===i.length?null:(i.length>1&&s&&aw(!1,`ambiguous function description (i.e. matches ${i.map((e=>JSON.stringify(e.format()))).join(", ")})`,"key",e),i[0])}return Ei(this,Se).get(XT.from(e).format())||null},Ce=function(e,t,s){if(hw(e)){const t=e.toLowerCase();for(const e of Ei(this,Ae).values())if(t===e.topicHash)return e;return null}if(-1===e.indexOf("(")){const i=[];for(const[t,s]of Ei(this,Ae))t.split("(")[0]===e&&i.push(s);if(t){for(let e=i.length-1;e>=0;e--)i[e].inputs.length<t.length&&i.splice(e,1);for(let e=i.length-1;e>=0;e--){const s=i[e].inputs;for(let a=0;a<t.length;a++)if(aS.isTyped(t[a])&&t[a].type!==s[a].baseType){i.splice(e,1);break}}}return 0===i.length?null:(i.length>1&&s&&aw(!1,`ambiguous event description (i.e. matches ${i.map((e=>JSON.stringify(e.format()))).join(", ")})`,"key",e),i[0])}return Ei(this,Ae).get(KT.from(e).format())||null};let uP=class e{constructor(e){Ti(this,Te),Ai(this,"fragments"),Ai(this,"deploy"),Ai(this,"fallback"),Ai(this,"receive"),Ti(this,ke),Ti(this,Ae),Ti(this,Se),Ti(this,Ee);let t=[];t="string"==typeof e?JSON.parse(e):e,Pi(this,Se,new Map),Pi(this,ke,new Map),Pi(this,Ae,new Map);const s=[];for(const r of t)try{s.push(zT.from(r))}catch(n){console.log(`[Warning] Invalid Fragment ${JSON.stringify(r)}:`,n.message)}$v(this,{fragments:Object.freeze(s)});let i=null,a=!1;Pi(this,Ee,this.getAbiCoder()),this.fragments.forEach(((e,t)=>{let s;switch(e.type){case"constructor":return this.deploy?void console.log("duplicate definition - constructor"):void $v(this,{deploy:e});case"fallback":return void(0===e.inputs.length?a=!0:(aw(!i||e.payable!==i.payable,"conflicting fallback fragments",`fragments[${t}]`,e),i=e,a=i.payable));case"function":s=Ei(this,Se);break;case"event":s=Ei(this,Ae);break;case"error":s=Ei(this,ke);break;default:return}const n=e.format();s.has(n)||s.set(n,e)})),this.deploy||$v(this,{deploy:ZT.from("constructor()")}),$v(this,{fallback:i,receive:a})}format(e){const t=e?"minimal":"full";return this.fragments.map((e=>e.format(t)))}formatJson(){const e=this.fragments.map((e=>e.format("json")));return JSON.stringify(e.map((e=>JSON.parse(e))))}getAbiCoder(){return aP.defaultAbiCoder()}getFunctionName(e){const t=Ci(this,Te,Pe).call(this,e,null,!1);return aw(t,"no matching function","key",e),t.name}hasFunction(e){return!!Ci(this,Te,Pe).call(this,e,null,!1)}getFunction(e,t){return Ci(this,Te,Pe).call(this,e,t||null,!0)}forEachFunction(e){const t=Array.from(Ei(this,Se).keys());t.sort(((e,t)=>e.localeCompare(t)));for(let s=0;s<t.length;s++){const i=t[s];e(Ei(this,Se).get(i),s)}}getEventName(e){const t=Ci(this,Te,Ce).call(this,e,null,!1);return aw(t,"no matching event","key",e),t.name}hasEvent(e){return!!Ci(this,Te,Ce).call(this,e,null,!1)}getEvent(e,t){return Ci(this,Te,Ce).call(this,e,t||null,!0)}forEachEvent(e){const t=Array.from(Ei(this,Ae).keys());t.sort(((e,t)=>e.localeCompare(t)));for(let s=0;s<t.length;s++){const i=t[s];e(Ei(this,Ae).get(i),s)}}getError(e,t){if(hw(e)){const t=e.toLowerCase();if(hP[t])return qT.from(hP[t].signature);for(const e of Ei(this,ke).values())if(t===e.selector)return e;return null}if(-1===e.indexOf("(")){const t=[];for(const[s,i]of Ei(this,ke))s.split("(")[0]===e&&t.push(i);return 0===t.length?"Error"===e?qT.from("error Error(string)"):"Panic"===e?qT.from("error Panic(uint256)"):null:(t.length>1&&aw(!1,`ambiguous error description (i.e. ${t.map((e=>JSON.stringify(e.format()))).join(", ")})`,"name",e),t[0])}if("Error(string)"===(e=qT.from(e).format()))return qT.from("error Error(string)");if("Panic(uint256)"===e)return qT.from("error Panic(uint256)");return Ei(this,ke).get(e)||null}forEachError(e){const t=Array.from(Ei(this,ke).keys());t.sort(((e,t)=>e.localeCompare(t)));for(let s=0;s<t.length;s++){const i=t[s];e(Ei(this,ke).get(i),s)}}_decodeParams(e,t){return Ei(this,Ee).decode(e,t)}_encodeParams(e,t){return Ei(this,Ee).encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){if("string"==typeof e){const t=this.getError(e);aw(t,"unknown error","fragment",e),e=t}return aw(gw(t,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",t),this._decodeParams(e.inputs,gw(t,4))}encodeErrorResult(e,t){if("string"==typeof e){const t=this.getError(e);aw(t,"unknown error","fragment",e),e=t}return fw([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionData(e,t){if("string"==typeof e){const t=this.getFunction(e);aw(t,"unknown function","fragment",e),e=t}return aw(gw(t,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",t),this._decodeParams(e.inputs,gw(t,4))}encodeFunctionData(e,t){if("string"==typeof e){const t=this.getFunction(e);aw(t,"unknown function","fragment",e),e=t}return fw([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionResult(e,t){if("string"==typeof e){const t=this.getFunction(e);aw(t,"unknown function","fragment",e),e=t}let s="invalid length for result data";const i=cw(t);if(i.length%32==0)try{return Ei(this,Ee).decode(e.outputs,i)}catch(a){s="could not decode result data"}iw(!1,s,"BAD_DATA",{value:pw(i),info:{method:e.name,signature:e.format()}})}makeError(e,t){const s=lw(e,"data"),i=aP.getBuiltinCallException("call",t,s);if(i.message.startsWith("execution reverted (unknown custom error)")){const e=pw(s.slice(0,4)),t=this.getError(e);if(t)try{const e=Ei(this,Ee).decode(t.inputs,s.slice(4));i.revert={name:t.name,signature:t.format(),args:e},i.reason=i.revert.signature,i.message=`execution reverted: ${i.reason}`}catch(SD){i.message="execution reverted (coult not decode custom error)"}}const a=this.parseTransaction(t);return a&&(i.invocation={method:a.name,signature:a.signature,args:a.args}),i}encodeFunctionResult(e,t){if("string"==typeof e){const t=this.getFunction(e);aw(t,"unknown function","fragment",e),e=t}return pw(Ei(this,Ee).encode(e.outputs,t||[]))}encodeFilterTopics(e,t){if("string"==typeof e){const t=this.getEvent(e);aw(t,"unknown event","eventFragment",e),e=t}iw(t.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:t.length,expectedCount:e.inputs.length});const s=[];e.anonymous||s.push(e.topicHash);const i=(e,t)=>"string"===e.type?kS(t):"bytes"===e.type?Tk(pw(t)):("bool"===e.type&&"boolean"==typeof t?t=t?"0x01":"0x00":e.type.match(/^u?int/)?t=Mw(t):e.type.match(/^bytes/)?t=yw(t,32,!1):"address"===e.type&&Ei(this,Ee).encode(["address"],[t]),bw(pw(t),32));for(t.forEach(((t,a)=>{const n=e.inputs[a];n.indexed?null==t?s.push(null):"array"===n.baseType||"tuple"===n.baseType?aw(!1,"filtering with tuples or arrays not supported","contract."+n.name,t):Array.isArray(t)?s.push(t.map((e=>i(n,e)))):s.push(i(n,t)):aw(null==t,"cannot filter non-indexed parameters; must be null","contract."+n.name,t)}));s.length&&null===s[s.length-1];)s.pop();return s}encodeEventLog(e,t){if("string"==typeof e){const t=this.getEvent(e);aw(t,"unknown event","eventFragment",e),e=t}const s=[],i=[],a=[];return e.anonymous||s.push(e.topicHash),aw(t.length===e.inputs.length,"event arguments/values mismatch","values",t),e.inputs.forEach(((e,n)=>{const r=t[n];if(e.indexed)if("string"===e.type)s.push(kS(r));else if("bytes"===e.type)s.push(Tk(r));else{if("tuple"===e.baseType||"array"===e.baseType)throw new Error("not implemented");s.push(Ei(this,Ee).encode([e.type],[r]))}else i.push(e),a.push(r)})),{data:Ei(this,Ee).encode(i,a),topics:s}}decodeEventLog(e,t,s){if("string"==typeof e){const t=this.getEvent(e);aw(t,"unknown event","eventFragment",e),e=t}if(null!=s&&!e.anonymous){const t=e.topicHash;aw(hw(s[0],32)&&s[0].toLowerCase()===t,"fragment/topic mismatch","topics[0]",s[0]),s=s.slice(1)}const i=[],a=[],n=[];e.inputs.forEach(((e,t)=>{e.indexed?"string"===e.type||"bytes"===e.type||"tuple"===e.baseType||"array"===e.baseType?(i.push(UT.from({type:"bytes32",name:e.name})),n.push(!0)):(i.push(e),n.push(!1)):(a.push(e),n.push(!1))}));const r=null!=s?Ei(this,Ee).decode(i,fw(s)):null,o=Ei(this,Ee).decode(a,t,!0),l=[],c=[];let h=0,u=0;return e.inputs.forEach(((e,t)=>{let s=null;if(e.indexed)if(null==r)s=new lP(null);else if(n[t])s=new lP(r[u++]);else try{s=r[u++]}catch(i){s=i}else try{s=o[h++]}catch(i){s=i}l.push(s),c.push(e.name||null)})),vx.fromItems(l,c)}parseTransaction(e){const t=lw(e.data,"tx.data"),s=Sw(null!=e.value?e.value:0,"tx.value"),i=this.getFunction(pw(t.slice(0,4)));if(!i)return null;const a=Ei(this,Ee).decode(i.inputs,t.slice(4));return new rP(i,i.selector,a,s)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new nP(t,t.topicHash,this.decodeEventLog(t,e.data,e.topics))}parseError(e){const t=pw(e),s=this.getError(gw(t,0,4));if(!s)return null;const i=Ei(this,Ee).decode(s.inputs,gw(t,4));return new oP(s,s.selector,i)}static from(t){return t instanceof e?t:"string"==typeof t?new e(JSON.parse(t)):"function"==typeof t.formatJson?new e(t.formatJson()):"function"==typeof t.format?new e(t.format("json")):new e(t)}};const dP=BigInt(0);function pP(e){return null==e?null:e}function fP(e){return null==e?null:e.toString()}class mP{constructor(e,t,s){Ai(this,"gasPrice"),Ai(this,"maxFeePerGas"),Ai(this,"maxPriorityFeePerGas"),$v(this,{gasPrice:pP(e),maxFeePerGas:pP(t),maxPriorityFeePerGas:pP(s)})}toJSON(){const{gasPrice:e,maxFeePerGas:t,maxPriorityFeePerGas:s}=this;return{_type:"FeeData",gasPrice:fP(e),maxFeePerGas:fP(t),maxPriorityFeePerGas:fP(s)}}}function gP(e){const t={};e.to&&(t.to=e.to),e.from&&(t.from=e.from),e.data&&(t.data=pw(e.data));const s="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const a of s)a in e&&null!=e[a]&&(t[a]=Sw(e[a],`request.${a}`));const i="type,nonce".split(/,/);for(const a of i)a in e&&null!=e[a]&&(t[a]=Cw(e[a],`request.${a}`));return e.accessList&&(t.accessList=CE(e.accessList)),"blockTag"in e&&(t.blockTag=e.blockTag),"enableCcipRead"in e&&(t.enableCcipRead=!!e.enableCcipRead),"customData"in e&&(t.customData=e.customData),"blobVersionedHashes"in e&&e.blobVersionedHashes&&(t.blobVersionedHashes=e.blobVersionedHashes.slice()),"kzg"in e&&(t.kzg=e.kzg),"blobs"in e&&e.blobs&&(t.blobs=e.blobs.map((e=>uw(e)?pw(e):Object.assign({},e)))),t}class yP{constructor(e,t){Ai(this,"provider"),Ai(this,"number"),Ai(this,"hash"),Ai(this,"timestamp"),Ai(this,"parentHash"),Ai(this,"parentBeaconBlockRoot"),Ai(this,"nonce"),Ai(this,"difficulty"),Ai(this,"gasLimit"),Ai(this,"gasUsed"),Ai(this,"stateRoot"),Ai(this,"receiptsRoot"),Ai(this,"blobGasUsed"),Ai(this,"excessBlobGas"),Ai(this,"miner"),Ai(this,"prevRandao"),Ai(this,"extraData"),Ai(this,"baseFeePerGas"),Ti(this,Me),Pi(this,Me,e.transactions.map((e=>"string"!=typeof e?new wP(e,t):e))),$v(this,{provider:t,hash:pP(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:pP(e.prevRandao),extraData:e.extraData,baseFeePerGas:pP(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return Ei(this,Me).map((e=>"string"==typeof e?e:e.hash))}get prefetchedTransactions(){const e=Ei(this,Me).slice();return 0===e.length?[]:(iw("object"==typeof e[0],"transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:t,extraData:s,gasLimit:i,gasUsed:a,hash:n,miner:r,prevRandao:o,nonce:l,number:c,parentHash:h,parentBeaconBlockRoot:u,stateRoot:d,receiptsRoot:p,timestamp:f,transactions:m}=this;return{_type:"Block",baseFeePerGas:fP(e),difficulty:fP(t),extraData:s,gasLimit:fP(i),gasUsed:fP(a),blobGasUsed:fP(this.blobGasUsed),excessBlobGas:fP(this.excessBlobGas),hash:n,miner:r,prevRandao:o,nonce:l,number:c,parentHash:h,timestamp:f,parentBeaconBlockRoot:u,stateRoot:d,receiptsRoot:p,transactions:m}}[Symbol.iterator](){let e=0;const t=this.transactions;return{next:()=>e<this.length?{value:t[e++],done:!1}:{value:void 0,done:!0}}}get length(){return Ei(this,Me).length}get date(){return null==this.timestamp?null:new Date(1e3*this.timestamp)}async getTransaction(e){let t;if("number"==typeof e)t=Ei(this,Me)[e];else{const s=e.toLowerCase();for(const e of Ei(this,Me)){if("string"==typeof e){if(e!==s)continue;t=e;break}if(e.hash===s){t=e;break}}}if(null==t)throw new Error("no such tx");return"string"==typeof t?await this.provider.getTransaction(t):t}getPrefetchedTransaction(e){const t=this.prefetchedTransactions;if("number"==typeof e)return t[e];e=e.toLowerCase();for(const s of t)if(s.hash===e)return s;aw(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return{orphan:"drop-block",hash:this.hash,number:this.number}}}Me=new WeakMap;class bP{constructor(e,t){Ai(this,"provider"),Ai(this,"transactionHash"),Ai(this,"blockHash"),Ai(this,"blockNumber"),Ai(this,"removed"),Ai(this,"address"),Ai(this,"data"),Ai(this,"topics"),Ai(this,"index"),Ai(this,"transactionIndex"),this.provider=t;const s=Object.freeze(e.topics.slice());$v(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:s,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:t,blockNumber:s,data:i,index:a,removed:n,topics:r,transactionHash:o,transactionIndex:l}=this;return{_type:"log",address:e,blockHash:t,blockNumber:s,data:i,index:a,removed:n,topics:r,transactionHash:o,transactionIndex:l}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return iw(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return iw(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return iw(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return{orphan:"drop-log",log:{transactionHash:(e=this).transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,address:e.address,data:e.data,topics:Object.freeze(e.topics.slice()),index:e.index}};var e}}class vP{constructor(e,t){Ai(this,"provider"),Ai(this,"to"),Ai(this,"from"),Ai(this,"contractAddress"),Ai(this,"hash"),Ai(this,"index"),Ai(this,"blockHash"),Ai(this,"blockNumber"),Ai(this,"logsBloom"),Ai(this,"gasUsed"),Ai(this,"blobGasUsed"),Ai(this,"cumulativeGasUsed"),Ai(this,"gasPrice"),Ai(this,"blobGasPrice"),Ai(this,"type"),Ai(this,"status"),Ai(this,"root"),Ti(this,Be),Pi(this,Be,Object.freeze(e.logs.map((e=>new bP(e,t)))));let s=dP;null!=e.effectiveGasPrice?s=e.effectiveGasPrice:null!=e.gasPrice&&(s=e.gasPrice),$v(this,{provider:t,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:s,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return Ei(this,Be)}toJSON(){const{to:e,from:t,contractAddress:s,hash:i,index:a,blockHash:n,blockNumber:r,logsBloom:o,logs:l,status:c,root:h}=this;return{_type:"TransactionReceipt",blockHash:n,blockNumber:r,contractAddress:s,cumulativeGasUsed:fP(this.cumulativeGasUsed),from:t,gasPrice:fP(this.gasPrice),blobGasUsed:fP(this.blobGasUsed),blobGasPrice:fP(this.blobGasPrice),gasUsed:fP(this.gasUsed),hash:i,index:a,logs:l,logsBloom:o,root:h,status:c,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(null==e)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(null==e)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return kP(this)}reorderedEvent(e){return iw(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),xP(this,e)}}Be=new WeakMap,Re=new WeakMap;let wP=class e{constructor(e,t){Ai(this,"provider"),Ai(this,"blockNumber"),Ai(this,"blockHash"),Ai(this,"index"),Ai(this,"hash"),Ai(this,"type"),Ai(this,"to"),Ai(this,"from"),Ai(this,"nonce"),Ai(this,"gasLimit"),Ai(this,"gasPrice"),Ai(this,"maxPriorityFeePerGas"),Ai(this,"maxFeePerGas"),Ai(this,"maxFeePerBlobGas"),Ai(this,"data"),Ai(this,"value"),Ai(this,"chainId"),Ai(this,"signature"),Ai(this,"accessList"),Ai(this,"blobVersionedHashes"),Ti(this,Re),this.provider=t,this.blockNumber=null!=e.blockNumber?e.blockNumber:null,this.blockHash=null!=e.blockHash?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=null!=e.maxPriorityFeePerGas?e.maxPriorityFeePerGas:null,this.maxFeePerGas=null!=e.maxFeePerGas?e.maxFeePerGas:null,this.maxFeePerBlobGas=null!=e.maxFeePerBlobGas?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=null!=e.accessList?e.accessList:null,this.blobVersionedHashes=null!=e.blobVersionedHashes?e.blobVersionedHashes:null,Pi(this,Re,-1)}toJSON(){const{blockNumber:e,blockHash:t,index:s,hash:i,type:a,to:n,from:r,nonce:o,data:l,signature:c,accessList:h,blobVersionedHashes:u}=this;return{_type:"TransactionResponse",accessList:h,blockNumber:e,blockHash:t,blobVersionedHashes:u,chainId:fP(this.chainId),data:l,from:r,gasLimit:fP(this.gasLimit),gasPrice:fP(this.gasPrice),hash:i,maxFeePerGas:fP(this.maxFeePerGas),maxPriorityFeePerGas:fP(this.maxPriorityFeePerGas),maxFeePerBlobGas:fP(this.maxFeePerBlobGas),nonce:o,signature:c,to:n,index:s,type:a,value:fP(this.value)}}async getBlock(){let e=this.blockNumber;if(null==e){const t=await this.getTransaction();t&&(e=t.blockNumber)}if(null==e)return null;const t=this.provider.getBlock(e);if(null==t)throw new Error("TODO");return t}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(null==this.blockNumber){const{tx:e,blockNumber:t}=await Xv({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return null==e||null==e.blockNumber?0:t-e.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,t){const s=null==e?1:e,i=null==t?0:t;let a=Ei(this,Re),n=-1,r=-1===a;const o=async()=>{if(r)return null;const{blockNumber:e,nonce:t}=await Xv({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(t<this.nonce)return void(a=e);if(r)return null;const i=await this.getTransaction();if(!i||null==i.blockNumber)for(-1===n&&(n=a-3,n<Ei(this,Re)&&(n=Ei(this,Re)));n<=e;){if(r)return null;const t=await this.provider.getBlock(n,!0);if(null==t)return;for(const e of t)if(e===this.hash)return;for(let i=0;i<t.length;i++){const n=await t.getTransaction(i);if(n.from===this.from&&n.nonce===this.nonce){if(r)return null;const t=await this.provider.getTransactionReceipt(n.hash);if(null==t)return;if(e-t.blockNumber+1<s)return;let i="replaced";n.data===this.data&&n.to===this.to&&n.value===this.value?i="repriced":"0x"===n.data&&n.from===n.to&&n.value===dP&&(i="cancelled"),iw(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:"replaced"===i||"cancelled"===i,reason:i,replacement:n.replaceableTransaction(a),hash:n.hash,receipt:t})}}n++}},l=e=>{if(null==e||0!==e.status)return e;iw(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:e.to,from:e.from,data:""},receipt:e})},c=await this.provider.getTransactionReceipt(this.hash);if(0===s)return l(c);if(c){if(await c.confirmations()>=s)return l(c)}else if(await o(),0===s)return null;const h=new Promise(((e,t)=>{const n=[],c=()=>{n.forEach((e=>e()))};if(n.push((()=>{r=!0})),i>0){const e=setTimeout((()=>{c(),t(sw("wait for transaction timeout","TIMEOUT"))}),i);n.push((()=>{clearTimeout(e)}))}const h=async i=>{if(await i.confirmations()>=s){c();try{e(l(i))}catch(a){t(a)}}};if(n.push((()=>{this.provider.off(this.hash,h)})),this.provider.on(this.hash,h),a>=0){const e=async()=>{try{await o()}catch(s){if(ew(s,"TRANSACTION_REPLACED"))return c(),void t(s)}r||this.provider.once("block",e)};n.push((()=>{this.provider.off("block",e)})),this.provider.once("block",e)}}));return await h}isMined(){return null!=this.blockHash}isLegacy(){return 0===this.type}isBerlin(){return 1===this.type}isLondon(){return 2===this.type}isCancun(){return 3===this.type}removedEvent(){return iw(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),kP(this)}reorderedEvent(e){return iw(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),iw(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),xP(this,e)}replaceableTransaction(t){aw(Number.isInteger(t)&&t>=0,"invalid startBlock","startBlock",t);const s=new e(this,this.provider);return Pi(s,Re,t),s}};function xP(e,t){return{orphan:"reorder-transaction",tx:e,other:t}}function kP(e){return{orphan:"drop-transaction",tx:e}}class AP extends bP{constructor(e,t,s){super(e,e.provider),Ai(this,"interface"),Ai(this,"fragment"),Ai(this,"args"),$v(this,{args:t.decodeEventLog(s,e.data,e.topics),fragment:s,interface:t})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class SP extends bP{constructor(e,t){super(e,e.provider),Ai(this,"error"),$v(this,{error:t})}}class EP extends vP{constructor(e,t,s){super(s,t),Ti(this,De),Pi(this,De,e)}get logs(){return super.logs.map((e=>{const t=e.topics.length?Ei(this,De).getEvent(e.topics[0]):null;if(t)try{return new AP(e,Ei(this,De),t)}catch(s){return new SP(e,s)}return e}))}}De=new WeakMap;class TP extends wP{constructor(e,t,s){super(s,t),Ti(this,Ne),Pi(this,Ne,e)}async wait(e,t){const s=await super.wait(e,t);return null==s?null:new EP(Ei(this,Ne),this.provider,s)}}Ne=new WeakMap;class PP extends _w{constructor(e,t,s,i){super(e,t,s),Ai(this,"log"),$v(this,{log:i})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class CP extends PP{constructor(e,t,s,i,a){super(e,t,s,new AP(a,e.interface,i)),$v(this,{args:e.interface.decodeEventLog(i,this.log.data,this.log.topics),fragment:i})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const MP=BigInt(0);function BP(e){return e&&"function"==typeof e.call}function RP(e){return e&&"function"==typeof e.estimateGas}function DP(e){return e&&"function"==typeof e.resolveName}function NP(e){return e&&"function"==typeof e.sendTransaction}function _P(e){if(null!=e){if(DP(e))return e;if(e.provider)return e.provider}}class FP{constructor(e,t,s){if(Ti(this,_e),Ai(this,"fragment"),$v(this,{fragment:t}),t.inputs.length<s.length)throw new Error("too many arguments");const i=OP(e.runner,"resolveName"),a=DP(i)?i:null;Pi(this,_e,async function(){const i=await Promise.all(t.inputs.map(((e,t)=>null==s[t]?null:e.walkAsync(s[t],((e,t)=>"address"===e?Array.isArray(t)?Promise.all(t.map((e=>YA(e,a)))):YA(t,a):t)))));return e.interface.encodeFilterTopics(t,i)}())}getTopicFilter(){return Ei(this,_e)}}function OP(e,t){return null==e?null:"function"==typeof e[t]?e:e.provider&&"function"==typeof e.provider[t]?e.provider:null}function LP(e){return null==e?null:e.provider||null}async function IP(e,t){const s=aS.dereference(e,"overrides");aw("object"==typeof s,"invalid overrides parameter","overrides",e);const i=gP(s);return aw(null==i.to||(t||[]).indexOf("to")>=0,"cannot override to","overrides.to",i.to),aw(null==i.data||(t||[]).indexOf("data")>=0,"cannot override data","overrides.data",i.data),i.from&&(i.from=i.from),i}function jP(e){const t=async function(t){const s=await IP(t,["data"]);s.to=await e.getAddress(),s.from&&(s.from=await YA(s.from,_P(e.runner)));const i=e.interface,a=Sw(s.value||MP,"overrides.value")===MP,n="0x"===(s.data||"0x");return!i.fallback||i.fallback.payable||!i.receive||n||a||aw(!1,"cannot send data to receive or send value to non-payable fallback","overrides",t),aw(i.fallback||n,"cannot send data to receive-only contract","overrides.data",s.data),aw(i.receive||i.fallback&&i.fallback.payable||a,"cannot send value to non-payable fallback","overrides.value",s.value),aw(i.fallback||n,"cannot send data to receive-only contract","overrides.data",s.data),s},s=async function(s){const i=e.runner;iw(NP(i),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const a=await i.sendTransaction(await t(s)),n=LP(e.runner);return new TP(e.interface,n,a)},i=async e=>await s(e);return $v(i,{_contract:e,estimateGas:async function(s){const i=OP(e.runner,"estimateGas");return iw(RP(i),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await i.estimateGas(await t(s))},populateTransaction:t,send:s,staticCall:async function(s){const i=OP(e.runner,"call");iw(BP(i),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const a=await t(s);try{return await i.call(a)}catch(n){if(tw(n)&&n.data)throw e.interface.makeError(n.data,a);throw n}}}),i}_e=new WeakMap;const HP=Symbol.for("_ethersInternal_contract"),VP=new WeakMap;function GP(e){return VP.get(e[HP])}async function UP(e,t){let s,i=null;if(Array.isArray(t)){const i=function(t){if(hw(t,32))return t;const s=e.interface.getEvent(t);return aw(s,"unknown fragment","name",t),s.topicHash};s=t.map((e=>null==e?null:Array.isArray(e)?e.map(i):i(e)))}else"*"===t?s=[null]:"string"==typeof t?hw(t,32)?s=[t]:(i=e.interface.getEvent(t),aw(i,"unknown fragment","event",t),s=[i.topicHash]):(a=t)&&"object"==typeof a&&"getTopicFilter"in a&&"function"==typeof a.getTopicFilter&&a.fragment?s=await t.getTopicFilter():"fragment"in t?(i=t.fragment,s=[i.topicHash]):aw(!1,"unknown event name","event",t);var a;return s=s.map((e=>{if(null==e)return null;if(Array.isArray(e)){const t=Array.from(new Set(e.map((e=>e.toLowerCase()))).values());return 1===t.length?t[0]:(t.sort(),t)}return e.toLowerCase()})),{fragment:i,tag:s.map((e=>null==e?"null":Array.isArray(e)?e.join("|"):e)).join("&"),topics:s}}async function zP(e,t){const{subs:s}=GP(e);return s.get((await UP(e,t)).tag)||null}async function WP(e,t,s){const i=LP(e.runner);iw(i,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:t});const{fragment:a,tag:n,topics:r}=await UP(e,s),{addr:o,subs:l}=GP(e);let c=l.get(n);if(!c){const t={address:o||e,topics:r},h=t=>{let i=a;if(null==i)try{i=e.interface.getEvent(t.topics[0])}catch(n){}if(i){const n=i,r=a?e.interface.decodeEventLog(a,t.data,t.topics):[];qP(e,s,r,(i=>new CP(e,i,s,n,t)))}else qP(e,s,[],(i=>new PP(e,i,s,t)))};let u=[];c={tag:n,listeners:[],start:()=>{u.length||u.push(i.on(t,h))},stop:async()=>{if(0==u.length)return;let e=u;u=[],await Promise.all(e),i.off(t,h)}},l.set(n,c)}return c}let QP=Promise.resolve();async function qP(e,t,s,i){try{await QP}catch(n){}const a=async function(e,t,s,i){await QP;const a=await zP(e,t);if(!a)return!1;const r=a.listeners.length;return a.listeners=a.listeners.filter((({listener:t,once:a})=>{const r=Array.from(s);i&&r.push(i(a?null:t));try{t.call(e,...r)}catch(n){}return!a})),0===a.listeners.length&&(a.stop(),GP(e).subs.delete(a.tag)),r>0}(e,t,s,i);return QP=a,await a}const KP=["then"];Fe=HP;let ZP=class e{constructor(e,t,s,i){Ai(this,"target"),Ai(this,"interface"),Ai(this,"runner"),Ai(this,"filters"),Ai(this,Fe),Ai(this,"fallback"),aw("string"==typeof e||XA(e),"invalid value for Contract target","target",e),null==s&&(s=null);const a=uP.from(t);let n;$v(this,{target:e,runner:s,interface:a}),Object.defineProperty(this,HP,{value:{}});let r=null,o=null;if(i){const e=LP(s);o=new TP(this.interface,e,i)}let l=new Map;if("string"==typeof e)if(hw(e))r=e,n=Promise.resolve(e);else{const t=OP(s,"resolveName");if(!DP(t))throw sw("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});n=t.resolveName(e).then((t=>{if(null==t)throw sw("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return GP(this).addr=t,t}))}else n=e.getAddress().then((e=>{if(null==e)throw new Error("TODO");return GP(this).addr=e,e}));var c;return c={addrPromise:n,addr:r,deployTx:o,subs:l},VP.set(this[HP],c),$v(this,{filters:new Proxy({},{get:(e,t,s)=>{if("symbol"==typeof t||KP.indexOf(t)>=0)return Reflect.get(e,t,s);try{return this.getEvent(t)}catch(i){if(!ew(i,"INVALID_ARGUMENT")||"key"!==i.argument)throw i}},has:(e,t)=>KP.indexOf(t)>=0?Reflect.has(e,t):Reflect.has(e,t)||this.interface.hasEvent(String(t))})}),$v(this,{fallback:a.receive||a.fallback?jP(this):null}),new Proxy(this,{get:(e,t,s)=>{if("symbol"==typeof t||t in e||KP.indexOf(t)>=0)return Reflect.get(e,t,s);try{return e.getFunction(t)}catch(i){if(!ew(i,"INVALID_ARGUMENT")||"key"!==i.argument)throw i}},has:(e,t)=>"symbol"==typeof t||t in e||KP.indexOf(t)>=0?Reflect.has(e,t):e.interface.hasFunction(t)})}connect(t){return new e(this.target,this.interface,t)}attach(t){return new e(t,this.interface,this.runner)}async getAddress(){return await GP(this).addrPromise}async getDeployedCode(){const e=LP(this.runner);iw(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const t=await e.getCode(await this.getAddress());return"0x"===t?null:t}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(null!=await this.getDeployedCode())return this;const t=LP(this.runner);return iw(null!=t,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise(((e,s)=>{const i=async()=>{try{if(null!=await this.getDeployedCode())return e(this);t.once("block",i)}catch(a){s(a)}};i()}))}deploymentTransaction(){return GP(this).deployTx}getFunction(e){return"string"!=typeof e&&(e=e.format()),function(e,t){const s=function(...s){const i=e.interface.getFunction(t,s);return iw(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:t,args:s}}),i},i=async function(...t){const i=s(...t);let a={};if(i.inputs.length+1===t.length&&(a=await IP(t.pop()),a.from&&(a.from=await YA(a.from,_P(e.runner)))),i.inputs.length!==t.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const n=await async function(e,t,s){const i=OP(e,"resolveName"),a=DP(i)?i:null;return await Promise.all(t.map(((e,t)=>e.walkAsync(s[t],((e,t)=>(t=aS.dereference(t,e),"address"===e?YA(t,a):t))))))}(e.runner,i.inputs,t);return Object.assign({},a,await Xv({to:e.getAddress(),data:e.interface.encodeFunctionData(i,n)}))},a=async function(...e){const t=await r(...e);return 1===t.length?t[0]:t},n=async function(...t){const s=e.runner;iw(NP(s),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const a=await s.sendTransaction(await i(...t)),n=LP(e.runner);return new TP(e.interface,n,a)},r=async function(...t){const a=OP(e.runner,"call");iw(BP(a),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const n=await i(...t);let r="0x";try{r=await a.call(n)}catch(l){if(tw(l)&&l.data)throw e.interface.makeError(l.data,n);throw l}const o=s(...t);return e.interface.decodeFunctionResult(o,r)},o=async(...e)=>s(...e).constant?await a(...e):await n(...e);return $v(o,{name:e.interface.getFunctionName(t),_contract:e,_key:t,getFragment:s,estimateGas:async function(...t){const s=OP(e.runner,"estimateGas");return iw(RP(s),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await s.estimateGas(await i(...t))},populateTransaction:i,send:n,staticCall:a,staticCallResult:r}),Object.defineProperty(o,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=e.interface.getFunction(t);return iw(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:t}}),s}}),o}(this,e)}getEvent(e){return"string"!=typeof e&&(e=e.format()),function(e,t){const s=function(...s){const i=e.interface.getEvent(t,s);return iw(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:t,args:s}}),i},i=function(...t){return new FP(e,s(...t),t)};return $v(i,{name:e.interface.getEventName(t),_contract:e,_key:t,getFragment:s}),Object.defineProperty(i,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=e.interface.getEvent(t);return iw(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:t}}),s}}),i}(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,t,s){null==t&&(t=0),null==s&&(s="latest");const{addr:i,addrPromise:a}=GP(this),n=i||await a,{fragment:r,topics:o}=await UP(this,e),l={address:n,topics:o,fromBlock:t,toBlock:s},c=LP(this.runner);return iw(c,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await c.getLogs(l)).map((e=>{let t=r;if(null==t)try{t=this.interface.getEvent(e.topics[0])}catch(s){}if(t)try{return new AP(e,this.interface,t)}catch(s){return new SP(e,s)}return new bP(e,c)}))}async on(e,t){const s=await WP(this,"on",e);return s.listeners.push({listener:t,once:!1}),s.start(),this}async once(e,t){const s=await WP(this,"once",e);return s.listeners.push({listener:t,once:!0}),s.start(),this}async emit(e,...t){return await qP(this,e,t,null)}async listenerCount(e){if(e){const t=await zP(this,e);return t?t.listeners.length:0}const{subs:t}=GP(this);let s=0;for(const{listeners:i}of t.values())s+=i.length;return s}async listeners(e){if(e){const t=await zP(this,e);return t?t.listeners.map((({listener:e})=>e)):[]}const{subs:t}=GP(this);let s=[];for(const{listeners:i}of t.values())s=s.concat(i.map((({listener:e})=>e)));return s}async off(e,t){const s=await zP(this,e);if(!s)return this;if(t){const e=s.listeners.map((({listener:e})=>e)).indexOf(t);e>=0&&s.listeners.splice(e,1)}return null!=t&&0!==s.listeners.length||(s.stop(),GP(this).subs.delete(s.tag)),this}async removeAllListeners(e){if(e){const t=await zP(this,e);if(!t)return this;t.stop(),GP(this).subs.delete(t.tag)}else{const{subs:e}=GP(this);for(const{tag:t,stop:s}of e.values())s(),e.delete(t)}return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return await this.off(e,t)}static buildClass(t){return class extends e{constructor(e,s=null){super(e,t,s)}}}static from(e,t,s){return null==s&&(s=null),new this(e,t,s)}};class JP extends(function(){return ZP}()){}function XP(e){return e.match(/^ipfs:\/\/ipfs\//i)?e=e.substring(12):e.match(/^ipfs:\/\//i)?e=e.substring(7):aw(!1,"unsupported IPFS format","link",e),`https://gateway.ipfs.io/ipfs/${e}`}class $P{constructor(e){Ai(this,"name"),$v(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,t){throw new Error("unsupported coin")}async decodeAddress(e,t){throw new Error("unsupported coin")}}const YP=new RegExp("^(ipfs)://(.*)$","i"),eC=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),YP,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")],tC=class e{constructor(e,t,s){Ti(this,Ie),Ai(this,"provider"),Ai(this,"address"),Ai(this,"name"),Ti(this,Oe),Ti(this,Le),$v(this,{provider:e,address:t,name:s}),Pi(this,Oe,null),Pi(this,Le,new JP(t,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e))}async supportsWildcard(){return null==Ei(this,Oe)&&Pi(this,Oe,(async()=>{try{return await Ei(this,Le).supportsInterface("0x9061b923")}catch(e){if(ew(e,"CALL_EXCEPTION"))return!1;throw Pi(this,Oe,null),e}})()),await Ei(this,Oe)}async getAddress(e){if(null==e&&(e=60),60===e)try{const e=await Ci(this,Ie,je).call(this,"addr(bytes32)");return null==e||e===DA?null:e}catch(a){if(ew(a,"CALL_EXCEPTION"))return null;throw a}if(e>=0&&e<2147483648){let t=e+2147483648;const s=await Ci(this,Ie,je).call(this,"addr(bytes32,uint)",[t]);if(hw(s,20))return JA(s)}let t=null;for(const n of this.provider.plugins)if(n instanceof $P&&n.supportsCoinType(e)){t=n;break}if(null==t)return null;const s=await Ci(this,Ie,je).call(this,"addr(bytes32,uint)",[e]);if(null==s||"0x"===s)return null;const i=await t.decodeAddress(e,s);if(null!=i)return i;iw(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:s}})}async getText(e){const t=await Ci(this,Ie,je).call(this,"text(bytes32,string)",[e]);return null==t||"0x"===t?null:t}async getContentHash(){const e=await Ci(this,Ie,je).call(this,"contenthash(bytes32)");if(null==e||"0x"===e)return null;const t=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(t){const e="e3010170"===t[1]?"ipfs":"ipns",s=parseInt(t[4],16);if(t[5].length===2*s)return`${e}://${function(e){const t=lw(e);let s=Pw(t),i="";for(;s;)i=Dw[Number(s%Nw)]+i,s/=Nw;for(let a=0;a<t.length&&!t[a];a++)i=Dw[0]+i;return i}("0x"+t[2])}`}const s=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(s&&64===s[1].length)return`bzz://${s[1]}`;iw(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const i=await this.getText("avatar");if(null==i)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:i});for(let a=0;a<eC.length;a++){const n=i.match(eC[a]);if(null==n)continue;const r=n[1].toLowerCase();switch(r){case"https":case"data":return e.push({type:"url",value:i}),{linkage:e,url:i};case"ipfs":{const t=XP(i);return e.push({type:"ipfs",value:i}),e.push({type:"url",value:t}),{linkage:e,url:t}}case"erc721":case"erc1155":{const a="erc721"===r?"tokenURI(uint256)":"uri(uint256)";e.push({type:r,value:i});const o=await this.getAddress();if(null==o)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const l=(n[2]||"").split("/");if(2!==l.length)return e.push({type:`!${r}caip`,value:n[2]||""}),{url:null,linkage:e};const c=l[1],h=new JP(l[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if("erc721"===r){const t=await h.ownerOf(c);if(o!==t)return e.push({type:"!owner",value:t}),{url:null,linkage:e};e.push({type:"owner",value:t})}else if("erc1155"===r){const t=await h.balanceOf(o,c);if(!t)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:t.toString()})}let u=await h[a](c);if(null==u||"0x"===u)return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:u}),"erc1155"===r&&(u=u.replace("{id}",Mw(c,32).substring(2)),e.push({type:"metadata-url-expanded",value:u})),u.match(/^ipfs:/i)&&(u=XP(u)),e.push({type:"metadata-url",value:u});let d={};const p=await new Xw(u).send();p.assertOk();try{d=p.bodyJson}catch(t){try{e.push({type:"!metadata",value:p.bodyText})}catch(s){const t=p.body;return t&&e.push({type:"!metadata",value:pw(t)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!d)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(d)});let f=d.image;if("string"!=typeof f)return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(f.match(/^(https:\/\/|data:)/i));else{if(null==f.match(YP))return e.push({type:"!imageUrl-ipfs",value:f}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:f}),f=XP(f)}return e.push({type:"url",value:f}),{linkage:e,url:f}}}}}catch(t){}return{linkage:e,url:null}}static async getEnsAddress(e){const t=await e.getNetwork(),s=t.getPlugin("org.ethers.plugins.network.Ens");return iw(s,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:t}}),s.address}static async fromName(t,s){var i;let a=s;for(;;){if(""===a||"."===a)return null;if("eth"!==s&&"eth"===a)return null;const n=await Ci(i=e,He,Ve).call(i,t,a);if(null!=n){const i=new e(t,n,s);return a===s||await i.supportsWildcard()?i:null}a=a.split(".").slice(1).join(".")}}};Oe=new WeakMap,Le=new WeakMap,Ie=new WeakSet,je=async function(e,t){t=(t||[]).slice();const s=Ei(this,Le).interface;t.unshift(EE(this.name));let i=null;await this.supportsWildcard()&&(i=s.getFunction(e),iw(i,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),t=[TE(this.name,255),s.encodeFunctionData(i,t)],e="resolve(bytes,bytes)"),t.push({enableCcipRead:!0});try{const a=await Ei(this,Le)[e](...t);return i?s.decodeFunctionResult(i,a)[0]:a}catch(a){if(!ew(a,"CALL_EXCEPTION"))throw a}return null},He=new WeakSet,Ve=async function(e,t){const s=await tC.getEnsAddress(e);try{const i=new JP(s,["function resolver(bytes32) view returns (address)"],e),a=await i.resolver(EE(t),{enableCcipRead:!0});return a===DA?null:a}catch(i){throw i}return null},Ti(tC,He);let sC=tC;const iC=BigInt(0);function aC(e,t){return function(s){return null==s?t:e(s)}}function nC(e,t){return s=>{if(t&&null==s)return null;if(!Array.isArray(s))throw new Error("not an array");return s.map((t=>e(t)))}}function rC(e,t){return s=>{const i={};for(const n in e){let r=n;if(t&&n in t&&!(r in s))for(const e of t[n])if(e in s){r=e;break}try{const t=e[n](s[r]);void 0!==t&&(i[n]=t)}catch(a){iw(!1,`invalid value for value.${n} (${a instanceof Error?a.message:"not-an-error"})`,"BAD_DATA",{value:s})}}return i}}function oC(e){return aw(hw(e,!0),"invalid data","value",e),e}function lC(e){return aw(hw(e,32),"invalid hash","value",e),e}const cC=rC({address:JA,blockHash:lC,blockNumber:Cw,data:oC,index:Cw,removed:aC((function(e){switch(e){case!0:case"true":return!0;case!1:case"false":return!1}aw(!1,`invalid boolean; ${JSON.stringify(e)}`,"value",e)}),!1),topics:nC(lC),transactionHash:lC,transactionIndex:Cw},{index:["logIndex"]}),hC=rC({hash:aC(lC),parentHash:lC,parentBeaconBlockRoot:aC(lC,null),number:Cw,timestamp:Cw,nonce:aC(oC),difficulty:Sw,gasLimit:Sw,gasUsed:Sw,stateRoot:aC(lC,null),receiptsRoot:aC(lC,null),blobGasUsed:aC(Sw,null),excessBlobGas:aC(Sw,null),miner:aC(JA),prevRandao:aC(lC,null),extraData:oC,baseFeePerGas:aC(Sw)},{prevRandao:["mixHash"]}),uC=rC({transactionIndex:Cw,blockNumber:Cw,transactionHash:lC,address:JA,topics:nC(lC),data:oC,index:Cw,blockHash:lC},{index:["logIndex"]}),dC=rC({to:aC(JA,null),from:aC(JA,null),contractAddress:aC(JA,null),index:Cw,root:aC(pw),gasUsed:Sw,blobGasUsed:aC(Sw,null),logsBloom:aC(oC),blockHash:lC,hash:lC,logs:nC((function(e){return uC(e)})),blockNumber:Cw,cumulativeGasUsed:Sw,effectiveGasPrice:aC(Sw),blobGasPrice:aC(Sw,null),status:aC(Cw),type:aC(Cw,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function pC(e){e.to&&Sw(e.to)===iC&&(e.to="0x0000000000000000000000000000000000000000");const t=rC({hash:lC,index:aC(Cw,void 0),type:e=>"0x"===e||null==e?0:Cw(e),accessList:aC(CE,null),blobVersionedHashes:aC(nC(lC,!0),null),blockHash:aC(lC,null),blockNumber:aC(Cw,null),transactionIndex:aC(Cw,null),from:JA,gasPrice:aC(Sw),maxPriorityFeePerGas:aC(Sw),maxFeePerGas:aC(Sw),maxFeePerBlobGas:aC(Sw,null),gasLimit:Sw,to:aC(JA,null),value:Sw,nonce:Cw,data:oC,creates:aC(JA,null),chainId:aC(Sw,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(e);if(null==t.to&&null==t.creates&&(t.creates=function(e){const t=JA(e.from);let s=Sw(e.nonce,"tx.nonce").toString(16);return s="0"===s?"0x":s.length%2?"0x0"+s:"0x"+s,JA(gw(Tk(cx([t,s])),12))}(t)),1!==e.type&&2!==e.type||null!=e.accessList||(t.accessList=[]),e.signature?t.signature=UA.from(e.signature):t.signature=UA.from(e),null==t.chainId){const e=t.signature.legacyChainId;null!=e&&(t.chainId=e)}return t.blockHash&&Sw(t.blockHash)===iC&&(t.blockHash=null),t}class fC{constructor(e){Ai(this,"name"),$v(this,{name:e})}clone(){return new fC(this.name)}}class mC extends fC{constructor(e,t){null==e&&(e=0),super(`org.ethers.network.plugins.GasCost#${e||0}`),Ai(this,"effectiveBlock"),Ai(this,"txBase"),Ai(this,"txCreate"),Ai(this,"txDataZero"),Ai(this,"txDataNonzero"),Ai(this,"txAccessListStorageKey"),Ai(this,"txAccessListAddress");const s={effectiveBlock:e};function i(e,i){let a=(t||{})[e];null==a&&(a=i),aw("number"==typeof a,`invalud value for ${e}`,"costs",t),s[e]=a}i("txBase",21e3),i("txCreate",32e3),i("txDataZero",4),i("txDataNonzero",16),i("txAccessListStorageKey",1900),i("txAccessListAddress",2400),$v(this,s)}clone(){return new mC(this.effectiveBlock,this)}}class gC extends fC{constructor(e,t){super("org.ethers.plugins.network.Ens"),Ai(this,"address"),Ai(this,"targetNetwork"),$v(this,{address:e||"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",targetNetwork:null==t?1:t})}clone(){return new gC(this.address,this.targetNetwork)}}class yC extends fC{constructor(e,t){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin"),Ti(this,Ge),Ti(this,Ue),Pi(this,Ge,e),Pi(this,Ue,t)}get url(){return Ei(this,Ge)}get processFunc(){return Ei(this,Ue)}clone(){return this}}Ge=new WeakMap,Ue=new WeakMap;const bC=new Map;ze=new WeakMap,We=new WeakMap,Qe=new WeakMap;let vC=class e{constructor(e,t){Ti(this,ze),Ti(this,We),Ti(this,Qe),Pi(this,ze,e),Pi(this,We,Sw(t)),Pi(this,Qe,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return Ei(this,ze)}set name(e){Pi(this,ze,e)}get chainId(){return Ei(this,We)}set chainId(e){Pi(this,We,Sw(e,"chainId"))}matches(e){if(null==e)return!1;if("string"==typeof e){try{return this.chainId===Sw(e)}catch(t){}return this.name===e}if("number"==typeof e||"bigint"==typeof e){try{return this.chainId===Sw(e)}catch(t){}return!1}if("object"==typeof e){if(null!=e.chainId){try{return this.chainId===Sw(e.chainId)}catch(t){}return!1}return null!=e.name&&this.name===e.name}return!1}get plugins(){return Array.from(Ei(this,Qe).values())}attachPlugin(e){if(Ei(this,Qe).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return Ei(this,Qe).set(e.name,e.clone()),this}getPlugin(e){return Ei(this,Qe).get(e)||null}getPlugins(e){return this.plugins.filter((t=>t.name.split("#")[0]===e))}clone(){const t=new e(this.name,this.chainId);return this.plugins.forEach((e=>{t.attachPlugin(e.clone())})),t}computeIntrinsicGas(e){const t=this.getPlugin("org.ethers.plugins.network.GasCost")||new mC;let s=t.txBase;if(null==e.to&&(s+=t.txCreate),e.data)for(let i=2;i<e.data.length;i+=2)"00"===e.data.substring(i,i+2)?s+=t.txDataZero:s+=t.txDataNonzero;if(e.accessList){const i=CE(e.accessList);for(const e in i)s+=t.txAccessListAddress+t.txAccessListStorageKey*i[e].storageKeys.length}return s}static from(t){if(function(){function e(e,t,s){const i=function(){const i=new vC(e,t);return null!=s.ensNetwork&&i.attachPlugin(new gC(null,s.ensNetwork)),i.attachPlugin(new mC),(s.plugins||[]).forEach((e=>{i.attachPlugin(e)})),i};vC.register(e,i),vC.register(t,i),s.altNames&&s.altNames.forEach((e=>{vC.register(e,i)}))}kC||(kC=!0,e("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),e("ropsten",3,{ensNetwork:3}),e("rinkeby",4,{ensNetwork:4}),e("goerli",5,{ensNetwork:5}),e("kovan",42,{ensNetwork:42}),e("sepolia",11155111,{ensNetwork:11155111}),e("holesky",17e3,{ensNetwork:17e3}),e("classic",61,{}),e("classicKotti",6,{}),e("arbitrum",42161,{ensNetwork:1}),e("arbitrum-goerli",421613,{}),e("arbitrum-sepolia",421614,{}),e("base",8453,{ensNetwork:1}),e("base-goerli",84531,{}),e("base-sepolia",84532,{}),e("bnb",56,{ensNetwork:1}),e("bnbt",97,{}),e("linea",59144,{ensNetwork:1}),e("linea-goerli",59140,{}),e("linea-sepolia",59141,{}),e("matic",137,{ensNetwork:1,plugins:[xC("https://gasstation.polygon.technology/v2")]}),e("matic-amoy",80002,{}),e("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[xC("https://gasstation-testnet.polygon.technology/v2")]}),e("optimism",10,{ensNetwork:1,plugins:[]}),e("optimism-goerli",420,{}),e("optimism-sepolia",11155420,{}),e("xdai",100,{ensNetwork:1}))}(),null==t)return e.from("mainnet");if("number"==typeof t&&(t=BigInt(t)),"string"==typeof t||"bigint"==typeof t){const s=bC.get(t);if(s)return s();if("bigint"==typeof t)return new e("unknown",t);aw(!1,"unknown network","network",t)}if("function"==typeof t.clone)return t.clone();if("object"==typeof t){aw("string"==typeof t.name&&"number"==typeof t.chainId,"invalid network object name or chainId","network",t);const s=new e(t.name,t.chainId);return(t.ensAddress||null!=t.ensNetwork)&&s.attachPlugin(new gC(t.ensAddress,t.ensNetwork)),s}aw(!1,"invalid network","network",t)}static register(e,t){"number"==typeof e&&(e=BigInt(e));const s=bC.get(e);s&&aw(!1,`conflicting network for ${JSON.stringify(s.name)}`,"nameOrChainId",e),bC.set(e,t)}};function wC(e,t){const s=String(e);if(!s.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${e}`);const i=s.split(".");if(1===i.length&&i.push(""),2!==i.length)throw new Error(`invalid gwei value: ${e}`);for(;i[1].length<t;)i[1]+="0";if(i[1].length>9){let e=BigInt(i[1].substring(0,9));i[1].substring(9).match(/^0+$/)||e++,i[1]=e.toString()}return BigInt(i[0]+i[1])}function xC(e){return new yC(e,(async(e,t,s)=>{let i;s.setHeader("User-Agent","ethers");try{const[t,a]=await Promise.all([s.send(),e()]);i=t;const n=i.bodyJson.standard;return{gasPrice:a.gasPrice,maxFeePerGas:wC(n.maxFee,9),maxPriorityFeePerGas:wC(n.maxPriorityFee,9)}}catch(a){iw(!1,`error encountered with polygon gas station (${JSON.stringify(s.url)})`,"SERVER_ERROR",{request:s,response:i,error:a})}}))}let kC=!1;function AC(e){return JSON.parse(JSON.stringify(e))}class SC{constructor(e){Ti(this,Xe),Ti(this,qe),Ti(this,Ke),Ti(this,Ze),Ti(this,Je),Pi(this,qe,e),Pi(this,Ke,null),Pi(this,Ze,4e3),Pi(this,Je,-2)}get pollingInterval(){return Ei(this,Ze)}set pollingInterval(e){Pi(this,Ze,e)}start(){Ei(this,Ke)||(Pi(this,Ke,Ei(this,qe)._setTimeout(Ci(this,Xe,$e).bind(this),Ei(this,Ze))),Ci(this,Xe,$e).call(this))}stop(){Ei(this,Ke)&&(Ei(this,qe)._clearTimeout(Ei(this,Ke)),Pi(this,Ke,null))}pause(e){this.stop(),e&&Pi(this,Je,-2)}resume(){this.start()}}qe=new WeakMap,Ke=new WeakMap,Ze=new WeakMap,Je=new WeakMap,Xe=new WeakSet,$e=async function(){try{const e=await Ei(this,qe).getBlockNumber();if(-2===Ei(this,Je))return void Pi(this,Je,e);if(e!==Ei(this,Je)){for(let t=Ei(this,Je)+1;t<=e;t++){if(null==Ei(this,Ke))return;await Ei(this,qe).emit("block",t)}Pi(this,Je,e)}}catch(e){}null!=Ei(this,Ke)&&Pi(this,Ke,Ei(this,qe)._setTimeout(Ci(this,Xe,$e).bind(this),Ei(this,Ze)))};class EC{constructor(e){Ti(this,Ye),Ti(this,et),Ti(this,tt),Pi(this,Ye,e),Pi(this,tt,!1),Pi(this,et,(e=>{this._poll(e,Ei(this,Ye))}))}async _poll(e,t){throw new Error("sub-classes must override this")}start(){Ei(this,tt)||(Pi(this,tt,!0),Ei(this,et).call(this,-2),Ei(this,Ye).on("block",Ei(this,et)))}stop(){Ei(this,tt)&&(Pi(this,tt,!1),Ei(this,Ye).off("block",Ei(this,et)))}pause(e){this.stop()}resume(){this.start()}}Ye=new WeakMap,et=new WeakMap,tt=new WeakMap;class TC extends EC{constructor(e,t){super(e),Ti(this,st),Ti(this,it),Pi(this,st,t),Pi(this,it,-2)}pause(e){e&&Pi(this,it,-2),super.pause(e)}async _poll(e,t){const s=await t.getBlock(Ei(this,st));null!=s&&(-2===Ei(this,it)?Pi(this,it,s.number):s.number>Ei(this,it)&&(t.emit(Ei(this,st),s.number),Pi(this,it,s.number)))}}st=new WeakMap,it=new WeakMap;class PC extends EC{constructor(e,t){super(e),Ti(this,at),Pi(this,at,AC(t))}async _poll(e,t){throw new Error("@TODO")}}at=new WeakMap;class CC extends EC{constructor(e,t){super(e),Ti(this,nt),Pi(this,nt,t)}async _poll(e,t){const s=await t.getTransactionReceipt(Ei(this,nt));s&&t.emit(Ei(this,nt),s)}}nt=new WeakMap;class MC{constructor(e,t){Ti(this,ut),Ti(this,rt),Ti(this,ot),Ti(this,lt),Ti(this,ct),Ti(this,ht),Pi(this,rt,e),Pi(this,ot,AC(t)),Pi(this,lt,Ci(this,ut,dt).bind(this)),Pi(this,ct,!1),Pi(this,ht,-2)}start(){Ei(this,ct)||(Pi(this,ct,!0),-2===Ei(this,ht)&&Ei(this,rt).getBlockNumber().then((e=>{Pi(this,ht,e)})),Ei(this,rt).on("block",Ei(this,lt)))}stop(){Ei(this,ct)&&(Pi(this,ct,!1),Ei(this,rt).off("block",Ei(this,lt)))}pause(e){this.stop(),e&&Pi(this,ht,-2)}resume(){this.start()}}rt=new WeakMap,ot=new WeakMap,lt=new WeakMap,ct=new WeakMap,ht=new WeakMap,ut=new WeakSet,dt=async function(e){if(-2===Ei(this,ht))return;const t=AC(Ei(this,ot));t.fromBlock=Ei(this,ht)+1,t.toBlock=e;const s=await Ei(this,rt).getLogs(t);if(0!==s.length)for(const i of s)Ei(this,rt).emit(Ei(this,ot),i),Pi(this,ht,i.blockNumber);else Ei(this,ht)<e-60&&Pi(this,ht,e-60)};const BC=BigInt(2);function RC(e){return e&&"function"==typeof e.then}function DC(e,t){return e+":"+JSON.stringify(t,((e,t)=>{if(null==t)return"null";if("bigint"==typeof t)return`bigint:${t.toString()}`;if("string"==typeof t)return t.toLowerCase();if("object"==typeof t&&!Array.isArray(t)){const e=Object.keys(t);return e.sort(),e.reduce(((e,s)=>(e[s]=t[s],e)),{})}return t}))}class NC{constructor(e){Ai(this,"name"),$v(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function _C(e){return(e=Array.from(new Set(e).values())).sort(),e}async function FC(e,t){if(null==e)throw new Error("invalid event");if(Array.isArray(e)&&(e={topics:e}),"string"==typeof e)switch(e){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:e,tag:e}}if(hw(e,32)){const t=e.toLowerCase();return{type:"transaction",tag:DC("tx",{hash:t}),hash:t}}if(e.orphan){const t=e;return{type:"orphan",tag:DC("orphan",t),filter:(s=t,JSON.parse(JSON.stringify(s)))}}var s;if(e.address||e.topics){const s=e,i={topics:(s.topics||[]).map((e=>null==e?null:Array.isArray(e)?_C(e.map((e=>e.toLowerCase()))):e.toLowerCase()))};if(s.address){const e=[],a=[],n=s=>{hw(s)?e.push(s):a.push((async()=>{e.push(await YA(s,t))})())};Array.isArray(s.address)?s.address.forEach(n):n(s.address),a.length&&await Promise.all(a),i.address=_C(e.map((e=>e.toLowerCase())))}return{filter:i,tag:DC("event",i),type:"event"}}aw(!1,"unknown ProviderEvent","event",e)}function OC(){return(new Date).getTime()}const LC={cacheTimeout:250,pollingInterval:4e3};class IC{constructor(e,t){if(Ti(this,Et),Ti(this,pt),Ti(this,ft),Ti(this,mt),Ti(this,gt),Ti(this,yt),Ti(this,bt),Ti(this,vt),Ti(this,wt),Ti(this,xt),Ti(this,kt),Ti(this,At),Ti(this,St),Pi(this,St,Object.assign({},LC,t||{})),"any"===e)Pi(this,bt,!0),Pi(this,yt,null);else if(e){const t=vC.from(e);Pi(this,bt,!1),Pi(this,yt,Promise.resolve(t)),setTimeout((()=>{this.emit("network",t,null)}),0)}else Pi(this,bt,!1),Pi(this,yt,null);Pi(this,wt,-1),Pi(this,vt,new Map),Pi(this,pt,new Map),Pi(this,ft,new Map),Pi(this,mt,null),Pi(this,gt,!1),Pi(this,xt,1),Pi(this,kt,new Map),Pi(this,At,!1)}get pollingInterval(){return Ei(this,St).pollingInterval}get provider(){return this}get plugins(){return Array.from(Ei(this,ft).values())}attachPlugin(e){if(Ei(this,ft).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return Ei(this,ft).set(e.name,e.connect(this)),this}getPlugin(e){return Ei(this,ft).get(e)||null}get disableCcipRead(){return Ei(this,At)}set disableCcipRead(e){Pi(this,At,!!e)}async ccipReadFetch(e,t,s){if(this.disableCcipRead||0===s.length||null==e.to)return null;const i=e.to.toLowerCase(),a=t.toLowerCase(),n=[];for(let o=0;o<s.length;o++){const t=s[o],l=t.replace("{sender}",i).replace("{data}",a),c=new Xw(l);-1===t.indexOf("{data}")&&(c.body={data:a,sender:i}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:c,index:o,urls:s});let h,u="unknown error";try{h=await c.send()}catch(r){n.push(r.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:c,result:{error:r}});continue}try{const e=h.bodyJson;if(e.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:c,result:e}),e.data;e.message&&(u=e.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:c,result:e})}catch(r){}iw(h.statusCode<400||h.statusCode>=500,`response not found during CCIP fetch: ${u}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:t,errorMessage:u}}),n.push(u)}iw(!1,`error encountered during CCIP fetch: ${n.map((e=>JSON.stringify(e))).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:s,errorMessages:n}})}_wrapBlock(e,t){return new yP(function(e){const t=hC(e);return t.transactions=e.transactions.map((e=>"string"==typeof e?e:pC(e))),t}(e),this)}_wrapLog(e,t){return new bP(function(e){return cC(e)}(e),this)}_wrapTransactionReceipt(e,t){return new vP(function(e){return dC(e)}(e),this)}_wrapTransactionResponse(e,t){return new wP(pC(e),this)}_detectNetwork(){iw(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){iw(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=Cw(await Ci(this,Et,Tt).call(this,{method:"getBlockNumber"}),"%response");return Ei(this,wt)>=0&&Pi(this,wt,e),e}_getAddress(e){return YA(e,this)}_getBlockTag(e){if(null==e)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}return hw(e)?hw(e,32)?e:Rw(e):("bigint"==typeof e&&(e=Cw(e,"blockTag")),"number"==typeof e?e>=0?Rw(e):Ei(this,wt)>=0?Rw(Ei(this,wt)+e):this.getBlockNumber().then((t=>Rw(t+e))):void aw(!1,"invalid blockTag","blockTag",e))}_getFilter(e){const t=(e.topics||[]).map((e=>null==e?null:Array.isArray(e)?_C(e.map((e=>e.toLowerCase()))):e.toLowerCase())),s="blockHash"in e?e.blockHash:void 0,i=(e,i,a)=>{let n;switch(e.length){case 0:break;case 1:n=e[0];break;default:e.sort(),n=e}if(s&&(null!=i||null!=a))throw new Error("invalid filter");const r={};return n&&(r.address=n),t.length&&(r.topics=t),i&&(r.fromBlock=i),a&&(r.toBlock=a),s&&(r.blockHash=s),r};let a,n,r=[];if(e.address)if(Array.isArray(e.address))for(const o of e.address)r.push(this._getAddress(o));else r.push(this._getAddress(e.address));return"fromBlock"in e&&(a=this._getBlockTag(e.fromBlock)),"toBlock"in e&&(n=this._getBlockTag(e.toBlock)),r.filter((e=>"string"!=typeof e)).length||null!=a&&"string"!=typeof a||null!=n&&"string"!=typeof n?Promise.all([Promise.all(r),a,n]).then((e=>i(e[0],e[1],e[2]))):i(r,a,n)}_getTransactionRequest(e){const t=gP(e),s=[];if(["to","from"].forEach((e=>{if(null==t[e])return;const i=YA(t[e],this);RC(i)?s.push(async function(){t[e]=await i}()):t[e]=i})),null!=t.blockTag){const e=this._getBlockTag(t.blockTag);RC(e)?s.push(async function(){t.blockTag=await e}()):t.blockTag=e}return s.length?async function(){return await Promise.all(s),t}():t}async getNetwork(){if(null==Ei(this,yt)){const e=(async()=>{try{const e=await this._detectNetwork();return this.emit("network",e,null),e}catch(t){throw Ei(this,yt)===e&&Pi(this,yt,null),t}})();return Pi(this,yt,e),(await e).clone()}const e=Ei(this,yt),[t,s]=await Promise.all([e,this._detectNetwork()]);return t.chainId!==s.chainId&&(Ei(this,bt)?(this.emit("network",s,t),Ei(this,yt)===e&&Pi(this,yt,Promise.resolve(s))):iw(!1,`network changed: ${t.chainId} => ${s.chainId} `,"NETWORK_ERROR",{event:"changed"})),t.clone()}async getFeeData(){const e=await this.getNetwork(),t=async()=>{const{_block:t,gasPrice:s,priorityFee:i}=await Xv({_block:Ci(this,Et,Bt).call(this,"latest",!1),gasPrice:(async()=>{try{return Sw(await Ci(this,Et,Tt).call(this,{method:"getGasPrice"}),"%response")}catch(e){}return null})(),priorityFee:(async()=>{try{return Sw(await Ci(this,Et,Tt).call(this,{method:"getPriorityFee"}),"%response")}catch(e){}return null})()});let a=null,n=null;const r=this._wrapBlock(t,e);return r&&r.baseFeePerGas&&(n=null!=i?i:BigInt("1000000000"),a=r.baseFeePerGas*BC+n),new mP(s,a,n)},s=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(s){const e=new Xw(s.url),i=await s.processFunc(t,this,e);return new mP(i.gasPrice,i.maxFeePerGas,i.maxPriorityFeePerGas)}return await t()}async estimateGas(e){let t=this._getTransactionRequest(e);return RC(t)&&(t=await t),Sw(await Ci(this,Et,Tt).call(this,{method:"estimateGas",transaction:t}),"%response")}async call(e){const{tx:t,blockTag:s}=await Xv({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await Ci(this,Et,Ct).call(this,Ci(this,Et,Pt).call(this,t,s,e.enableCcipRead?0:-1))}async getBalance(e,t){return Sw(await Ci(this,Et,Mt).call(this,{method:"getBalance"},e,t),"%response")}async getTransactionCount(e,t){return Cw(await Ci(this,Et,Mt).call(this,{method:"getTransactionCount"},e,t),"%response")}async getCode(e,t){return pw(await Ci(this,Et,Mt).call(this,{method:"getCode"},e,t))}async getStorage(e,t,s){const i=Sw(t,"position");return pw(await Ci(this,Et,Mt).call(this,{method:"getStorage",position:i},e,s))}async broadcastTransaction(e){const{blockNumber:t,hash:s,network:i}=await Xv({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),a=WE.from(e);if(a.hash!==s)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(a,i).replaceableTransaction(t)}async getBlock(e,t){const{network:s,params:i}=await Xv({network:this.getNetwork(),params:Ci(this,Et,Bt).call(this,e,!!t)});return null==i?null:this._wrapBlock(i,s)}async getTransaction(e){const{network:t,params:s}=await Xv({network:this.getNetwork(),params:Ci(this,Et,Tt).call(this,{method:"getTransaction",hash:e})});return null==s?null:this._wrapTransactionResponse(s,t)}async getTransactionReceipt(e){const{network:t,params:s}=await Xv({network:this.getNetwork(),params:Ci(this,Et,Tt).call(this,{method:"getTransactionReceipt",hash:e})});if(null==s)return null;if(null==s.gasPrice&&null==s.effectiveGasPrice){const t=await Ci(this,Et,Tt).call(this,{method:"getTransaction",hash:e});if(null==t)throw new Error("report this; could not find tx or effectiveGasPrice");s.effectiveGasPrice=t.gasPrice}return this._wrapTransactionReceipt(s,t)}async getTransactionResult(e){const{result:t}=await Xv({network:this.getNetwork(),result:Ci(this,Et,Tt).call(this,{method:"getTransactionResult",hash:e})});return null==t?null:pw(t)}async getLogs(e){let t=this._getFilter(e);RC(t)&&(t=await t);const{network:s,params:i}=await Xv({network:this.getNetwork(),params:Ci(this,Et,Tt).call(this,{method:"getLogs",filter:t})});return i.map((e=>this._wrapLog(e,s)))}_getProvider(e){iw(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await sC.fromName(this,e)}async getAvatar(e){const t=await this.getResolver(e);return t?await t.getAvatar():null}async resolveName(e){const t=await this.getResolver(e);return t?await t.getAddress():null}async lookupAddress(e){const t=EE((e=JA(e)).substring(2).toLowerCase()+".addr.reverse");try{const s=await sC.getEnsAddress(this),i=new JP(s,["function resolver(bytes32) view returns (address)"],this),a=await i.resolver(t);if(null==a||a===DA)return null;const n=new JP(a,["function name(bytes32) view returns (string)"],this),r=await n.name(t);return await this.resolveName(r)!==e?null:r}catch(s){if(ew(s,"BAD_DATA")&&"0x"===s.value)return null;if(ew(s,"CALL_EXCEPTION"))return null;throw s}return null}async waitForTransaction(e,t,s){const i=null!=t?t:1;return 0===i?this.getTransactionReceipt(e):new Promise((async(t,a)=>{let n=null;const r=async s=>{try{const a=await this.getTransactionReceipt(e);if(null!=a&&s-a.blockNumber+1>=i)return t(a),void(n&&(clearTimeout(n),n=null))}catch(a){console.log("EEE",a)}this.once("block",r)};null!=s&&(n=setTimeout((()=>{null!=n&&(n=null,this.off("block",r),a(sw("timeout","TIMEOUT",{reason:"timeout"})))}),s)),r(await this.getBlockNumber())}))}async waitForBlock(e){iw(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const t=Ei(this,kt).get(e);t&&(t.timer&&clearTimeout(t.timer),Ei(this,kt).delete(e))}_setTimeout(e,t){null==t&&(t=0);const s=Mi(this,xt)._++,i=()=>{Ei(this,kt).delete(s),e()};if(this.paused)Ei(this,kt).set(s,{timer:null,func:i,time:t});else{const e=setTimeout(i,t);Ei(this,kt).set(s,{timer:e,func:i,time:OC()})}return s}_forEachSubscriber(e){for(const t of Ei(this,pt).values())e(t.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new NC(e.type);case"block":{const e=new SC(this);return e.pollingInterval=this.pollingInterval,e}case"safe":case"finalized":return new TC(this,e.type);case"event":return new MC(this,e.filter);case"transaction":return new CC(this,e.hash);case"orphan":return new PC(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,t){for(const s of Ei(this,pt).values())if(s.subscriber===e){s.started&&s.subscriber.stop(),s.subscriber=t,s.started&&t.start(),null!=Ei(this,mt)&&t.pause(Ei(this,mt));break}}async on(e,t){const s=await Ci(this,Et,Dt).call(this,e);return s.listeners.push({listener:t,once:!1}),s.started||(s.subscriber.start(),s.started=!0,null!=Ei(this,mt)&&s.subscriber.pause(Ei(this,mt))),this}async once(e,t){const s=await Ci(this,Et,Dt).call(this,e);return s.listeners.push({listener:t,once:!0}),s.started||(s.subscriber.start(),s.started=!0,null!=Ei(this,mt)&&s.subscriber.pause(Ei(this,mt))),this}async emit(e,...t){const s=await Ci(this,Et,Rt).call(this,e,t);if(!s||0===s.listeners.length)return!1;const i=s.listeners.length;return s.listeners=s.listeners.filter((({listener:s,once:i})=>{const a=new _w(this,i?null:s,e);try{s.call(this,...t,a)}catch(n){}return!i})),0===s.listeners.length&&(s.started&&s.subscriber.stop(),Ei(this,pt).delete(s.tag)),i>0}async listenerCount(e){if(e){const t=await Ci(this,Et,Rt).call(this,e);return t?t.listeners.length:0}let t=0;for(const{listeners:s}of Ei(this,pt).values())t+=s.length;return t}async listeners(e){if(e){const t=await Ci(this,Et,Rt).call(this,e);return t?t.listeners.map((({listener:e})=>e)):[]}let t=[];for(const{listeners:s}of Ei(this,pt).values())t=t.concat(s.map((({listener:e})=>e)));return t}async off(e,t){const s=await Ci(this,Et,Rt).call(this,e);if(!s)return this;if(t){const e=s.listeners.map((({listener:e})=>e)).indexOf(t);e>=0&&s.listeners.splice(e,1)}return t&&0!==s.listeners.length||(s.started&&s.subscriber.stop(),Ei(this,pt).delete(s.tag)),this}async removeAllListeners(e){if(e){const{tag:t,started:s,subscriber:i}=await Ci(this,Et,Dt).call(this,e);s&&i.stop(),Ei(this,pt).delete(t)}else for(const[t,{started:s,subscriber:i}]of Ei(this,pt))s&&i.stop(),Ei(this,pt).delete(t);return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return this.off(e,t)}get destroyed(){return Ei(this,gt)}destroy(){this.removeAllListeners();for(const e of Ei(this,kt).keys())this._clearTimeout(e);Pi(this,gt,!0)}get paused(){return null!=Ei(this,mt)}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(Pi(this,wt,-1),null!=Ei(this,mt)){if(Ei(this,mt)==!!e)return;iw(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber((t=>t.pause(e))),Pi(this,mt,!!e);for(const t of Ei(this,kt).values())t.timer&&clearTimeout(t.timer),t.time=OC()-t.time}resume(){if(null!=Ei(this,mt)){this._forEachSubscriber((e=>e.resume())),Pi(this,mt,null);for(const e of Ei(this,kt).values()){let t=e.time;t<0&&(t=0),e.time=OC(),setTimeout(e.func,t)}}}}function jC(e,t){try{const s=HC(e,t);if(s)return Iw(s)}catch(s){}return null}function HC(e,t){if("0x"===e)return null;try{const s=Cw(gw(e,t,t+32)),i=Cw(gw(e,s,s+32));return gw(e,s+32,s+32+i)}catch(s){}return null}function VC(e){const t=Bw(e);if(t.length>32)throw new Error("internal; should not happen");const s=new Uint8Array(32);return s.set(t,32-t.length),s}function GC(e){if(e.length%32==0)return e;const t=new Uint8Array(32*Math.ceil(e.length/32));return t.set(e),t}pt=new WeakMap,ft=new WeakMap,mt=new WeakMap,gt=new WeakMap,yt=new WeakMap,bt=new WeakMap,vt=new WeakMap,wt=new WeakMap,xt=new WeakMap,kt=new WeakMap,At=new WeakMap,St=new WeakMap,Et=new WeakSet,Tt=async function(e){const t=Ei(this,St).cacheTimeout;if(t<0)return await this._perform(e);const s=DC(e.method,e);let i=Ei(this,vt).get(s);return i||(i=this._perform(e),Ei(this,vt).set(s,i),setTimeout((()=>{Ei(this,vt).get(s)===i&&Ei(this,vt).delete(s)}),t)),await i},Pt=async function(e,t,s){iw(s<10,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:t,enableCcipRead:!0})});const i=gP(e);try{return pw(await this._perform({method:"call",transaction:i,blockTag:t}))}catch(a){if(!this.disableCcipRead&&tw(a)&&a.data&&s>=0&&"latest"===t&&null!=i.to&&"0x556f1830"===gw(a.data,0,4)){const e=a.data,r=await YA(i.to,this);let o;try{o=function(e){const t={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};iw(mw(e)>=160,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const s=gw(e,0,32);iw(gw(s,0,12)===gw(WC,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),t.sender=gw(s,12);try{const s=[],i=Cw(gw(e,32,64)),a=Cw(gw(e,i,i+32)),n=gw(e,i+32);for(let e=0;e<a;e++){const t=jC(n,32*e);if(null==t)throw new Error("abort");s.push(t)}t.urls=s}catch(a){iw(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const s=HC(e,64);if(null==s)throw new Error("abort");t.calldata=s}catch(a){iw(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}iw(gw(e,100,128)===gw(WC,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),t.selector=gw(e,96,100);try{const s=HC(e,128);if(null==s)throw new Error("abort");t.extraData=s}catch(a){iw(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return t.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map((e=>t[e])),t}(gw(a.data,4))}catch(n){iw(!1,n.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:i,info:{data:e}})}iw(o.sender.toLowerCase()===r.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:e,reason:"OffchainLookup",transaction:i,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:o.errorArgs}});const l=await this.ccipReadFetch(i,o.calldata,o.urls);iw(null!=l,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:i,info:{data:a.data,errorArgs:o.errorArgs}});const c={to:r,data:fw([o.selector,zC([l,o.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:c});try{const e=await Ci(this,Et,Pt).call(this,c,t,s+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},c),result:e}),e}catch(n){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},c),error:n}),n}}throw a}},Ct=async function(e){const{value:t}=await Xv({network:this.getNetwork(),value:e});return t},Mt=async function(e,t,s){let i=this._getAddress(t),a=this._getBlockTag(s);return"string"==typeof i&&"string"==typeof a||([i,a]=await Promise.all([i,a])),await Ci(this,Et,Ct).call(this,Ci(this,Et,Tt).call(this,Object.assign(e,{address:i,blockTag:a})))},Bt=async function(e,t){if(hw(e,32))return await Ci(this,Et,Tt).call(this,{method:"getBlock",blockHash:e,includeTransactions:t});let s=this._getBlockTag(e);return"string"!=typeof s&&(s=await s),await Ci(this,Et,Tt).call(this,{method:"getBlock",blockTag:s,includeTransactions:t})},Rt=async function(e,t){let s=await FC(e,this);return"event"===s.type&&t&&t.length>0&&!0===t[0].removed&&(s=await FC({orphan:"drop-log",log:t[0]},this)),Ei(this,pt).get(s.tag)||null},Dt=async function(e){const t=await FC(e,this),s=t.tag;let i=Ei(this,pt).get(s);return i||(i={subscriber:this._getSubscriber(t),tag:s,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},Ei(this,pt).set(s,i)),i};const UC=new Uint8Array([]);function zC(e){const t=[];let s=0;for(let i=0;i<e.length;i++)t.push(UC),s+=32;for(let i=0;i<e.length;i++){const a=lw(e[i]);t[i]=VC(s),t.push(VC(a.length)),t.push(GC(a)),s+=32+32*Math.ceil(a.length/32)}return fw(t)}const WC="0x0000000000000000000000000000000000000000000000000000000000000000";function QC(e,t){if(e.provider)return e.provider;iw(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:t})}async function qC(e,t){let s=gP(t);if(null!=s.to&&(s.to=YA(s.to,e)),null!=s.from){const t=s.from;s.from=Promise.all([e.getAddress(),YA(t,e)]).then((([e,t])=>(aw(e.toLowerCase()===t.toLowerCase(),"transaction from mismatch","tx.from",t),e)))}else s.from=e.getAddress();return await Xv(s)}class KC{constructor(e){Ai(this,"provider"),$v(this,{provider:e||null})}async getNonce(e){return QC(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await qC(this,e)}async populateTransaction(e){const t=QC(this,"populateTransaction"),s=await qC(this,e);null==s.nonce&&(s.nonce=await this.getNonce("pending")),null==s.gasLimit&&(s.gasLimit=await this.estimateGas(s));const i=await this.provider.getNetwork();null!=s.chainId?aw(Sw(s.chainId)===i.chainId,"transaction chainId mismatch","tx.chainId",e.chainId):s.chainId=i.chainId;const a=null!=s.maxFeePerGas||null!=s.maxPriorityFeePerGas;if(null==s.gasPrice||2!==s.type&&!a?0!==s.type&&1!==s.type||!a||aw(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e):aw(!1,"eip-1559 transaction do not support gasPrice","tx",e),2!==s.type&&null!=s.type||null==s.maxFeePerGas||null==s.maxPriorityFeePerGas)if(0===s.type||1===s.type){const e=await t.getFeeData();iw(null!=e.gasPrice,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),null==s.gasPrice&&(s.gasPrice=e.gasPrice)}else{const e=await t.getFeeData();if(null==s.type)if(null!=e.maxFeePerGas&&null!=e.maxPriorityFeePerGas)if(s.type=2,null!=s.gasPrice){const e=s.gasPrice;delete s.gasPrice,s.maxFeePerGas=e,s.maxPriorityFeePerGas=e}else null==s.maxFeePerGas&&(s.maxFeePerGas=e.maxFeePerGas),null==s.maxPriorityFeePerGas&&(s.maxPriorityFeePerGas=e.maxPriorityFeePerGas);else null!=e.gasPrice?(iw(!a,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),null==s.gasPrice&&(s.gasPrice=e.gasPrice),s.type=0):iw(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else 2!==s.type&&3!==s.type||(null==s.maxFeePerGas&&(s.maxFeePerGas=e.maxFeePerGas),null==s.maxPriorityFeePerGas&&(s.maxPriorityFeePerGas=e.maxPriorityFeePerGas))}else s.type=2;return await Xv(s)}async estimateGas(e){return QC(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return QC(this,"call").call(await this.populateCall(e))}async resolveName(e){const t=QC(this,"resolveName");return await t.resolveName(e)}async sendTransaction(e){const t=QC(this,"sendTransaction"),s=await this.populateTransaction(e);delete s.from;const i=WE.from(s);return await t.broadcastTransaction(await this.signTransaction(i))}}class ZC{constructor(e){Ti(this,jt),Ti(this,Nt),Ti(this,_t),Ti(this,Ft),Ti(this,Ot),Ti(this,Lt),Ti(this,It),Pi(this,Nt,e),Pi(this,_t,null),Pi(this,Ft,Ci(this,jt,Ht).bind(this)),Pi(this,Ot,!1),Pi(this,Lt,null),Pi(this,It,!1)}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,t){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}start(){Ei(this,Ot)||(Pi(this,Ot,!0),Ci(this,jt,Ht).call(this,-2))}stop(){Ei(this,Ot)&&(Pi(this,Ot,!1),Pi(this,It,!0),Ci(this,jt,Vt).call(this),Ei(this,Nt).off("block",Ei(this,Ft)))}pause(e){e&&Ci(this,jt,Vt).call(this),Ei(this,Nt).off("block",Ei(this,Ft))}resume(){this.start()}}Nt=new WeakMap,_t=new WeakMap,Ft=new WeakMap,Ot=new WeakMap,Lt=new WeakMap,It=new WeakMap,jt=new WeakSet,Ht=async function(e){try{null==Ei(this,_t)&&Pi(this,_t,this._subscribe(Ei(this,Nt)));let e=null;try{e=await Ei(this,_t)}catch(t){if(!ew(t,"UNSUPPORTED_OPERATION")||"eth_newFilter"!==t.operation)throw t}if(null==e)return Pi(this,_t,null),void Ei(this,Nt)._recoverSubscriber(this,this._recover(Ei(this,Nt)));const s=await Ei(this,Nt).getNetwork();if(Ei(this,Lt)||Pi(this,Lt,s),Ei(this,Lt).chainId!==s.chainId)throw new Error("chaid changed");if(Ei(this,It))return;const i=await Ei(this,Nt).send("eth_getFilterChanges",[e]);await this._emitResults(Ei(this,Nt),i)}catch(t){console.log("@TODO",t)}Ei(this,Nt).once("block",Ei(this,Ft))},Vt=function(){const e=Ei(this,_t);e&&(Pi(this,_t,null),e.then((e=>{Ei(this,Nt).destroyed||Ei(this,Nt).send("eth_uninstallFilter",[e])})))};class JC extends ZC{constructor(e,t){var s;super(e),Ti(this,Gt),Pi(this,Gt,(s=t,JSON.parse(JSON.stringify(s))))}_recover(e){return new MC(e,Ei(this,Gt))}async _subscribe(e){return await e.send("eth_newFilter",[Ei(this,Gt)])}async _emitResults(e,t){for(const s of t)e.emit(Ei(this,Gt),e._wrapLog(s,e._network))}}Gt=new WeakMap;class XC extends ZC{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,t){for(const s of t)e.emit("pending",s)}}const $C="bigint,boolean,function,number,string,symbol".split(/,/g);function YC(e){if(null==e||$C.indexOf(typeof e)>=0)return e;if("function"==typeof e.getAddress)return e;if(Array.isArray(e))return e.map(YC);if("object"==typeof e)return Object.keys(e).reduce(((t,s)=>(t[s]=e[s],t)),{});throw new Error(`should not happen: ${e} (${typeof e})`)}function eM(e){return new Promise((t=>{setTimeout(t,e)}))}function tM(e){return e?e.toLowerCase():e}function sM(e){return e&&"number"==typeof e.pollingInterval}const iM={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class aM extends KC{constructor(e,t){super(e),Ai(this,"address"),$v(this,{address:t=JA(t)})}connect(e){iw(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(e){return await this.populateCall(e)}async sendUncheckedTransaction(e){const t=YC(e),s=[];if(t.from){const i=t.from;s.push((async()=>{const s=await YA(i,this.provider);aw(null!=s&&s.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",e),t.from=s})())}else t.from=this.address;if(null==t.gasLimit&&s.push((async()=>{t.gasLimit=await this.provider.estimateGas({...t,from:this.address})})()),null!=t.to){const e=t.to;s.push((async()=>{t.to=await YA(e,this.provider)})())}s.length&&await Promise.all(s);const i=this.provider.getRpcTransaction(t);return this.provider.send("eth_sendTransaction",[i])}async sendTransaction(e){const t=await this.provider.getBlockNumber(),s=await this.sendUncheckedTransaction(e);return await new Promise(((e,i)=>{const a=[1e3,100];let n=0;const r=async()=>{try{const i=await this.provider.getTransaction(s);if(null!=i)return void e(i.replaceableTransaction(t))}catch(o){if(ew(o,"CANCELLED")||ew(o,"BAD_DATA")||ew(o,"NETWORK_ERROR")||ew(o,"UNSUPPORTED_OPERATION"))return null==o.info&&(o.info={}),o.info.sendTransactionHash=s,void i(o);if(ew(o,"INVALID_ARGUMENT")&&(n++,null==o.info&&(o.info={}),o.info.sendTransactionHash=s,n>10))return void i(o);this.provider.emit("error",sw("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:o}))}this.provider._setTimeout((()=>{r()}),a.pop()||4e3)};r()}))}async signTransaction(e){const t=YC(e);if(t.from){const s=await YA(t.from,this.provider);aw(null!=s&&s.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",e),t.from=s}else t.from=this.address;const s=this.provider.getRpcTransaction(t);return await this.provider.send("eth_signTransaction",[s])}async signMessage(e){const t="string"==typeof e?Lw(e):e;return await this.provider.send("personal_sign",[pw(t),this.address.toLowerCase()])}async signTypedData(e,t,s){const i=YC(s),a=await rT.resolveNames(e,t,i,(async e=>{const t=await YA(e);return aw(null!=t,"TypedData does not support null address","value",e),t}));return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(rT.getPayload(a.domain,t,a.value))])}async unlock(e){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),e,null])}async _legacySignMessage(e){const t="string"==typeof e?Lw(e):e;return await this.provider.send("eth_sign",[this.address.toLowerCase(),pw(t)])}}class nM extends IC{constructor(e,t){super(e,t),Ti(this,Jt),Ti(this,Ut),Ti(this,zt),Ti(this,Wt),Ti(this,Qt),Ti(this,qt),Ti(this,Kt),Ti(this,Zt),Pi(this,zt,1),Pi(this,Ut,Object.assign({},iM,t||{})),Pi(this,Wt,[]),Pi(this,Qt,null),Pi(this,Kt,null),Pi(this,Zt,null);{let e=null;const t=new Promise((t=>{e=t}));Pi(this,qt,{promise:t,resolve:e})}const s=this._getOption("staticNetwork");"boolean"==typeof s?(aw(!s||"any"!==e,"staticNetwork cannot be used on special network 'any'","options",t),s&&null!=e&&Pi(this,Kt,vC.from(e))):s&&(aw(null==e||s.matches(e),"staticNetwork MUST match network object","options",t),Pi(this,Kt,s))}_getOption(e){return Ei(this,Ut)[e]}get _network(){return iw(Ei(this,Kt),"network is not available yet","NETWORK_ERROR"),Ei(this,Kt)}async _perform(e){if("call"===e.method||"estimateGas"===e.method){let t=e.transaction;if(t&&null!=t.type&&Sw(t.type)&&null==t.maxFeePerGas&&null==t.maxPriorityFeePerGas){const s=await this.getFeeData();null==s.maxFeePerGas&&null==s.maxPriorityFeePerGas&&(e=Object.assign({},e,{transaction:Object.assign({},t,{type:void 0})}))}}const t=this.getRpcRequest(e);return null!=t?await this.send(t.method,t.args):super._perform(e)}async _detectNetwork(){const e=this._getOption("staticNetwork");if(e){if(!0!==e)return e;if(Ei(this,Kt))return Ei(this,Kt)}return Ei(this,Zt)?await Ei(this,Zt):this.ready?(Pi(this,Zt,(async()=>{try{const e=vC.from(Sw(await this.send("eth_chainId",[])));return Pi(this,Zt,null),e}catch(e){throw Pi(this,Zt,null),e}})()),await Ei(this,Zt)):(Pi(this,Zt,(async()=>{const e={id:Mi(this,zt)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};let t;this.emit("debug",{action:"sendRpcPayload",payload:e});try{t=(await this._send(e))[0],Pi(this,Zt,null)}catch(s){throw Pi(this,Zt,null),this.emit("debug",{action:"receiveRpcError",error:s}),s}if(this.emit("debug",{action:"receiveRpcResult",result:t}),"result"in t)return vC.from(Sw(t.result));throw this.getRpcError(e,t)})()),await Ei(this,Zt))}_start(){null!=Ei(this,qt)&&null!=Ei(this,qt).resolve&&(Ei(this,qt).resolve(),Pi(this,qt,null),(async()=>{for(;null==Ei(this,Kt)&&!this.destroyed;)try{Pi(this,Kt,await this._detectNetwork())}catch(e){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",sw("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:e}})),await eM(1e3)}Ci(this,Jt,Xt).call(this)})())}async _waitUntilReady(){if(null!=Ei(this,qt))return await Ei(this,qt).promise}_getSubscriber(e){return"pending"===e.type?new XC(this):"event"===e.type?this._getOption("polling")?new MC(this,e.filter):new JC(this,e.filter):"orphan"===e.type&&"drop-log"===e.filter.orphan?new NC("orphan"):super._getSubscriber(e)}get ready(){return null==Ei(this,qt)}getRpcTransaction(e){const t={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach((s=>{if(null==e[s])return;let i=s;"gasLimit"===s&&(i="gas"),t[i]=Rw(Sw(e[s],`tx.${s}`))})),["from","to","data"].forEach((s=>{null!=e[s]&&(t[s]=pw(e[s]))})),e.accessList&&(t.accessList=CE(e.accessList)),e.blobVersionedHashes&&(t.blobVersionedHashes=e.blobVersionedHashes.map((e=>e.toLowerCase()))),t}getRpcRequest(e){switch(e.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[tM(e.address),e.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[tM(e.address),e.blockTag]};case"getCode":return{method:"eth_getCode",args:[tM(e.address),e.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[tM(e.address),"0x"+e.position.toString(16),e.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[e.signedTransaction]};case"getBlock":if("blockTag"in e)return{method:"eth_getBlockByNumber",args:[e.blockTag,!!e.includeTransactions]};if("blockHash"in e)return{method:"eth_getBlockByHash",args:[e.blockHash,!!e.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[e.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[e.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(e.transaction),e.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(e.transaction)]};case"getLogs":return e.filter&&null!=e.filter.address&&(Array.isArray(e.filter.address)?e.filter.address=e.filter.address.map(tM):e.filter.address=tM(e.filter.address)),{method:"eth_getLogs",args:[e.filter]}}return null}getRpcError(e,t){const{method:s}=e,{error:i}=t;if("eth_estimateGas"===s&&i.message){const t=i.message;if(!t.match(/revert/i)&&t.match(/insufficient funds/i))return sw("insufficient funds","INSUFFICIENT_FUNDS",{transaction:e.params[0],info:{payload:e,error:i}})}if("eth_call"===s||"eth_estimateGas"===s){const t=oM(i),a=aP.getBuiltinCallException("eth_call"===s?"call":"estimateGas",e.params[0],t?t.data:null);return a.info={error:i,payload:e},a}const a=JSON.stringify(function(e){const t=[];return lM(e,t),t}(i));if("string"==typeof i.message&&i.message.match(/user denied|ethers-user-denied/i))return sw("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[s]||"unknown",reason:"rejected",info:{payload:e,error:i}});if("eth_sendRawTransaction"===s||"eth_sendTransaction"===s){const t=e.params[0];if(a.match(/insufficient funds|base fee exceeds gas limit/i))return sw("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:t,info:{error:i}});if(a.match(/nonce/i)&&a.match(/too low/i))return sw("nonce has already been used","NONCE_EXPIRED",{transaction:t,info:{error:i}});if(a.match(/replacement transaction/i)&&a.match(/underpriced/i))return sw("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:t,info:{error:i}});if(a.match(/only replay-protected/i))return sw("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:s,info:{transaction:t,info:{error:i}}})}let n=!!a.match(/the method .* does not exist/i);return n||i&&i.details&&i.details.startsWith("Unauthorized method:")&&(n=!0),n?sw("unsupported operation","UNSUPPORTED_OPERATION",{operation:e.method,info:{error:i,payload:e}}):sw("could not coalesce error","UNKNOWN_ERROR",{error:i,payload:e})}send(e,t){if(this.destroyed)return Promise.reject(sw("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:e}));const s=Mi(this,zt)._++,i=new Promise(((i,a)=>{Ei(this,Wt).push({resolve:i,reject:a,payload:{method:e,params:t,id:s,jsonrpc:"2.0"}})}));return Ci(this,Jt,Xt).call(this),i}async getSigner(e){null==e&&(e=0);const t=this.send("eth_accounts",[]);if("number"==typeof e){const s=await t;if(e>=s.length)throw new Error("no such account");return new aM(this,s[e])}const{accounts:s}=await Xv({network:this.getNetwork(),accounts:t});e=JA(e);for(const i of s)if(JA(i)===e)return new aM(this,e);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map((e=>new aM(this,e)))}destroy(){Ei(this,Qt)&&(clearTimeout(Ei(this,Qt)),Pi(this,Qt,null));for(const{payload:e,reject:t}of Ei(this,Wt))t(sw("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:e.method}));Pi(this,Wt,[]),super.destroy()}}Ut=new WeakMap,zt=new WeakMap,Wt=new WeakMap,Qt=new WeakMap,qt=new WeakMap,Kt=new WeakMap,Zt=new WeakMap,Jt=new WeakSet,Xt=function(){if(Ei(this,Qt))return;const e=1===this._getOption("batchMaxCount")?0:this._getOption("batchStallTime");Pi(this,Qt,setTimeout((()=>{Pi(this,Qt,null);const e=Ei(this,Wt);for(Pi(this,Wt,[]);e.length;){const t=[e.shift()];for(;e.length&&t.length!==Ei(this,Ut).batchMaxCount;)if(t.push(e.shift()),JSON.stringify(t.map((e=>e.payload))).length>Ei(this,Ut).batchMaxSize){e.unshift(t.pop());break}(async()=>{const e=1===t.length?t[0].payload:t.map((e=>e.payload));this.emit("debug",{action:"sendRpcPayload",payload:e});try{const s=await this._send(e);this.emit("debug",{action:"receiveRpcResult",result:s});for(const{resolve:e,reject:i,payload:a}of t){if(this.destroyed){i(sw("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:a.method}));continue}const t=s.filter((e=>e.id===a.id))[0];if(null!=t)"error"in t?i(this.getRpcError(a,t)):e(t.result);else{const e=sw("missing response for request","BAD_DATA",{value:s,info:{payload:a}});this.emit("error",e),i(e)}}}catch(s){this.emit("debug",{action:"receiveRpcError",error:s});for(const{reject:e}of t)e(s)}})()}}),e))};class rM extends nM{constructor(e,t){super(e,t),Ti(this,$t);let s=this._getOption("pollingInterval");null==s&&(s=iM.pollingInterval),Pi(this,$t,s)}_getSubscriber(e){const t=super._getSubscriber(e);return sM(t)&&(t.pollingInterval=Ei(this,$t)),t}get pollingInterval(){return Ei(this,$t)}set pollingInterval(e){if(!Number.isInteger(e)||e<0)throw new Error("invalid interval");Pi(this,$t,e),this._forEachSubscriber((e=>{sM(e)&&(e.pollingInterval=Ei(this,$t))}))}}function oM(e){if(null==e)return null;if("string"==typeof e.message&&e.message.match(/revert/i)&&hw(e.data))return{message:e.message,data:e.data};if("object"==typeof e){for(const t in e){const s=oM(e[t]);if(s)return s}return null}if("string"==typeof e)try{return oM(JSON.parse(e))}catch(t){}return null}function lM(e,t){if(null!=e){if("string"==typeof e.message&&t.push(e.message),"object"==typeof e)for(const s in e)lM(e[s],t);if("string"==typeof e)try{return lM(JSON.parse(e),t)}catch(s){}}}$t=new WeakMap;class cM extends rM{constructor(e,t,s){const i=Object.assign({},null!=s?s:{},{batchMaxCount:1});aw(e&&e.request,"invalid EIP-1193 provider","ethereum",e),super(t,i),Ti(this,Yt),Pi(this,Yt,(async(t,s)=>{const i={method:t,params:s};this.emit("debug",{action:"sendEip1193Request",payload:i});try{const t=await e.request(i);return this.emit("debug",{action:"receiveEip1193Result",result:t}),t}catch(SD){const t=new Error(SD.message);throw t.code=SD.code,t.data=SD.data,t.payload=i,this.emit("debug",{action:"receiveEip1193Error",error:t}),t}}))}async send(e,t){return await this._start(),await super.send(e,t)}async _send(e){aw(!Array.isArray(e),"EIP-1193 does not support batch request","payload",e);try{const t=await Ei(this,Yt).call(this,e.method,e.params||[]);return[{id:e.id,result:t}]}catch(SD){return[{id:e.id,error:{code:SD.code,data:SD.data,message:SD.message}}]}}getRpcError(e,t){switch((t=JSON.parse(JSON.stringify(t))).error.code||-1){case 4001:t.error.message=`ethers-user-denied: ${t.error.message}`;break;case 4200:t.error.message=`ethers-unsupported: ${t.error.message}`}return super.getRpcError(e,t)}async hasSigner(e){null==e&&(e=0);const t=await this.send("eth_accounts",[]);return"number"==typeof e?t.length>e:(e=e.toLowerCase(),0!==t.filter((t=>t.toLowerCase()===e)).length)}async getSigner(e){if(null==e&&(e=0),!(await this.hasSigner(e)))try{await Ei(this,Yt).call(this,"eth_requestAccounts",[])}catch(t){const e=t.payload;throw this.getRpcError(e,{id:e.id,error:t})}return await super.getSigner(e)}}Yt=new WeakMap;const hM=""+new URL("Vector-L8wVFDDW.png",import.meta.url).href,uM=""+new URL("Flame-BejVHtvN.png",import.meta.url).href,dM=""+new URL("Flame-1-DQvoWNes.png",import.meta.url).href,pM=""+new URL("Flame-2-BpnUaCkv.png",import.meta.url).href,fM=""+new URL("Corner-Frame-3 1-D2BLk6eF.png",import.meta.url).href,mM=""+new URL("Corner-Frame-3 2-BTERBFke.png",import.meta.url).href,gM=""+new URL("Corner-Frame-3 3-CSmT3o1a.png",import.meta.url).href,yM=""+new URL("Corner-Frame-3 4-BcteDHs9.png",import.meta.url).href;function bM(){const{login:e}=Qv(),t=Ng();ga.useEffect((()=>{s()}),[]);const s=async()=>{if(window.ethereum)try{(await window.ethereum.request({method:"eth_accounts"})).length>0&&localStorage.getItem("access_token")&&console.log("already connected")}catch(e){console.error("Error checking wallet connection:",e)}};return Ea.jsxs("div",{className:"login-root",children:[Ea.jsx("img",{src:uM,className:"flame-top",alt:"Flame Top"}),Ea.jsx("img",{src:uM,className:"flame-bottom",style:{transform:"rotate(180deg)"},alt:"Flame Bottom"}),Ea.jsx("img",{src:pM,className:"flame-left",alt:"Flame Left"}),Ea.jsx("img",{src:dM,className:"flame-right",alt:"Flame Right"}),Ea.jsx("img",{src:gM,className:"corner-frame corner-tl",style:{width:"129px",height:"129px"},alt:"Corner TL"}),Ea.jsx("img",{src:yM,className:"corner-frame corner-tr",style:{width:"129px",height:"129px"},alt:"Corner TR"}),Ea.jsx("img",{src:fM,className:"corner-frame corner-bl",style:{width:"129px",height:"129px"},alt:"Corner BL"}),Ea.jsx("img",{src:mM,className:"corner-frame corner-br",style:{width:"129px",height:"129px"},alt:"Corner BR"}),Ea.jsxs("div",{className:"login-box",children:[Ea.jsx("img",{src:hM,alt:"vector",className:"login-vector"}),Ea.jsx("h2",{className:"login-title",children:"Log In or Sign Up"}),Ea.jsxs("button",{onClick:async()=>{if(window.ethereum)try{const s=new cM(window.ethereum),i=await s.getSigner(),a=await i.getAddress(),n="Welcome to the game!\n\nClick to sign in.",r=await i.signMessage(n);await e({walletAddress:a,signature:r,message:n}),console.log("connected"),t("/")}catch(s){console.error("Login failed:",s),alert("Failed to connect wallet. Please try again.")}else alert("No MetaMask Detected")},className:"login-metamask-btn",children:[Ea.jsx("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAZCAYAAAArK+5dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAPpSURBVHgB5VRNbBtFFP529td14jpBdpMmVdcCNYWqTahoJP7sjcS1aoo4cEEVnLgA6SW9IMENQYSUihsH1JwiQKLlUgmJKg4BUXFpWlRESdO6pSRGbuON69jetXeG2d/YqluExAneYfbNzJv3vfe99xb4z8jSm7qBf0lOGQN6qAuhMp0dKh8ckMxcRskTitPDMyvL+Afy+6knDEqJcWndfueH2zaapJaZzZumBzBt7JkEdc66+lBCxEuPq0iowjIFnaWCs5j5sFDo5vTmlJ6UVPkEVyc3G9S4sGrjj4rj3TmETnycL+YlLw3mHGPBI9fg7C8NjA/LY/tT0hmREZjvZwqyTDucN5sElZqkM+a/Of+bBavFonvJIS6wD8CYYPI1uqxYFN+uWt53fFhBwya6LHUCWBzAlaWChcvF1gPZhdY+AMFlgT5gg5/uNPFrycHLB1T0xHimQcXcqEtV4Py1Ou7Wujz0afFqSILtQwvqZjF/pcEdRv2AtQrw+c+Nhzv3o+gAeKS4NPUo26Z9mojxIfmRb6jodyjxF8fsZqRKAo4/FcPogOTR0i6jgzJePRRDryp0e2oezh31fLbNwe5L/DPm6nq/gJEUgZ5QIYu+iapQ9Gh+Mat1KSqyS2GxZuNaieLWhh8FYyw/s7Q+4epSCPDiPnKyXxEW9qcJNH5aa4io212j65CESpDulfHsXgcNjl/YoLiyTk+G9xHAREbShTYeNqsituoEoujvYyrjGfh6dYtwcD8Dh8+VogBxzfECcwN8cpeYe/1LdBaZMJxoj6w/0YLIb+9UJPz4pwra1jAO1y+saXzA/Nqkkp1zQBmbjPy6S/0DXWdgRruRy/lj/CHb6eAGHxS5rWmafCCKhE/yDop0f4tn19munFij/J6ejCjiERnd2N7B087GW8gO1iNKXEknmnj38Ian283una4qHiOnPYByRd7Z3oYWL+5mhUCRGXanbMQ0yulq+88EPt1GKN6TYVkCEr0UmrptIwSqB8DZ/lqEM7uNznjhmPd7qtkSmjxFKjJcNf2eSKkOem0RLUfwiqxpnc59n1gM6PLl9vS+m9yjHu4pc7tFQG+fhmYmi08u3kd++bp3lztyEG+9kIay8g1qd8scgHkNEQp/Wtj70UomyiA4PseXqWBjEtBz8dGJQnXk6BQRSHLXre8x7vjxJOIxtIaPoD7wtBm/+sUZxbyhU6dlsHolGdCTj+gMFYdhTukbNGl5Lb9n5vqif7qKhfnn59S4tJB95oD+3NiIdyry4diyrOX790rHD709Xwh9lD59LddYvTgmCEIE8PejGsh3X312jFEkw33ulTfm8L+QvwAAcJAHVMDC3wAAAABJRU5ErkJggg==",alt:"MetaMask Logo",className:"login-metamask-logo"}),Ea.jsx("p",{className:"login-metamask-text",children:"Connect Metamask"})]})]})]})}const vM="survivor_game_save";function wM(e){try{const t={gold:e.gold||0,passiveUpgrades:e.passiveUpgrades||{},allTimeStats:e.allTimeStats||{totalRuns:0,totalGoldEarned:0,totalEnemiesKilled:0,totalExperienceGained:0,totalDamageDealt:0,highestLevel:1,longestSurvivalTime:0,averageSurvivalTime:0},gameStats:e.gameStats||{totalGoldEarned:0,totalEnemiesKilled:0,totalExperienceGained:0,highestLevel:1,longestSurvivalTime:0},lastRunStats:e.lastRunStats||null,savedAt:(new Date).toISOString(),version:"1.0"};return localStorage.setItem(vM,JSON.stringify(t)),console.log("Game data saved to local storage"),!0}catch(t){return console.error("Error saving to local storage:",t),!1}}function xM(){try{const e=localStorage.getItem(vM);if(!e)return console.log("No saved data found in local storage"),null;const t=JSON.parse(e);return console.log("Game data loaded from local storage:",t),t}catch(e){return console.error("Error loading from local storage:",e),null}}const kM=new Ri.Events.EventEmitter;"undefined"!=typeof window&&(window.EventBus=kM);const AM=async()=>{try{return(await jv.get("/scores/global")).data}catch(e){throw console.error("Failed to get global scores:",e),e}},SM=async()=>{try{return(await jv.get("/scores/global")).data}catch(e){throw console.error("Failed to get global kill counts:",e),e}},EM=async()=>{try{return(await jv.get("/profile")).data}catch(e){throw console.error("Failed to get user profile:",e),e}},TM=async()=>{try{return(await jv.get("/my/upgrades")).data}catch(e){throw console.error("Failed to get upgrades:",e),e}},PM=async e=>{try{return(await jv.post("/user/upgrade",{statId:e})).data}catch(t){throw console.error("Failed to buy upgrade:",t),t}},CM=async e=>{try{return(await jv.post("/session",e)).data}catch(t){throw console.error("Failed to start game session:",t),t}},MM=async e=>{try{return(await jv.post("/session/checkpoint",e)).data}catch(t){throw console.error("Failed to save checkpoint:",t),t}},BM=async e=>{try{return(await jv.post("/session/end",e)).data}catch(t){throw console.error("Failed to end game session:",t),t}},RM=class e{constructor(){if(e.instance)return e.instance;e.instance=this,this.backendUpgrades=null,this.isLoaded=!1}static getInstance(){return e.instance||(e.instance=new e),e.instance}async loadBackendUpgrades(){if(!localStorage.getItem("access_token"))return console.log("[BackendStatsManager] No auth token, skipping backend upgrades"),this.backendUpgrades={},this.isLoaded=!1,{};try{console.log("[BackendStatsManager] Loading backend upgrades...");const e=await TM(),t=e.data||e;return this.backendUpgrades=this.convertBackendUpgrades(t),this.isLoaded=!0,console.log("[BackendStatsManager] Backend upgrades loaded:",this.backendUpgrades),this.backendUpgrades}catch(e){return console.error("[BackendStatsManager] Failed to load backend upgrades:",e),this.backendUpgrades={},this.isLoaded=!1,{}}}convertBackendUpgrades(e){const t={};return Array.isArray(e)?(e.forEach((e=>{const{type:s,level:i}=e;switch(s){case"MAX_HEALTH":t.maxHealthBonus=20*i;break;case"DAMAGE_BOOST":t.damageBonus=5*i;break;case"MOVESPEED":t.moveSpeedBonus=10*i;break;case"COOLDOWN_REDUCTION":t.cooldownReduction=Math.min(.05*i,.5);break;case"ATTACK_RANGE":t.attackRangeBonus=15*i;break;case"PICKUP_RADIUS":t.pickupRangeBonus=10*i;break;case"HP_REGEN":t.hpRegenBonus=1*i;break;default:console.warn(`[BackendStatsManager] Unknown upgrade type: ${s}`)}})),t):(console.warn("[BackendStatsManager] Invalid backend upgrades format"),{})}applyBackendUpgradesToPlayer(e){var t,s;if(!e||!this.backendUpgrades||!this.isLoaded)return void console.log("[BackendStatsManager] Cannot apply upgrades - missing data");console.log("[BackendStatsManager] Applying backend upgrades to player...");const i=this.backendUpgrades;if(i.maxHealthBonus){const t=e.maxHealth;e.maxHealth=100+i.maxHealthBonus,e.health=e.maxHealth,console.log(`[BackendStatsManager] Applied health: ${t} -> ${e.maxHealth}`)}if(i.damageBonus){const t=e.damage;e.damage=10+i.damageBonus,console.log(`[BackendStatsManager] Applied damage: ${t} -> ${e.damage}`)}if(i.moveSpeedBonus){const t=e.moveSpeed;e.moveSpeed=150+i.moveSpeedBonus,console.log(`[BackendStatsManager] Applied speed: ${t} -> ${e.moveSpeed}`)}if(i.attackRangeBonus){const t=e.attackRange;e.attackRange=100+i.attackRangeBonus,console.log(`[BackendStatsManager] Applied range: ${t} -> ${e.attackRange}`)}if(i.pickupRangeBonus){const t=e.pickupRange;e.pickupRange=50+i.pickupRangeBonus,console.log(`[BackendStatsManager] Applied pickup: ${t} -> ${e.pickupRange}`)}if(i.cooldownReduction&&e.fireRate){const t=e.fireRate;e.fireRate=e.fireRate*(1+i.cooldownReduction),console.log(`[BackendStatsManager] Applied fire rate: ${t} -> ${e.fireRate}`)}i.hpRegenBonus&&(e.hpRegenRate=i.hpRegenBonus,console.log(`[BackendStatsManager] Set HP regen rate: ${e.hpRegenRate}/sec`)),(null==(s=null==(t=e.scene)?void 0:t.playerAttackSystem)?void 0:s.updateStats)&&e.scene.playerAttackSystem.updateStats(),console.log("[BackendStatsManager] Backend upgrades applied successfully")}getBackendUpgrades(){return this.backendUpgrades||{}}isBackendUpgradesLoaded(){return this.isLoaded}};Ai(RM,"instance",null);let DM=RM;const NM={maxHealth:{base:100,perLevel:20,baseCost:100,multiplier:1.5,maxLevel:15},baseDamage:{base:10,perLevel:2,baseCost:150,multiplier:1.6,maxLevel:15},moveSpeed:{base:200,perLevel:15,baseCost:125,multiplier:1.4,maxLevel:12},attackSpeed:{base:1,perLevel:.1,baseCost:175,multiplier:1.7,maxLevel:10},critChance:{base:5,perLevel:2,baseCost:200,multiplier:1.8,maxLevel:10},critDamage:{base:150,perLevel:25,baseCost:250,multiplier:1.9,maxLevel:8},pickupRange:{base:50,perLevel:10,baseCost:120,multiplier:1.3,maxLevel:12},armor:{base:0,perLevel:2,baseCost:180,multiplier:1.6,maxLevel:10},expMultiplier:{base:100,perLevel:10,baseCost:300,multiplier:2,maxLevel:8},goldMultiplier:{base:100,perLevel:20,baseCost:350,multiplier:2.2,maxLevel:8}},_M=class e{constructor(){if(e.instance)return e.instance;e.instance=this,this.gold=500,this.passiveUpgrades={},this.isGameRunning=!1,this.gameStartTime=0,this.debugMode=!1,this.playerStats=this.getBasePlayerStats(),this.currentRunStats=this.getEmptyRunStats(),this.lastRunStats=null,this.allTimeStats=this.getEmptyAllTimeStats(),this.gameProgress=this.getBaseGameProgress(),this.events=new Phaser.Events.EventEmitter,this.currentScene=null,this.backendStatsManager=DM.getInstance(),this.loadingBackendUpgrades=!1,this.loadGame(),this.applyPassiveUpgrades(),this.loadBackendUpgradesAsync(),kM.on("upgrade-purchased",(()=>{console.log("GameManager: Upgrade purchased, refreshing backend upgrades..."),this.loadBackendUpgradesAsync()}))}static get(){return e.instance||new e}async loadBackendUpgradesAsync(){var e;if(!this.loadingBackendUpgrades){this.loadingBackendUpgrades=!0;try{await this.backendStatsManager.loadBackendUpgrades(),console.log("GameManager: Backend upgrades loaded in background"),(null==(e=this.currentScene)?void 0:e.player)&&this.applyPlayerStats(this.currentScene.player)}catch(t){console.warn("GameManager: Failed to load backend upgrades in background:",t)}finally{this.loadingBackendUpgrades=!1}}}getBasePlayerStats(){return{level:1,experience:0,nextLevelExp:100,maxHealth:100,health:100,damage:10,moveSpeed:100,fireRate:1,attackRange:80}}getEmptyRunStats(){return{survivalTime:0,maxLevel:1,enemiesKilled:0,goldEarned:0,experienceGained:0,damageDealt:0,damageTaken:0,causeOfDeath:null}}getEmptyAllTimeStats(){return{totalRuns:0,totalGoldEarned:0,totalEnemiesKilled:0,totalExperienceGained:0,totalDamageDealt:0,highestLevel:1,longestSurvivalTime:0,averageSurvivalTime:0}}getBaseGameProgress(){return{gameTime:0,currentDifficulty:1,maxEnemies:30,enemySpawnDelay:3e3}}purchaseUpgrade(e,t){var s;if(this.gold<t)return!1;if(!NM[e])return!1;const i=NM[e],a=(null==(s=this.passiveUpgrades[e])?void 0:s.level)||0;if(a>=i.maxLevel)return!1;this.gold-=t;const n=a+1,r=i.base+i.perLevel*n;return this.passiveUpgrades[e]={level:n,value:r},this.saveGame(),this.emitStateUpdate(),console.log(`Purchased ${e} for ${t} gold. New level: ${n}`),console.log(`Remaining gold: ${this.gold}`),kM.emit("game-state-updated"),!0}resetProgress(){return this.gold=0,this.passiveUpgrades={},this.currentRunStats=this.getEmptyRunStats(),this.lastRunStats=null,this.allTimeStats=this.getEmptyAllTimeStats(),this.playerStats=this.getBasePlayerStats(),function(e=500){try{const t={gold:e,passiveUpgrades:{},allTimeStats:{totalRuns:0,totalGoldEarned:0,totalEnemiesKilled:0,totalExperienceGained:0,totalDamageDealt:0,highestLevel:1,longestSurvivalTime:0,averageSurvivalTime:0},gameStats:{totalGoldEarned:0,totalEnemiesKilled:0,totalExperienceGained:0,highestLevel:1,longestSurvivalTime:0},lastRunStats:null,savedAt:(new Date).toISOString(),version:"1.0"};return localStorage.setItem(vM,JSON.stringify(t)),console.log("Progress reset successfully with",e,"starting gold"),!0}catch(t){return console.error("Error resetting progress:",t),!1}}(0),this.emitStateUpdate(),!0}startNewRun(){this.isGameRunning=!0,this.gameStartTime=Date.now(),this.currentRunStats=this.getEmptyRunStats(),this.playerStats=this.getBasePlayerStats(),this.gameProgress=this.getBaseGameProgress(),this.loadBackendUpgradesAsync(),this.applyPassiveUpgrades();const e={gold:this.gold,totalGold:this.gold,currentGold:this.gold};kM.emit("player-gold-updated",e),kM.emit("player-stats-updated",e)}handlePlayerDeath(e="Unknown"){if(!this.isGameRunning)return;console.log(`GameManager: handlePlayerDeath called with cause: ${e}`),this.isGameRunning=!1;const t=Math.floor((Date.now()-this.gameStartTime)/1e3);this.currentRunStats.survivalTime=t,this.currentRunStats.causeOfDeath=e,this.lastRunStats={...this.currentRunStats},this.updateAllTimeStats(t),this.saveGame(),kM.emit("player-died",this.lastRunStats),window.dispatchEvent(new CustomEvent("playerDeath",{detail:this.lastRunStats}))}updateAllTimeStats(e){this.allTimeStats.totalRuns++,this.allTimeStats.totalGoldEarned+=this.currentRunStats.goldEarned,this.allTimeStats.totalEnemiesKilled+=this.currentRunStats.enemiesKilled,this.allTimeStats.totalExperienceGained+=this.currentRunStats.experienceGained,this.allTimeStats.totalDamageDealt+=this.currentRunStats.damageDealt,this.currentRunStats.maxLevel>this.allTimeStats.highestLevel&&(this.allTimeStats.highestLevel=this.currentRunStats.maxLevel),e>this.allTimeStats.longestSurvivalTime&&(this.allTimeStats.longestSurvivalTime=e),this.allTimeStats.averageSurvivalTime=Math.floor((this.allTimeStats.longestSurvivalTime+e)/this.allTimeStats.totalRuns)}applyPlayerStats(e){if(!e)return void console.warn("GameManager: No player provided to applyPlayerStats");console.log("GameManager: Applying player stats...");const t=this.getBasePlayerStats();if(e.maxHealth=t.maxHealth,e.health=t.health,e.damage=t.damage,e.moveSpeed=t.moveSpeed,e.fireRate=t.fireRate,e.attackRange=t.attackRange,this.passiveUpgrades&&Object.keys(this.passiveUpgrades).length>0?(console.log("GameManager: Applying local upgrades..."),Object.entries(this.passiveUpgrades).forEach((([t,s])=>{switch(console.log(`GameManager: Applying ${t}:`,s),t){case"maxHealth":e.maxHealth=s.value,e.health=s.value,console.log(`GameManager: Applied maxHealth - now ${e.health}/${e.maxHealth}`);break;case"baseDamage":e.damage=s.value,console.log(`GameManager: Applied damage - now ${e.damage}`);break;case"moveSpeed":e.moveSpeed=s.value,console.log(`GameManager: Applied moveSpeed - now ${e.moveSpeed}`);break;case"attackSpeed":e.fireRate=s.value;break;case"armor":e.armor=s.value;break;case"critChance":e.critChance=s.value/100;break;case"critDamage":e.critDamage=s.value/100;break;case"pickupRange":e.pickupRange=s.value}}))):console.log("GameManager: No local upgrades to apply"),this.backendStatsManager.isBackendUpgradesLoaded())try{this.backendStatsManager.applyBackendUpgradesToPlayer(e),console.log("GameManager: Backend upgrades applied successfully")}catch(s){console.warn("GameManager: Failed to apply backend upgrades:",s)}else console.log("GameManager: Backend upgrades not loaded yet, will apply when ready");this.playerStats.maxHealth=e.maxHealth,this.playerStats.health=e.health,this.playerStats.damage=e.damage,this.playerStats.moveSpeed=e.moveSpeed,this.playerStats.fireRate=e.fireRate,this.playerStats.attackRange=e.attackRange,console.log("GameManager: Final player stats applied:",{maxHealth:e.maxHealth,damage:e.damage,moveSpeed:e.moveSpeed,fireRate:e.fireRate,attackRange:e.attackRange})}applyPassiveUpgrades(){Object.entries(this.passiveUpgrades).forEach((([e,t])=>{switch(e){case"maxHealth":this.playerStats.maxHealth=t.value,this.playerStats.health=t.value;break;case"baseDamage":this.playerStats.damage=t.value;break;case"moveSpeed":this.playerStats.moveSpeed=t.value;break;case"attackSpeed":this.playerStats.fireRate=t.value}}))}addExperience(e){const t=this.getMultiplier("expMultiplier"),s=Math.floor(e*t);return this.playerStats.experience+=s,this.isGameRunning&&(this.currentRunStats.experienceGained+=s),this.playerStats.experience>=this.playerStats.nextLevelExp?(this.levelUp(),!0):(this.events.emit("experienceUpdated",this.playerStats.experience,this.playerStats.nextLevelExp),!1)}levelUp(){this.playerStats.level++,this.isGameRunning&&(this.currentRunStats.maxLevel=Math.max(this.currentRunStats.maxLevel,this.playerStats.level));const e=this.playerStats.experience-this.playerStats.nextLevelExp;this.playerStats.nextLevelExp=Math.floor(1.2*this.playerStats.nextLevelExp),this.playerStats.experience=e,this.events.emit("levelUp",this.playerStats.level)}addEnemyKill(){this.isGameRunning&&this.currentRunStats.enemiesKilled++}addGold(e){var t;const s=this.getMultiplier("goldMultiplier"),i=Math.floor(e*s);this.gold+=i,this.isGameRunning&&(this.currentRunStats.goldEarned+=i);const a={gold:this.gold,goldEarned:i,totalGold:this.gold};kM.emit("player-gold-updated",a),kM.emit("player-stats-updated",{gold:this.gold,currentGold:this.gold}),window.dispatchEvent(new CustomEvent("playerGoldUpdated",{detail:a})),console.log(`Player gained ${i} gold. Total: ${this.gold}`),(null==(t=this.currentScene)?void 0:t.uiManager)&&this.currentScene.uiManager.updateScoreboard()}getGold(){return this.gold}addDamageDealt(e){this.isGameRunning&&(this.currentRunStats.damageDealt+=e)}updateDifficulty(e){this.gameProgress.gameTime+=e/1e3;const t=1+Math.floor(this.gameProgress.gameTime/60);t!==this.gameProgress.currentDifficulty&&(this.gameProgress.currentDifficulty=t,this.gameProgress.maxEnemies=Math.min(60,30+3*(t-1)),this.gameProgress.enemySpawnDelay=Math.max(100,3e3-300*(t-1)),this.events.emit("difficultyUpdated",t))}getMultiplier(e){return this.passiveUpgrades[e]?this.passiveUpgrades[e].value/100:1}getCurrentSurvivalTime(){return this.isGameRunning?Math.floor((Date.now()-this.gameStartTime)/1e3):0}formatTime(e){return`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`}formatNumber(e){return e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString()}toggleDebugMode(){return this.debugMode=!this.debugMode,this.debugMode}emitStateUpdate(){window.dispatchEvent(new CustomEvent("gameStateUpdated",{detail:{gold:this.gold,passiveUpgrades:this.passiveUpgrades,allTimeStats:this.allTimeStats,lastRunStats:this.lastRunStats,currentRunStats:this.currentRunStats}}))}saveGame(){wM({gold:this.gold,passiveUpgrades:this.passiveUpgrades,allTimeStats:this.allTimeStats,lastRunStats:this.lastRunStats})}loadGame(){const e=xM();e&&(this.gold=e.gold||500,this.passiveUpgrades=e.passiveUpgrades||{},this.allTimeStats=e.allTimeStats||this.getEmptyAllTimeStats(),this.lastRunStats=e.lastRunStats||null)}setCurrentScene(e){this.currentScene=e}};Ai(_M,"instance",null);let FM=_M;const OM=ga.createContext(),LM=()=>{const e=ga.useContext(OM);if(!e)throw new Error("useGame must be used within a GameProvider");return e},IM=({children:e})=>{const[t]=ga.useState((()=>new FM));console.log("gameManager",t);const[s,i]=ga.useState(!1),[a,n]=ga.useState(null);ga.useEffect((()=>{const e=()=>{var e,s;const i=(null==(s=null==(e=window.game)?void 0:e.registry)?void 0:s.get("gameManager"))||null;i&&!t&&(console.log("GameManager found and initialized"),setGameManager(i),r(i))};e();const s=setInterval(e,1e3);return()=>clearInterval(s)}),[t]);const r=e=>{try{const t=xM();t&&e&&(e.gold=t.gold||500,e.passiveUpgrades={...t.passiveUpgrades||{}},e.allTimeStats={...t.allTimeStats||{}},console.log("Saved data loaded into GameManager"))}catch(t){console.error("Error loading saved data:",t)}},o=()=>{if(t)try{t.saveGame&&t.saveGame(),wM({gold:t.gold||0,passiveUpgrades:t.passiveUpgrades||{},allTimeStats:t.allTimeStats||{}}),console.log("Game data saved")}catch(e){console.error("Error saving game data:",e)}},l=()=>{if(a)return a;let e=document.getElementById("phaser-game-container");if(!e){e=document.createElement("div"),e.id="phaser-game-container",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.zIndex="1",document.body.appendChild(e);const t=document.querySelector("canvas");t&&t.parentNode!==e&&(e.appendChild(t),console.log("Canvas moved to game container"))}return n(e),e},c=()=>{try{window.game.scene.getScenes(!0).forEach((e=>{"MainMapScene"!==e.scene.key&&window.game.scene.pause(e.scene.key)})),console.log("All scenes cleaned up")}catch(e){console.error("Error cleaning up scenes:",e)}},h={gameManager:t,isGameInitialized:s,startGameScene:()=>{var e;if(!(null==(e=window.game)?void 0:e.scene))return console.error("Game or scene manager not available!"),!1;try{return(null==t?void 0:t.applyPassiveUpgrades)&&t.applyPassiveUpgrades(),o(),l(),c(),window.game.scene.getScene("MainMapScene")?(window.game.scene.stop("MainMapScene"),setTimeout((()=>{window.game.scene.start("MainMapScene"),console.log("MainMapScene started fresh")}),100),!0):(console.error("MainMapScene not found!"),!1)}catch(s){return console.error("Error starting game scene:",s),!1}},stopGame:()=>{try{o(),c(),console.log("Game stopped and cleaned up")}catch(e){console.error("Error stopping game:",e)}},saveGameData:o,initializeGameContainer:l};return Ea.jsx(OM.Provider,{value:h,children:e})};var jM=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},HM="undefined"==typeof window||"Deno"in globalThis;function VM(){}function GM(e){return"number"==typeof e&&e>=0&&e!==1/0}function UM(e,t){return Math.max(e+(t||0)-Date.now(),0)}function zM(e,t){return"function"==typeof e?e(t):e}function WM(e,t){return"function"==typeof e?e(t):e}function QM(e,t){const{type:s="all",exact:i,fetchStatus:a,predicate:n,queryKey:r,stale:o}=e;if(r)if(i){if(t.queryHash!==KM(r,t.options))return!1}else if(!JM(t.queryKey,r))return!1;if("all"!==s){const e=t.isActive();if("active"===s&&!e)return!1;if("inactive"===s&&e)return!1}return!("boolean"==typeof o&&t.isStale()!==o||a&&a!==t.state.fetchStatus||n&&!n(t))}function qM(e,t){const{exact:s,status:i,predicate:a,mutationKey:n}=e;if(n){if(!t.options.mutationKey)return!1;if(s){if(ZM(t.options.mutationKey)!==ZM(n))return!1}else if(!JM(t.options.mutationKey,n))return!1}return!(i&&t.state.status!==i||a&&!a(t))}function KM(e,t){return((null==t?void 0:t.queryKeyHashFn)||ZM)(e)}function ZM(e){return JSON.stringify(e,((e,t)=>eB(t)?Object.keys(t).sort().reduce(((e,s)=>(e[s]=t[s],e)),{}):t))}function JM(e,t){return e===t||typeof e==typeof t&&!(!e||!t||"object"!=typeof e||"object"!=typeof t)&&Object.keys(t).every((s=>JM(e[s],t[s])))}function XM(e,t){if(e===t)return e;const s=YM(e)&&YM(t);if(s||eB(e)&&eB(t)){const i=s?e:Object.keys(e),a=i.length,n=s?t:Object.keys(t),r=n.length,o=s?[]:{},l=new Set(i);let c=0;for(let h=0;h<r;h++){const i=s?h:n[h];(!s&&l.has(i)||s)&&void 0===e[i]&&void 0===t[i]?(o[i]=void 0,c++):(o[i]=XM(e[i],t[i]),o[i]===e[i]&&void 0!==e[i]&&c++)}return a===r&&c===a?e:o}return t}function $M(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}function YM(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function eB(e){if(!tB(e))return!1;const t=e.constructor;if(void 0===t)return!0;const s=t.prototype;return!!tB(s)&&!!s.hasOwnProperty("isPrototypeOf")&&Object.getPrototypeOf(e)===Object.prototype}function tB(e){return"[object Object]"===Object.prototype.toString.call(e)}function sB(e,t,s){return"function"==typeof s.structuralSharing?s.structuralSharing(e,t):!1!==s.structuralSharing?XM(e,t):t}function iB(e,t,s=0){const i=[...e,t];return s&&i.length>s?i.slice(1):i}function aB(e,t,s=0){const i=[t,...e];return s&&i.length>s?i.slice(0,-1):i}var nB=Symbol();function rB(e,t){return!e.queryFn&&(null==t?void 0:t.initialPromise)?()=>t.initialPromise:e.queryFn&&e.queryFn!==nB?e.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`))}function oB(e,t){return"function"==typeof e?e(...t):!!e}var lB=new(is=class extends jM{constructor(){super(),Ti(this,es),Ti(this,ts),Ti(this,ss),Pi(this,ss,(e=>{if(!HM&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}))}onSubscribe(){Ei(this,ts)||this.setEventListener(Ei(this,ss))}onUnsubscribe(){var e;this.hasListeners()||(null==(e=Ei(this,ts))||e.call(this),Pi(this,ts,void 0))}setEventListener(e){var t;Pi(this,ss,e),null==(t=Ei(this,ts))||t.call(this),Pi(this,ts,e((e=>{"boolean"==typeof e?this.setFocused(e):this.onFocus()})))}setFocused(e){Ei(this,es)!==e&&(Pi(this,es,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach((t=>{t(e)}))}isFocused(){var e;return"boolean"==typeof Ei(this,es)?Ei(this,es):"hidden"!==(null==(e=globalThis.document)?void 0:e.visibilityState)}},es=new WeakMap,ts=new WeakMap,ss=new WeakMap,is),cB=new(os=class extends jM{constructor(){super(),Ti(this,as,!0),Ti(this,ns),Ti(this,rs),Pi(this,rs,(e=>{if(!HM&&window.addEventListener){const t=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",s)}}}))}onSubscribe(){Ei(this,ns)||this.setEventListener(Ei(this,rs))}onUnsubscribe(){var e;this.hasListeners()||(null==(e=Ei(this,ns))||e.call(this),Pi(this,ns,void 0))}setEventListener(e){var t;Pi(this,rs,e),null==(t=Ei(this,ns))||t.call(this),Pi(this,ns,e(this.setOnline.bind(this)))}setOnline(e){Ei(this,as)!==e&&(Pi(this,as,e),this.listeners.forEach((t=>{t(e)})))}isOnline(){return Ei(this,as)}},as=new WeakMap,ns=new WeakMap,rs=new WeakMap,os);function hB(){let e,t;const s=new Promise(((s,i)=>{e=s,t=i}));function i(e){Object.assign(s,e),delete s.resolve,delete s.reject}return s.status="pending",s.catch((()=>{})),s.resolve=t=>{i({status:"fulfilled",value:t}),e(t)},s.reject=e=>{i({status:"rejected",reason:e}),t(e)},s}function uB(e){return Math.min(1e3*2**e,3e4)}function dB(e){return"online"!==(e??"online")||cB.isOnline()}var pB=class extends Error{constructor(e){super("CancelledError"),this.revert=null==e?void 0:e.revert,this.silent=null==e?void 0:e.silent}};function fB(e){return e instanceof pB}function mB(e){let t,s=!1,i=0,a=!1;const n=hB(),r=()=>lB.isFocused()&&("always"===e.networkMode||cB.isOnline())&&e.canRun(),o=()=>dB(e.networkMode)&&e.canRun(),l=s=>{var i;a||(a=!0,null==(i=e.onSuccess)||i.call(e,s),null==t||t(),n.resolve(s))},c=s=>{var i;a||(a=!0,null==(i=e.onError)||i.call(e,s),null==t||t(),n.reject(s))},h=()=>new Promise((s=>{var i;t=e=>{(a||r())&&s(e)},null==(i=e.onPause)||i.call(e)})).then((()=>{var s;t=void 0,a||null==(s=e.onContinue)||s.call(e)})),u=()=>{if(a)return;let t;const n=0===i?e.initialPromise:void 0;try{t=n??e.fn()}catch(o){t=Promise.reject(o)}Promise.resolve(t).then(l).catch((t=>{var n;if(a)return;const o=e.retry??(HM?0:3),l=e.retryDelay??uB,d="function"==typeof l?l(i,t):l,p=!0===o||"number"==typeof o&&i<o||"function"==typeof o&&o(i,t);var f;!s&&p?(i++,null==(n=e.onFail)||n.call(e,i,t),(f=d,new Promise((e=>{setTimeout(e,f)}))).then((()=>r()?void 0:h())).then((()=>{s?c(t):u()}))):c(t)}))};return{promise:n,cancel:t=>{var s;a||(c(new pB(t)),null==(s=e.abort)||s.call(e))},continue:()=>(null==t||t(),n),cancelRetry:()=>{s=!0},continueRetry:()=>{s=!1},canStart:o,start:()=>(o()?u():h().then(u),n)}}var gB=e=>setTimeout(e,0),yB=function(){let e=[],t=0,s=e=>{e()},i=e=>{e()},a=gB;const n=i=>{t?e.push(i):a((()=>{s(i)}))};return{batch:n=>{let r;t++;try{r=n()}finally{t--,t||(()=>{const t=e;e=[],t.length&&a((()=>{i((()=>{t.forEach((e=>{s(e)}))}))}))})()}return r},batchCalls:e=>(...t)=>{n((()=>{e(...t)}))},schedule:n,setNotifyFunction:e=>{s=e},setBatchNotifyFunction:e=>{i=e},setScheduler:e=>{a=e}}}(),bB=(cs=class{constructor(){Ti(this,ls)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),GM(this.gcTime)&&Pi(this,ls,setTimeout((()=>{this.optionalRemove()}),this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(HM?1/0:3e5))}clearGcTimeout(){Ei(this,ls)&&(clearTimeout(Ei(this,ls)),Pi(this,ls,void 0))}},ls=new WeakMap,cs),vB=(vs=class extends bB{constructor(e){super(),Ti(this,ys),Ti(this,hs),Ti(this,us),Ti(this,ds),Ti(this,ps),Ti(this,fs),Ti(this,ms),Ti(this,gs),Pi(this,gs,!1),Pi(this,ms,e.defaultOptions),this.setOptions(e.options),this.observers=[],Pi(this,ps,e.client),Pi(this,ds,Ei(this,ps).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,Pi(this,hs,function(e){const t="function"==typeof e.initialData?e.initialData():e.initialData,s=void 0!==t,i=s?"function"==typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:s?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}(this.options)),this.state=e.state??Ei(this,hs),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return null==(e=Ei(this,fs))?void 0:e.promise}setOptions(e){this.options={...Ei(this,ms),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){this.observers.length||"idle"!==this.state.fetchStatus||Ei(this,ds).remove(this)}setData(e,t){const s=sB(this.state.data,e,this.options);return Ci(this,ys,bs).call(this,{data:s,type:"success",dataUpdatedAt:null==t?void 0:t.updatedAt,manual:null==t?void 0:t.manual}),s}setState(e,t){Ci(this,ys,bs).call(this,{type:"setState",state:e,setStateOptions:t})}cancel(e){var t,s;const i=null==(t=Ei(this,fs))?void 0:t.promise;return null==(s=Ei(this,fs))||s.cancel(e),i?i.then(VM).catch(VM):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Ei(this,hs))}isActive(){return this.observers.some((e=>!1!==WM(e.options.enabled,this)))}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===nB||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0&&this.observers.some((e=>"static"===zM(e.options.staleTime,this)))}isStale(){return this.getObserversCount()>0?this.observers.some((e=>e.getCurrentResult().isStale)):void 0===this.state.data||this.state.isInvalidated}isStaleByTime(e=0){return void 0===this.state.data||"static"!==e&&(!!this.state.isInvalidated||!UM(this.state.dataUpdatedAt,e))}onFocus(){var e;const t=this.observers.find((e=>e.shouldFetchOnWindowFocus()));null==t||t.refetch({cancelRefetch:!1}),null==(e=Ei(this,fs))||e.continue()}onOnline(){var e;const t=this.observers.find((e=>e.shouldFetchOnReconnect()));null==t||t.refetch({cancelRefetch:!1}),null==(e=Ei(this,fs))||e.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),Ei(this,ds).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter((t=>t!==e)),this.observers.length||(Ei(this,fs)&&(Ei(this,gs)?Ei(this,fs).cancel({revert:!0}):Ei(this,fs).cancelRetry()),this.scheduleGc()),Ei(this,ds).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ci(this,ys,bs).call(this,{type:"invalidate"})}fetch(e,t){var s,i,a;if("idle"!==this.state.fetchStatus)if(void 0!==this.state.data&&(null==t?void 0:t.cancelRefetch))this.cancel({silent:!0});else if(Ei(this,fs))return Ei(this,fs).continueRetry(),Ei(this,fs).promise;if(e&&this.setOptions(e),!this.options.queryFn){const e=this.observers.find((e=>e.options.queryFn));e&&this.setOptions(e.options)}const n=new AbortController,r=e=>{Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(Pi(this,gs,!0),n.signal)})},o=()=>{const e=rB(this.options,t),s=(()=>{const e={client:Ei(this,ps),queryKey:this.queryKey,meta:this.meta};return r(e),e})();return Pi(this,gs,!1),this.options.persister?this.options.persister(e,s,this):e(s)},l=(()=>{const e={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:Ei(this,ps),state:this.state,fetchFn:o};return r(e),e})();null==(s=this.options.behavior)||s.onFetch(l,this),Pi(this,us,this.state),"idle"!==this.state.fetchStatus&&this.state.fetchMeta===(null==(i=l.fetchOptions)?void 0:i.meta)||Ci(this,ys,bs).call(this,{type:"fetch",meta:null==(a=l.fetchOptions)?void 0:a.meta});const c=e=>{var t,s,i,a;fB(e)&&e.silent||Ci(this,ys,bs).call(this,{type:"error",error:e}),fB(e)||(null==(s=(t=Ei(this,ds).config).onError)||s.call(t,e,this),null==(a=(i=Ei(this,ds).config).onSettled)||a.call(i,this.state.data,e,this)),this.scheduleGc()};return Pi(this,fs,mB({initialPromise:null==t?void 0:t.initialPromise,fn:l.fetchFn,abort:n.abort.bind(n),onSuccess:e=>{var t,s,i,a;if(void 0!==e){try{this.setData(e)}catch(n){return void c(n)}null==(s=(t=Ei(this,ds).config).onSuccess)||s.call(t,e,this),null==(a=(i=Ei(this,ds).config).onSettled)||a.call(i,e,this.state.error,this),this.scheduleGc()}else c(new Error(`${this.queryHash} data is undefined`))},onError:c,onFail:(e,t)=>{Ci(this,ys,bs).call(this,{type:"failed",failureCount:e,error:t})},onPause:()=>{Ci(this,ys,bs).call(this,{type:"pause"})},onContinue:()=>{Ci(this,ys,bs).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0})),Ei(this,fs).start()}},hs=new WeakMap,us=new WeakMap,ds=new WeakMap,ps=new WeakMap,fs=new WeakMap,ms=new WeakMap,gs=new WeakMap,ys=new WeakSet,bs=function(e){this.state=(t=>{switch(e.type){case"failed":return{...t,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...wB(t.data,this.options),fetchMeta:e.meta??null};case"success":return Pi(this,us,void 0),{...t,data:e.data,dataUpdateCount:t.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=e.error;return fB(s)&&s.revert&&Ei(this,us)?{...Ei(this,us),fetchStatus:"idle"}:{...t,error:s,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...e.state}}})(this.state),yB.batch((()=>{this.observers.forEach((e=>{e.onQueryUpdate()})),Ei(this,ds).notify({query:this,type:"updated",action:e})}))},vs);function wB(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:dB(t.networkMode)?"fetching":"paused",...void 0===e&&{error:null,status:"pending"}}}var xB=(xs=class extends jM{constructor(e={}){super(),Ti(this,ws),this.config=e,Pi(this,ws,new Map)}build(e,t,s){const i=t.queryKey,a=t.queryHash??KM(i,t);let n=this.get(a);return n||(n=new vB({client:e,queryKey:i,queryHash:a,options:e.defaultQueryOptions(t),state:s,defaultOptions:e.getQueryDefaults(i)}),this.add(n)),n}add(e){Ei(this,ws).has(e.queryHash)||(Ei(this,ws).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=Ei(this,ws).get(e.queryHash);t&&(e.destroy(),t===e&&Ei(this,ws).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){yB.batch((()=>{this.getAll().forEach((e=>{this.remove(e)}))}))}get(e){return Ei(this,ws).get(e)}getAll(){return[...Ei(this,ws).values()]}find(e){const t={exact:!0,...e};return this.getAll().find((e=>QM(t,e)))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter((t=>QM(e,t))):t}notify(e){yB.batch((()=>{this.listeners.forEach((t=>{t(e)}))}))}onFocus(){yB.batch((()=>{this.getAll().forEach((e=>{e.onFocus()}))}))}onOnline(){yB.batch((()=>{this.getAll().forEach((e=>{e.onOnline()}))}))}},ws=new WeakMap,xs),kB=(Ps=class extends bB{constructor(e){super(),Ti(this,Es),Ti(this,ks),Ti(this,As),Ti(this,Ss),this.mutationId=e.mutationId,Pi(this,As,e.mutationCache),Pi(this,ks,[]),this.state=e.state||{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0},this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){Ei(this,ks).includes(e)||(Ei(this,ks).push(e),this.clearGcTimeout(),Ei(this,As).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){Pi(this,ks,Ei(this,ks).filter((t=>t!==e))),this.scheduleGc(),Ei(this,As).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){Ei(this,ks).length||("pending"===this.state.status?this.scheduleGc():Ei(this,As).remove(this))}continue(){var e;return(null==(e=Ei(this,Ss))?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var t,s,i,a,n,r,o,l,c,h,u,d,p,f,m,g,y,b,v,w;const x=()=>{Ci(this,Es,Ts).call(this,{type:"continue"})};Pi(this,Ss,mB({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(e,t)=>{Ci(this,Es,Ts).call(this,{type:"failed",failureCount:e,error:t})},onPause:()=>{Ci(this,Es,Ts).call(this,{type:"pause"})},onContinue:x,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Ei(this,As).canRun(this)}));const k="pending"===this.state.status,A=!Ei(this,Ss).canStart();try{if(k)x();else{Ci(this,Es,Ts).call(this,{type:"pending",variables:e,isPaused:A}),await(null==(s=(t=Ei(this,As).config).onMutate)?void 0:s.call(t,e,this));const n=await(null==(a=(i=this.options).onMutate)?void 0:a.call(i,e));n!==this.state.context&&Ci(this,Es,Ts).call(this,{type:"pending",context:n,variables:e,isPaused:A})}const p=await Ei(this,Ss).start();return await(null==(r=(n=Ei(this,As).config).onSuccess)?void 0:r.call(n,p,e,this.state.context,this)),await(null==(l=(o=this.options).onSuccess)?void 0:l.call(o,p,e,this.state.context)),await(null==(h=(c=Ei(this,As).config).onSettled)?void 0:h.call(c,p,null,this.state.variables,this.state.context,this)),await(null==(d=(u=this.options).onSettled)?void 0:d.call(u,p,null,e,this.state.context)),Ci(this,Es,Ts).call(this,{type:"success",data:p}),p}catch(S){try{throw await(null==(f=(p=Ei(this,As).config).onError)?void 0:f.call(p,S,e,this.state.context,this)),await(null==(g=(m=this.options).onError)?void 0:g.call(m,S,e,this.state.context)),await(null==(b=(y=Ei(this,As).config).onSettled)?void 0:b.call(y,void 0,S,this.state.variables,this.state.context,this)),await(null==(w=(v=this.options).onSettled)?void 0:w.call(v,void 0,S,e,this.state.context)),S}finally{Ci(this,Es,Ts).call(this,{type:"error",error:S})}}finally{Ei(this,As).runNext(this)}}},ks=new WeakMap,As=new WeakMap,Ss=new WeakMap,Es=new WeakSet,Ts=function(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),yB.batch((()=>{Ei(this,ks).forEach((t=>{t.onMutationUpdate(e)})),Ei(this,As).notify({mutation:this,type:"updated",action:e})}))},Ps),AB=(Rs=class extends jM{constructor(e={}){super(),Ti(this,Cs),Ti(this,Ms),Ti(this,Bs),this.config=e,Pi(this,Cs,new Set),Pi(this,Ms,new Map),Pi(this,Bs,0)}build(e,t,s){const i=new kB({mutationCache:this,mutationId:++Mi(this,Bs)._,options:e.defaultMutationOptions(t),state:s});return this.add(i),i}add(e){Ei(this,Cs).add(e);const t=SB(e);if("string"==typeof t){const s=Ei(this,Ms).get(t);s?s.push(e):Ei(this,Ms).set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(Ei(this,Cs).delete(e)){const t=SB(e);if("string"==typeof t){const s=Ei(this,Ms).get(t);if(s)if(s.length>1){const t=s.indexOf(e);-1!==t&&s.splice(t,1)}else s[0]===e&&Ei(this,Ms).delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=SB(e);if("string"==typeof t){const s=Ei(this,Ms).get(t),i=null==s?void 0:s.find((e=>"pending"===e.state.status));return!i||i===e}return!0}runNext(e){var t;const s=SB(e);if("string"==typeof s){const i=null==(t=Ei(this,Ms).get(s))?void 0:t.find((t=>t!==e&&t.state.isPaused));return(null==i?void 0:i.continue())??Promise.resolve()}return Promise.resolve()}clear(){yB.batch((()=>{Ei(this,Cs).forEach((e=>{this.notify({type:"removed",mutation:e})})),Ei(this,Cs).clear(),Ei(this,Ms).clear()}))}getAll(){return Array.from(Ei(this,Cs))}find(e){const t={exact:!0,...e};return this.getAll().find((e=>qM(t,e)))}findAll(e={}){return this.getAll().filter((t=>qM(e,t)))}notify(e){yB.batch((()=>{this.listeners.forEach((t=>{t(e)}))}))}resumePausedMutations(){const e=this.getAll().filter((e=>e.state.isPaused));return yB.batch((()=>Promise.all(e.map((e=>e.continue().catch(VM))))))}},Cs=new WeakMap,Ms=new WeakMap,Bs=new WeakMap,Rs);function SB(e){var t;return null==(t=e.options.scope)?void 0:t.id}function EB(e){return{onFetch:(t,s)=>{var i,a,n,r,o;const l=t.options,c=null==(n=null==(a=null==(i=t.fetchOptions)?void 0:i.meta)?void 0:a.fetchMore)?void 0:n.direction,h=(null==(r=t.state.data)?void 0:r.pages)||[],u=(null==(o=t.state.data)?void 0:o.pageParams)||[];let d={pages:[],pageParams:[]},p=0;const f=async()=>{let s=!1;const i=rB(t.options,t.fetchOptions),a=async(e,a,n)=>{if(s)return Promise.reject();if(null==a&&e.pages.length)return Promise.resolve(e);const r=(()=>{const e={client:t.client,queryKey:t.queryKey,pageParam:a,direction:n?"backward":"forward",meta:t.options.meta};var i;return i=e,Object.defineProperty(i,"signal",{enumerable:!0,get:()=>(t.signal.aborted?s=!0:t.signal.addEventListener("abort",(()=>{s=!0})),t.signal)}),e})(),o=await i(r),{maxPages:l}=t.options,c=n?aB:iB;return{pages:c(e.pages,o,l),pageParams:c(e.pageParams,a,l)}};if(c&&h.length){const e="backward"===c,t={pages:h,pageParams:u},s=(e?PB:TB)(l,t);d=await a(t,s,e)}else{const t=e??h.length;do{const e=0===p?u[0]??l.initialPageParam:TB(l,d);if(p>0&&null==e)break;d=await a(d,e),p++}while(p<t)}return d};t.options.persister?t.fetchFn=()=>{var e,i;return null==(i=(e=t.options).persister)?void 0:i.call(e,f,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},s)}:t.fetchFn=f}}}function TB(e,{pages:t,pageParams:s}){const i=t.length-1;return t.length>0?e.getNextPageParam(t[i],t,s[i],s):void 0}function PB(e,{pages:t,pageParams:s}){var i;return t.length>0?null==(i=e.getPreviousPageParam)?void 0:i.call(e,t[0],t,s[0],s):void 0}var CB=(Hs=class{constructor(e={}){Ti(this,Ds),Ti(this,Ns),Ti(this,_s),Ti(this,Fs),Ti(this,Os),Ti(this,Ls),Ti(this,Is),Ti(this,js),Pi(this,Ds,e.queryCache||new xB),Pi(this,Ns,e.mutationCache||new AB),Pi(this,_s,e.defaultOptions||{}),Pi(this,Fs,new Map),Pi(this,Os,new Map),Pi(this,Ls,0)}mount(){Mi(this,Ls)._++,1===Ei(this,Ls)&&(Pi(this,Is,lB.subscribe((async e=>{e&&(await this.resumePausedMutations(),Ei(this,Ds).onFocus())}))),Pi(this,js,cB.subscribe((async e=>{e&&(await this.resumePausedMutations(),Ei(this,Ds).onOnline())}))))}unmount(){var e,t;Mi(this,Ls)._--,0===Ei(this,Ls)&&(null==(e=Ei(this,Is))||e.call(this),Pi(this,Is,void 0),null==(t=Ei(this,js))||t.call(this),Pi(this,js,void 0))}isFetching(e){return Ei(this,Ds).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Ei(this,Ns).findAll({...e,status:"pending"}).length}getQueryData(e){var t;const s=this.defaultQueryOptions({queryKey:e});return null==(t=Ei(this,Ds).get(s.queryHash))?void 0:t.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),s=Ei(this,Ds).build(this,t),i=s.state.data;return void 0===i?this.fetchQuery(e):(e.revalidateIfStale&&s.isStaleByTime(zM(t.staleTime,s))&&this.prefetchQuery(t),Promise.resolve(i))}getQueriesData(e){return Ei(this,Ds).findAll(e).map((({queryKey:e,state:t})=>[e,t.data]))}setQueryData(e,t,s){const i=this.defaultQueryOptions({queryKey:e}),a=Ei(this,Ds).get(i.queryHash),n=function(e,t){return"function"==typeof e?e(t):e}(t,null==a?void 0:a.state.data);if(void 0!==n)return Ei(this,Ds).build(this,i).setData(n,{...s,manual:!0})}setQueriesData(e,t,s){return yB.batch((()=>Ei(this,Ds).findAll(e).map((({queryKey:e})=>[e,this.setQueryData(e,t,s)]))))}getQueryState(e){var t;const s=this.defaultQueryOptions({queryKey:e});return null==(t=Ei(this,Ds).get(s.queryHash))?void 0:t.state}removeQueries(e){const t=Ei(this,Ds);yB.batch((()=>{t.findAll(e).forEach((e=>{t.remove(e)}))}))}resetQueries(e,t){const s=Ei(this,Ds);return yB.batch((()=>(s.findAll(e).forEach((e=>{e.reset()})),this.refetchQueries({type:"active",...e},t))))}cancelQueries(e,t={}){const s={revert:!0,...t},i=yB.batch((()=>Ei(this,Ds).findAll(e).map((e=>e.cancel(s)))));return Promise.all(i).then(VM).catch(VM)}invalidateQueries(e,t={}){return yB.batch((()=>(Ei(this,Ds).findAll(e).forEach((e=>{e.invalidate()})),"none"===(null==e?void 0:e.refetchType)?Promise.resolve():this.refetchQueries({...e,type:(null==e?void 0:e.refetchType)??(null==e?void 0:e.type)??"active"},t))))}refetchQueries(e,t={}){const s={...t,cancelRefetch:t.cancelRefetch??!0},i=yB.batch((()=>Ei(this,Ds).findAll(e).filter((e=>!e.isDisabled()&&!e.isStatic())).map((e=>{let t=e.fetch(void 0,s);return s.throwOnError||(t=t.catch(VM)),"paused"===e.state.fetchStatus?Promise.resolve():t}))));return Promise.all(i).then(VM)}fetchQuery(e){const t=this.defaultQueryOptions(e);void 0===t.retry&&(t.retry=!1);const s=Ei(this,Ds).build(this,t);return s.isStaleByTime(zM(t.staleTime,s))?s.fetch(t):Promise.resolve(s.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(VM).catch(VM)}fetchInfiniteQuery(e){return e.behavior=EB(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(VM).catch(VM)}ensureInfiniteQueryData(e){return e.behavior=EB(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return cB.isOnline()?Ei(this,Ns).resumePausedMutations():Promise.resolve()}getQueryCache(){return Ei(this,Ds)}getMutationCache(){return Ei(this,Ns)}getDefaultOptions(){return Ei(this,_s)}setDefaultOptions(e){Pi(this,_s,e)}setQueryDefaults(e,t){Ei(this,Fs).set(ZM(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Ei(this,Fs).values()],s={};return t.forEach((t=>{JM(e,t.queryKey)&&Object.assign(s,t.defaultOptions)})),s}setMutationDefaults(e,t){Ei(this,Os).set(ZM(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Ei(this,Os).values()],s={};return t.forEach((t=>{JM(e,t.mutationKey)&&Object.assign(s,t.defaultOptions)})),s}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Ei(this,_s).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=KM(t.queryKey,t)),void 0===t.refetchOnReconnect&&(t.refetchOnReconnect="always"!==t.networkMode),void 0===t.throwOnError&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===nB&&(t.enabled=!1),t}defaultMutationOptions(e){return(null==e?void 0:e._defaulted)?e:{...Ei(this,_s).mutations,...(null==e?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Ei(this,Ds).clear(),Ei(this,Ns).clear()}},Ds=new WeakMap,Ns=new WeakMap,_s=new WeakMap,Fs=new WeakMap,Os=new WeakMap,Ls=new WeakMap,Is=new WeakMap,js=new WeakMap,Hs),MB=(di=class extends jM{constructor(e,t){super(),Ti(this,si),Ti(this,Vs),Ti(this,Gs),Ti(this,Us),Ti(this,zs),Ti(this,Ws),Ti(this,Qs),Ti(this,qs),Ti(this,Ks),Ti(this,Zs),Ti(this,Js),Ti(this,Xs),Ti(this,$s),Ti(this,Ys),Ti(this,ei),Ti(this,ti,new Set),this.options=t,Pi(this,Vs,e),Pi(this,Ks,null),Pi(this,qs,hB()),this.options.experimental_prefetchInRender||Ei(this,qs).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(t)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(Ei(this,Gs).addObserver(this),BB(Ei(this,Gs),this.options)?Ci(this,si,ii).call(this):this.updateResult(),Ci(this,si,oi).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return RB(Ei(this,Gs),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return RB(Ei(this,Gs),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Ci(this,si,li).call(this),Ci(this,si,ci).call(this),Ei(this,Gs).removeObserver(this)}setOptions(e){const t=this.options,s=Ei(this,Gs);if(this.options=Ei(this,Vs).defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof WM(this.options.enabled,Ei(this,Gs)))throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Ci(this,si,hi).call(this),Ei(this,Gs).setOptions(this.options),t._defaulted&&!$M(this.options,t)&&Ei(this,Vs).getQueryCache().notify({type:"observerOptionsUpdated",query:Ei(this,Gs),observer:this});const i=this.hasListeners();i&&DB(Ei(this,Gs),s,this.options,t)&&Ci(this,si,ii).call(this),this.updateResult(),!i||Ei(this,Gs)===s&&WM(this.options.enabled,Ei(this,Gs))===WM(t.enabled,Ei(this,Gs))&&zM(this.options.staleTime,Ei(this,Gs))===zM(t.staleTime,Ei(this,Gs))||Ci(this,si,ai).call(this);const a=Ci(this,si,ni).call(this);!i||Ei(this,Gs)===s&&WM(this.options.enabled,Ei(this,Gs))===WM(t.enabled,Ei(this,Gs))&&a===Ei(this,ei)||Ci(this,si,ri).call(this,a)}getOptimisticResult(e){const t=Ei(this,Vs).getQueryCache().build(Ei(this,Vs),e),s=this.createResult(t,e);return i=s,!$M(this.getCurrentResult(),i)&&(Pi(this,zs,s),Pi(this,Qs,this.options),Pi(this,Ws,Ei(this,Gs).state)),s;var i}getCurrentResult(){return Ei(this,zs)}trackResult(e,t){return new Proxy(e,{get:(e,s)=>(this.trackProp(s),null==t||t(s),Reflect.get(e,s))})}trackProp(e){Ei(this,ti).add(e)}getCurrentQuery(){return Ei(this,Gs)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=Ei(this,Vs).defaultQueryOptions(e),s=Ei(this,Vs).getQueryCache().build(Ei(this,Vs),t);return s.fetch().then((()=>this.createResult(s,t)))}fetch(e){return Ci(this,si,ii).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then((()=>(this.updateResult(),Ei(this,zs))))}createResult(e,t){var s;const i=Ei(this,Gs),a=this.options,n=Ei(this,zs),r=Ei(this,Ws),o=Ei(this,Qs),l=e!==i?e.state:Ei(this,Us),{state:c}=e;let h,u={...c},d=!1;if(t._optimisticResults){const s=this.hasListeners(),n=!s&&BB(e,t),r=s&&DB(e,i,t,a);(n||r)&&(u={...u,...wB(c.data,e.options)}),"isRestoring"===t._optimisticResults&&(u.fetchStatus="idle")}let{error:p,errorUpdatedAt:f,status:m}=u;h=u.data;let g=!1;if(void 0!==t.placeholderData&&void 0===h&&"pending"===m){let e;(null==n?void 0:n.isPlaceholderData)&&t.placeholderData===(null==o?void 0:o.placeholderData)?(e=n.data,g=!0):e="function"==typeof t.placeholderData?t.placeholderData(null==(s=Ei(this,Xs))?void 0:s.state.data,Ei(this,Xs)):t.placeholderData,void 0!==e&&(m="success",h=sB(null==n?void 0:n.data,e,t),d=!0)}if(t.select&&void 0!==h&&!g)if(n&&h===(null==r?void 0:r.data)&&t.select===Ei(this,Zs))h=Ei(this,Js);else try{Pi(this,Zs,t.select),h=t.select(h),h=sB(null==n?void 0:n.data,h,t),Pi(this,Js,h),Pi(this,Ks,null)}catch(A){Pi(this,Ks,A)}Ei(this,Ks)&&(p=Ei(this,Ks),h=Ei(this,Js),f=Date.now(),m="error");const y="fetching"===u.fetchStatus,b="pending"===m,v="error"===m,w=b&&y,x=void 0!==h,k={status:m,fetchStatus:u.fetchStatus,isPending:b,isSuccess:"success"===m,isError:v,isInitialLoading:w,isLoading:w,data:h,dataUpdatedAt:u.dataUpdatedAt,error:p,errorUpdatedAt:f,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>l.dataUpdateCount||u.errorUpdateCount>l.errorUpdateCount,isFetching:y,isRefetching:y&&!b,isLoadingError:v&&!x,isPaused:"paused"===u.fetchStatus,isPlaceholderData:d,isRefetchError:v&&x,isStale:NB(e,t),refetch:this.refetch,promise:Ei(this,qs),isEnabled:!1!==WM(t.enabled,e)};if(this.options.experimental_prefetchInRender){const t=e=>{"error"===k.status?e.reject(k.error):void 0!==k.data&&e.resolve(k.data)},s=()=>{const e=Pi(this,qs,k.promise=hB());t(e)},a=Ei(this,qs);switch(a.status){case"pending":e.queryHash===i.queryHash&&t(a);break;case"fulfilled":"error"!==k.status&&k.data===a.value||s();break;case"rejected":"error"===k.status&&k.error===a.reason||s()}}return k}updateResult(){const e=Ei(this,zs),t=this.createResult(Ei(this,Gs),this.options);Pi(this,Ws,Ei(this,Gs).state),Pi(this,Qs,this.options),void 0!==Ei(this,Ws).data&&Pi(this,Xs,Ei(this,Gs)),$M(t,e)||(Pi(this,zs,t),Ci(this,si,ui).call(this,{listeners:(()=>{if(!e)return!0;const{notifyOnChangeProps:t}=this.options,s="function"==typeof t?t():t;if("all"===s||!s&&!Ei(this,ti).size)return!0;const i=new Set(s??Ei(this,ti));return this.options.throwOnError&&i.add("error"),Object.keys(Ei(this,zs)).some((t=>{const s=t;return Ei(this,zs)[s]!==e[s]&&i.has(s)}))})()}))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Ci(this,si,oi).call(this)}},Vs=new WeakMap,Gs=new WeakMap,Us=new WeakMap,zs=new WeakMap,Ws=new WeakMap,Qs=new WeakMap,qs=new WeakMap,Ks=new WeakMap,Zs=new WeakMap,Js=new WeakMap,Xs=new WeakMap,$s=new WeakMap,Ys=new WeakMap,ei=new WeakMap,ti=new WeakMap,si=new WeakSet,ii=function(e){Ci(this,si,hi).call(this);let t=Ei(this,Gs).fetch(this.options,e);return(null==e?void 0:e.throwOnError)||(t=t.catch(VM)),t},ai=function(){Ci(this,si,li).call(this);const e=zM(this.options.staleTime,Ei(this,Gs));if(HM||Ei(this,zs).isStale||!GM(e))return;const t=UM(Ei(this,zs).dataUpdatedAt,e);Pi(this,$s,setTimeout((()=>{Ei(this,zs).isStale||this.updateResult()}),t+1))},ni=function(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(Ei(this,Gs)):this.options.refetchInterval)??!1},ri=function(e){Ci(this,si,ci).call(this),Pi(this,ei,e),!HM&&!1!==WM(this.options.enabled,Ei(this,Gs))&&GM(Ei(this,ei))&&0!==Ei(this,ei)&&Pi(this,Ys,setInterval((()=>{(this.options.refetchIntervalInBackground||lB.isFocused())&&Ci(this,si,ii).call(this)}),Ei(this,ei)))},oi=function(){Ci(this,si,ai).call(this),Ci(this,si,ri).call(this,Ci(this,si,ni).call(this))},li=function(){Ei(this,$s)&&(clearTimeout(Ei(this,$s)),Pi(this,$s,void 0))},ci=function(){Ei(this,Ys)&&(clearInterval(Ei(this,Ys)),Pi(this,Ys,void 0))},hi=function(){const e=Ei(this,Vs).getQueryCache().build(Ei(this,Vs),this.options);if(e===Ei(this,Gs))return;const t=Ei(this,Gs);Pi(this,Gs,e),Pi(this,Us,e.state),this.hasListeners()&&(null==t||t.removeObserver(this),e.addObserver(this))},ui=function(e){yB.batch((()=>{e.listeners&&this.listeners.forEach((e=>{e(Ei(this,zs))})),Ei(this,Vs).getQueryCache().notify({query:Ei(this,Gs),type:"observerResultsUpdated"})}))},di);function BB(e,t){return function(e,t){return!1!==WM(t.enabled,e)&&void 0===e.state.data&&!("error"===e.state.status&&!1===t.retryOnMount)}(e,t)||void 0!==e.state.data&&RB(e,t,t.refetchOnMount)}function RB(e,t,s){if(!1!==WM(t.enabled,e)&&"static"!==zM(t.staleTime,e)){const i="function"==typeof s?s(e):s;return"always"===i||!1!==i&&NB(e,t)}return!1}function DB(e,t,s,i){return(e!==t||!1===WM(i.enabled,e))&&(!s.suspense||"error"!==e.state.status)&&NB(e,s)}function NB(e,t){return!1!==WM(t.enabled,e)&&e.isStaleByTime(zM(t.staleTime,e))}var _B=(wi=class extends jM{constructor(e,t){super(),Ti(this,yi),Ti(this,pi),Ti(this,fi),Ti(this,mi),Ti(this,gi),Pi(this,pi,e),this.setOptions(t),this.bindMethods(),Ci(this,yi,bi).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var t;const s=this.options;this.options=Ei(this,pi).defaultMutationOptions(e),$M(this.options,s)||Ei(this,pi).getMutationCache().notify({type:"observerOptionsUpdated",mutation:Ei(this,mi),observer:this}),(null==s?void 0:s.mutationKey)&&this.options.mutationKey&&ZM(s.mutationKey)!==ZM(this.options.mutationKey)?this.reset():"pending"===(null==(t=Ei(this,mi))?void 0:t.state.status)&&Ei(this,mi).setOptions(this.options)}onUnsubscribe(){var e;this.hasListeners()||null==(e=Ei(this,mi))||e.removeObserver(this)}onMutationUpdate(e){Ci(this,yi,bi).call(this),Ci(this,yi,vi).call(this,e)}getCurrentResult(){return Ei(this,fi)}reset(){var e;null==(e=Ei(this,mi))||e.removeObserver(this),Pi(this,mi,void 0),Ci(this,yi,bi).call(this),Ci(this,yi,vi).call(this)}mutate(e,t){var s;return Pi(this,gi,t),null==(s=Ei(this,mi))||s.removeObserver(this),Pi(this,mi,Ei(this,pi).getMutationCache().build(Ei(this,pi),this.options)),Ei(this,mi).addObserver(this),Ei(this,mi).execute(e)}},pi=new WeakMap,fi=new WeakMap,mi=new WeakMap,gi=new WeakMap,yi=new WeakSet,bi=function(){var e;const t=(null==(e=Ei(this,mi))?void 0:e.state)??{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0};Pi(this,fi,{...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset})},vi=function(e){yB.batch((()=>{var t,s,i,a,n,r,o,l;if(Ei(this,gi)&&this.hasListeners()){const c=Ei(this,fi).variables,h=Ei(this,fi).context;"success"===(null==e?void 0:e.type)?(null==(s=(t=Ei(this,gi)).onSuccess)||s.call(t,e.data,c,h),null==(a=(i=Ei(this,gi)).onSettled)||a.call(i,e.data,null,c,h)):"error"===(null==e?void 0:e.type)&&(null==(r=(n=Ei(this,gi)).onError)||r.call(n,e.error,c,h),null==(l=(o=Ei(this,gi)).onSettled)||l.call(o,void 0,e.error,c,h))}this.listeners.forEach((e=>{e(Ei(this,fi))}))}))},wi),FB=ga.createContext(void 0),OB=e=>{const t=ga.useContext(FB);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},LB=({client:e,children:t})=>(ga.useEffect((()=>(e.mount(),()=>{e.unmount()})),[e]),Ea.jsx(FB.Provider,{value:e,children:t})),IB=ga.createContext(!1);IB.Provider;var jB=ga.createContext(function(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}()),HB=(e,t,s)=>t.fetchOptimistic(e).catch((()=>{s.clearReset()}));function VB(e,t){return function(e,t){var s,i,a,n,r;const o=ga.useContext(IB),l=ga.useContext(jB),c=OB(),h=c.defaultQueryOptions(e);null==(i=null==(s=c.getDefaultOptions().queries)?void 0:s._experimental_beforeQuery)||i.call(s,h),h._optimisticResults=o?"isRestoring":"optimistic",(e=>{if(e.suspense){const t=e=>"static"===e?e:Math.max(e??1e3,1e3),s=e.staleTime;e.staleTime="function"==typeof s?(...e)=>t(s(...e)):t(s),"number"==typeof e.gcTime&&(e.gcTime=Math.max(e.gcTime,1e3))}})(h),((e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))})(h,l),(e=>{ga.useEffect((()=>{e.clearReset()}),[e])})(l);const u=!c.getQueryCache().get(h.queryHash),[d]=ga.useState((()=>new t(c,h))),p=d.getOptimisticResult(h),f=!o&&!1!==e.subscribed;if(ga.useSyncExternalStore(ga.useCallback((e=>{const t=f?d.subscribe(yB.batchCalls(e)):VM;return d.updateResult(),t}),[d,f]),(()=>d.getCurrentResult()),(()=>d.getCurrentResult())),ga.useEffect((()=>{d.setOptions(h)}),[h,d]),((e,t)=>(null==e?void 0:e.suspense)&&t.isPending)(h,p))throw HB(h,d,l);if((({result:e,errorResetBoundary:t,throwOnError:s,query:i,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&i&&(a&&void 0===e.data||oB(s,[e.error,i])))({result:p,errorResetBoundary:l,throwOnError:h.throwOnError,query:c.getQueryCache().get(h.queryHash),suspense:h.suspense}))throw p.error;if(null==(n=null==(a=c.getDefaultOptions().queries)?void 0:a._experimental_afterQuery)||n.call(a,h,p),h.experimental_prefetchInRender&&!HM&&((e,t)=>e.isLoading&&e.isFetching&&!t)(p,o)){const e=u?HB(h,d,l):null==(r=c.getQueryCache().get(h.queryHash))?void 0:r.promise;null==e||e.catch(VM).finally((()=>{d.updateResult()}))}return h.notifyOnChangeProps?p:d.trackResult(p)}(e,MB)}function GB(e,t){const s=OB(),[i]=ga.useState((()=>new _B(s,e)));ga.useEffect((()=>{i.setOptions(e)}),[i,e]);const a=ga.useSyncExternalStore(ga.useCallback((e=>i.subscribe(yB.batchCalls(e))),[i]),(()=>i.getCurrentResult()),(()=>i.getCurrentResult())),n=ga.useCallback(((e,t)=>{i.mutate(e,t).catch(VM)}),[i]);if(a.error&&oB(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:n,mutateAsync:a.mutate}}const UB=({gameManager:e,onStartGame:t})=>{console.log({gameManager:e,onStartGame:t});const s=OB(),[i,a]=ga.useState("upgrades"),[n,r]=ga.useState("all"),[o,l]=ga.useState(null),[c,h]=ga.useState(null),[u,d]=ga.useState(!1),[p,f]=ga.useState(!1),[m,g]=ga.useState(!0),[y,b]=ga.useState("boot"),[v,w]=ga.useState({gold:500,passiveUpgrades:{},allTimeStats:{},lastRunStats:null,currentRunStats:{}}),[x,k]=ga.useState([]),{data:A}=VB({queryKey:["user-upgrades"],queryFn:()=>TM()}),S=GB({mutationFn:PM,onSuccess:()=>{s.invalidateQueries({queryKey:["user-upgrades"]}),M("Upgrade purchased successfully!")},onError:e=>{console.error("Failed to upgrade:",e),M("Failed to purchase upgrade!")}});ga.useEffect((()=>{e?(console.log("gameManager loaded",e),w({gold:e.gold||500,passiveUpgrades:e.passiveUpgrades||{},allTimeStats:e.allTimeStats||{},lastRunStats:e.lastRunStats||null,currentRunStats:e.currentRunStats||{}})):console.log("not loadedd");const t=t=>{t.detail?w(t.detail):e&&w({gold:e.gold||500,passiveUpgrades:e.passiveUpgrades||{},allTimeStats:e.allTimeStats||{},lastRunStats:e.lastRunStats||null,currentRunStats:e.currentRunStats||{}})},s=e=>{f(!0),a("death")},i=()=>{b("assets"),B("Boot scene complete - loading assets...")},n=()=>{g(!1),b("ready"),B("All assets loaded - game ready to start!")};window.addEventListener("gameStateUpdated",t),window.addEventListener("playerDeath",s),window.addEventListener("gameBootComplete",i),window.addEventListener("gamePreloadComplete",n);const r=setTimeout((()=>{m&&(B("Loading timeout reached - force completing loading"),g(!1),b("ready"))}),1e4);return()=>{clearTimeout(r),window.removeEventListener("gameStateUpdated",t),window.removeEventListener("playerDeath",s),window.removeEventListener("gameBootComplete",i),window.removeEventListener("gamePreloadComplete",n)}}),[e]);const E=(null==A?void 0:A.data)||[],T="all"===n?E:E.filter((e=>e.category===n)),P=e=>`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`,C=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString(),M=e=>{h(e),setTimeout((()=>h(null)),3e3)},B=e=>{const t=(new Date).toLocaleTimeString();k((s=>[`[${t}] ${e}`,...s.slice(0,9)]))},R=()=>{if(m)B("Cannot start game - still loading assets");else{B("StartGame function called"),f(!1);try{B(`GameManager exists: ${!!e}`),B(`GameManager.startNewRun exists: ${!(!e||!e.startNewRun)}`),B(`onStartGame exists: ${!!t}`),B("onStartGame type: "+typeof t),e&&e.startNewRun?(console.log("Calling startNewRun from MainMenu"),B("Calling gameManager.startNewRun()"),e.startNewRun(),B("gameManager.startNewRun() completed"),B(`Game running: ${e.isGameRunning}`),B(`Game start time: ${e.gameStartTime}`)):B("GameManager or startNewRun method not available"),t?(console.log("Calling onStartGame from MainMenu"),B("Calling onStartGame callback"),t(),B("onStartGame callback completed")):B("onStartGame callback not provided!")}catch(s){console.error("Error starting game:",s),B(`Error starting game: ${s.message}`)}}},[D,N]=ga.useState(!1);return p&&v.lastRunStats?Ea.jsx("div",{className:"death-root",children:Ea.jsxs("div",{className:"death-container",children:[Ea.jsx("h1",{className:"death-title",children:" YOU DIED "}),Ea.jsxs("div",{className:"death-stats",children:[Ea.jsx("h3",{className:"death-stats-title",children:" Last Run Statistics"}),Ea.jsxs("div",{className:"death-stats-grid",children:[Ea.jsxs("div",{children:[Ea.jsx("strong",{children:" Survival Time:"}),Ea.jsx("br",{}),Ea.jsx("span",{className:"death-stat-green",children:P(v.lastRunStats.survivalTime)})]}),Ea.jsxs("div",{children:[Ea.jsx("strong",{children:" Level Reached:"}),Ea.jsx("br",{}),Ea.jsx("span",{className:"death-stat-orange",children:v.lastRunStats.maxLevel})]}),Ea.jsxs("div",{children:[Ea.jsx("strong",{children:" Enemies Killed:"}),Ea.jsx("br",{}),Ea.jsx("span",{className:"death-stat-red",children:v.lastRunStats.enemiesKilled})]}),Ea.jsxs("div",{children:[Ea.jsx("strong",{children:" Gold Earned:"}),Ea.jsx("br",{}),Ea.jsx("span",{className:"death-stat-yellow",children:v.lastRunStats.goldEarned})]}),Ea.jsxs("div",{children:[Ea.jsx("strong",{children:" Experience Gained:"}),Ea.jsx("br",{}),Ea.jsx("span",{className:"death-stat-blue",children:C(v.lastRunStats.experienceGained)})]}),Ea.jsxs("div",{children:[Ea.jsx("strong",{children:" Damage Dealt:"}),Ea.jsx("br",{}),Ea.jsx("span",{className:"death-stat-orange",children:C(v.lastRunStats.damageDealt)})]})]}),v.lastRunStats.causeOfDeath&&Ea.jsx("div",{className:"death-cause",children:Ea.jsx("strong",{children:" Cause of Death: Skill Issue"})})]}),Ea.jsxs("div",{className:"death-btn-row",children:[Ea.jsx("button",{onClick:()=>{f(!1),a("upgrades")},className:"death-btn-continue",children:" Continue to Menu"}),Ea.jsx("button",{onClick:R,className:"death-btn-retry",children:" Try Again"})]})]})}):Ea.jsxs("div",{className:"mainmenu-root",children:[Ea.jsxs("div",{className:"mainmenu-header",children:[Ea.jsx("h1",{className:"mainmenu-title",children:"Insomnus"}),Ea.jsxs("div",{className:"mainmenu-header-right",children:[Ea.jsxs("div",{className:"mainmenu-gold",children:[" GOLD:"," ",Ea.jsx("span",{className:"mainmenu-gold-amount",children:C(v.gold)})]}),Ea.jsx("button",{onClick:R,className:"mainmenu-start-btn"+(m?" loading":""),disabled:m,children:m?Ea.jsxs(Ea.Fragment,{children:[Ea.jsx("span",{className:"loading-spinner-small"}),"boot"===y&&"Initializing...","assets"===y&&"Loading Assets..."]}):" Start Game"})]})]}),Ea.jsx("div",{className:"mainmenu-tabs",children:["upgrades","stats","settings"].map((e=>Ea.jsxs("button",{onClick:()=>a(e),className:"mainmenu-tab"+(i===e?" active":""),children:["upgrades"===e&&""," ","stats"===e&&""," ","settings"===e&&""," ",e]},e)))}),m&&Ea.jsx("div",{className:"mainmenu-loading-overlay",children:Ea.jsxs("div",{className:"mainmenu-loading-content",children:[Ea.jsx("div",{className:"loading-spinner-large"}),Ea.jsx("h2",{className:"mainmenu-loading-title",children:"Initializing Game"}),Ea.jsxs("p",{className:"mainmenu-loading-text",children:["boot"===y&&"Starting game engine...","assets"===y&&"Loading game assets..."]}),Ea.jsx("div",{className:"mainmenu-loading-progress",children:Ea.jsx("div",{className:"mainmenu-loading-progress-bar",children:Ea.jsx("div",{className:"mainmenu-loading-progress-fill",style:{width:"boot"===y?"30%":"90%"}})})})]})}),Ea.jsxs("div",{className:"mainmenu-content",children:["upgrades"===i&&Ea.jsxs("div",{children:[Ea.jsx("div",{className:"mainmenu-categories",children:["all","combat","survival","mobility","utility","progression"].map((e=>Ea.jsx("button",{onClick:()=>r(e),className:"mainmenu-category"+(n===e?" selected":""),children:e},e)))}),Ea.jsx("div",{className:"mainmenu-upgrades-grid",children:T.map((e=>{const t=e.level||0,s=e.isMaxed||!1;return Ea.jsxs("div",{className:"mainmenu-upgrade"+(t>0?" upgraded":""),children:[Ea.jsxs("div",{className:"mainmenu-upgrade-header",children:[Ea.jsxs("div",{className:"mainmenu-upgrade-title-row",children:[Ea.jsx("span",{className:"mainmenu-upgrade-icon",children:e.icon||""}),Ea.jsx("h3",{className:"mainmenu-upgrade-title",children:e.name}),Ea.jsx("button",{className:"mainmenu-upgrade-info",onMouseEnter:()=>l(e.id),onMouseLeave:()=>l(null),children:""})]}),Ea.jsxs("div",{className:"mainmenu-upgrade-level",children:["Level ",t]})]}),o===e.id&&Ea.jsx("div",{className:"mainmenu-upgrade-tooltip",children:e.description}),Ea.jsx("div",{className:"mainmenu-upgrade-values",children:e.progress&&Ea.jsxs("div",{children:[Ea.jsx("span",{children:"Progress: "}),Ea.jsx("span",{className:"mainmenu-upgrade-current",children:e.progress})]})}),Ea.jsx("div",{className:"mainmenu-upgrade-actions",children:s?Ea.jsx("div",{className:"mainmenu-upgrade-maxed",children:" MAXED"}):Ea.jsx("button",{onClick:()=>{return t=e.id,void S.mutate(t);var t},disabled:S.isPending,className:"mainmenu-upgrade-btn"+(S.isPending?" disabled":""),children:S.isPending?" UPGRADING...":" UPGRADE"})})]},e.id)}))})]}),"stats"===i&&Ea.jsxs("div",{children:[Ea.jsx("h2",{className:"mainmenu-stats-title",children:" STATISTICS"}),Ea.jsxs("div",{className:"mainmenu-stats-grid",children:[Ea.jsxs("div",{className:"mainmenu-stats-alltime",children:[Ea.jsx("h3",{className:"mainmenu-stats-alltime-title",children:" All-Time Records"}),Ea.jsxs("div",{className:"mainmenu-stats-alltime-list",children:[Ea.jsxs("div",{className:"mainmenu-stats-row",children:[Ea.jsx("span",{children:" Total Runs:"}),Ea.jsx("span",{className:"mainmenu-stats-green",children:v.allTimeStats.totalRuns||0})]}),Ea.jsxs("div",{className:"mainmenu-stats-row",children:[Ea.jsx("span",{children:" Highest Level:"}),Ea.jsx("span",{className:"mainmenu-stats-orange",children:v.allTimeStats.highestLevel||1})]}),Ea.jsxs("div",{className:"mainmenu-stats-row",children:[Ea.jsx("span",{children:" Longest Survival:"}),Ea.jsx("span",{className:"mainmenu-stats-green",children:P(v.allTimeStats.longestSurvivalTime||0)})]}),Ea.jsxs("div",{className:"mainmenu-stats-row",children:[Ea.jsx("span",{children:" Total Gold Earned:"}),Ea.jsx("span",{className:"mainmenu-stats-yellow",children:C(v.allTimeStats.totalGoldEarned||0)})]}),Ea.jsxs("div",{className:"mainmenu-stats-row",children:[Ea.jsx("span",{children:" Enemies Killed:"}),Ea.jsx("span",{className:"mainmenu-stats-red",children:C(v.allTimeStats.totalEnemiesKilled||0)})]}),Ea.jsxs("div",{className:"mainmenu-stats-row",children:[Ea.jsx("span",{children:" Average Survival:"}),Ea.jsx("span",{className:"mainmenu-stats-blue",children:P(v.allTimeStats.averageSurvivalTime||0)})]})]})]}),Ea.jsxs("div",{className:"mainmenu-stats-upgrades",children:[Ea.jsx("h3",{className:"mainmenu-stats-upgrades-title",children:" Current Upgrades"}),Ea.jsx("div",{className:"mainmenu-stats-upgrades-list",children:E.map((e=>{const t=e.level||0;return Ea.jsxs("div",{className:"mainmenu-stats-upgrade-row"+(t>0?"":" faded"),children:[Ea.jsxs("span",{children:[e.icon||""," ",e.name,":"]}),Ea.jsxs("div",{children:[Ea.jsx("span",{className:"mainmenu-stats-upgrade-value",children:e.progress||"N/A"}),Ea.jsxs("span",{className:"mainmenu-stats-upgrade-level",children:["(Lv ",t,")"]})]})]},e.id)}))})]})]})]}),"settings"===i&&Ea.jsxs("div",{className:"mainmenu-settings",children:[Ea.jsx("h2",{className:"mainmenu-settings-title",children:" SETTINGS"}),Ea.jsxs("div",{className:"mainmenu-settings-danger",children:[Ea.jsx("h3",{className:"mainmenu-settings-danger-title",children:" Danger Zone"}),Ea.jsxs("p",{className:"mainmenu-settings-danger-desc",children:["This will reset all your progress including upgrades and statistics.",Ea.jsx("br",{}),"You will receive 25,000 gold to test upgrades."]}),Ea.jsx("button",{onClick:()=>d(!0),className:"mainmenu-settings-reset-btn",children:" RESET ALL PROGRESS"})]})]})]}),c&&Ea.jsx("div",{className:"mainmenu-notification",children:c}),u&&Ea.jsx("div",{className:"mainmenu-reset-overlay",children:Ea.jsxs("div",{className:"mainmenu-reset-modal",children:[Ea.jsx("h3",{className:"mainmenu-reset-title",children:" Reset Progress?"}),Ea.jsxs("p",{className:"mainmenu-reset-desc",children:["This action cannot be undone!",Ea.jsx("br",{}),"All upgrades and statistics will be lost."]}),Ea.jsxs("div",{className:"mainmenu-reset-btn-row",children:[Ea.jsx("button",{onClick:()=>d(!1),className:"mainmenu-reset-cancel-btn",children:"CANCEL"}),Ea.jsx("button",{onClick:()=>{e&&e.resetProgress&&(e.resetProgress(),d(!1),M("Progress has been reset!"))},className:"mainmenu-reset-confirm-btn",children:"RESET"})]})]})})]})},zB=({onStartGame:e})=>{const{gameManager:t}=LM();return Ea.jsx(UB,{gameManager:t,onStartGame:()=>{console.log("Starting game from MainMenu"),t&&t.startNewRun&&console.log("GameManager ready for new run"),e&&e()}})},WB=()=>{var e;const{user:t,logout:s}=Qv(),i=Ng(),a=Bg(),{gameControls:n}=Kv(),r=a.pathname.startsWith("/game");return Ea.jsxs("header",{className:"bg-dark-secondary border-b border-dark-secondary h-16 flex items-center justify-between px-6",children:[Ea.jsx("div",{className:"flex items-center"}),Ea.jsx("div",{className:"flex items-center space-x-4",children:t&&Ea.jsxs(Ea.Fragment,{children:[Ea.jsxs("h1",{className:"text-yellow-400 text-xl",children:[Ea.jsx("span",{className:"text-white font-medium",children:"Welcome, "}),Ea.jsx("span",{className:"text-yellow-400 font-medium",children:(null==(e=null==t?void 0:t.data)?void 0:e.username)||(null==t?void 0:t.username)||"Player"})]}),Ea.jsx("button",{onClick:()=>{r&&"playing"===(null==n?void 0:n.gameState)&&(null==n?void 0:n.returnToMenu)?n.returnToMenu():r&&(null==n?void 0:n.startGame)?n.startGame():i("/game")},className:"px-6 py-3 text-sm pt-4 font-bold text-white bg-red-600 hover:bg-red-700 rounded transition-colors whitespace-nowrap shadow-lg",children:r&&"playing"===(null==n?void 0:n.gameState)?" Return to Menu":"Start Game"}),Ea.jsx("div",{className:"w-px h-6 bg-gray-600"}),Ea.jsx("button",{onClick:s,className:"px-6 py-3 pt-4 text-sm font-bold text-white bg-red-600 hover:bg-red-700 rounded transition-colors whitespace-nowrap shadow-lg",children:"Logout"})]})})]})},QB=({size:e})=>Ea.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 20 20",fill:"none",children:[Ea.jsxs("g",{clipPath:"url(#clip0_17780_125)",children:[Ea.jsx("path",{d:"M8.33337 10.833H1.66671V11.6663H0.833374V18.333H1.66671V19.1663H8.33337V18.333H9.16671V11.6663H8.33337V10.833ZM7.50004 17.4997H2.50004V12.4997H7.50004V17.4997Z",fill:"white"}),Ea.jsx("path",{d:"M8.33337 1.66634V0.833008H1.66671V1.66634H0.833374V8.33301H1.66671V9.16634H8.33337V8.33301H9.16671V1.66634H8.33337ZM2.50004 7.49967V2.49967H7.50004V7.49967H2.50004Z",fill:"white"}),Ea.jsx("path",{d:"M18.3334 10.833H11.6667V11.6663H10.8334V18.333H11.6667V19.1663H18.3334V18.333H19.1667V11.6663H18.3334V10.833ZM17.5 17.4997H12.5V12.4997H17.5V17.4997Z",fill:"white"}),Ea.jsx("path",{d:"M18.3334 1.66634V0.833008H11.6667V1.66634H10.8334V8.33301H11.6667V9.16634H18.3334V8.33301H19.1667V1.66634H18.3334ZM17.5 7.49967H12.5V2.49967H17.5V7.49967Z",fill:"white"})]}),Ea.jsx("defs",{children:Ea.jsx("clipPath",{id:"clip0_17780_125",children:Ea.jsx("rect",{width:"20",height:"20",fill:"white"})})})]}),qB=({size:e})=>Ea.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 20 20",fill:"none",children:Ea.jsx("path",{d:"M19.1667 4.16699V11.667H18.3334V10.8337H17.5V10.0003H16.6667V9.16699H15V10.0003H14.1667V10.8337H13.3334V11.667H12.5V12.5003H11.6667V13.3337H10.8334V14.167H10V15.0003H8.33337V14.167H7.50004V13.3337H6.66671V12.5003H5.83337V11.667H4.16671V12.5003H3.33337V13.3337H2.50004V14.167H0.833374V12.5003H1.66671V11.667H2.50004V10.8337H3.33337V10.0003H4.16671V9.16699H5.83337V10.0003H6.66671V10.8337H7.50004V11.667H8.33337V12.5003H10V11.667H10.8334V10.8337H11.6667V10.0003H12.5V9.16699H13.3334V8.33366H14.1667V6.66699H13.3334V5.83366H12.5V5.00033H11.6667V4.16699H19.1667Z",fill:"white"})}),KB=({size:e})=>Ea.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",children:[Ea.jsx("path",{d:"M23 18H9V19H23V18Z",fill:"white"}),Ea.jsx("path",{d:"M23 12H9V13H23V12Z",fill:"white"}),Ea.jsx("path",{d:"M23 6H9V7H23V6Z",fill:"white"}),Ea.jsx("path",{d:"M7 15H8V17H7V18H6V19H5V20H4V21H3V20H2V19H1V17H2V18H3V19H4V18H5V17H6V16H7V15Z",fill:"white"}),Ea.jsx("path",{d:"M8 9V11H7V12H6V13H5V14H4V15H3V14H2V13H1V11H2V12H3V13H4V12H5V11H6V10H7V9H8Z",fill:"white"}),Ea.jsx("path",{d:"M8 3V5H7V6H6V7H5V8H4V9H3V8H2V7H1V5H2V6H3V7H4V6H5V5H6V4H7V3H8Z",fill:"white"})]}),ZB=({size:e})=>Ea.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 20 20",fill:"none",children:[Ea.jsx("g",{"clip-path":"url(#clip0_17795_142)",children:Ea.jsx("path",{d:"M18.3334 4.99967V3.33301H17.5V2.49967H16.6667V1.66634H15.8334V0.833008H4.16671V1.66634H3.33337V2.49967H2.50004V3.33301H1.66671V4.99967H0.833374V18.333H1.66671V19.1663H18.3334V18.333H19.1667V4.99967H18.3334ZM10.8334 2.49967H15V3.33301H15.8334V4.16634H16.6667V5.83301H10.8334V2.49967ZM3.33337 4.16634H4.16671V3.33301H5.00004V2.49967H9.16671V5.83301H3.33337V4.16634ZM2.50004 17.4997V7.49967H9.16671V9.16634H7.50004V12.4997H8.33337V13.333H10.8334V14.1663H7.50004V15.833H9.16671V17.4997H2.50004ZM17.5 17.4997H10.8334V15.833H12.5V12.4997H11.6667V11.6663H9.16671V10.833H12.5V9.16634H10.8334V7.49967H17.5V17.4997Z",fill:"white"})}),Ea.jsx("defs",{children:Ea.jsx("clipPath",{id:"clip0_17795_142",children:Ea.jsx("rect",{width:"20",height:"20",fill:"white"})})})]}),JB=({size:e})=>Ea.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 20 20",fill:"none",children:[Ea.jsx("path",{d:"M15 4.99967V7.49967H14.1666V8.33301H13.3333V9.16634H12.5V9.99967H11.6666V10.833H10.8333V11.6663H9.99996V10.833H9.16663V9.99967H8.33329V9.16634H7.49996V8.33301H6.66663V7.49967H5.83329V4.99967H6.66663V4.16634H9.16663V4.99967H9.99996V5.83301H10.8333V4.99967H11.6666V4.16634H14.1666V4.99967H15Z",fill:"white"}),Ea.jsx("path",{d:"M16.6666 14.1663H17.5V13.333H18.3333V1.66634H17.5V0.833008H3.33329V1.66634H2.49996V2.49967H1.66663V17.4997H2.49996V18.333H3.33329V19.1663H17.5V18.333H18.3333V17.4997H17.5V16.6663H16.6666V14.1663ZM15 17.4997H4.16663V16.6663H3.33329V14.9997H4.16663V14.1663H15V17.4997ZM3.33329 2.49967H16.6666V12.4997H3.33329V2.49967Z",fill:"white"})]}),XB=({size:e})=>Ea.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 20 20",fill:"none",children:[Ea.jsx("path",{d:"M14.1666 4.16634V2.49967H13.3333V1.66634H11.6666V0.833008H8.33329V1.66634H6.66663V2.49967H5.83329V4.16634H4.99996V7.49967H5.83329V9.16634H6.66663V9.99967H8.33329V10.833H11.6666V9.99967H13.3333V9.16634H14.1666V7.49967H15V4.16634H14.1666ZM12.5 7.49967V8.33301H11.6666V9.16634H8.33329V8.33301H7.49996V7.49967H6.66663V4.16634H7.49996V3.33301H8.33329V2.49967H11.6666V3.33301H12.5V4.16634H13.3333V7.49967H12.5Z",fill:"white"}),Ea.jsx("path",{d:"M17.5 15.833V14.9997H16.6666V14.1663H15.8333V13.333H14.1666V12.4997H5.83329V13.333H4.16663V14.1663H3.33329V14.9997H2.49996V15.833H1.66663V18.333H2.49996V19.1663H17.5V18.333H18.3333V15.833H17.5ZM4.16663 15.833V14.9997H5.83329V14.1663H14.1666V14.9997H15.8333V15.833H16.6666V17.4997H3.33329V15.833H4.16663Z",fill:"white"})]}),$B=({size:e})=>Ea.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 20 20",fill:"none",children:[Ea.jsx("path",{d:"M13.333 14.1663L12.1413 12.9746L14.283 10.833H7.49967V9.16634H14.283L12.1413 7.02467L13.333 5.83301L17.4997 9.99967L13.333 14.1663Z",fill:"white"}),Ea.jsx("path",{d:"M15.833 2.49967H4.16634C3.24967 2.49967 2.49967 3.24967 2.49967 4.16634V7.49967H4.16634V4.16634H15.833V15.833H4.16634V12.4997H2.49967V15.833C2.49967 16.7497 3.24967 17.4997 4.16634 17.4997H15.833C16.7497 17.4997 17.4997 16.7497 17.4997 15.833V4.16634C17.4997 3.24967 16.7497 2.49967 15.833 2.49967Z",fill:"white"})]}),YB=()=>{const e=Bg(),t=Ng(),{logout:s}=Qv(),i=t=>e.pathname===t?"active":"";return Ea.jsxs("div",{className:"min-h-screen text-white flex",children:[Ea.jsx("nav",{className:"bg-dark-secondary border-r border-dark-secondary w-64 min-h-screen relative",children:Ea.jsxs("div",{className:"p-4",children:[Ea.jsx("img",{src:"/logo.svg",alt:"Logo",className:" mb-16",draggable:"false"}),Ea.jsxs("div",{className:" gap-5 flex flex-col",children:[Ea.jsxs(gy,{to:"/",className:" flex gap-3 pl-6 pr-5 py-3 outline-none border-none  text-sm font-medium transition-colors "+(i("/")?"bg-translucent-light-8 text-light-primary":"text-light-primary hover:bg-translucent-light-8"),children:[Ea.jsx(QB,{size:20}),Ea.jsx("p",{className:"text-button-48-pixelify",children:"Dashboard"})]}),Ea.jsxs(gy,{to:"/leaderboard",className:" flex gap-3 pl-6 pr-5 py-3 outline-none border-none  text-sm font-medium transition-colors "+(i("/leaderboard")?"bg-translucent-light-8 text-light-primary":"text-light-primary hover:bg-translucent-light-8"),children:[Ea.jsx(qB,{size:20}),Ea.jsx("p",{className:"text-button-48-pixelify",children:"Leaderboard"})]}),Ea.jsxs(gy,{to:"/quest",className:" flex gap-3 pl-6 pr-5 py-3 outline-none border-none  text-sm font-medium transition-colors "+(i("/quest")?"bg-translucent-light-8 text-light-primary":"text-light-primary hover:bg-translucent-light-8"),children:[Ea.jsx(KB,{size:20}),Ea.jsx("p",{className:"text-button-48-pixelify",children:"Quest"})]}),Ea.jsxs(gy,{to:"/market",className:" flex gap-3 pl-6 pr-5 py-3 outline-none border-none  text-sm font-medium transition-colors "+(i("/market")?"bg-translucent-light-8 text-light-primary":"text-light-primary hover:bg-translucent-light-8"),children:[Ea.jsx(ZB,{size:20}),Ea.jsx("p",{className:"text-button-48-pixelify",children:"Market"})]}),Ea.jsxs(gy,{to:"/guide",className:" flex gap-3 pl-6 pr-5 py-3 outline-none border-none  text-sm font-medium transition-colors "+(i("/guide")?"bg-translucent-light-8 text-light-primary":"text-light-primary hover:bg-translucent-light-8"),children:[Ea.jsx(JB,{size:20}),Ea.jsx("p",{className:"text-button-48-pixelify",children:"Guide"})]}),Ea.jsxs(gy,{to:"/account",className:" flex gap-3 pl-6 pr-5 py-3 outline-none border-none  text-sm font-medium transition-colors "+(i("/account")?"bg-translucent-light-8 text-light-primary":"text-light-primary hover:bg-translucent-light-8"),children:[Ea.jsx(XB,{size:20}),Ea.jsx("p",{className:"text-button-48-pixelify",children:"Account"})]})]}),Ea.jsx("div",{className:"absolute bottom-4 left-4 right-4",children:Ea.jsxs("button",{onClick:()=>{s(),t("/login")},className:"w-full flex gap-3 pl-6 pr-5 py-3 outline-none border-none text-sm font-medium transition-colors text-light-primary hover:bg-translucent-light-8",children:[Ea.jsx($B,{size:20}),Ea.jsx("p",{className:"text-button-48-pixelify",children:"Logout"})]})})]})}),Ea.jsxs("div",{className:"flex-1 flex flex-col min-h-screen bg-dark-secondary",children:[Ea.jsx(WB,{}),Ea.jsx(Qg,{})]})]})},eR=({icon:e,title:t,value:s,subtitle:i,onClick:a,className:n="",height:r="h-[108px]",background:o="bg-[url('/small-frame.png')]",titleStyle:l="text-body-2-pixelify",valueStyle:c="text-heading-4-alagard",layout:h="vertical",disabled:u=!1,badge:d,customContent:p})=>{const f=a&&!u;return Ea.jsxs("div",{className:`relative p-8 flex w-full ${r} ${f?"cursor-pointer hover:opacity-80":""} ${n}`,onClick:f?a:void 0,children:[Ea.jsx("div",{className:`absolute inset-0 ${o} bg-no-repeat bg-cover pointer-events-none`}),Ea.jsx("div",{className:"relative z-10 flex justify-center items-center w-full h-full",children:p||Ea.jsxs("div",{className:"flex "+("horizontal"===h?"flex-row items-center gap-4":"flex-col gap-2 items-center"),children:[e&&Ea.jsx("div",{className:"flex-shrink-0",children:e}),Ea.jsxs("div",{className:`flex flex-col ${"horizontal"===h?"items-start":"items-center"} gap-1`,children:[Ea.jsx("p",{className:l,children:t}),Ea.jsx("p",{className:`${c} ${u?"opacity-50":""}`,children:s}),i&&Ea.jsx("p",{className:"text-xs text-gray-400",children:i})]}),d&&Ea.jsx("div",{className:"absolute top-2 right-2",children:d})]})})]})},tR=({title:e,value:t,progress:s,description:i,onUpgrade:a,isMaxed:n,upgradeId:r,upgradeCost:o})=>Ea.jsxs("div",{className:"relative p-8 flex w-full h-[160px]",children:[Ea.jsx("div",{className:"absolute inset-0 bg-[url('/big-frame.png')] bg-no-repeat bg-cover pointer-events-none"}),Ea.jsxs("div",{className:"relative z-10 flex flex-col justify-center items-center w-full h-full gap-3",children:[Ea.jsxs("div",{className:"flex flex-col gap-1 items-center",children:[Ea.jsx("p",{className:"text-body-2-pixelify text-center text-[#ffae0b]",children:e}),Ea.jsx("p",{className:"text-heading-4-alagard",children:t}),s&&Ea.jsx("p",{className:"text-xs text-gray-400",children:s})]}),a&&Ea.jsx("button",{onClick:()=>a(r),disabled:n,className:"mt-2 px-4 py-2 text-sm font-bold rounded "+(n?"bg-gray-500 text-gray-300 cursor-not-allowed":"bg-yellow-600 hover:bg-yellow-700 text-white"),children:n?"MAXED":`UPGRADE (${o||0} gold)`})]})]}),sR=()=>{var e,t,s,i;const{user:a}=Qv(),n=OB(),[r,o]=ga.useState(""),{data:l,isLoading:c,error:h}=VB({queryKey:["user",a.id],queryFn:()=>(async e=>{try{return(await jv.get(`/users/${e}`)).data}catch(h){throw console.error("Failed to get user by ID:",h),h}})(a.id),enabled:!!(null==a?void 0:a.id)}),{data:u}=VB({queryKey:["user-maps"],queryFn:()=>(async()=>{try{return(await jv.get("/maps")).data}catch(h){throw console.error("Failed to get maps:",h),h}})()}),{data:d}=VB({queryKey:["user-stats"],queryFn:()=>(async()=>{try{return(await jv.get("/my/statistic")).data.data}catch(h){throw console.error("Failed to get all users:",h),h}})()}),{data:p}=VB({queryKey:["user-upgrades"],queryFn:()=>TM()}),{data:f}=VB({queryKey:["user-global-rank"],queryFn:async()=>{try{console.log("Fetching global scores...");const e=await AM();console.log("Global scores response:",e);const t=(null==e?void 0:e.data)||e||[];console.log("Scores data:",t);const s=t.findIndex((e=>{var t;return e.userId===(null==a?void 0:a.id)||e.id===(null==a?void 0:a.id)||e.username===(null==(t=null==a?void 0:a.data)?void 0:t.username)||e.username===(null==a?void 0:a.username)}));console.log("User rank found:",s);const i=-1!==s?s+1:"N/A";return console.log("Final rank:",i),i}catch(e){return console.error("Failed to get global rank:",e),"N/A"}},enabled:!!(null==a?void 0:a.id)}),m=GB({mutationFn:PM,onSuccess:()=>{n.invalidateQueries({queryKey:["user-upgrades"]}),n.invalidateQueries({queryKey:["user-stats"]}),n.invalidateQueries({queryKey:["user",a.id]}),kM.emit("upgrade-purchased"),console.log("Dashboard: Upgrade purchased, notified GameManager"),o("Upgrade successful!"),setTimeout((()=>o("")),3e3)},onError:e=>{var t,s,i,a,n,r,l,c;console.error("Failed to upgrade:",e);let h="Failed to upgrade. Please try again.";(null==(i=null==(s=null==(t=e.response)?void 0:t.data)?void 0:s.error)?void 0:i.message)?h=e.response.data.error.message:400===(null==(a=e.response)?void 0:a.status)?h="Insufficient gold to purchase this upgrade!":401===(null==(n=e.response)?void 0:n.status)?h="Authentication required. Please log in again.":403===(null==(r=e.response)?void 0:r.status)?h="You don't have permission to perform this action.":404===(null==(l=e.response)?void 0:l.status)?h="Upgrade not found.":(null==(c=e.response)?void 0:c.status)>=500&&(h="Server error. Please try again later."),o(h),setTimeout((()=>o("")),5e3)}}),g=e=>{m.mutate(e)};return console.log("globalRank",f),ga.useEffect((()=>{const e=()=>{console.log("Dashboard: Invalidating queries after game session ended"),n.invalidateQueries({queryKey:["user"]}),n.invalidateQueries({queryKey:["user-stats"]}),n.invalidateQueries({queryKey:["user-upgrades"]}),n.invalidateQueries({queryKey:["user-maps"]})};return kM.on("invalidate-dashboard-data",e),()=>{kM.removeListener("invalidate-dashboard-data",e)}}),[n]),c?Ea.jsx("div",{children:"Loading..."}):h?Ea.jsx("div",{children:"Error loading user data"}):Ea.jsxs("div",{className:"min-h-screen flex flex-col text-white pl-6 pr-6",children:[r&&Ea.jsx("div",{className:"p-4 mb-4 bg-yellow-900 text-[#ffae0b] rounded text-center font-bold shadow border border-[#ffae0b]",children:r}),Ea.jsxs("div",{className:"p-6 flex flex-col gap-6 border border-[#24110F] rounded-lg bg-dark-secondary mb-6",children:[Ea.jsx("h1",{className:"text-heading-3-alagard",style:{color:"#ffae0b"},children:"Statistics"}),Ea.jsxs("div",{className:"grid grid-cols-2 minh-screen md:grid-cols-3 gap-6",children:[Ea.jsx(eR,{title:"Current Gold",value:(null==(t=null==(e=null==l?void 0:l.data)?void 0:e.gold)?void 0:t.toLocaleString())||0,titleStyle:"text-body-2-pixelify text-[#ffae0b]"}),Ea.jsx(eR,{title:"Global Rank",value:f||"Loading...",titleStyle:"text-body-2-pixelify text-[#ffae0b]"}),Ea.jsx(eR,{title:"Total Runs",value:(null==d?void 0:d.totalRuns)||0,titleStyle:"text-body-2-pixelify text-[#ffae0b]"}),Ea.jsx(eR,{title:"Highest level",value:(null==d?void 0:d.maxSkillLevel)||0,titleStyle:"text-body-2-pixelify text-[#ffae0b]"}),Ea.jsx(eR,{title:"Total Gold Earned",value:(null==(s=null==d?void 0:d.totalGoldEarned)?void 0:s.toLocaleString())||0,titleStyle:"text-body-2-pixelify text-[#ffae0b]"}),Ea.jsx(eR,{title:"Enemies Killed",value:(null==d?void 0:d.totalKillPoints)||0,titleStyle:"text-body-2-pixelify text-[#ffae0b]"}),Ea.jsx(eR,{title:"Average survival",value:(null==d?void 0:d.averageSurvival)||"00:00",titleStyle:"text-body-2-pixelify text-[#ffae0b]"}),Ea.jsx(eR,{title:"Longest Survival",value:(null==d?void 0:d.longestSurvival)||"00:00",titleStyle:"text-body-2-pixelify text-[#ffae0b]"})]})]}),Ea.jsxs("div",{className:"bg-dark-secondary border border-[#24110F] rounded-lg overflow-hidden w-full",children:[Ea.jsx("div",{className:"bg-[#24110F] border-b border-[#2F1A18]",children:Ea.jsx("h2",{className:"text-heading-1-pixelify-bold text-[#FFAE0B]",children:"Upgrades"})}),Ea.jsx("div",{className:"p-6 max-h-96 overflow-y-auto \n    scrollbar-thin \n    scrollbar-track-gray-800 \n    scrollbar-thumb-[#FFAE0B] \n    scrollbar-thumb-rounded-full \n    hover:scrollbar-thumb-[#FFAE0B]/80\n    [&::-webkit-scrollbar]:w-2\n    [&::-webkit-scrollbar-track]:bg-gray-800\n    [&::-webkit-scrollbar-thumb]:bg-[#FFAE0B]\n    [&::-webkit-scrollbar-thumb]:rounded-full\n    [&::-webkit-scrollbar-thumb]:hover:bg-[#FFAE0B]/80\n  ",style:{scrollbarWidth:"thin",scrollbarColor:"#FFAE0B #2D3748"},children:Ea.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3  gap-6",children:(null==(i=null==p?void 0:p.data)?void 0:i.map((e=>Ea.jsx(tR,{title:e.name,value:`Level ${e.level}`,progress:e.progress,description:e.description,onUpgrade:g,isMaxed:e.isMaxed,upgradeId:e.id,upgradeCost:e.cost||e.upgradeCost||0},e.id))))||Ea.jsxs(Ea.Fragment,{children:[Ea.jsx(tR,{title:"Weapon",value:"Sword",upgradeCost:100}),Ea.jsx(tR,{title:"Armor",value:"Leather",upgradeCost:150}),Ea.jsx(tR,{title:"Shield",value:"Wooden",upgradeCost:120}),Ea.jsx(tR,{title:"Potion",value:"Health",upgradeCost:80}),Ea.jsx(tR,{title:"Spell",value:"Fireball",upgradeCost:200}),Ea.jsx(tR,{title:"Pet",value:"Wolf",upgradeCost:300})]})})})]})]})},iR=()=>{const[e,t]=ga.useState("experience"),{data:s,isLoading:i,isError:a,error:n}=VB({queryKey:["globalScores"],queryFn:AM}),{data:r,isLoading:o,isError:l,error:c}=VB({queryKey:["globalKillCounts"],queryFn:SM}),h="killCount"===e?l:a,u="killCount"===e?c:n,d="killCount"===e?r:s;if("killCount"===e?o:i)return Ea.jsx("div",{className:"p-8 text-white",children:"Loading..."});if(h)return Ea.jsxs("div",{className:"p-8 text-white",children:["Failed to load leaderboard.",Ea.jsx("br",{}),JSON.stringify(u)]});const p=(null==d?void 0:d.data)?[...d.data].sort(((t,s)=>{let i,a;switch(e){case"killCount":i=t.killPoints||0,a=s.killPoints||0;break;case"experience":default:i=t.experience||0,a=s.experience||0;break;case"gold":i=t.gold||0,a=s.gold||0;break;case"totalGames":i=t.totalGames||0,a=s.totalGames||0}return i<a?1:-1})):[];return Ea.jsxs("div",{className:"min-h-screen flex flex-col text-white pl-6 pr-6",children:[Ea.jsxs("div",{className:"flex items-center justify-between mb-6 px-8",children:[Ea.jsx("h1",{className:"font-alagard font-medium text-[#FFAE0B] text-3xl leading-10",children:"Leaderboard"}),Ea.jsx("div",{className:"flex items-center space-x-4 pt-6",children:Ea.jsxs("div",{className:"relative",children:[Ea.jsxs("select",{value:e,onChange:e=>t(e.target.value),className:"bg-dark-secondary rounded px-3 py-2 text-white appearance-none cursor-pointer pr-8 w-full h-full",children:[Ea.jsx("option",{value:"experience",children:"Experience"}),Ea.jsx("option",{value:"killCount",children:"Kill Points"}),Ea.jsx("option",{value:"gold",children:"Gold"}),Ea.jsx("option",{value:"totalGames",children:"Games Played"})]}),Ea.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:Ea.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Ea.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})})]}),Ea.jsxs("div",{className:"bg-dark-secondary  border border-[#24110F] rounded-lg overflow-hidden w-full",children:[Ea.jsx("div",{className:"bg-[#24110F] border-b border-[#2F1A18] px-6 py-4",children:Ea.jsxs("h2",{className:"text-heading-1-pixelify-bold text-[#FFAE0B]",children:["Top Players (",p.length," players)"]})}),Ea.jsx("div",{className:"divide-y divide-[#2F1A18] min-h-screen max-h-96 overflow-y-auto \n    scrollbar-thin \n    scrollbar-track-gray-800 \n    scrollbar-thumb-[#FFAE0B] \n    scrollbar-thumb-rounded-full \n    hover:scrollbar-thumb-[#FFAE0B]/80\n    [&::-webkit-scrollbar]:w-2\n    [&::-webkit-scrollbar-track]:bg-gray-800\n    [&::-webkit-scrollbar-thumb]:bg-[#FFAE0B]\n    [&::-webkit-scrollbar-thumb]:rounded-full\n    [&::-webkit-scrollbar-thumb]:hover:bg-[#FFAE0B]/80\n  ",style:{scrollbarWidth:"thin",scrollbarColor:"#FFAE0B #2D3748"},children:p.map(((t,s)=>Ea.jsxs("div",{className:"px-6 py-4 flex items-center justify-between hover:bg-translucent-light-4 transition-colors",children:[Ea.jsxs("div",{className:"flex items-center space-x-4",children:[Ea.jsx("div",{className:"flex items-center justify-center border-2 border-[#392423] bg-[#2F1A18] p-1 w-12 h-9",children:s+1}),Ea.jsx("div",{children:Ea.jsx("p",{className:"text-body-1-alagard font-bold",children:t.username||t.name})})]}),Ea.jsx("div",{className:"text-right",children:Ea.jsx("p",{className:"text-body-1-alagard font-bold",children:"killCount"===e?`${(t.killPoints||0).toLocaleString()} kill pts`:"experience"===e?`${(t.experience||0).toLocaleString()} XP`:"gold"===e?`${(t.gold||0).toLocaleString()} gold`:"totalGames"===e?`${(t.totalGames||0).toLocaleString()} games`:`${(t.experience||0).toLocaleString()} XP`})})]},t.id||s)))})]})]})},aR=()=>Ea.jsx("div",{children:Ea.jsx("h1",{className:"text-display-1-alagard-bold flex flex-col items-center justify-center h-screen text-center text-[#FFAE0B]",children:"Coming soon"})}),nR=()=>Ea.jsx("div",{children:Ea.jsx("h1",{className:"text-display-1-alagard-bold flex flex-col items-center justify-center h-screen text-center text-[#FFAE0B]",children:"Coming soon"})}),rR=()=>{const[e,t]=ga.useState("faq"),s={faq:{content:Ea.jsxs("div",{className:"space-y-8 bg-dark-secondary",children:[Ea.jsxs("div",{children:[Ea.jsx("h3",{className:"text-heading-1-pixelify-bold mb-4",children:"How to play?"}),Ea.jsxs("div",{className:"space-y-4",children:[Ea.jsxs("div",{children:[Ea.jsx("h4",{className:"text-heading-2-pixelify-bold mb-2 text-[#FFAE0B]",children:"Movement:"}),Ea.jsx("p",{className:"text-body-1-alagard text-gray-300",children:"Use WASD keys or hold the right mouse button to follow the cursor."}),Ea.jsx("img",{className:"pt-2",src:"/guideGif.gif",alt:"Movement"})]}),Ea.jsxs("div",{children:[Ea.jsx("h4",{className:"text-heading-2-pixelify-bold mb-2 text-[#FFAE0B]",children:"Collecting Resources:"}),Ea.jsx("p",{className:"text-body-1-alagard text-gray-300",children:"Collect EXP and gold drops from enemy mobs by walking near or over the items."})]})]})]}),Ea.jsxs("div",{children:[Ea.jsx("h3",{className:"text-heading-1-pixelify-bold mb-4",children:"Portal System"}),Ea.jsx("p",{className:"text-body-1-alagard text-gray-300",children:"The main map has 4 portals located at each corner of the map. Portals randomly activate after the player survives 3 minutes. If the player manages to enter an activated portal before it closes, they are transported to one of 4 bonus maps: - Beach of Undeath- Dark Forest - Nest of Underlord - Maze"})]}),Ea.jsxs("div",{children:[Ea.jsx("h3",{className:"text-heading-1-pixelify-bold mb-4",children:"Character Upgrades"}),Ea.jsx("p",{className:"text-body-1-alagard text-gray-300",children:"To upgrade your character, collect EXP throughout the map to level up. When leveled up, 3 random skill upgrade cards appear and the player must choose one of the 3. If a player manages to choose the same skill 10 times, that skill upgrades to an Ultimate skill and unlocks a hidden ability."})]}),Ea.jsxs("div",{children:[Ea.jsx("h3",{className:"text-heading-1-pixelify-bold mb-4",children:"Base Stats:"}),Ea.jsx("p",{className:"text-body-1-alagard text-gray-300",children:"Upgrades Every player can upgrade their base stats from the main menu Dashboard section, using gold coins collected from previous game sessions."})]}),Ea.jsxs("div",{children:[Ea.jsx("h3",{className:"text-heading-1-pixelify-bold mb-4 text-[#FFAE0B]",children:"Maps"}),Ea.jsxs("div",{className:"space-y-6",children:[Ea.jsxs("div",{children:[Ea.jsx("h4",{className:"text-heading-2-pixelify-bold mb-2",children:"Dark Forest:"}),Ea.jsx("p",{className:"text-body-1-alagard text-gray-300",children:"Dark Forest is the territory of Dark Elves, who are allies with humans. However, ancient creatures controlled by demons want to destroy the Dark Elves' totem, which has the ability to keep demons away from their territory. The player helps protect their totem and receives an EXP multiplier as a reward. This map features wave-based attacks with a total of 5 waves."})]}),Ea.jsxs("div",{children:[Ea.jsx("h4",{className:"text-heading-2-pixelify-bold mb-2",children:"Nest of Underlord:"}),Ea.jsx("p",{className:"text-body-1-alagard text-gray-300",children:"This place is a boss area featuring the most powerful enemy in the game, along with ghouls that you must fight. The map has a 5-minute time limit. If the player manages to kill the boss, they are granted an Ultimate skill. If not, the player will be sent back to the main map as long as they survive."})]}),Ea.jsxs("div",{children:[Ea.jsx("h4",{className:"text-heading-2-pixelify-bold mb-2",children:"Beach of Undeaths:"}),Ea.jsx("p",{className:"text-body-1-alagard text-gray-300",children:"A nice beach cursed with pirate members and goblins. This map provides a gold multiplier and has randomly spawning gold treasure. There is also a mini-boss pirate captain who is much more powerful than regular mobs on the map. The map has a 3-minute time limit, so kill as many mobs as possible to collect resources for later upgrades and consumable items."})]}),Ea.jsxs("div",{children:[Ea.jsx("h4",{className:"text-heading-2-pixelify-bold mb-2",children:"Chaos Realm:"}),Ea.jsx("p",{className:"text-body-1-alagard text-gray-300",children:"The Chaos Realm is a hellish, volcanic underground place where the player must escape within 5 minutes. This map features extreme difficulty with exclusive rewards. The longer it takes, the more the player loses score. If the score reaches 0, the player faces instant death. When the map is completed, the player is rewarded with multiplied rewards based on leftover time."})]})]})]})]})},skill:{content:Ea.jsxs("div",{className:"space-y-8 bg-dark-secondary",children:[Ea.jsxs("div",{children:[Ea.jsxs("div",{className:"mb-8",children:[Ea.jsx("h4",{className:"text-heading-2-pixelify-bold mb-2 text-[#FFAE0B]",children:"Basic skill: Slash"}),Ea.jsxs("div",{className:"space-y-2 mb-4",children:[Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Type:"})," ","Physical Swordsmanship"]}),Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Attack Range:"})," ","Short (Melee)"]}),Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Progression:"})," ","10 Levels (BasicMasterEmperor Divine  God)"]})]}),Ea.jsx("p",{className:"text-body-1-alagard text-gray-300 mb-4",children:"A masterful swordsmanship technique passed down through generations of cathedral knights, this devastating slash channels the wielder's soul into their blade. What begins as a simple cut evolves into a strike capable of cleaving through the very fabric of darkness itself."}),Ea.jsxs("div",{children:[Ea.jsx("h5",{className:"text-heading-3-pixelify-bold mb-2 text-[#FFAE0B]",children:"Upgrade:"}),Ea.jsxs("ul",{className:"text-body-1-alagard text-gray-300 space-y-1",children:[Ea.jsx("li",{children:" Slash's AoE and Damage will increase due to the Slash card"}),Ea.jsx("li",{children:" Slash's Damage will increase due to the Attack Damage card"}),Ea.jsx("li",{children:" Slash's CD will be reduced due to the Cooldown Reduction card"}),Ea.jsx("li",{children:" Slash's AoE will increase due to the Attack Range card"}),Ea.jsx("li",{children:" Slash will upgrade into Dash slash select 10 times Slash card in per session"})]})]})]}),Ea.jsxs("div",{className:"mb-8",children:[Ea.jsx("h4",{className:"text-heading-2-pixelify-bold mb-2 text-[#FFAE0B]",children:"Basic Skill: Marksman"}),Ea.jsxs("div",{className:"space-y-2 mb-4",children:[Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Skill Type:"})," ","Single target/Projectile"]}),Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Attack Range:"})," ","Long"]}),Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Progression:"})," ","10 Levels (BasicMasterEmperor Divine  God)"]})]}),Ea.jsx("p",{className:"text-body-1-alagard text-gray-300 mb-4",children:"A refined marksmanship technique developed by monster hunters who rely on precision and skill rather than mystical power. This gunmanship art focuses on exploiting weak points and vital areas of monstrous creatures through disciplined training and keen observation. Beginning with basic accuracy, the skill evolves through ten levels of masteryfrom simple headshots to god-tier precision that can pierce through multiple targets, ignore thick hide and bone, and deliver devastating critical strikes. At its pinnacle, master marksmen achieve supernatural focus and timing, allowing them to place shots with impossible accuracy even against the fastest and most elusive beasts."}),Ea.jsxs("div",{children:[Ea.jsx("h5",{className:"text-heading-3-pixelify-bold mb-2 text-[#FFAE0B]",children:"Upgrade:"}),Ea.jsxs("ul",{className:"text-body-1-alagard text-gray-300 space-y-1",children:[Ea.jsx("li",{children:" Marksman's Damage will increase due to the Marksman card"}),Ea.jsx("li",{children:" Marksman's Projectile number will increase due to the Marksman skill tier"}),Ea.jsx("li",{children:" Marksman's Damage will increase due to the Attack Damage card"}),Ea.jsx("li",{children:" Marksman's CD will be reduced due to the Cooldown Reduction card"}),Ea.jsx("li",{children:" Marksman's Attack range will increase due to the Attack Range card"}),Ea.jsx("li",{children:" Marksman will upgrade into Barrage skill when the Marksmanship skill becomes God Tier"})]})]})]})]}),Ea.jsxs("div",{children:[Ea.jsx("h3",{className:"text-heading-1-pixelify-bold mb-4 text-[#FFAE0B]",children:"Magic Skills"}),Ea.jsxs("div",{className:"mb-8",children:[Ea.jsx("h4",{className:"text-heading-2-pixelify-bold mb-2 text-[#FFAE0B]",children:"Magic skill: Fire Ball"}),Ea.jsxs("div",{className:"space-y-2 mb-4",children:[Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Type:"})," Single target/ AoE/DOT/Magical"]}),Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Effect:"})," ","Blast enemies, does DOT damage"]}),Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Attack Range:"})," ","Medium (Ranged)"]}),Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Progression:"})," ","10 Levels (BasicMasterEmperor Divine  God)"]})]}),Ea.jsx("p",{className:"text-body-1-alagard text-gray-300 mb-4",children:"A devastating magical art that conjures spheres of concentrated flame to obliterate enemies from afar. This ancient pyromantic technique begins with simple fire manipulation but evolves through ten levels of mastery into an apocalyptic force capable of turning entire battlefields into blazing infernos. The caster manifests a blazing orb of pure fire that streaks across the battlefield before erupting in a violent explosion, incinerating everything within its radius. At god-tier mastery, these fireballs burn with such intensity they can melt stone, vaporize water, and leave craters of molten glass where once enemies stood, with explosions so massive they can consume entire monster hordes in walls of searing flame."}),Ea.jsxs("div",{children:[Ea.jsx("h5",{className:"text-heading-3-pixelify-bold mb-2 text-[#FFAE0B]",children:"Upgrade:"}),Ea.jsxs("ul",{className:"text-body-1-alagard text-gray-300 space-y-1",children:[Ea.jsx("li",{children:" Fire Ball's Damage will increase due to the Fire Ball card"}),Ea.jsx("li",{children:" Fire Ball's Projectile number will increase when Fire Ball is in each tier"}),Ea.jsx("li",{children:" Fire Ball's Damage will increase due to the Attack Damage card"}),Ea.jsx("li",{children:" Fire Ball's CD will be reduced due to the Cooldown Reduction card"}),Ea.jsx("li",{children:" Fire Ball's Attack range and AoE will increase due to the Attack Range card"}),Ea.jsx("li",{children:" Fire Ball will upgrade into Fire Blizzard skill when the Fire Ball skill becomes God Tier"})]})]})]}),Ea.jsxs("div",{className:"mb-8",children:[Ea.jsx("h4",{className:"text-heading-2-pixelify-bold mb-2 text-[#FFAE0B]",children:"Magic skill: Fire Arrow"}),Ea.jsxs("div",{className:"space-y-2 mb-4",children:[Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Type:"})," Single target/DOT/ Magical"]}),Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Effect:"})," ","Pierces through enemies, does DOT damage"]}),Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Attack Range:"})," ","Long (Piercing Ranged)"]}),Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Progression:"})," ","10 Levels (BasicMasterEmperor Divine  God-tier)"]})]}),Ea.jsx("p",{className:"text-body-1-alagard text-gray-300 mb-4",children:"A precise magical archery technique that creates arrows of pure flame to pierce and burn through enemy ranks. This ancient pyromantic art begins with simple fire-imbued projectiles but evolves through ten levels of mastery into devastating lances of concentrated flame that can penetrate multiple foes in a single shot. The caster manifests a blazing arrow that streaks through the air, piercing straight through enemies while leaving trails of searing fire in its wake, scorching everything it passes through. At god-tier mastery, these flame arrows burn with such ferocity they can punch through the thickest armor and bone, creating chains of burning destruction as they pass through entire groups of monsters, leaving smoldering wounds that continue to burn long after impact."}),Ea.jsxs("div",{children:[Ea.jsx("h5",{className:"text-heading-3-pixelify-bold mb-2 text-[#FFAE0B]",children:"Upgrade:"}),Ea.jsxs("ul",{className:"text-body-1-alagard text-gray-300 space-y-1",children:[Ea.jsx("li",{children:" Fire Arrow's Damage will increase due to the Fire Arrow card"}),Ea.jsx("li",{children:" Fire Arrow's Projectile number will increase when Fire Arrow is in each tier"}),Ea.jsx("li",{children:" Fire Arrow's Damage will increase due to the Attack Damage card"}),Ea.jsx("li",{children:" Fire Arrows CD will be reduced due to the Cooldown Reduction card"}),Ea.jsx("li",{children:" Fire Arrow's Attack range and AoE will increase due to the Attack Range card"}),Ea.jsx("li",{children:" Fire Arrow will upgrade into the Split Fire skill when the Fire Arrow skill becomes God Tier"})]})]})]}),Ea.jsxs("div",{className:"mb-8",children:[Ea.jsx("h4",{className:"text-heading-2-pixelify-bold mb-2 text-[#FFAE0B]",children:"Magic skill: Ice Shard"}),Ea.jsxs("div",{className:"space-y-2 mb-4",children:[Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Type:"})," Single target/ AoE/Crowd Control/Magical/ Slow"]}),Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Effect:"})," ","Blast slows enemies in the area"]}),Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Attack Range:"})," ","Long (Piercing Ranged)"]}),Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Progression:"})," ","10 Levels (BasicMasterEmperor Divine  God-tier)"]})]}),Ea.jsx("p",{className:"text-body-1-alagard text-gray-300 mb-4",children:"A chilling magical technique that hurls razor-sharp shards of enchanted ice to slow and damage enemies across the battlefield. This ancient cryomantic art begins with simple ice manipulation but evolves through ten levels of mastery into devastating frozen projectiles that can halt entire monster hordes in their tracks. The caster manifests a gleaming ice shard that streaks toward its target before shattering mid-air, releasing a burst of freezing mist that chills the air and slows all enemies caught within its frigid radius. At god-tier mastery, these ice shards explode with such bone-deep cold they can freeze blood in veins, turn flesh brittle as glass, and create expanding zones of supernatural winter that leave monsters crawling at a snail's pace through fields of deadly frost."}),Ea.jsxs("div",{children:[Ea.jsx("h5",{className:"text-heading-3-pixelify-bold mb-2 text-[#FFAE0B]",children:"Upgrade:"}),Ea.jsxs("ul",{className:"text-body-1-alagard text-gray-300 space-y-1",children:[Ea.jsx("li",{children:" Ice Shard's Damage will increase due to the Ice Shard card"}),Ea.jsx("li",{children:" Ice Shard's Damage will increase due to the Attack Damage card"}),Ea.jsx("li",{children:" Ice Shard's CD will be reduced due to the Cooldown Reduction card"}),Ea.jsx("li",{children:" Ice Shard's Attack range and AoE will increase due to the Attack Range card"}),Ea.jsx("li",{children:" Ice Shard will upgrade into the Freezing Field skill when the Ice Shard skill becomes God Tier"})]})]})]}),Ea.jsxs("div",{className:"mb-8",children:[Ea.jsx("h4",{className:"text-heading-2-pixelify-bold mb-2 text-[#FFAE0B]",children:"Magic skill: Lightning Chain"}),Ea.jsxs("div",{className:"space-y-2 mb-4",children:[Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Type:"})," ","Multi-target/Chain/Crowd Control/Magical/"]}),Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Effect:"})," ","Blast slows enemies in the area"]}),Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Attack Range:"})," ","Long (Piercing Ranged)"]}),Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Progression:"})," ","10 Levels (BasicMasterEmperor Divine  God-tier)"]})]}),Ea.jsx("p",{className:"text-body-1-alagard text-gray-300 mb-4",children:"A devastating electrical magic that unleashes arcing bolts of lightning to jump between multiple enemies in succession. This ancient storm magic begins with simple electrical manipulation but evolves through ten levels of mastery into god-tier lightning that can leap across entire battlefields, stunning and frying dozens of monsters in a single cast. The caster releases a crackling bolt that strikes the first target before chaining to nearby enemies, each successive jump dealing reduced but still lethal damage while leaving victims paralyzed by electrical shock. At its pinnacle, these lightning chains can arc through seemingly endless numbers of foes, turning entire monster hordes into writhing, electrocuted masses as the bolt seeks out every living creature within range, growing weaker with each jump but never losing its ability to stun and disable even the most resilient beasts."}),Ea.jsxs("div",{children:[Ea.jsx("h5",{className:"text-heading-3-pixelify-bold mb-2 text-[#FFAE0B]",children:"Upgrade:"}),Ea.jsxs("ul",{className:"text-body-1-alagard text-gray-300 space-y-1",children:[Ea.jsx("li",{children:" Lightning Chain's Damage will increase due to the Lightning Chain card"}),Ea.jsx("li",{children:" Lightning Chain's target number will increase due to the Lightning Chain card, but the leap number will decrease"}),Ea.jsx("li",{children:" Lightning Chain's Damage will increase due to the Attack Damage card"}),Ea.jsx("li",{children:" Lightning Chain's CD will be reduced due to the Cooldown Reduction card"}),Ea.jsx("li",{children:" Lightning Chain's Attack range and AoE will increase due to the Attack Range card"}),Ea.jsx("li",{children:" Lightning Chain will upgrade into the Surge of Lightning skill when the Lightning Chain skill becomes God Tier"})]})]})]}),Ea.jsxs("div",{className:"mb-8",children:[Ea.jsx("h4",{className:"text-heading-2-pixelify-bold mb-2 text-[#FFAE0B]",children:"Magic skill: Holy Light"}),Ea.jsxs("div",{className:"space-y-2 mb-4",children:[Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Type:"}),"AoE/Crowd Control/Magical/"]}),Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Effect:"})," Slim chance of Blinds the enemy, not able to do melee damage"]}),Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Attack Range:"}),"AoE"]}),Ea.jsxs("p",{className:"text-body-1-alagard text-gray-300",children:[Ea.jsx("span",{className:"text-[#FFAE0B] font-bold",children:"Progression:"}),"10 Levels (BasicMasterEmperor Divine  God-tier)"]})]}),Ea.jsx("p",{className:"text-body-1-alagard text-gray-300 mb-4",children:"A sacred magical art that unleashes blinding flashes of pure holy light to temporarily disable enemies across the battlefield. This divine technique begins with simple light manipulation but evolves through ten levels of mastery into god-tier radiance that can blind entire armies of darkness with overwhelming luminescence. The caster channels celestial energy into a brilliant flash that erupts outward, searing the vision of all enemies within range and leaving them unable to strike accurately for several crucial moments. At its pinnacle, this holy light burns with such intensity that it can blind even creatures of shadow and undead abominations, creating cascading waves of radiance that spread from enemy to enemy, ensuring that entire monster hordes stumble helplessly in temporary blindness as the divine light overwhelms their senses and renders them defenseless against follow-up attacks."}),Ea.jsxs("div",{children:[Ea.jsx("h5",{className:"text-heading-3-pixelify-bold mb-2 text-[#FFAE0B]",children:"Upgrade:"}),Ea.jsxs("ul",{className:"text-body-1-alagard text-gray-300 space-y-1",children:[Ea.jsx("li",{children:" Holy Light's change to blind the enemy will increase due to the Holy Light in each tier"}),Ea.jsx("li",{children:" Holy Light's CD will be reduced due to the Holy Light card"}),Ea.jsx("li",{children:" Holy Light's CD will be reduced due to the Cooldown Reduction card"}),Ea.jsx("li",{children:" Holy Light's Attack range and AoE will increase due to the Attack Range card"}),Ea.jsx("li",{children:" Holy Light will upgrade into the Holy Being skill when the Holy Light skill becomes God Tier"})]})]})]})]})]})},defense:{content:Ea.jsxs("div",{className:"space-y-6 bg-dark-secondary",children:[Ea.jsx("h3",{className:"text-heading-1-pixelify-bold mb-4",children:"Defense Mechanics"}),Ea.jsx("p",{className:"text-body-1-alagard text-gray-300",children:"Understanding defense mechanics is crucial for surviving the dangerous dungeons and boss encounters."})]})},stats:{content:Ea.jsxs("div",{className:"space-y-6 bg-dark-secondary",children:[Ea.jsx("h3",{className:"text-heading-1-pixelify-bold mb-4",children:"Character Statistics"}),Ea.jsx("p",{className:"text-body-1-alagard text-gray-300",children:"Your character's stats determine their effectiveness in combat and exploration."})]})}};return Ea.jsxs("div",{className:"text-white flex flex-col absolute w-[1176px] h-[944px] top-20 left-64 bg-dark-secondary pt-12 pr-6 pb-12 pl-6 gap-6",children:[Ea.jsx("h1",{className:"text-display-1-alagard-bold text-left text-[#FFAE0B]",children:"Guide"}),Ea.jsx("div",{className:"flex space-x-2",children:[{id:"faq",label:"FAQ"},{id:"skill",label:"Skill"}].map((s=>Ea.jsx("button",{onClick:()=>t(s.id),className:"px-6 py-3 rounded-md transition-colors text-button-48-pixelify "+(e===s.id?"bg-red-600 text-white":"bg-transparent border border-red-600 text-white hover:bg-red-600/20"),children:s.label},s.id)))}),Ea.jsx("div",{className:"w-full flex-1 overflow-y-auto max-h-[600px] \n    scrollbar-thin \n    scrollbar-track-gray-800 \n    scrollbar-thumb-[#FFAE0B] \n    scrollbar-thumb-rounded-full \n    hover:scrollbar-thumb-[#FFAE0B]/80\n    [&::-webkit-scrollbar]:w-2\n    [&::-webkit-scrollbar-track]:bg-gray-800\n    [&::-webkit-scrollbar-thumb]:bg-[#FFAE0B]\n    [&::-webkit-scrollbar-thumb]:rounded-full\n    [&::-webkit-scrollbar-thumb]:hover:bg-[#FFAE0B]/80\n  ",style:{scrollbarWidth:"thin",scrollbarColor:"#FFAE0B #2D3748"},children:s[e].content})]})},oR=({size:e})=>Ea.jsx("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Ea.jsx("path",{d:"M29.3333 13.334V10.6673H27.9999V8.00065H26.6666V5.33398H25.3333V4.00065H22.6666V2.66732H18.6666V1.33398H13.3333V2.66732H9.33325V4.00065H6.66658V5.33398H5.33325V6.66732H3.99992V9.33398H2.66659V12.0007H1.33325V20.0007H2.66659V22.6673H3.99992V25.334H5.33325V26.6673H6.66658V28.0006H9.33325V29.334H13.3333V30.6673H18.6666V29.334H22.6666V26.6673H18.6666V28.0006H13.3333V26.6673H9.33325V25.334H7.99992V24.0007H6.66658V21.334H5.33325V18.6673H3.99992V13.334H5.33325V10.6673H6.66658V8.00065H7.99992V6.66732H9.33325V5.33398H13.3333V4.00065H18.6666V5.33398H22.6666V6.66732H23.9999V8.00065H25.3333V10.6673H26.6666V13.334H27.9999V18.6673H26.6666V20.0007H23.9999V13.334H22.6666V10.6673H21.3333V9.33398H18.6666V8.00065H13.3333V9.33398H10.6666V10.6673H9.33325V13.334H7.99992V18.6673H9.33325V21.334H10.6666V22.6673H13.3333V24.0007H18.6666V22.6673H21.3333V21.334H22.6666V22.6673H27.9999V21.334H29.3333V18.6673H30.6666V13.334H29.3333ZM21.3333 18.6673H19.9999V20.0007H18.6666V21.334H13.3333V20.0007H11.9999V18.6673H10.6666V13.334H11.9999V12.0007H13.3333V10.6673H18.6666V12.0007H19.9999V13.334H21.3333V18.6673Z",fill:"white"})}),lR=({size:e})=>Ea.jsxs("svg",{width:"25",height:"24",viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Ea.jsx("path",{d:"M16.5 10H17.5V17H16.5V18H15.5V19H14.5V20H13.5V21H12.5V22H11.5V23H5.5V22H4.5V21H3.5V20H2.5V19H1.5V14H2.5V13H3.5V12H4.5V11H5.5V14H4.5V15H3.5V18H4.5V19H5.5V20H6.5V21H10.5V20H11.5V19H12.5V18H13.5V17H14.5V16H15.5V11H14.5V10H13.5V9H14.5V8H15.5V9H16.5V10Z",fill:"white"}),Ea.jsx("path",{d:"M23.5 5V10H22.5V11H21.5V12H20.5V13H19.5V10H20.5V9H21.5V6H20.5V5H19.5V4H18.5V3H14.5V4H13.5V5H12.5V6H11.5V7H10.5V8H9.5V13H10.5V14H11.5V15H10.5V16H9.5V15H8.5V14H7.5V7H8.5V6H9.5V5H10.5V4H11.5V3H12.5V2H13.5V1H19.5V2H20.5V3H21.5V4H22.5V5H23.5Z",fill:"white"})]}),cR=({size:e})=>Ea.jsx("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Ea.jsx("path",{d:"M29.3333 14.6673V10.6673H27.9999V8.00065H26.6666V6.66732H23.9999V5.33398H19.9999V6.66732H11.9999V5.33398H7.99992V6.66732H5.33325V8.00065H3.99992V10.6673H2.66659V14.6673H1.33325V24.0007H3.99992V25.334H6.66658V26.6673H9.33325V24.0007H7.99992V22.6673H10.6666V24.0007H11.9999V25.334H19.9999V24.0007H21.3333V22.6673H23.9999V24.0007H22.6666V26.6673H25.3333V25.334H27.9999V24.0007H30.6666V14.6673H29.3333ZM11.9999 20.0007H9.33325V18.6673H7.99992V16.0007H9.33325V14.6673H11.9999V16.0007H13.3333V18.6673H11.9999V20.0007ZM23.9999 18.6673H22.6666V20.0007H19.9999V18.6673H18.6666V16.0007H19.9999V14.6673H22.6666V16.0007H23.9999V18.6673Z",fill:"white"})}),hR=({size:e})=>Ea.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Ea.jsx("path",{d:"M23.9999 15.9993V17.3327H25.3333V19.9993H23.9999V21.3327H21.3333V19.9993H19.9999V17.3327H21.3333V15.9993H23.9999Z",fill:"white"}),Ea.jsx("path",{d:"M30.6666 10.666V27.9993H29.3333V29.3327H2.66659V27.9993H1.33325V3.99935H2.66659V2.66602H27.9999V3.99935H29.3333V5.33268H3.99992V26.666H27.9999V11.9993H6.66658V9.33268H29.3333V10.666H30.6666Z",fill:"white"})]}),uR=({size:e})=>Ea.jsx("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Ea.jsx("path",{d:"M20.6667 13.3327V11.9993H22V10.666H23.3333V9.33268H24.6667V7.99935H26V6.66602H27.3333V5.33268H28.6667V3.99935H30V2.66602H26V3.99935H24.6667V5.33268H23.3333V6.66602H22V7.99935H20.6667V9.33268H19.3333V10.666H16.6667V9.33268H15.3333V7.99935H14V5.33268H12.6667V3.99935H11.3333V2.66602H2V3.99935H3.33333V5.33268H4.66667V6.66602H6V9.33268H7.33333V10.666H8.66667V13.3327H10V14.666H11.3333V17.3327H12.6667V18.666H11.3333V19.9993H10V21.3327H8.66667V22.666H7.33333V23.9993H6V25.3327H4.66667V26.666H3.33333V27.9993H2V29.3327H6V27.9993H7.33333V26.666H8.66667V25.3327H10V23.9993H11.3333V22.666H12.6667V21.3327H15.3333V22.666H16.6667V23.9993H18V26.666H19.3333V27.9993H20.6667V29.3327H30V27.9993H28.6667V26.666H27.3333V25.3327H26V22.666H24.6667V21.3327H23.3333V18.666H22V17.3327H20.6667V14.666H19.3333V13.3327H20.6667ZM20.6667 18.666V19.9993H22V22.666H23.3333V23.9993H24.6667V26.666H20.6667V23.9993H19.3333V22.666H18V21.3327H16.6667V18.666H15.3333V17.3327H14V15.9993H12.6667V13.3327H11.3333V11.9993H10V9.33268H8.66667V7.99935H7.33333V5.33268H11.3333V6.66602H12.6667V9.33268H14V10.666H15.3333V13.3327H16.6667V14.666H18V15.9993H19.3333V18.666H20.6667Z",fill:"white"})}),dR=({className:e="w-5 h-5",...t})=>Ea.jsxs("svg",{className:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[Ea.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),Ea.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}),Ea.jsx("path",{d:"M9 14h6"}),Ea.jsx("path",{d:"M9 18h6"}),Ea.jsx("path",{d:"M9 10h6"})]}),pR=()=>{const{user:e}=Qv(),[t,s]=ga.useState({username:"",email:"",x:"",discord:"",referralCode:"",gold:0,xp:0,walletAddress:""}),[i,a]=ga.useState(!0),[n,r]=ga.useState(!1),[o,l]=ga.useState(!1),[c,h]=ga.useState(!1),[u,d]=ga.useState(!1),[p,f]=ga.useState(""),[m,g]=ga.useState(""),[y,b]=ga.useState(""),[v,w]=ga.useState(""),[x,k]=ga.useState("");ga.useEffect((()=>{(async()=>{var e,t,i,n;try{a(!0);const r=await EM(),o=r.data||r;s({username:o.username||"Unknown User",email:o.email||"",x:(null==(e=o.socials)?void 0:e.x)||"",discord:(null==(t=o.socials)?void 0:t.discord)||"",referralCode:o.referralCode||o.id||"",gold:o.gold||0,xp:o.xp||0,walletAddress:o.walletAddress||""}),f((null==(i=o.socials)?void 0:i.discord)||""),g((null==(n=o.socials)?void 0:n.x)||""),b(o.email||""),w(o.username||"")}catch(r){console.error("Failed to fetch profile:",r)}finally{a(!1)}})()}),[]);const A=async()=>{var e,i,a,n,o;try{const e={username:v||t.username,email:y||t.email,socials:{x:m||t.x,discord:p||t.discord}};await(async e=>{try{return(await jv.put("/profile/update",e)).data}catch(t){throw console.error("Failed to update profile:",t),t}})(e),await(async()=>{var e,t,i,a;try{const n=await EM(),r=n.data||n;s({username:r.username||"Unknown User",email:r.email||"",x:(null==(e=r.socials)?void 0:e.x)||"",discord:(null==(t=r.socials)?void 0:t.discord)||"",referralCode:r.referralCode||r.id||"",gold:r.gold||0,xp:r.xp||0,walletAddress:r.walletAddress||""}),w(r.username||""),b(r.email||""),f((null==(i=r.socials)?void 0:i.discord)||""),g((null==(a=r.socials)?void 0:a.x)||"")}catch(n){console.error("Failed to refresh profile:",n)}})(),r(!1),l(!1),h(!1),d(!1),k("")}catch(c){let s="Failed to update profile. Please try again.";409===(null==(e=c.response)?void 0:e.status)?s="Username already exists. Please choose a different username.":400===(null==(i=c.response)?void 0:i.status)?s="Invalid data provided. Please check your input.":401===(null==(a=c.response)?void 0:a.status)?s="Authentication required. Please log in again.":(null==(o=null==(n=c.response)?void 0:n.data)?void 0:o.message)&&(s=c.response.data.message),k(s),d(!1),w(t.username)}};return i?Ea.jsx("div",{className:"min-h-screen flex items-center justify-center text-white bg-[#170908] pl-6 pr-6",children:Ea.jsx("div",{className:"w-[500px] bg-[#24110F] border border-[#392423] rounded-lg p-6",children:Ea.jsxs("div",{className:"flex flex-col items-center",children:[Ea.jsx("div",{className:"w-24 h-24 bg-gray-600 rounded-full mb-4 animate-pulse"}),Ea.jsx("div",{className:"h-8 bg-gray-600 rounded w-32 mb-6 animate-pulse"}),Ea.jsx("div",{className:"space-y-3 w-full",children:[1,2,3,4].map((e=>Ea.jsx("div",{className:"bg-[#2F1A18] border border-[#392423] rounded-lg p-3 h-12 animate-pulse"},e)))})]})})}):Ea.jsx("div",{className:"min-h-screen flex items-center justify-center text-white bg-[#170908] pl-6 pr-6",children:Ea.jsxs("div",{className:"w-[500px] bg-[#24110F] border border-[#392423] rounded-lg p-6",children:[x&&Ea.jsx("div",{className:"mb-4 p-3 bg-red-900 text-red-300 rounded text-center font-bold border border-red-600",children:x}),Ea.jsxs("div",{className:"flex flex-col items-center mb-6",children:[Ea.jsx("div",{className:"w-24 h-24 bg-gray-600 rounded-full mb-4 flex items-center justify-center",children:Ea.jsx("span",{className:"text-4xl",children:""})}),Ea.jsx("div",{className:"flex items-center space-x-2",children:u?Ea.jsxs(Ea.Fragment,{children:[Ea.jsx("input",{type:"text",value:v,onChange:e=>w(e.target.value),className:"bg-[#392423] border border-[#4A2D2A] rounded px-3 py-1 text-white text-xl font-bold text-center",placeholder:"Enter username"}),Ea.jsx("button",{onClick:()=>{A()},className:"text-green-400 hover:text-green-300 transition-colors",children:""}),Ea.jsx("button",{onClick:()=>{d(!1),w(t.username),k("")},className:"text-red-400 hover:text-red-300 transition-colors",children:""})]}):Ea.jsxs(Ea.Fragment,{children:[Ea.jsx("h2",{className:"text-2xl font-bold text-white",children:t.username}),Ea.jsx("button",{onClick:()=>d(!0),className:"text-blue-400 hover:text-blue-300 transition-colors",children:Ea.jsx(dR,{className:"w-4 h-4"})})]})})]}),Ea.jsxs("div",{className:"space-y-3",children:[Ea.jsx("div",{className:"bg-[#2F1A18] border border-[#392423] rounded-lg p-3 flex items-center justify-between",children:Ea.jsxs("div",{className:"flex items-center space-x-3",children:[Ea.jsx(hR,{className:"w-5 h-5 text-gray-400"}),Ea.jsxs("div",{children:[Ea.jsx("span",{className:"text-white font-medium block",children:t.walletAddress?`${t.walletAddress.slice(0,6)}...${t.walletAddress.slice(-4)}`:"No wallet"}),Ea.jsx("span",{className:"text-gray-400 text-sm",children:"Wallet Address"})]})]})}),Ea.jsxs("div",{className:"bg-[#2F1A18] border border-[#392423] rounded-lg p-3 flex items-center justify-between",children:[Ea.jsxs("div",{className:"flex items-center space-x-3",children:[Ea.jsx(cR,{className:"w-5 h-5 text-blue-500"}),n?Ea.jsx("input",{type:"text",value:p,onChange:e=>f(e.target.value),className:"bg-[#392423] border border-[#4A2D2A] rounded px-2 py-1 text-white text-sm flex-1",placeholder:"Enter Discord URL"}):Ea.jsx("span",{className:"text-white font-medium",children:t.discord})]}),Ea.jsx("div",{className:"flex items-center space-x-2",children:n?Ea.jsxs(Ea.Fragment,{children:[Ea.jsx("button",{onClick:()=>{A()},className:"text-green-400 hover:text-green-300 transition-colors text-sm",children:""}),Ea.jsx("button",{onClick:()=>{r(!1),f(t.discord)},className:"text-red-400 hover:text-red-300 transition-colors text-sm",children:""})]}):Ea.jsx(Ea.Fragment,{children:Ea.jsx("button",{onClick:()=>r(!0),className:"text-blue-400 hover:text-blue-300 transition-colors text-sm",children:Ea.jsx(dR,{className:"w-4 h-4"})})})})]}),Ea.jsxs("div",{className:"bg-[#2F1A18] border border-[#392423] rounded-lg p-3 flex items-center justify-between",children:[Ea.jsxs("div",{className:"flex items-center space-x-3",children:[Ea.jsx(uR,{className:"w-5 h-5 text-blue-400"}),o?Ea.jsx("input",{type:"text",value:m,onChange:e=>g(e.target.value),className:"bg-[#392423] border border-[#4A2D2A] rounded px-2 py-1 text-white text-sm flex-1",placeholder:"Enter X URL"}):Ea.jsx("span",{className:"text-white font-medium",children:t.x})]}),Ea.jsx("div",{className:"flex items-center space-x-2",children:o?Ea.jsxs(Ea.Fragment,{children:[Ea.jsx("button",{onClick:()=>{A()},className:"text-green-400 hover:text-green-300 transition-colors text-sm",children:""}),Ea.jsx("button",{onClick:()=>{l(!1),g(t.x)},className:"text-red-400 hover:text-red-300 transition-colors text-sm",children:""})]}):Ea.jsx(Ea.Fragment,{children:Ea.jsx("button",{onClick:()=>l(!0),className:"text-blue-400 hover:text-blue-300 transition-colors text-sm",children:Ea.jsx(dR,{className:"w-4 h-4"})})})})]}),Ea.jsxs("div",{className:"bg-[#2F1A18] border border-[#392423] rounded-lg p-3 flex items-center justify-between",children:[Ea.jsxs("div",{className:"flex items-center space-x-3",children:[Ea.jsx(oR,{className:"w-5 h-5 text-gray-400"}),c?Ea.jsx("input",{type:"text",value:y,onChange:e=>b(e.target.value),className:"bg-[#392423] border border-[#4A2D2A] rounded px-2 py-1 text-white text-sm flex-1",placeholder:"Enter Email"}):Ea.jsx("span",{className:"text-white font-medium",children:t.email})]}),Ea.jsx("div",{className:"flex items-center space-x-2",children:c?Ea.jsxs(Ea.Fragment,{children:[Ea.jsx("button",{onClick:()=>{A()},className:"text-green-400 hover:text-green-300 transition-colors text-sm",children:""}),Ea.jsx("button",{onClick:()=>{h(!1),b(t.email)},className:"text-red-400 hover:text-red-300 transition-colors text-sm",children:""})]}):Ea.jsx(Ea.Fragment,{children:Ea.jsx("button",{onClick:()=>h(!0),className:"text-blue-400 hover:text-blue-300 transition-colors text-sm",children:Ea.jsx(dR,{className:"w-4 h-4"})})})})]})]}),Ea.jsxs("button",{className:"w-full mt-6 bg-transparent border-2 border-red-600 text-red-600 py-3 px-4 rounded-lg flex items-center justify-center space-x-2 hover:bg-red-600 hover:text-white transition-colors",children:[Ea.jsx(lR,{className:"w-6 h-6"}),Ea.jsx("span",{children:"Referral Link"})]})]})})};var fR={exports:{}};function mR(){}function gR(){}gR.resetWarningCache=mR,fR.exports=function(){function e(e,t,s,i,a,n){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==n){var r=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw r.name="Invariant Violation",r}}function t(){return e}e.isRequired=e;var s={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:gR,resetWarningCache:mR};return s.PropTypes=s,s}();const yR=Bi(fR.exports);class bR extends Phaser.Scene{constructor(){super("Level"),Ai(this,"dino"),Ai(this,"welcome")}editorCreate(){const e=this.add.image(640,288,"dino");e.setInteractive(new Phaser.Geom.Rectangle(0,0,250,250),Phaser.Geom.Rectangle.Contains);const t=this.add.text(640,478,"",{});t.setOrigin(.5,.5),t.text="Phaser 3 + Phaser Editor v4",t.setStyle({fontFamily:"Arial",fontSize:"30px"}),this.dino=e,this.welcome=t,this.events.emit("scene-awake")}create(){this.editorCreate(),this.dino.on("pointerdown",(()=>{this.welcome.text="Hello, World!"}))}}class vR extends Phaser.Scene{constructor(){super("Preload"),Ai(this,"progressBar")}editorPreload(){this.load.pack("asset-pack","assets/asset-pack.json")}editorCreate(){const e=this.add.image(505.0120544433594,360,"guapen");e.scaleX=.32715486817515643,e.scaleY=.32715486817515643;const t=this.add.rectangle(553,361,256,20);t.setOrigin(0,0),t.isFilled=!0,t.fillColor=14737632;const s=this.add.rectangle(553.0120849609375,361,256,20);s.setOrigin(0,0),s.fillColor=14737632,s.isStroked=!0;const i=this.add.text(552.0120849609375,329,"",{});i.text="Loading...",i.setStyle({color:"#e0e0e0",fontFamily:"arial",fontSize:"20px"}),this.progressBar=t,this.events.emit("scene-awake")}preload(){try{this.editorCreate(),this.editorPreload();const t=this.progressBar.width;try{this.load.image("Exp","assets/images/exp_orb.png"),console.log("Started loading Exp texture")}catch(e){console.error("Error loading Exp texture:",e),this.createFallbackTexture()}this.load.on("progress",(e=>{this.progressBar.width=e*t})),this.load.on("complete",(()=>{console.log("All assets loaded. Exp texture exists:",this.textures.exists("Exp"))}))}catch(e){console.error("Error in preload:",e)}}create(){this.textures.exists("Exp")||(console.warn("Exp texture failed to load, creating fallback texture"),this.createFallbackTexture()),console.log("Preload scene complete - waiting for manual game start"),window.EventBus&&window.EventBus.emit("preload-complete"),window.dispatchEvent(new CustomEvent("gamePreloadComplete"))}createFallbackTexture(){try{const e=this.add.graphics();e.fillStyle(65535,1),e.fillCircle(8,8,8),e.generateTexture("Exp",16,16),e.destroy(),console.log("Created fallback Exp texture")}catch(e){console.error("Error creating fallback texture:",e)}}}class wR extends Phaser.GameObjects.Container{constructor(e,t,s,i,a){super(e,t??100,s??30),this.width=i||200,this.height=a||20,this.setScrollFactor(0),this.setDepth(100),e.add.existing(this),e.healthBar=this}createHealthBar(){this.background=this.scene.add.rectangle(0,0,this.width+4,this.height+4,0),this.background.setOrigin(0,0),this.add(this.background),this.redBar=this.scene.add.rectangle(2,2,this.width,this.height,16711680),this.redBar.setOrigin(0,0),this.add(this.redBar),this.greenBar=this.scene.add.rectangle(2,2,this.width,this.height,65280),this.greenBar.setOrigin(0,0),this.add(this.greenBar),this.healthText=this.scene.add.text(this.width/2+2,this.height/2+2,"100/100",{fontFamily:"Arial",fontSize:"14px",color:"#ffffff",stroke:"#000000",strokeThickness:2}),this.healthText.setOrigin(.5,.5),this.add(this.healthText),this.scene.textures.exists("health_icon")&&(this.healthIcon=this.scene.add.image(-25,this.height/2,"health_icon"),this.healthIcon.setScale(.5),this.healthIcon.setOrigin(.5),this.add(this.healthIcon))}updateHealth(e,t){const s=Math.max(0,Math.min(1,e/t));this.greenBar.width=this.width*s,this.healthText.setText(`${Math.ceil(e)}/${t}`),s<.3&&e>0&&this.playLowHealthEffect(),s>.6?this.greenBar.setFillStyle(65280):s>.3?this.greenBar.setFillStyle(16776960):this.greenBar.setFillStyle(16742144)}playLowHealthEffect(){if(!this.isPlayingEffect){this.isPlayingEffect=!0,this.scene.tweens.add({targets:this,x:this.x+1,duration:50,yoyo:!0,repeat:1,onComplete:()=>{this.isPlayingEffect=!1}}),this.scene.tweens.add({targets:this.greenBar,alpha:.7,duration:300,yoyo:!0,repeat:1,onComplete:()=>{this.greenBar.alpha=1}});try{this.scene.sound&&this.scene.cache.audio.exists("low_health_sound")&&this.scene.sound.add("low_health_sound").play({volume:.3})}catch(e){console.warn("Could not play low health sound:",e)}}}showDamageFlash(){const e=this.scene.add.rectangle(0,0,this.width+4,this.height+4,16711680,.5);e.setOrigin(0,0),this.add(e),this.scene.tweens.add({targets:e,alpha:0,duration:200,onComplete:()=>{e.destroy()}})}showHealEffect(){const e=this.scene.add.rectangle(0,0,this.width+4,this.height+4,65280,.5);e.setOrigin(0,0),this.add(e),this.scene.tweens.add({targets:e,alpha:0,duration:200,onComplete:()=>{e.destroy()}})}}class xR extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t??10,s??10),this.background=e.add.rectangle(0,0,300,30,0,.7),this.background.setOrigin(0,0),this.add(this.background),this.levelText=e.add.text(10,15,"LEVEL: 1",{fontFamily:"Arial, sans-serif",fontSize:"10px",color:"#ffffff",stroke:"#000000",strokeThickness:4,align:"left"}),this.levelText.setOrigin(0,.5),this.add(this.levelText),this.expText=e.add.text(120,15,"EXP: 0/100",{fontFamily:"Arial, sans-serif",fontSize:"10px",color:"#ffff00",stroke:"#000000",strokeThickness:4,align:"left"}),this.expText.setOrigin(0,.5),this.add(this.expText),this.setScrollFactor(0),this.setDepth(1e3),this.level=1,this.experience=0,this.nextLevelExp=100,this.onLevelUpCallbacks=[],e.playerLevelSystem=this,this.updateText(),this.updateExpBar()}addExperience(e){try{return console.log(`Adding ${e} experience points`),("number"!=typeof e||isNaN(e))&&(console.warn("Invalid experience amount:",e),e=1),this.experience+=e,this.checkLevelUp(),this.updateText(),this.updateExpBar(),this.createFloatingText(`+${e} EXP`),this}catch(t){return console.error("Error adding experience:",t),this}}checkLevelUp(){if(this.experience>=this.nextLevelExp){this.level++,this.experience-=this.nextLevelExp,this.nextLevelExp=Math.floor(100*Math.pow(1.2,this.level-1)),this.levelUpEffect();try{this.onLevelUpCallbacks.forEach((e=>e(this.level)))}catch(e){console.error("Error in level up callback:",e)}this.updateExpBar(),this.checkLevelUp()}}updateText(){this.levelText.setText(`LEVEL: ${this.level}`),this.expText.setText(`EXP: ${this.experience}/${this.nextLevelExp}`);const e=Math.max(204,this.levelText.width+this.expText.width+30);this.background.width=e,this.progressBarFill&&this.updateProgressBar(),this.updateExpBar()}createFloatingText(e){try{const t=this.scene.player;if(!t)return void console.warn("Player not found for floating text");const s=this.scene.add.text(t.x,t.y-30,e,{fontFamily:"Arial, sans-serif",fontSize:"10px",color:"#FFD700",stroke:"#000000",strokeThickness:2});s.setOrigin(.5),this.scene.tweens.add({targets:s,y:s.y-60,alpha:0,duration:1500,onComplete:()=>{s.destroy()}})}catch(t){console.error("Error creating floating text:",t)}}levelUpEffect(){try{const e=this.scene.player;if(!e)return void console.warn("Player not found for level up effect");const t=this.scene.add.text(e.x,e.y-40,"LEVEL UP!",{fontFamily:"Arial, sans-serif",fontSize:"28px",color:"#00FF00",stroke:"#000000",strokeThickness:5});t.setOrigin(.5);for(let s=0;s<20;s++){const t=Math.random()*Math.PI*2,s=20+40*Math.random(),i=5+10*Math.random(),a=this.scene.add.circle(e.x,e.y,i,65280,.8);this.scene.tweens.add({targets:a,x:e.x+Math.cos(t)*s,y:e.y+Math.sin(t)*s,alpha:0,scale:.5,duration:1e3,ease:"Power1",onComplete:()=>{a.destroy()}})}this.scene.tweens.add({targets:t,scaleX:1.5,scaleY:1.5,duration:200,yoyo:!0,repeat:1,onComplete:()=>{this.scene.tweens.add({targets:t,alpha:0,y:t.y-50,duration:1e3,onComplete:()=>{t.destroy()}})}})}catch(e){console.error("Error creating level up effect:",e)}}onLevelUp(e){return"function"==typeof e&&this.onLevelUpCallbacks.push(e),this}getLevel(){return this.level}getLevelProgress(){return this.experience/this.nextLevelExp}setUIPosition(e,t){return this.setPosition(e,t),console.log("UI Position set to:",e,t),this}createProgressBar(e,t,s,i){try{return this.progressBarBg&&(this.progressBarBg.destroy(),this.progressBarFill.destroy()),this.progressBarBg=this.scene.add.rectangle(0,40,s,i,0,.7),this.progressBarBg.setScrollFactor(0),this.progressBarBg.setOrigin(0,.5),this.progressBarBg.setDepth(99),this.add(this.progressBarBg),this.progressBarFill=this.scene.add.rectangle(2,40,0,i-4,65535,1),this.progressBarFill.setScrollFactor(0),this.progressBarFill.setOrigin(0,.5),this.progressBarFill.setDepth(99),this.add(this.progressBarFill),this.progressBarWidth=s-4,this.updateProgressBar(),this}catch(a){return console.error("Error creating progress bar:",a),this}}updateProgressBar(){try{if(this.progressBarFill&&this.progressBarWidth){const e=this.getLevelProgress(),t=this.progressBarWidth*e;this.progressBarFill.width=t}}catch(e){console.error("Error updating progress bar:",e)}}updateExpBar(){try{const e={currentExp:this.experience,maxExp:this.nextLevelExp,level:this.level,experience:this.experience,maxExperience:this.nextLevelExp,exp:this.experience,maxExp:this.nextLevelExp,lvl:this.level};kM.emit("player-exp-updated",e),kM.emit("player-stats-updated",e),window.dispatchEvent(new CustomEvent("playerExpUpdated",{detail:e})),window.dispatchEvent(new CustomEvent("playerStatsUpdated",{detail:e}))}catch(e){console.error("Error updating exp bar:",e)}}}class kR{constructor(e){this.scene=e,this.gameManager=FM.get(),this.healthBar=null,this.playerLevel=null,this.timer={text:null,background:null,label:null,elapsed:0},this.scoreboard={container:null,background:null,title:null,stats:{wave:null,kills:null,gold:null}},this.attackCooldowns={container:null,slash:{icon:null,cooldownBar:null,background:null},fire:{icon:null,cooldownBar:null,background:null},ice:{icon:null,cooldownBar:null,background:null}},this.uiContainer=null,this.isInitialized=!1}initialize(){try{this.createContainer(),this.createLevelSystem(),this.createTimer(),this.createScoreboard(),this.createAttackCooldownUI(),this.setupEventListeners(),this.isInitialized=!0}catch(e){}}createContainer(){this.uiContainer&&this.uiContainer.active||(this.uiContainer=this.scene.add.container(0,0),this.uiContainer.setScrollFactor(0).setDepth(1e3))}createHealthBar(){this.healthBar&&this.healthBar.active||(this.healthBar=new wR(this.scene,320,230,200,20),this.scene.healthBar=this.healthBar)}createLevelSystem(){this.playerLevel&&this.playerLevel.active||(this.playerLevel=new xR(this.scene,320,180),this.scene.add.existing(this.playerLevel),this.playerLevel.createProgressBar(0,0,204,20),this.playerLevel.onLevelUp((e=>{this.handleLevelUp(e)})),this.scene.playerLevelSystem=this.playerLevel,this.syncWithGameManager())}createTimer(){this.timer.background=this.scene.add.rectangle(890,210,120,40,0,.7).setStrokeStyle(2,16777215).setScrollFactor(0).setDepth(900),this.timer.label=this.scene.add.text(890,190,"TIME",{fontFamily:"Arial",fontSize:"14px",color:"#ffffff",stroke:"#000000",strokeThickness:2}).setOrigin(.5).setScrollFactor(0).setDepth(901),this.timer.text=this.scene.add.text(890,210,"00:00",{fontFamily:"Arial",fontSize:"24px",color:"#ffff00",stroke:"#000000",strokeThickness:3,fontStyle:"bold"}).setOrigin(.5).setScrollFactor(0).setDepth(901),this.uiContainer.add([this.timer.background,this.timer.label,this.timer.text]),this.timer.elapsed=0}createScoreboard(){this.scoreboard.container=this.scene.add.container(config.x,config.y),this.scoreboard.container.setScrollFactor(0).setDepth(900),this.scoreboard.background=this.scene.add.rectangle(0,0,config.width,config.height,0,.7).setStrokeStyle(2,16777215),this.scoreboard.title=this.scene.add.text(0,-35,"STATS",{fontFamily:"Arial",fontSize:"14px",color:"#ffffff",stroke:"#000000",strokeThickness:2,fontStyle:"bold"}).setOrigin(.5);const e={fontFamily:"Arial",fontSize:"12px",color:"#ffffff",stroke:"#000000",strokeThickness:1};this.scoreboard.stats.wave=this.scene.add.text(-60,-15,"Wave: 0",e),this.scoreboard.stats.kills=this.scene.add.text(-60,0,"Kills: 0",e),this.scoreboard.stats.gold=this.scene.add.text(-60,15,"Gold: 0",e),this.scoreboard.container.add([this.scoreboard.background,this.scoreboard.title,this.scoreboard.stats.wave,this.scoreboard.stats.kills,this.scoreboard.stats.gold]),this.uiContainer.add(this.scoreboard.container)}updateScoreboard(){var e,t;if(this.scoreboard.container)try{let s=0;this.gameManager&&this.gameManager.currentWave?s=this.gameManager.currentWave:(null==(e=this.scene.gameplayManager)?void 0:e.mobManager)?s=this.scene.gameplayManager.mobManager.getStatistics().currentWave||0:void 0!==this.scene.currentWave&&(s=this.scene.currentWave);let i=0;(null==(t=this.scene.gameplayManager)?void 0:t.mobManager)?i=this.scene.gameplayManager.mobManager.getStatistics().totalKilled||0:void 0!==this.scene.enemiesKilled&&(i=this.scene.enemiesKilled);const a=this.gameManager?this.gameManager.gold:0;this.scoreboard.stats.wave.setText(`Wave: ${s}`),this.scoreboard.stats.kills.setText(`Kills: ${i}`),this.scoreboard.stats.gold.setText(`Gold: ${a}`),this.lastWave=s}catch(s){console.error("Error updating scoreboard:",s)}}showScoreboardUpdate(e,t,s=65280){try{kM.emit("ui-scoreboard-update",{statType:e,value:t,color:`#${s.toString(16).padStart(6,"0")}`,timestamp:Date.now()})}catch(i){console.error("Error showing scoreboard update:",i)}}createAttackCooldownUI(){this.attackCooldowns.container=this.scene.add.container(80,this.scene.cameras.main.height-80),this.attackCooldowns.container.setScrollFactor(0).setDepth(950),[{key:"slash",color:65280,x:270,label:"SLASH"},{key:"fire",color:16729088,x:300,label:"FIRE"},{key:"ice",color:43775,x:330,label:"ICE"}].forEach((e=>{this.attackCooldowns[e.key].background=this.scene.add.circle(e.x,-120,10,0,.8),this.attackCooldowns[e.key].background.setStrokeStyle(2,e.color,1),this.attackCooldowns[e.key].icon=this.scene.add.circle(e.x,-120,10,e.color,.7),this.attackCooldowns[e.key].cooldownBar=this.scene.add.graphics();const t=this.scene.add.text(e.x,35,e.label,{fontFamily:"Arial",fontSize:"10px",color:"#ffffff",stroke:"#000000",strokeThickness:1}).setOrigin(.5);this.attackCooldowns.container.add([this.attackCooldowns[e.key].background,this.attackCooldowns[e.key].icon,this.attackCooldowns[e.key].cooldownBar,t])}))}updateAttackCooldowns(){if(!this.scene.playerAttackSystem||!this.attackCooldowns.container)return;const e=this.scene.playerAttackSystem,t=this.scene.time.now;[{key:"slash",lastTime:e.lastSlashTime,cooldown:e.slashCooldown,color:65280,x:270},{key:"fire",lastTime:e.lastFireTime,cooldown:e.fireCooldown,color:16729088,x:300},{key:"ice",lastTime:e.lastIceTime,cooldown:e.iceCooldown,color:43775,x:330}].forEach((e=>{const s=t-e.lastTime,i=Math.min(s/e.cooldown,1);if(this.attackCooldowns[e.key].cooldownBar.clear(),i<1){const t=i*Math.PI*2;this.attackCooldowns[e.key].cooldownBar.fillStyle(0,.6),this.attackCooldowns[e.key].cooldownBar.fillCircle(e.x,-120,11),this.attackCooldowns[e.key].cooldownBar.fillStyle(e.color,.8),this.attackCooldowns[e.key].cooldownBar.beginPath(),this.attackCooldowns[e.key].cooldownBar.moveTo(e.x,-120),this.attackCooldowns[e.key].cooldownBar.arc(e.x,-120,11,-Math.PI/2,-Math.PI/2+t,!1),this.attackCooldowns[e.key].cooldownBar.closePath(),this.attackCooldowns[e.key].cooldownBar.fillPath(),this.attackCooldowns[e.key].icon.setAlpha(.3)}else this.attackCooldowns[e.key].icon.setAlpha(1)}))}setupEventListeners(){var e;(null==(e=this.gameManager)?void 0:e.events)&&(this.gameManager.events.off("experienceUpdated"),this.gameManager.events.off("levelUp"),this.gameManager.events.off("enemyKilled"),this.gameManager.events.off("goldEarned"),this.gameManager.events.off("waveStarted"),this.gameManager.events.on("experienceUpdated",(()=>{this.syncWithGameManager()})),this.gameManager.events.on("levelUp",(e=>{this.handleLevelUp(e)})),this.gameManager.events.on("enemyKilled",(e=>{this.showScoreboardUpdate("kills",e||1,16711680)})),this.gameManager.events.on("goldEarned",(e=>{this.showScoreboardUpdate("gold",e,16776960)})),this.gameManager.events.on("waveStarted",(e=>{this.showScoreboardUpdate("wave",1,65280)})))}handleLevelUp(e){var t,s;this.gameManager&&(this.gameManager.playerStats.level=e),this.playerLevel&&(this.playerLevel.level=e,null==(s=(t=this.playerLevel).updateText)||s.call(t)),this.scene.powerUpManager&&this.scene.powerUpManager.showPowerUpSelection()}syncWithGameManager(){var e,t,s,i;if(this.gameManager&&this.playerLevel)try{const{level:a,experience:n,nextLevelExp:r}=this.gameManager.playerStats;Object.assign(this.playerLevel,{level:a,experience:n,nextLevelExp:r}),null==(t=(e=this.playerLevel).updateText)||t.call(e),null==(i=(s=this.playerLevel).updateProgressBar)||i.call(s)}catch(a){console.error("Error syncing with GameManager:",a)}}updateTimer(e){var t,s;if(!(null==(t=this.timer.text)?void 0:t.active))return;this.timer.elapsed+=e/1e3,(null==(s=this.gameManager)?void 0:s.gameProgress)&&(this.gameManager.gameProgress.gameTime=this.timer.elapsed);const i=Math.floor(this.timer.elapsed/60),a=Math.floor(this.timer.elapsed%60),n=`${i.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`;this.timer.text.setText(n),Math.floor(this.timer.elapsed)%60==0&&e>0&&i>0&&this.pulseTimer()}pulseTimer(){this.scene.tweens.add({targets:this.timer.text,scale:1.3,duration:200,yoyo:!0,repeat:1,ease:"Power2"})}updateHealthBar(){if(this.healthBar&&this.scene.player){const{health:e,maxHealth:t}=this.scene.player;this.healthBar.updateHealth(e,t)}}showDamageEffect(){var e,t;null==(t=null==(e=this.healthBar)?void 0:e.showDamageFlash)||t.call(e)}showHealEffect(){var e,t;null==(t=null==(e=this.healthBar)?void 0:e.showHealEffect)||t.call(e)}addExperience(e){this.gameManager&&this.gameManager.addExperience(e)}showMessage(e,t=2e3){try{kM.emit("notification",{text:e,color:"#ffffff",type:"message",duration:t,timestamp:Date.now()})}catch(s){console.error("Error showing message:",s)}}reset(){this.timer.elapsed=0,this.lastWave=0,this.syncWithGameManager(),this.updateScoreboard()}update(e,t){if(this.isInitialized)try{this.updateHealthBar(),this.updateTimer(t),this.updateAttackCooldowns(),this.updateScoreboard(),this.playerLevel&&!this.playerLevel.active&&this.createLevelSystem()}catch(s){console.error("Error in UI update:",s)}}shutdown(){var e;(null==(e=this.gameManager)?void 0:e.events)&&(this.gameManager.events.off("experienceUpdated"),this.gameManager.events.off("levelUp"),this.gameManager.events.off("enemyKilled"),this.gameManager.events.off("goldEarned"),this.gameManager.events.off("waveStarted")),[this.timer.background,this.timer.label,this.timer.text,this.scoreboard.container,this.attackCooldowns.container,this.uiContainer].forEach((e=>{(null==e?void 0:e.destroy)&&e.destroy()})),this.isInitialized=!1,this.timer={text:null,background:null,label:null,elapsed:0},this.scoreboard={container:null,background:null,title:null,stats:{wave:null,kills:null,gold:null}},this.attackCooldowns={container:null,slash:{icon:null,cooldownBar:null,background:null},fire:{icon:null,cooldownBar:null,background:null},ice:{icon:null,cooldownBar:null,background:null}}}}class AR extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t??32,s??32,i||"zombierun",a??0),e.physics.add.existing(this,!1),this.body.setSize(16,16,!1),this.body.setOffset(14,32),this.maxHealth=30,this.health=this.maxHealth,this.damage=10,this.speed=50,this.attackRange=5,this.attackCooldown=1e3,this.lastAttackTime=0,this.isDead=!1,this.isMoving=!1,this.lastDirection="down",this.createAnimations(),this.addToZombieGroup(e),this.updateListener=this.update.bind(this),e.events.on("update",this.updateListener)}addToZombieGroup(e){e.zombieGroup||(e.zombieGroup=e.physics.add.group(),e.physics.add.collider(e.zombieGroup,e.zombieGroup,this.handleZombieCollision,null,e)),e.zombieGroup.add(this)}handleZombieCollision(e,t){if(Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y)<20){const s=Phaser.Math.Angle.Between(e.x,e.y,t.x,t.y),i=30,a=Math.cos(s)*i,n=Math.sin(s)*i;t.body.velocity.x+=a,t.body.velocity.y+=n,e.body.velocity.x-=a,e.body.velocity.y-=n}}createAnimations(){this.scene.anims.exists("zombieRunAni")||this.scene.anims.create({key:"zombieRunAni",frames:this.scene.anims.generateFrameNumbers("zombierun",{start:0,end:6}),frameRate:8,repeat:-1}),this.scene.anims.exists("zombieIdle")||this.scene.anims.create({key:"zombieIdle",frames:[{key:"zombierun",frame:0}],frameRate:1,repeat:0})}createHealthBar(){this.healthBarBg=this.scene.add.rectangle(this.x,this.y-20,30,4,16711680),this.healthBarBg.setOrigin(.5,.5),this.healthBarBg.setDepth(1),this.healthBarFg=this.scene.add.rectangle(this.x-15,this.y-20,30,4,65280),this.healthBarFg.setOrigin(0,.5),this.healthBarFg.setDepth(20),this.on("destroy",(()=>{this.healthBarBg&&this.healthBarBg.destroy(),this.healthBarFg&&this.healthBarFg.destroy()})),this.updateHealthBar()}updateHealthBar(){if(!this.healthBarFg||!this.healthBarBg)return;this.healthBarBg.setPosition(this.x-10,this.y-10),this.healthBarFg.setPosition(this.x-25,this.y-10);const e=this.health/this.maxHealth;this.healthBarFg.width=30*e}update(e,t){if(!this.isDead&&this.active)try{this.updateHealthBar();const t=this.scene.player;if(!t)return;if(Phaser.Math.Distance.Between(this.x,this.y,t.x,t.y)>this.attackRange){const e=Phaser.Math.Angle.Between(this.x,this.y,t.x,t.y),s=Math.cos(e)*this.speed*.1,i=Math.sin(e)*this.speed*.1;this.body.velocity.x+=s,this.body.velocity.y+=i,this.body.velocity.x*=.9,this.body.velocity.y*=.9,this.applyZombieAvoidance();const a=this.speed,n=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);if(n>a){const e=a/n;this.body.velocity.x*=e,this.body.velocity.y*=e}this.isMoving=!0,this.updateDirection(e)}else{this.body.velocity.x*=.8,this.body.velocity.y*=.8;const s=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);this.isMoving=s>5,e-this.lastAttackTime>this.attackCooldown&&(this.attackPlayer(t),this.lastAttackTime=e)}this.updateAnimation()}catch(s){console.error("Error in Zombie update:",s)}}applyZombieAvoidance(){if(!this.scene.zombieGroup)return;let e=0,t=0,s=0;this.scene.zombieGroup.children.entries.forEach((i=>{if(i===this||i.isDead)return;const a=Phaser.Math.Distance.Between(this.x,this.y,i.x,i.y);if(a<25&&a>0){const n=Phaser.Math.Angle.Between(i.x,i.y,this.x,this.y),r=15*(1-a/25);e+=Math.cos(n)*r,t+=Math.sin(n)*r,s++}})),s>0&&(this.body.velocity.x+=.1*e,this.body.velocity.y+=.1*t)}updateDirection(e){const t=Phaser.Math.RadToDeg(e);this.lastDirection=t>=-45&&t<45?"right":t>=45&&t<135?"down":t>=135||t<-135?"left":"up"}updateAnimation(){this.isMoving?(this.anims.isPlaying&&"zombieRunAni"===this.anims.currentAnim.key||this.play("zombieRunAni"),"right"===this.lastDirection?this.setFlipX(!1):"left"===this.lastDirection&&this.setFlipX(!0)):this.anims.isPlaying&&"zombieIdle"===this.anims.currentAnim.key||this.play("zombieIdle")}attackPlayer(e){e&&e.takeDamage&&(e.takeDamage(this.damage),this.setTint(16711680),this.scene.time.delayedCall(150,(()=>{this.clearTint()})),this.lastAttackTime=this.scene.time.now)}takeDamage(e){this.health-=e,this.updateHealthBar(),this.setTint(16711680),this.scene.time.delayedCall(100,(()=>{this.clearTint()})),this.health<=0&&this.die()}die(){this.isDead||(this.isDead=!0,this.body.velocity.x=0,this.body.velocity.y=0,this.body.enable=!1,this.stop(),this.scene.zombieGroup&&this.scene.zombieGroup.remove(this),this.scene.tweens.add({targets:this,alpha:0,scale:.8,duration:300,onComplete:()=>this.cleanupAndDestroy()}),this.spawnRewards())}spawnRewards(){try{if(this.scene.spawnExperienceOrb){const e=Phaser.Math.Between(1,3);for(let t=0;t<e;t++){const e=Phaser.Math.Between(-10,10),t=Phaser.Math.Between(-10,10);this.scene.spawnExperienceOrb(this.x+e,this.y+t,1)}}}catch(e){console.error("Error spawning rewards:",e)}}cleanupAndDestroy(){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null)}catch(e){console.error("Error removing update listener:",e)}this.destroy()}destroy(e){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null),this.scene&&this.scene.zombieGroup&&this.scene.zombieGroup.children&&this.scene.zombieGroup.remove(this)}catch(t){console.error("Error in destroy method:",t)}super.destroy(e)}}class SR extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t??32,s??32,i||"Zombie2RunAni",a??0),e.physics.add.existing(this,!1),this.body.setSize(16,16,!1),this.body.setOffset(14,32),this.maxHealth=30,this.health=this.maxHealth,this.damage=10,this.speed=50,this.attackRange=5,this.attackCooldown=1e3,this.lastAttackTime=0,this.isDead=!1,this.isMoving=!1,this.lastDirection="down",this.createAnimations(),this.addToZombieGroup(e),this.updateListener=this.update.bind(this),e.events.on("update",this.updateListener)}addToZombieGroup(e){e.zombieGroup||(e.zombieGroup=e.physics.add.group(),e.physics.add.collider(e.zombieGroup,e.zombieGroup,this.handleZombieCollision,null,e)),e.zombieGroup.add(this)}handleZombieCollision(e,t){if(Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y)<20){const s=Phaser.Math.Angle.Between(e.x,e.y,t.x,t.y),i=30,a=Math.cos(s)*i,n=Math.sin(s)*i;t.body.velocity.x+=a,t.body.velocity.y+=n,e.body.velocity.x-=a,e.body.velocity.y-=n}}createAnimations(){this.scene.anims.exists("zombieRunAni")||this.scene.anims.create({key:"zombieRunAni",frames:this.scene.anims.generateFrameNumbers("Zombie2RunAni",{start:0,end:6}),frameRate:8,repeat:-1}),this.scene.anims.exists("zombieIdle")||this.scene.anims.create({key:"zombieIdle",frames:[{key:"Zombie2RunAni",frame:0}],frameRate:1,repeat:0})}createHealthBar(){this.healthBarBg=this.scene.add.rectangle(this.x,this.y-20,30,4,16711680),this.healthBarBg.setOrigin(.5,.5),this.healthBarBg.setDepth(1),this.healthBarFg=this.scene.add.rectangle(this.x-15,this.y-20,30,4,65280),this.healthBarFg.setOrigin(0,.5),this.healthBarFg.setDepth(20),this.on("destroy",(()=>{this.healthBarBg&&this.healthBarBg.destroy(),this.healthBarFg&&this.healthBarFg.destroy()})),this.updateHealthBar()}updateHealthBar(){if(!this.healthBarFg||!this.healthBarBg)return;this.healthBarBg.setPosition(this.x-10,this.y-10),this.healthBarFg.setPosition(this.x-25,this.y-10);const e=this.health/this.maxHealth;this.healthBarFg.width=30*e}update(e,t){if(!this.isDead&&this.active)try{this.updateHealthBar();const t=this.scene.player;if(!t)return;if(Phaser.Math.Distance.Between(this.x,this.y,t.x,t.y)>this.attackRange){const e=Phaser.Math.Angle.Between(this.x,this.y,t.x,t.y),s=Math.cos(e)*this.speed*.1,i=Math.sin(e)*this.speed*.1;this.body.velocity.x+=s,this.body.velocity.y+=i,this.body.velocity.x*=.9,this.body.velocity.y*=.9,this.applyZombieAvoidance();const a=this.speed,n=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);if(n>a){const e=a/n;this.body.velocity.x*=e,this.body.velocity.y*=e}this.isMoving=!0,this.updateDirection(e)}else{this.body.velocity.x*=.8,this.body.velocity.y*=.8;const s=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);this.isMoving=s>5,e-this.lastAttackTime>this.attackCooldown&&(this.attackPlayer(t),this.lastAttackTime=e)}this.updateAnimation()}catch(s){console.error("Error in Zombie update:",s)}}applyZombieAvoidance(){if(!this.scene.zombieGroup)return;let e=0,t=0,s=0;this.scene.zombieGroup.children.entries.forEach((i=>{if(i===this||i.isDead)return;const a=Phaser.Math.Distance.Between(this.x,this.y,i.x,i.y);if(a<25&&a>0){const n=Phaser.Math.Angle.Between(i.x,i.y,this.x,this.y),r=15*(1-a/25);e+=Math.cos(n)*r,t+=Math.sin(n)*r,s++}})),s>0&&(this.body.velocity.x+=.1*e,this.body.velocity.y+=.1*t)}updateDirection(e){const t=Phaser.Math.RadToDeg(e);this.lastDirection=t>=-45&&t<45?"right":t>=45&&t<135?"down":t>=135||t<-135?"left":"up"}updateAnimation(){this.isMoving&&(this.anims.isPlaying&&"Zombie2RunAni"===this.anims.currentAnim.key||this.play("Zombie2RunAni"),"right"===this.lastDirection?this.setFlipX(!1):"left"===this.lastDirection&&this.setFlipX(!0))}attackPlayer(e){e&&e.takeDamage&&(e.takeDamage(this.damage),this.setTint(16711680),this.scene.time.delayedCall(150,(()=>{this.clearTint()})),this.lastAttackTime=this.scene.time.now)}takeDamage(e){this.health-=e,this.updateHealthBar(),this.setTint(16711680),this.scene.time.delayedCall(100,(()=>{this.clearTint()})),this.health<=0&&this.die()}die(){this.isDead||(this.isDead=!0,this.body.velocity.x=0,this.body.velocity.y=0,this.body.enable=!1,this.stop(),this.scene.zombieGroup&&this.scene.zombieGroup.remove(this),this.scene.tweens.add({targets:this,alpha:0,scale:.8,duration:300,onComplete:()=>this.cleanupAndDestroy()}),this.spawnRewards())}spawnRewards(){try{if(this.scene.spawnExperienceOrb){const e=Phaser.Math.Between(1,3);for(let t=0;t<e;t++){const e=Phaser.Math.Between(-10,10),t=Phaser.Math.Between(-10,10);this.scene.spawnExperienceOrb(this.x+e,this.y+t,1)}}}catch(e){console.error("Error spawning rewards:",e)}}cleanupAndDestroy(){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null)}catch(e){console.error("Error removing update listener:",e)}this.destroy()}destroy(e){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null),this.scene&&this.scene.zombieGroup&&this.scene.zombieGroup.children&&this.scene.zombieGroup.remove(this)}catch(t){console.error("Error in destroy method:",t)}super.destroy(e)}}class ER extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t??191,s??94,i||"Police run",a??0),e.physics.add.existing(this,!1),this.body.setSize(16,16,!1),this.body.setOffset(14,32),this.maxHealth=30,this.health=this.maxHealth,this.damage=10,this.speed=50,this.attackRange=5,this.attackCooldown=1e3,this.lastAttackTime=0,this.isDead=!1,this.isMoving=!1,this.lastDirection="down",this.createAnimations(),this.addToZombieGroup(e),this.updateListener=this.update.bind(this),e.events.on("update",this.updateListener)}addToZombieGroup(e){e.zombieGroup||(e.zombieGroup=e.physics.add.group(),e.physics.add.collider(e.zombieGroup,e.zombieGroup,this.handleZombieCollision,null,e)),e.zombieGroup.add(this)}handleZombieCollision(e,t,s){if(Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y,s.x,s.y)<20){const i=Phaser.Math.Angle.Between(e.x,e.y,t.x,t.y,s.x,s.y),a=30,n=Math.cos(i)*a,r=Math.sin(i)*a;t.body.velocity.x+=n,t.body.velocity.y+=r,e.body.velocity.x-=n,e.body.velocity.y-=r,s.body.velocity.x-=n,s.body.velocity.y-=r}}createAnimations(){this.scene.anims.exists("PoliceDroid")||this.scene.anims.create({key:"PoliceDroid",frames:this.scene.anims.generateFrameNumbers("Police run",{start:0,end:10}),frameRate:8,repeat:-1}),this.scene.anims.exists("PoliceDroidIdle")||this.scene.anims.create({key:"PoliceDroidIdle",frames:[{key:"Police run",frame:0}],frameRate:1,repeat:0})}createHealthBar(){this.healthBarBg=this.scene.add.rectangle(this.x,this.y-20,30,4,16711680),this.healthBarBg.setOrigin(.5,.5),this.healthBarBg.setDepth(1),this.healthBarFg=this.scene.add.rectangle(this.x-15,this.y-20,30,4,65280),this.healthBarFg.setOrigin(0,.5),this.healthBarFg.setDepth(20),this.on("destroy",(()=>{this.healthBarBg&&this.healthBarBg.destroy(),this.healthBarFg&&this.healthBarFg.destroy()})),this.updateHealthBar()}updateHealthBar(){if(!this.healthBarFg||!this.healthBarBg)return;this.healthBarBg.setPosition(this.x-10,this.y-10),this.healthBarFg.setPosition(this.x-25,this.y-10);const e=this.health/this.maxHealth;this.healthBarFg.width=30*e}update(e,t){if(!this.isDead&&this.active)try{this.updateHealthBar();const t=this.scene.player;if(!t)return;if(Phaser.Math.Distance.Between(this.x,this.y,t.x,t.y)>this.attackRange){const e=Phaser.Math.Angle.Between(this.x,this.y,t.x,t.y),s=Math.cos(e)*this.speed*.1,i=Math.sin(e)*this.speed*.1;this.body.velocity.x+=s,this.body.velocity.y+=i,this.body.velocity.x*=.9,this.body.velocity.y*=.9,this.applyZombieAvoidance();const a=this.speed,n=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);if(n>a){const e=a/n;this.body.velocity.x*=e,this.body.velocity.y*=e}this.isMoving=!0,this.updateDirection(e)}else{this.body.velocity.x*=.8,this.body.velocity.y*=.8;const s=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);this.isMoving=s>5,e-this.lastAttackTime>this.attackCooldown&&(this.attackPlayer(t),this.lastAttackTime=e)}this.updateAnimation()}catch(s){console.error("Error in DroidPolice update:",s)}}applyZombieAvoidance(){if(!this.scene.zombieGroup)return;let e=0,t=0,s=0;this.scene.zombieGroup.children.entries.forEach((i=>{if(i===this||i.isDead)return;const a=Phaser.Math.Distance.Between(this.x,this.y,i.x,i.y);if(a<25&&a>0){const n=Phaser.Math.Angle.Between(i.x,i.y,this.x,this.y),r=15*(1-a/25);e+=Math.cos(n)*r,t+=Math.sin(n)*r,s++}})),s>0&&(this.body.velocity.x+=.1*e,this.body.velocity.y+=.1*t)}updateDirection(e){const t=Phaser.Math.RadToDeg(e);this.lastDirection=t>=-45&&t<45?"right":t>=45&&t<135?"down":t>=135||t<-135?"left":"up"}updateAnimation(){this.isMoving?(this.anims.isPlaying&&"PoliceDroid"===this.anims.currentAnim.key||this.play("PoliceDroid"),"right"===this.lastDirection?this.setFlipX(!1):"left"===this.lastDirection&&this.setFlipX(!0)):this.anims.isPlaying&&"PoliceDroidIdle"===this.anims.currentAnim.key||this.play("PoliceDroidIdle")}attackPlayer(e){e&&e.takeDamage&&(e.takeDamage(this.damage),this.setTint(16711680),this.scene.time.delayedCall(150,(()=>{this.clearTint()})),this.lastAttackTime=this.scene.time.now)}takeDamage(e){this.health-=e,this.updateHealthBar(),this.setTint(16711680),this.scene.time.delayedCall(100,(()=>{this.clearTint()})),this.health<=0&&this.die()}die(){this.isDead||(this.isDead=!0,this.body.velocity.x=0,this.body.velocity.y=0,this.body.enable=!1,this.stop(),this.scene&&this.scene.zombieGroup&&this.scene.zombieGroup.children&&this.scene.zombieGroup.remove(this),this.scene.tweens.add({targets:this,alpha:0,scale:.8,duration:300,onComplete:()=>this.cleanupAndDestroy()}),this.spawnRewards())}spawnRewards(){try{if(this.scene.spawnExperienceOrb){const e=Phaser.Math.Between(1,3);for(let t=0;t<e;t++){const e=Phaser.Math.Between(-10,10),t=Phaser.Math.Between(-10,10);this.scene.spawnExperienceOrb(this.x+e,this.y+t,1)}}}catch(e){console.error("Error spawning rewards:",e)}}cleanupAndDestroy(){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null)}catch(e){console.error("Error removing update listener:",e)}this.destroy()}destroy(e){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null),this.scene&&this.scene.zombieGroup&&this.scene.zombieGroup.children&&this.scene.zombieGroup.remove(this)}catch(t){console.error("Error in destroy method:",t)}super.destroy(e)}}class TR extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t??32,s??32,i||"Dagger Bandit-Run",a??0),e.physics.add.existing(this,!1),this.body.setSize(16,16,!1),this.body.setOffset(14,32),this.maxHealth=30,this.health=this.maxHealth,this.damage=10,this.speed=50,this.attackRange=5,this.attackCooldown=1e3,this.lastAttackTime=0,this.isDead=!1,this.isMoving=!1,this.lastDirection="down",this.createAnimations(),this.addToZombieGroup(e),this.updateListener=this.update.bind(this),e.events.on("update",this.updateListener)}addToZombieGroup(e){e.zombieGroup||(e.zombieGroup=e.physics.add.group(),e.physics.add.collider(e.zombieGroup,e.zombieGroup,this.handleZombieCollision,null,e)),e.zombieGroup.add(this)}handleZombieCollision(e,t,s){if(Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y,s.x,s.y)<20){const i=Phaser.Math.Angle.Between(e.x,e.y,t.x,t.y,s.x,s.y),a=30,n=Math.cos(i)*a,r=Math.sin(i)*a;t.body.velocity.x+=n,t.body.velocity.y+=r,e.body.velocity.x-=n,e.body.velocity.y-=r,s.body.velocity.y-=n,s.body.velocity.y-=r}}createAnimations(){this.scene.anims.exists("Assasin Run")||this.scene.anims.create({key:"Assasin Run",frames:this.scene.anims.generateFrameNumbers("Dagger Bandit-Run",{start:0,end:7}),frameRate:8,repeat:-1}),this.scene.anims.exists("assassin")||this.scene.anims.create({key:"assassin",frames:[{key:"Dagger Bandit-Run",frame:0}],frameRate:1,repeat:0})}createHealthBar(){this.healthBarBg=this.scene.add.rectangle(this.x,this.y-20,30,4,16711680),this.healthBarBg.setOrigin(.5,.5),this.healthBarBg.setDepth(1),this.healthBarFg=this.scene.add.rectangle(this.x-15,this.y-20,30,4,65280),this.healthBarFg.setOrigin(0,.5),this.healthBarFg.setDepth(20),this.on("destroy",(()=>{this.healthBarBg&&this.healthBarBg.destroy(),this.healthBarFg&&this.healthBarFg.destroy()})),this.updateHealthBar()}updateHealthBar(){if(!this.healthBarFg||!this.healthBarBg)return;this.healthBarBg.setPosition(this.x-10,this.y-10),this.healthBarFg.setPosition(this.x-25,this.y-10);const e=this.health/this.maxHealth;this.healthBarFg.width=30*e}update(e,t){if(!this.isDead&&this.active)try{this.updateHealthBar();const t=this.scene.player;if(!t)return;if(Phaser.Math.Distance.Between(this.x,this.y,t.x,t.y)>this.attackRange){const e=Phaser.Math.Angle.Between(this.x,this.y,t.x,t.y),s=Math.cos(e)*this.speed*.1,i=Math.sin(e)*this.speed*.1;this.body.velocity.x+=s,this.body.velocity.y+=i,this.body.velocity.x*=.9,this.body.velocity.y*=.9,this.applyZombieAvoidance();const a=this.speed,n=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);if(n>a){const e=a/n;this.body.velocity.x*=e,this.body.velocity.y*=e}this.isMoving=!0,this.updateDirection(e)}else{this.body.velocity.x*=.8,this.body.velocity.y*=.8;const s=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);this.isMoving=s>5,e-this.lastAttackTime>this.attackCooldown&&(this.attackPlayer(t),this.lastAttackTime=e)}this.updateAnimation()}catch(s){console.error("Error in Assassinupdate:",s)}}applyZombieAvoidance(){if(!this.scene.zombieGroup)return;let e=0,t=0,s=0;this.scene.zombieGroup.children.entries.forEach((i=>{if(i===this||i.isDead)return;const a=Phaser.Math.Distance.Between(this.x,this.y,i.x,i.y);if(a<25&&a>0){const n=Phaser.Math.Angle.Between(i.x,i.y,this.x,this.y),r=15*(1-a/25);e+=Math.cos(n)*r,t+=Math.sin(n)*r,s++}})),s>0&&(this.body.velocity.x+=.1*e,this.body.velocity.y+=.1*t)}updateDirection(e){const t=Phaser.Math.RadToDeg(e);this.lastDirection=t>=-45&&t<45?"right":t>=45&&t<135?"down":t>=135||t<-135?"left":"up"}updateAnimation(){this.isMoving?(this.anims.isPlaying&&"Assasin Run"===this.anims.currentAnim.key||this.play("Assasin Run"),"right"===this.lastDirection?this.setFlipX(!1):"left"===this.lastDirection&&this.setFlipX(!0)):this.anims.isPlaying&&"assassin"===this.anims.currentAnim.key||this.play("assassin")}attackPlayer(e){e&&e.takeDamage&&(e.takeDamage(this.damage),this.setTint(16711680),this.scene.time.delayedCall(150,(()=>{this.clearTint()})),this.lastAttackTime=this.scene.time.now)}takeDamage(e){this.health-=e,this.updateHealthBar(),this.setTint(16711680),this.scene.time.delayedCall(100,(()=>{this.clearTint()})),this.health<=0&&this.die()}die(){this.isDead||(this.isDead=!0,this.body.velocity.x=0,this.body.velocity.y=0,this.body.enable=!1,this.stop(),this.scene.zombieGroup&&this.scene.zombieGroup.remove(this),this.scene.tweens.add({targets:this,alpha:0,scale:.8,duration:300,onComplete:()=>this.cleanupAndDestroy()}),this.spawnRewards())}spawnRewards(){try{if(this.scene.spawnExperienceOrb){const e=Phaser.Math.Between(1,3);for(let t=0;t<e;t++){const e=Phaser.Math.Between(-10,10),t=Phaser.Math.Between(-10,10);this.scene.spawnExperienceOrb(this.x+e,this.y+t,1)}}}catch(e){console.error("Error spawning rewards:",e)}}cleanupAndDestroy(){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null)}catch(e){console.error("Error removing update listener:",e)}this.destroy()}destroy(e){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null),this.scene&&this.scene.zombieGroup&&this.scene.zombieGroup.children&&this.scene.zombieGroup.remove(this)}catch(t){console.error("Error in destroy method:",t)}super.destroy(e)}}class PR extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t??32,s??32,i||"run_1",a??0),e.physics.add.existing(this,!1),this.body.setSize(16,16,!1),this.body.setOffset(14,32),this.maxHealth=30,this.health=this.maxHealth,this.damage=10,this.speed=50,this.attackRange=5,this.attackCooldown=1e3,this.lastAttackTime=0,this.isDead=!1,this.isMoving=!1,this.lastDirection="down",this.createAnimations(),this.addToZombieGroup(e),this.updateListener=this.update.bind(this),e.events.on("update",this.updateListener)}addToZombieGroup(e){e.zombieGroup||(e.zombieGroup=e.physics.add.group(),e.physics.add.collider(e.zombieGroup,e.zombieGroup,this.handleZombieCollision,null,e)),e.zombieGroup.add(this)}handleZombieCollision(e,t,s){if(Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y,s.x,s.y)<20){const i=Phaser.Math.Angle.Between(e.x,e.y,t.x,t.y,s.x,s.y),a=30,n=Math.cos(i)*a,r=Math.sin(i)*a;t.body.velocity.x+=n,t.body.velocity.y+=r,e.body.velocity.x-=n,e.body.velocity.y-=r,s.body.velocity.y-=n,s.body.velocity.y-=r}}createAnimations(){this.scene.anims.exists("AssasinTank Run")||this.scene.anims.create({key:"AssasinTank Run",frames:this.scene.anims.generateFrameNumbers("run_1",{start:0,end:7}),frameRate:8,repeat:-1}),this.scene.anims.exists("assassinTank")||this.scene.anims.create({key:"assassinTank",frames:[{key:"run_1",frame:0}],frameRate:1,repeat:0})}createHealthBar(){this.healthBarBg=this.scene.add.rectangle(this.x,this.y-20,30,4,16711680),this.healthBarBg.setOrigin(.5,.5),this.healthBarBg.setDepth(1),this.healthBarFg=this.scene.add.rectangle(this.x-15,this.y-20,30,4,65280),this.healthBarFg.setOrigin(0,.5),this.healthBarFg.setDepth(20),this.on("destroy",(()=>{this.healthBarBg&&this.healthBarBg.destroy(),this.healthBarFg&&this.healthBarFg.destroy()})),this.updateHealthBar()}updateHealthBar(){if(!this.healthBarFg||!this.healthBarBg)return;this.healthBarBg.setPosition(this.x-10,this.y-10),this.healthBarFg.setPosition(this.x-25,this.y-10);const e=this.health/this.maxHealth;this.healthBarFg.width=30*e}update(e,t){if(!this.isDead&&this.active)try{this.updateHealthBar();const t=this.scene.player;if(!t)return;if(Phaser.Math.Distance.Between(this.x,this.y,t.x,t.y)>this.attackRange){const e=Phaser.Math.Angle.Between(this.x,this.y,t.x,t.y),s=Math.cos(e)*this.speed*.1,i=Math.sin(e)*this.speed*.1;this.body.velocity.x+=s,this.body.velocity.y+=i,this.body.velocity.x*=.9,this.body.velocity.y*=.9,this.applyZombieAvoidance();const a=this.speed,n=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);if(n>a){const e=a/n;this.body.velocity.x*=e,this.body.velocity.y*=e}this.isMoving=!0,this.updateDirection(e)}else{this.body.velocity.x*=.8,this.body.velocity.y*=.8;const s=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);this.isMoving=s>5,e-this.lastAttackTime>this.attackCooldown&&(this.attackPlayer(t),this.lastAttackTime=e)}this.updateAnimation()}catch(s){console.error("Error in AssassinTank update:",s)}}applyZombieAvoidance(){if(!this.scene.zombieGroup)return;let e=0,t=0,s=0;this.scene.zombieGroup.children.entries.forEach((i=>{if(i===this||i.isDead)return;const a=Phaser.Math.Distance.Between(this.x,this.y,i.x,i.y);if(a<25&&a>0){const n=Phaser.Math.Angle.Between(i.x,i.y,this.x,this.y),r=15*(1-a/25);e+=Math.cos(n)*r,t+=Math.sin(n)*r,s++}})),s>0&&(this.body.velocity.x+=.1*e,this.body.velocity.y+=.1*t)}updateDirection(e){const t=Phaser.Math.RadToDeg(e);this.lastDirection=t>=-45&&t<45?"right":t>=45&&t<135?"down":t>=135||t<-135?"left":"up"}updateAnimation(){this.isMoving?(this.anims.isPlaying&&"AssasinTank Run"===this.anims.currentAnim.key||this.play("AssasinTank Run"),"right"===this.lastDirection?this.setFlipX(!1):"left"===this.lastDirection&&this.setFlipX(!0)):this.anims.isPlaying&&"assassinTank"===this.anims.currentAnim.key||this.play("assassinTank")}attackPlayer(e){e&&e.takeDamage&&(e.takeDamage(this.damage),this.setTint(16711680),this.scene.time.delayedCall(150,(()=>{this.clearTint()})),this.lastAttackTime=this.scene.time.now)}takeDamage(e){this.health-=e,this.updateHealthBar(),this.setTint(16711680),this.scene.time.delayedCall(100,(()=>{this.clearTint()})),this.health<=0&&this.die()}die(){this.isDead||(this.isDead=!0,this.body.velocity.x=0,this.body.velocity.y=0,this.body.enable=!1,this.stop(),this.scene.zombieGroup&&this.scene.zombieGroup.remove(this),this.scene.tweens.add({targets:this,alpha:0,scale:.8,duration:300,onComplete:()=>this.cleanupAndDestroy()}),this.spawnRewards())}spawnRewards(){try{if(this.scene.spawnExperienceOrb){const e=Phaser.Math.Between(1,3);for(let t=0;t<e;t++){const e=Phaser.Math.Between(-10,10),t=Phaser.Math.Between(-10,10);this.scene.spawnExperienceOrb(this.x+e,this.y+t,1)}}}catch(e){console.error("Error spawning rewards:",e)}}cleanupAndDestroy(){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null)}catch(e){console.error("Error removing update listener:",e)}this.destroy()}destroy(e){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null),this.scene&&this.scene.zombieGroup&&this.scene.zombieGroup.children&&this.scene.zombieGroup.remove(this)}catch(t){console.error("Error in destroy method:",t)}super.destroy(e)}}class CR extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t??32,s??32,i||"Archer Bandit-Run_85x32",a??0),e.physics.add.existing(this,!1),this.body.setSize(16,16,!1),this.body.setOffset(14,32),this.maxHealth=30,this.health=this.maxHealth,this.damage=10,this.speed=50,this.attackRange=5,this.attackCooldown=1e3,this.lastAttackTime=0,this.isDead=!1,this.isMoving=!1,this.lastDirection="down",this.createAnimations(),this.addToZombieGroup(e),this.updateListener=this.update.bind(this),e.events.on("update",this.updateListener)}addToZombieGroup(e){e.zombieGroup||(e.zombieGroup=e.physics.add.group(),e.physics.add.collider(e.zombieGroup,e.zombieGroup,this.handleZombieCollision,null,e)),e.zombieGroup.add(this)}handleZombieCollision(e,t,s){if(Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y,s.x,s.y)<20){const i=Phaser.Math.Angle.Between(e.x,e.y,t.x,t.y,s.x,s.y),a=30,n=Math.cos(i)*a,r=Math.sin(i)*a;t.body.velocity.x+=n,t.body.velocity.y+=r,e.body.velocity.x-=n,e.body.velocity.y-=r,s.body.velocity.y-=n,s.body.velocity.y-=r}}createAnimations(){this.scene.anims.exists("AssasinArcher Run")||this.scene.anims.create({key:"AssasinArcher Run",frames:this.scene.anims.generateFrameNumbers("Archer Bandit-Run_85x32",{start:0,end:7}),frameRate:8,repeat:-1}),this.scene.anims.exists("AssasinArcher")||this.scene.anims.create({key:"AssasinArcher",frames:[{key:"Archer Bandit-Run_85x32",frame:0}],frameRate:1,repeat:0})}createHealthBar(){this.healthBarBg=this.scene.add.rectangle(this.x,this.y-20,30,4,16711680),this.healthBarBg.setOrigin(.5,.5),this.healthBarBg.setDepth(1),this.healthBarFg=this.scene.add.rectangle(this.x+55,this.y-20,30,4,65280),this.healthBarFg.setOrigin(0,.5),this.healthBarFg.setDepth(20),this.on("destroy",(()=>{this.healthBarBg&&this.healthBarBg.destroy(),this.healthBarFg&&this.healthBarFg.destroy()})),this.updateHealthBar()}updateHealthBar(){if(!this.healthBarFg||!this.healthBarBg)return;this.healthBarBg.setPosition(this.x-10,this.y-10),this.healthBarFg.setPosition(this.x-25,this.y-10);const e=this.health/this.maxHealth;this.healthBarFg.width=30*e}update(e,t){if(!this.isDead&&this.active)try{this.updateHealthBar();const t=this.scene.player;if(!t)return;if(Phaser.Math.Distance.Between(this.x,this.y,t.x,t.y)>this.attackRange){const e=Phaser.Math.Angle.Between(this.x,this.y,t.x,t.y),s=Math.cos(e)*this.speed*.1,i=Math.sin(e)*this.speed*.1;this.body.velocity.x+=s,this.body.velocity.y+=i,this.body.velocity.x*=.9,this.body.velocity.y*=.9,this.applyZombieAvoidance();const a=this.speed,n=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);if(n>a){const e=a/n;this.body.velocity.x*=e,this.body.velocity.y*=e}this.isMoving=!0,this.updateDirection(e)}else{this.body.velocity.x*=.8,this.body.velocity.y*=.8;const s=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);this.isMoving=s>5,e-this.lastAttackTime>this.attackCooldown&&(this.attackPlayer(t),this.lastAttackTime=e)}this.updateAnimation()}catch(s){console.error("Error in AssasinArcher update:",s)}}applyZombieAvoidance(){if(!this.scene.zombieGroup)return;let e=0,t=0,s=0;this.scene.zombieGroup.children.entries.forEach((i=>{if(i===this||i.isDead)return;const a=Phaser.Math.Distance.Between(this.x,this.y,i.x,i.y);if(a<25&&a>0){const n=Phaser.Math.Angle.Between(i.x,i.y,this.x,this.y),r=15*(1-a/25);e+=Math.cos(n)*r,t+=Math.sin(n)*r,s++}})),s>0&&(this.body.velocity.x+=.1*e,this.body.velocity.y+=.1*t)}updateDirection(e){const t=Phaser.Math.RadToDeg(e);this.lastDirection=t>=-45&&t<45?"right":t>=45&&t<135?"down":t>=135||t<-135?"left":"up"}updateAnimation(){this.isMoving?(this.anims.isPlaying&&"AssasinArcher Run"===this.anims.currentAnim.key||this.play("AssasinArcher Run"),"right"===this.lastDirection?this.setFlipX(!1):"left"===this.lastDirection&&this.setFlipX(!0)):this.anims.isPlaying&&"AssasinArcher"===this.anims.currentAnim.key||this.play("AssasinArcher")}attackPlayer(e){e&&e.takeDamage&&(e.takeDamage(this.damage),this.setTint(16711680),this.scene.time.delayedCall(150,(()=>{this.clearTint()})),this.lastAttackTime=this.scene.time.now)}takeDamage(e){this.health-=e,this.updateHealthBar(),this.setTint(16711680),this.scene.time.delayedCall(100,(()=>{this.clearTint()})),this.health<=0&&this.die()}die(){this.isDead||(this.isDead=!0,this.body.velocity.x=0,this.body.velocity.y=0,this.body.enable=!1,this.stop(),this.scene.zombieGroup&&this.scene.zombieGroup.remove(this),this.scene.tweens.add({targets:this,alpha:0,scale:.8,duration:300,onComplete:()=>this.cleanupAndDestroy()}),this.spawnRewards())}spawnRewards(){try{if(this.scene.spawnExperienceOrb){const e=Phaser.Math.Between(1,3);for(let t=0;t<e;t++){const e=Phaser.Math.Between(-10,10),t=Phaser.Math.Between(-10,10);this.scene.spawnExperienceOrb(this.x+e,this.y+t,1)}}}catch(e){console.error("Error spawning rewards:",e)}}cleanupAndDestroy(){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null)}catch(e){console.error("Error removing update listener:",e)}this.destroy()}destroy(e){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null),this.scene&&this.scene.zombieGroup&&this.scene.zombieGroup.children&&this.scene.zombieGroup.remove(this)}catch(t){console.error("Error in destroy method:",t)}super.destroy(e)}}class MR extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t??64,s??64,i||"run_2",a??0),e.physics.add.existing(this,!1),this.body.setSize(32,32,!1),this.body.setOffset(16,32),this.maxHealth=80,this.health=this.maxHealth,this.damage=25,this.speed=30,this.attackRange=40,this.attackCooldown=1500,this.lastAttackTime=0,this.isDead=!1,this.isMoving=!1,this.lastDirection="down",this.createAnimations(),this.addToZombieGroup(e),this.updateListener=this.update.bind(this),e.events.on("update",this.updateListener)}addToZombieGroup(e){e.zombieGroup||(e.zombieGroup=e.physics.add.group(),e.physics.add.collider(e.zombieGroup,e.zombieGroup,this.handleZombieCollision,null,e)),e.zombieGroup.add(this)}handleZombieCollision(e,t,s){if(Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y)<30){const i=Phaser.Math.Angle.Between(e.x,e.y,t.x,t.y),a=40,n=Math.cos(i)*a,r=Math.sin(i)*a;t.body.velocity.x+=n,t.body.velocity.y+=r,e.body.velocity.x-=n,e.body.velocity.y-=r,s&&(s.body.velocity.x-=.5*n,s.body.velocity.y-=.5*r)}}createAnimations(){this.scene.anims.exists("BigDude Run")||this.scene.anims.create({key:"BigDude Run",frames:this.scene.anims.generateFrameNumbers("run_2",{start:0,end:7}),frameRate:6,repeat:-1}),this.scene.textures.exists("attack 2t")&&!this.scene.anims.exists("BigDude Attack2")&&this.scene.anims.create({key:"BigDude Attack2",frames:this.scene.anims.generateFrameNumbers("attack 2t",{start:0,end:7}),frameRate:8,repeat:0}),this.scene.anims.exists("BigDude Idle")||this.scene.anims.create({key:"BigDude Idle",frames:[{key:"run_2",frame:0}],frameRate:1,repeat:0})}createHealthBar(){this.healthBarBg=this.scene.add.rectangle(this.x,this.y-25,40,6,16711680),this.healthBarBg.setOrigin(.5,.5),this.healthBarBg.setDepth(1),this.healthBarFg=this.scene.add.rectangle(this.x-20,this.y-25,40,6,65280),this.healthBarFg.setOrigin(0,.5),this.healthBarFg.setDepth(20),this.on("destroy",(()=>{this.healthBarBg&&this.healthBarBg.destroy(),this.healthBarFg&&this.healthBarFg.destroy()})),this.updateHealthBar()}updateHealthBar(){if(!this.healthBarFg||!this.healthBarBg)return;this.healthBarBg.setPosition(this.x,this.y-15),this.healthBarFg.setPosition(this.x-20,this.y-15);const e=this.health/this.maxHealth;this.healthBarFg.width=40*e}update(e,t){if(!this.isDead&&this.active)try{this.updateHealthBar();const t=this.scene.player;if(!t)return;if(Phaser.Math.Distance.Between(this.x,this.y,t.x,t.y)>this.attackRange){const e=Phaser.Math.Angle.Between(this.x,this.y,t.x,t.y),s=Math.cos(e)*this.speed*.1,i=Math.sin(e)*this.speed*.1;this.body.velocity.x+=s,this.body.velocity.y+=i,this.body.velocity.x*=.85,this.body.velocity.y*=.85,this.applyZombieAvoidance();const a=this.speed,n=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);if(n>a){const e=a/n;this.body.velocity.x*=e,this.body.velocity.y*=e}this.isMoving=!0,this.updateDirection(e)}else{this.body.velocity.x*=.7,this.body.velocity.y*=.7;const s=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);this.isMoving=s>5,e-this.lastAttackTime>this.attackCooldown&&(this.attackPlayer(t),this.lastAttackTime=e)}this.updateAnimation()}catch(s){console.error("Error in BigDude update:",s)}}applyZombieAvoidance(){if(!this.scene.zombieGroup)return;let e=0,t=0,s=0;this.scene.zombieGroup.children.entries.forEach((i=>{if(i===this||i.isDead)return;const a=Phaser.Math.Distance.Between(this.x,this.y,i.x,i.y);if(a<35&&a>0){const n=Phaser.Math.Angle.Between(i.x,i.y,this.x,this.y),r=20*(1-a/35);e+=Math.cos(n)*r,t+=Math.sin(n)*r,s++}})),s>0&&(this.body.velocity.x+=.08*e,this.body.velocity.y+=.08*t)}updateDirection(e){const t=Phaser.Math.RadToDeg(e);this.lastDirection=t>=-45&&t<45?"right":t>=45&&t<135?"down":t>=135||t<-135?"left":"up"}updateAnimation(){this.isMoving?(this.anims.isPlaying&&"BigDude Run"===this.anims.currentAnim.key||this.play("BigDude Run"),"right"===this.lastDirection?this.setFlipX(!1):"left"===this.lastDirection&&this.setFlipX(!0)):this.anims.isPlaying&&"BigDude Idle"===this.anims.currentAnim.key||this.play("BigDude Idle")}attackPlayer(e){e&&e.takeDamage&&(this.scene.anims.exists("BigDude Attack2")?(this.play("BigDude Attack2"),this.scene.time.delayedCall(400,(()=>{e&&e.takeDamage&&!this.isDead&&e.takeDamage(this.damage)}))):e.takeDamage(this.damage),this.setTint(16746496),this.scene.time.delayedCall(200,(()=>{this.active&&this.clearTint()})),this.lastAttackTime=this.scene.time.now)}takeDamage(e){this.isDead||(this.health-=e,this.updateHealthBar(),this.setTint(16711680),this.scene.time.delayedCall(150,(()=>{this.active&&this.clearTint()})),this.health<=0&&this.die())}die(){this.isDead||(this.isDead=!0,this.body.velocity.x=0,this.body.velocity.y=0,this.body.enable=!1,this.stop(),this.scene.zombieGroup&&this.scene.zombieGroup.remove(this),this.scene.tweens.add({targets:this,alpha:0,scale:.7,duration:500,onComplete:()=>this.cleanupAndDestroy()}),this.spawnRewards())}spawnRewards(){try{if(this.scene.spawnExperienceOrb){const e=Phaser.Math.Between(3,6);for(let t=0;t<e;t++){const e=Phaser.Math.Between(-15,15),t=Phaser.Math.Between(-15,15);this.scene.spawnExperienceOrb(this.x+e,this.y+t,2)}}}catch(e){console.error("Error spawning rewards:",e)}}cleanupAndDestroy(){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null)}catch(e){console.error("Error removing update listener:",e)}this.destroy()}destroy(e){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null),this.scene&&this.scene.zombieGroup&&this.scene.zombieGroup.children&&this.scene.zombieGroup.remove(this)}catch(t){console.error("Error in destroy method:",t)}super.destroy(e)}}class BR extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t??48,s??48,i||"WreackerRun",a??0),e.physics.add.existing(this,!1),this.body.setSize(24,24,!1),this.body.setOffset(12,24),this.maxHealth=50,this.health=this.maxHealth,this.damage=15,this.speed=60,this.attackRange=30,this.attackCooldown=800,this.lastAttackTime=0,this.isDead=!1,this.isMoving=!1,this.lastDirection="down",this.createAnimations(),this.addToZombieGroup(e),this.updateListener=this.update.bind(this),e.events.on("update",this.updateListener)}addToZombieGroup(e){e.zombieGroup||(e.zombieGroup=e.physics.add.group(),e.physics.add.collider(e.zombieGroup,e.zombieGroup,this.handleZombieCollision,null,e)),e.zombieGroup.add(this)}handleZombieCollision(e,t,s){if(Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y)<25){const i=Phaser.Math.Angle.Between(e.x,e.y,t.x,t.y),a=30,n=Math.cos(i)*a,r=Math.sin(i)*a;t.body.velocity.x+=n,t.body.velocity.y+=r,e.body.velocity.x-=n,e.body.velocity.y-=r,s&&(s.body.velocity.x-=.7*n,s.body.velocity.y-=.7*r)}}createAnimations(){this.scene.anims.exists("WreackerRun")||this.scene.anims.create({key:"WreackerRun",frames:this.scene.anims.generateFrameNumbers("WreackerRun",{start:0,end:7}),frameRate:8,repeat:-1}),this.scene.textures.exists("WreackerAttack")&&!this.scene.anims.exists("Wreacker Attack")&&this.scene.anims.create({key:"Wreacker Attack",frames:this.scene.anims.generateFrameNumbers("WreackerAttack",{start:0,end:5}),frameRate:10,repeat:0}),this.scene.anims.exists("Wreacker Idle")||this.scene.anims.create({key:"Wreacker Idle",frames:[{key:"WreackerRun",frame:0}],frameRate:1,repeat:0})}createHealthBar(){this.healthBarBg=this.scene.add.rectangle(this.x,this.y-20,35,5,16711680),this.healthBarBg.setOrigin(.5,.5),this.healthBarBg.setDepth(1),this.healthBarFg=this.scene.add.rectangle(this.x-17.5,this.y-20,35,5,65280),this.healthBarFg.setOrigin(0,.5),this.healthBarFg.setDepth(20),this.on("destroy",(()=>{this.healthBarBg&&this.healthBarBg.destroy(),this.healthBarFg&&this.healthBarFg.destroy()})),this.updateHealthBar()}updateHealthBar(){if(!this.healthBarFg||!this.healthBarBg)return;this.healthBarBg.setPosition(this.x,this.y-12),this.healthBarFg.setPosition(this.x-17.5,this.y-12);const e=this.health/this.maxHealth;this.healthBarFg.width=35*e}update(e,t){if(!this.isDead&&this.active)try{this.updateHealthBar();const t=this.scene.player;if(!t)return;if(Phaser.Math.Distance.Between(this.x,this.y,t.x,t.y)>this.attackRange){const e=Phaser.Math.Angle.Between(this.x,this.y,t.x,t.y),s=Math.cos(e)*this.speed*.12,i=Math.sin(e)*this.speed*.12;this.body.velocity.x+=s,this.body.velocity.y+=i,this.body.velocity.x*=.88,this.body.velocity.y*=.88,this.applyZombieAvoidance();const a=this.speed,n=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);if(n>a){const e=a/n;this.body.velocity.x*=e,this.body.velocity.y*=e}this.isMoving=!0,this.updateDirection(e)}else{this.body.velocity.x*=.75,this.body.velocity.y*=.75;const s=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);this.isMoving=s>5,e-this.lastAttackTime>this.attackCooldown&&(this.attackPlayer(t),this.lastAttackTime=e)}this.updateAnimation()}catch(s){console.error("Error in Wreacker update:",s)}}applyZombieAvoidance(){if(!this.scene.zombieGroup)return;let e=0,t=0,s=0;this.scene.zombieGroup.children.entries.forEach((i=>{if(i===this||i.isDead)return;const a=Phaser.Math.Distance.Between(this.x,this.y,i.x,i.y);if(a<30&&a>0){const n=Phaser.Math.Angle.Between(i.x,i.y,this.x,this.y),r=18*(1-a/30);e+=Math.cos(n)*r,t+=Math.sin(n)*r,s++}})),s>0&&(this.body.velocity.x+=.1*e,this.body.velocity.y+=.1*t)}updateDirection(e){const t=Phaser.Math.RadToDeg(e);this.lastDirection=t>=-45&&t<45?"right":t>=45&&t<135?"down":t>=135||t<-135?"left":"up"}updateAnimation(){this.isMoving?(this.anims.isPlaying&&"WreackerRun"===this.anims.currentAnim.key||this.play("WreackerRun"),"right"===this.lastDirection?this.setFlipX(!1):"left"===this.lastDirection&&this.setFlipX(!0)):this.anims.isPlaying&&"Wreacker Idle"===this.anims.currentAnim.key||this.play("Wreacker Idle")}attackPlayer(e){e&&e.takeDamage&&(this.scene.anims.exists("Wreacker Attack")?(this.play("Wreacker Attack"),this.scene.time.delayedCall(250,(()=>{e&&e.takeDamage&&!this.isDead&&e.takeDamage(this.damage)}))):e.takeDamage(this.damage),this.setTint(16729088),this.scene.time.delayedCall(150,(()=>{this.active&&this.clearTint()})),this.lastAttackTime=this.scene.time.now)}takeDamage(e){this.isDead||(this.health-=e,this.updateHealthBar(),this.setTint(16711680),this.scene.time.delayedCall(120,(()=>{this.active&&this.clearTint()})),this.health<=0&&this.die())}die(){this.isDead||(this.isDead=!0,this.body.velocity.x=0,this.body.velocity.y=0,this.body.enable=!1,this.stop(),this.scene.zombieGroup&&this.scene.zombieGroup.remove(this),this.scene.tweens.add({targets:this,alpha:0,scale:.6,duration:400,onComplete:()=>this.cleanupAndDestroy()}),this.spawnRewards())}spawnRewards(){try{if(this.scene.spawnExperienceOrb){const e=Phaser.Math.Between(2,4);for(let t=0;t<e;t++){const e=Phaser.Math.Between(-12,12),t=Phaser.Math.Between(-12,12);this.scene.spawnExperienceOrb(this.x+e,this.y+t,1.5)}}}catch(e){console.error("Error spawning rewards:",e)}}cleanupAndDestroy(){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null)}catch(e){console.error("Error removing update listener:",e)}this.destroy()}destroy(e){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null),this.scene&&this.scene.zombieGroup&&this.scene.zombieGroup.children&&this.scene.zombieGroup.remove(this)}catch(t){console.error("Error in destroy method:",t)}super.destroy(e)}}class RR extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t??64,s??64,i||"Warrior-Run",a??0),e.physics.add.existing(this,!1),this.body.setSize(32,32,!1),this.body.setOffset(16,32),this.maxHealth=60,this.health=this.maxHealth,this.damage=20,this.speed=45,this.attackRange=35,this.attackCooldown=1e3,this.lastAttackTime=0,this.isDead=!1,this.isMoving=!1,this.lastDirection="down",this.createAnimations(),this.addToZombieGroup(e),this.updateListener=this.update.bind(this),e.events.on("update",this.updateListener)}addToZombieGroup(e){e.zombieGroup||(e.zombieGroup=e.physics.add.group(),e.physics.add.collider(e.zombieGroup,e.zombieGroup,this.handleZombieCollision,null,e)),e.zombieGroup.add(this)}handleZombieCollision(e,t,s){if(Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y)<28){const i=Phaser.Math.Angle.Between(e.x,e.y,t.x,t.y),a=35,n=Math.cos(i)*a,r=Math.sin(i)*a;t.body.velocity.x+=n,t.body.velocity.y+=r,e.body.velocity.x-=n,e.body.velocity.y-=r,s&&(s.body.velocity.x-=.6*n,s.body.velocity.y-=.6*r)}}createAnimations(){this.scene.anims.exists("Warrior-Run")||this.scene.anims.create({key:"Warrior-Run",frames:this.scene.anims.generateFrameNumbers("Warrior-Run",{start:0,end:7}),frameRate:8,repeat:-1}),this.scene.textures.exists("WarriorAttack")&&!this.scene.anims.exists("Warrior Attack")&&this.scene.anims.create({key:"Warrior Attack",frames:this.scene.anims.generateFrameNumbers("WarriorAttack",{start:0,end:5}),frameRate:10,repeat:0}),this.scene.anims.exists("Warrior Idle")||this.scene.anims.create({key:"Warrior Idle",frames:[{key:"Warrior-Run",frame:0}],frameRate:1,repeat:0})}createHealthBar(){this.healthBarBg=this.scene.add.rectangle(this.x,this.y-25,38,6,16711680),this.healthBarBg.setOrigin(.5,.5),this.healthBarBg.setDepth(1),this.healthBarFg=this.scene.add.rectangle(this.x-19,this.y-25,38,6,65280),this.healthBarFg.setOrigin(0,.5),this.healthBarFg.setDepth(20),this.on("destroy",(()=>{this.healthBarBg&&this.healthBarBg.destroy(),this.healthBarFg&&this.healthBarFg.destroy()})),this.updateHealthBar()}updateHealthBar(){if(!this.healthBarFg||!this.healthBarBg)return;this.healthBarBg.setPosition(this.x,this.y-15),this.healthBarFg.setPosition(this.x-19,this.y-15);const e=this.health/this.maxHealth;this.healthBarFg.width=38*e}update(e,t){if(!this.isDead&&this.active)try{this.updateHealthBar();const t=this.scene.player;if(!t)return;if(Phaser.Math.Distance.Between(this.x,this.y,t.x,t.y)>this.attackRange){const e=Phaser.Math.Angle.Between(this.x,this.y,t.x,t.y),s=Math.cos(e)*this.speed*.11,i=Math.sin(e)*this.speed*.11;this.body.velocity.x+=s,this.body.velocity.y+=i,this.body.velocity.x*=.87,this.body.velocity.y*=.87,this.applyZombieAvoidance();const a=this.speed,n=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);if(n>a){const e=a/n;this.body.velocity.x*=e,this.body.velocity.y*=e}this.isMoving=!0,this.updateDirection(e)}else{this.body.velocity.x*=.75,this.body.velocity.y*=.75;const s=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);this.isMoving=s>5,e-this.lastAttackTime>this.attackCooldown&&(this.attackPlayer(t),this.lastAttackTime=e)}this.updateAnimation()}catch(s){console.error("Error in Warrior update:",s)}}applyZombieAvoidance(){if(!this.scene.zombieGroup)return;let e=0,t=0,s=0;this.scene.zombieGroup.children.entries.forEach((i=>{if(i===this||i.isDead)return;const a=Phaser.Math.Distance.Between(this.x,this.y,i.x,i.y);if(a<32&&a>0){const n=Phaser.Math.Angle.Between(i.x,i.y,this.x,this.y),r=19*(1-a/32);e+=Math.cos(n)*r,t+=Math.sin(n)*r,s++}})),s>0&&(this.body.velocity.x+=.09*e,this.body.velocity.y+=.09*t)}updateDirection(e){const t=Phaser.Math.RadToDeg(e);this.lastDirection=t>=-45&&t<45?"right":t>=45&&t<135?"down":t>=135||t<-135?"left":"up"}updateAnimation(){this.isMoving?(this.anims.isPlaying&&"Warrior-Run"===this.anims.currentAnim.key||this.play("Warrior-Run"),"right"===this.lastDirection?this.setFlipX(!1):"left"===this.lastDirection&&this.setFlipX(!0)):this.anims.isPlaying&&"Warrior Idle"===this.anims.currentAnim.key||this.play("Warrior Idle")}attackPlayer(e){e&&e.takeDamage&&(this.scene.anims.exists("Warrior Attack")?(this.play("Warrior Attack"),this.scene.time.delayedCall(300,(()=>{e&&e.takeDamage&&!this.isDead&&e.takeDamage(this.damage)}))):e.takeDamage(this.damage),this.setTint(16755200),this.scene.time.delayedCall(180,(()=>{this.active&&this.clearTint()})),this.lastAttackTime=this.scene.time.now)}takeDamage(e){this.isDead||(this.health-=e,this.updateHealthBar(),this.setTint(16711680),this.scene.time.delayedCall(140,(()=>{this.active&&this.clearTint()})),this.health<=0&&this.die())}die(){this.isDead||(this.isDead=!0,this.body.velocity.x=0,this.body.velocity.y=0,this.body.enable=!1,this.stop(),this.scene.zombieGroup&&this.scene.zombieGroup.remove(this),this.scene.tweens.add({targets:this,alpha:0,scale:.65,duration:450,onComplete:()=>this.cleanupAndDestroy()}),this.spawnRewards())}spawnRewards(){try{if(this.scene.spawnExperienceOrb){const e=Phaser.Math.Between(3,5);for(let t=0;t<e;t++){const e=Phaser.Math.Between(-13,13),t=Phaser.Math.Between(-13,13);this.scene.spawnExperienceOrb(this.x+e,this.y+t,1.8)}}}catch(e){console.error("Error spawning rewards:",e)}}cleanupAndDestroy(){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null)}catch(e){console.error("Error removing update listener:",e)}this.destroy()}destroy(e){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null),this.scene&&this.scene.zombieGroup&&this.scene.zombieGroup.children&&this.scene.zombieGroup.remove(this)}catch(t){console.error("Error in destroy method:",t)}super.destroy(e)}}class DR extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t??64,s??64,i||"crawler_run_32x16_v01",a??0),e.physics.add.existing(this,!1),this.body.setSize(24,12,!1),this.body.setOffset(4,4),this.maxHealth=30,this.health=this.maxHealth,this.damage=15,this.speed=45,this.attackRange=25,this.attackCooldown=800,this.lastAttackTime=0,this.isDead=!1,this.isMoving=!1,this.lastDirection="down",this.createAnimations(),this.addToZombieGroup(e),this.updateListener=this.update.bind(this),e.events.on("update",this.updateListener)}addToZombieGroup(e){e.zombieGroup||(e.zombieGroup=e.physics.add.group(),e.physics.add.collider(e.zombieGroup,e.zombieGroup,this.handleZombieCollision,null,e)),e.zombieGroup.add(this)}handleZombieCollision(e,t,s){if(Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y)<25){const i=Phaser.Math.Angle.Between(e.x,e.y,t.x,t.y),a=30,n=Math.cos(i)*a,r=Math.sin(i)*a;t.body.velocity.x+=n,t.body.velocity.y+=r,e.body.velocity.x-=n,e.body.velocity.y-=r,s&&(s.body.velocity.x-=.3*n,s.body.velocity.y-=.3*r)}}createAnimations(){this.scene.anims.exists("Crawler Run")||this.scene.anims.create({key:"Crawler Run",frames:this.scene.anims.generateFrameNumbers("crawler_run_32x16_v01",{start:0,end:7}),frameRate:10,repeat:-1}),this.scene.textures.exists("crawler_attack")&&!this.scene.anims.exists("Crawler Attack")&&this.scene.anims.create({key:"Crawler Attack",frames:this.scene.anims.generateFrameNumbers("crawler_attack",{start:0,end:5}),frameRate:12,repeat:0}),this.scene.anims.exists("Crawler Idle")||this.scene.anims.create({key:"Crawler Idle",frames:[{key:"crawler_run_32x16_v01",frame:0}],frameRate:1,repeat:0})}createHealthBar(){this.healthBarBg=this.scene.add.rectangle(this.x,this.y-20,30,4,16711680),this.healthBarBg.setOrigin(.5,.5),this.healthBarBg.setDepth(1),this.healthBarFg=this.scene.add.rectangle(this.x-15,this.y-20,30,4,65280),this.healthBarFg.setOrigin(0,.5),this.healthBarFg.setDepth(20),this.on("destroy",(()=>{this.healthBarBg&&this.healthBarBg.destroy(),this.healthBarFg&&this.healthBarFg.destroy()})),this.updateHealthBar()}updateHealthBar(){if(!this.healthBarFg||!this.healthBarBg)return;this.healthBarBg.setPosition(this.x,this.y-12),this.healthBarFg.setPosition(this.x-15,this.y-12);const e=this.health/this.maxHealth;this.healthBarFg.width=30*e}update(e,t){if(!this.isDead&&this.active)try{this.updateHealthBar();const t=this.scene.player;if(!t)return;if(Phaser.Math.Distance.Between(this.x,this.y,t.x,t.y)>this.attackRange){const e=Phaser.Math.Angle.Between(this.x,this.y,t.x,t.y),s=Math.cos(e)*this.speed*.12,i=Math.sin(e)*this.speed*.12;this.body.velocity.x+=s,this.body.velocity.y+=i,this.body.velocity.x*=.9,this.body.velocity.y*=.9,this.applyZombieAvoidance();const a=this.speed,n=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);if(n>a){const e=a/n;this.body.velocity.x*=e,this.body.velocity.y*=e}this.isMoving=!0,this.updateDirection(e)}else{this.body.velocity.x*=.8,this.body.velocity.y*=.8;const s=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);this.isMoving=s>3,e-this.lastAttackTime>this.attackCooldown&&(this.attackPlayer(t),this.lastAttackTime=e)}this.updateAnimation()}catch(s){console.error("Error in Crawler update:",s)}}applyZombieAvoidance(){if(!this.scene.zombieGroup)return;let e=0,t=0,s=0;this.scene.zombieGroup.children.entries.forEach((i=>{if(i===this||i.isDead)return;const a=Phaser.Math.Distance.Between(this.x,this.y,i.x,i.y);if(a<25&&a>0){const n=Phaser.Math.Angle.Between(i.x,i.y,this.x,this.y),r=15*(1-a/25);e+=Math.cos(n)*r,t+=Math.sin(n)*r,s++}})),s>0&&(this.body.velocity.x+=.06*e,this.body.velocity.y+=.06*t)}updateDirection(e){const t=Phaser.Math.RadToDeg(e);this.lastDirection=t>=-45&&t<45?"right":t>=45&&t<135?"down":t>=135||t<-135?"left":"up"}updateAnimation(){this.isMoving?(this.anims.isPlaying&&"Crawler Run"===this.anims.currentAnim.key||this.play("Crawler Run"),"right"===this.lastDirection?this.setFlipX(!1):"left"===this.lastDirection&&this.setFlipX(!0)):this.anims.isPlaying&&"Crawler Idle"===this.anims.currentAnim.key||this.play("Crawler Idle")}attackPlayer(e){e&&e.takeDamage&&(this.scene.anims.exists("Crawler Attack")?(this.play("Crawler Attack"),this.scene.time.delayedCall(300,(()=>{e&&e.takeDamage&&!this.isDead&&e.takeDamage(this.damage)}))):e.takeDamage(this.damage),this.setTint(16729088),this.scene.time.delayedCall(150,(()=>{this.active&&this.clearTint()})),this.lastAttackTime=this.scene.time.now)}takeDamage(e){this.isDead||(this.health-=e,this.updateHealthBar(),this.setTint(16711680),this.scene.time.delayedCall(100,(()=>{this.active&&this.clearTint()})),this.health<=0&&this.die())}die(){this.isDead||(this.isDead=!0,this.body.velocity.x=0,this.body.velocity.y=0,this.body.enable=!1,this.stop(),this.scene&&this.scene.zombieGroup&&this.scene.zombieGroup.children&&this.scene.zombieGroup.remove(this),this.scene.tweens.add({targets:this,alpha:0,scale:.5,duration:400,onComplete:()=>this.cleanupAndDestroy()}),this.spawnRewards())}spawnRewards(){try{if(this.scene.spawnExperienceOrb){const e=Phaser.Math.Between(1,3);for(let t=0;t<e;t++){const e=Phaser.Math.Between(-10,10),t=Phaser.Math.Between(-10,10);this.scene.spawnExperienceOrb(this.x+e,this.y+t,1)}}}catch(e){console.error("Error spawning rewards:",e)}}cleanupAndDestroy(){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null)}catch(e){console.error("Error removing update listener:",e)}this.destroy()}destroy(e){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null),this.scene&&this.scene.zombieGroup&&this.scene.zombieGroup.children&&this.scene.zombieGroup.remove(this)}catch(t){console.error("Error in destroy method:",t)}super.destroy(e)}}class NR extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t??64,s??64,i||"Bomber_Activited_run_v01",a??0),e.physics.add.existing(this,!1),this.body.setSize(28,28,!1),this.body.setOffset(18,20),this.maxHealth=40,this.health=this.maxHealth,this.damage=35,this.speed=35,this.explosionRange=80,this.triggerRange=50,this.explosionDelay=1e3,this.isTriggered=!1,this.triggerTime=0,this.isDead=!1,this.isMoving=!1,this.lastDirection="down",this.flashTimer=0,this.flashInterval=200,this.createAnimations(),this.addToZombieGroup(e),this.updateListener=this.update.bind(this),e.events.on("update",this.updateListener)}addToZombieGroup(e){e.zombieGroup||(e.zombieGroup=e.physics.add.group(),e.physics.add.collider(e.zombieGroup,e.zombieGroup,this.handleZombieCollision,null,e)),e.zombieGroup.add(this)}handleZombieCollision(e,t,s){if(Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y)<28){const i=Phaser.Math.Angle.Between(e.x,e.y,t.x,t.y),a=35,n=Math.cos(i)*a,r=Math.sin(i)*a;t.body.velocity.x+=n,t.body.velocity.y+=r,e.body.velocity.x-=n,e.body.velocity.y-=r,s&&(s.body.velocity.x-=.4*n,s.body.velocity.y-=.4*r)}}createAnimations(){this.scene.anims.exists("Bomber Run")||this.scene.anims.create({key:"Bomber Run",frames:this.scene.anims.generateFrameNumbers("Bomber_Activited_run_v01",{start:0,end:7}),frameRate:8,repeat:-1}),this.scene.textures.exists("bomber_explode")&&!this.scene.anims.exists("Bomber Explode")&&this.scene.anims.create({key:"Bomber Explode",frames:this.scene.anims.generateFrameNumbers("bomber_explode",{start:0,end:5}),frameRate:15,repeat:0}),this.scene.anims.exists("Bomber Idle")||this.scene.anims.create({key:"Bomber Idle",frames:[{key:"Bomber_Activited_run_v01",frame:0}],frameRate:1,repeat:0})}createHealthBar(){this.healthBarBg=this.scene.add.rectangle(this.x,this.y-22,35,5,16711680),this.healthBarBg.setOrigin(.5,.5),this.healthBarBg.setDepth(1),this.healthBarFg=this.scene.add.rectangle(this.x-17.5,this.y-22,35,5,65280),this.healthBarFg.setOrigin(0,.5),this.healthBarFg.setDepth(20),this.on("destroy",(()=>{this.healthBarBg&&this.healthBarBg.destroy(),this.healthBarFg&&this.healthBarFg.destroy()})),this.updateHealthBar()}updateHealthBar(){if(!this.healthBarFg||!this.healthBarBg)return;this.healthBarBg.setPosition(this.x,this.y-15),this.healthBarFg.setPosition(this.x-17.5,this.y-15);const e=this.health/this.maxHealth;this.healthBarFg.width=35*e,this.isTriggered&&(this.healthBarBg.setFillStyle(16755200),this.healthBarFg.setFillStyle(16711680))}update(e,t){if(!this.isDead&&this.active)try{this.updateHealthBar();const t=this.scene.player;if(!t)return;const s=Phaser.Math.Distance.Between(this.x,this.y,t.x,t.y);if(!this.isTriggered&&s<=this.triggerRange&&this.triggerExplosion(e),this.isTriggered&&(this.handleTriggeredState(e),e-this.triggerTime>=this.explosionDelay))return void this.explode();const i=this.isTriggered?1.5*this.speed:this.speed;if(s>10){const e=Phaser.Math.Angle.Between(this.x,this.y,t.x,t.y),s=this.isTriggered?.15:.11,a=Math.cos(e)*i*s,n=Math.sin(e)*i*s;this.body.velocity.x+=a,this.body.velocity.y+=n,this.body.velocity.x*=.88,this.body.velocity.y*=.88,this.isTriggered||this.applyZombieAvoidance();const r=i,o=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);if(o>r){const e=r/o;this.body.velocity.x*=e,this.body.velocity.y*=e}this.isMoving=!0,this.updateDirection(e)}else{this.body.velocity.x*=.8,this.body.velocity.y*=.8;const e=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);this.isMoving=e>3}this.updateAnimation()}catch(s){console.error("Error in Bomber update:",s)}}triggerExplosion(e){this.isTriggered=!0,this.triggerTime=e,this.setTint(16737792),this.scene.sound&&this.scene.sound.get("bomber_trigger")&&this.scene.sound.play("bomber_trigger")}handleTriggeredState(e){const t=this.explosionDelay-(e-this.triggerTime),s=Math.max(50,.2*t);e-this.flashTimer>s&&(16777215===this.tint?this.setTint(16711680):this.clearTint(),this.flashTimer=e)}explode(){this.isDead||(this.isDead=!0,this.body.enable=!1,this.stop(),this.createExplosionEffect(),this.dealExplosionDamage(),this.scene.sound&&this.scene.sound.get("explosion")&&this.scene.sound.play("explosion"),this.scene.zombieGroup&&this.scene.zombieGroup.remove(this),this.scene.tweens.add({targets:this,scaleX:2,scaleY:2,alpha:0,duration:300,ease:"Power2",onComplete:()=>this.cleanupAndDestroy()}),this.spawnRewards())}createExplosionEffect(){const e=this.scene.add.circle(this.x,this.y,0,16729088,.7);e.setDepth(100),this.scene.tweens.add({targets:e,radius:this.explosionRange,alpha:0,duration:400,ease:"Power2",onComplete:()=>e.destroy()})}dealExplosionDamage(){const e=this.scene.player;if(e&&e.active){const t=Phaser.Math.Distance.Between(this.x,this.y,e.x,e.y);if(t<=this.explosionRange){const s=1-t/this.explosionRange,i=Math.floor(this.damage*s);e.takeDamage&&e.takeDamage(i)}}this.scene.zombieGroup&&this.scene.zombieGroup.children.entries.forEach((e=>{if(e===this||e.isDead||!e.active)return;const t=Phaser.Math.Distance.Between(this.x,this.y,e.x,e.y);if(t<=this.explosionRange){const s=1-t/this.explosionRange,i=Math.floor(.5*this.damage*s);e.takeDamage&&e.takeDamage(i)}}))}applyZombieAvoidance(){if(!this.scene.zombieGroup)return;let e=0,t=0,s=0;this.scene.zombieGroup.children.entries.forEach((i=>{if(i===this||i.isDead)return;const a=Phaser.Math.Distance.Between(this.x,this.y,i.x,i.y);if(a<30&&a>0){const n=Phaser.Math.Angle.Between(i.x,i.y,this.x,this.y),r=18*(1-a/30);e+=Math.cos(n)*r,t+=Math.sin(n)*r,s++}})),s>0&&(this.body.velocity.x+=.07*e,this.body.velocity.y+=.07*t)}updateDirection(e){const t=Phaser.Math.RadToDeg(e);this.lastDirection=t>=-45&&t<45?"right":t>=45&&t<135?"down":t>=135||t<-135?"left":"up"}updateAnimation(){this.isMoving?(this.anims.isPlaying&&"Bomber Run"===this.anims.currentAnim.key||(this.play("Bomber Run"),this.isTriggered&&(this.anims.msPerFrame=80)),"right"===this.lastDirection?this.setFlipX(!1):"left"===this.lastDirection&&this.setFlipX(!0)):this.anims.isPlaying&&"Bomber Idle"===this.anims.currentAnim.key||this.play("Bomber Idle")}takeDamage(e){this.isDead||(this.health-=e,this.updateHealthBar(),this.setTint(16711680),this.scene.time.delayedCall(120,(()=>{this.active&&!this.isTriggered&&this.clearTint()})),this.health<=0&&this.explode())}spawnRewards(){try{if(this.scene.spawnExperienceOrb){const e=Phaser.Math.Between(2,4);for(let t=0;t<e;t++){const e=Phaser.Math.Between(-20,20),t=Phaser.Math.Between(-20,20);this.scene.spawnExperienceOrb(this.x+e,this.y+t,3)}}}catch(e){console.error("Error spawning rewards:",e)}}cleanupAndDestroy(){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null)}catch(e){console.error("Error removing update listener:",e)}this.destroy()}destroy(e){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null),this.scene&&this.scene.zombieGroup&&this.scene.zombieGroup.children&&this.scene.zombieGroup.remove(this)}catch(t){console.error("Error in destroy method:",t)}super.destroy(e)}}class _R extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t??64,s??64,i||"saber_run_53x53_v01",a??0),e.physics.add.existing(this,!1),this.body.setSize(36,36,!1),this.body.setOffset(8,8),this.maxHealth=60,this.health=this.maxHealth,this.damage=20,this.speed=55,this.attackRange=35,this.attackCooldown=600,this.lastAttackTime=0,this.isDead=!1,this.isMoving=!1,this.isAttacking=!1,this.lastDirection="down",this.dashCooldown=3e3,this.lastDashTime=0,this.dashSpeed=120,this.dashDuration=300,this.isDashing=!1,this.dashStartTime=0,this.createAnimations(),this.addToZombieGroup(e),this.updateListener=this.update.bind(this),e.events.on("update",this.updateListener)}addToZombieGroup(e){e.zombieGroup||(e.zombieGroup=e.physics.add.group(),e.physics.add.collider(e.zombieGroup,e.zombieGroup,this.handleZombieCollision,null,e)),e.zombieGroup.add(this)}handleZombieCollision(e,t,s){if(Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y)<32){const i=Phaser.Math.Angle.Between(e.x,e.y,t.x,t.y),a=25,n=Math.cos(i)*a,r=Math.sin(i)*a;t.body.velocity.x+=n,t.body.velocity.y+=r,e.body.velocity.x-=n,e.body.velocity.y-=r,s&&!s.isDashing&&(s.body.velocity.x-=.2*n,s.body.velocity.y-=.2*r)}}createAnimations(){this.scene.anims.exists("Saber Run")||this.scene.anims.create({key:"Saber Run",frames:this.scene.anims.generateFrameNumbers("saber_run_53x53_v01",{start:0,end:7}),frameRate:12,repeat:-1}),this.scene.textures.exists("saber_attack")&&!this.scene.anims.exists("Saber Attack")&&this.scene.anims.create({key:"Saber Attack",frames:this.scene.anims.generateFrameNumbers("saber_attack",{start:0,end:5}),frameRate:15,repeat:0}),this.scene.textures.exists("saber_dash")&&!this.scene.anims.exists("Saber Dash")&&this.scene.anims.create({key:"Saber Dash",frames:this.scene.anims.generateFrameNumbers("saber_dash",{start:0,end:3}),frameRate:20,repeat:-1}),this.scene.anims.exists("Saber Idle")||this.scene.anims.create({key:"Saber Idle",frames:[{key:"saber_run_53x53_v01",frame:0}],frameRate:1,repeat:0})}createHealthBar(){this.healthBarBg=this.scene.add.rectangle(this.x,this.y-25,38,5,16711680),this.healthBarBg.setOrigin(.5,.5),this.healthBarBg.setDepth(1),this.healthBarFg=this.scene.add.rectangle(this.x-19,this.y-25,38,5,65280),this.healthBarFg.setOrigin(0,.5),this.healthBarFg.setDepth(20),this.on("destroy",(()=>{this.healthBarBg&&this.healthBarBg.destroy(),this.healthBarFg&&this.healthBarFg.destroy()})),this.updateHealthBar()}updateHealthBar(){if(!this.healthBarFg||!this.healthBarBg)return;this.healthBarBg.setPosition(this.x,this.y-18),this.healthBarFg.setPosition(this.x-19,this.y-18);const e=this.health/this.maxHealth;this.healthBarFg.width=38*e,this.isDashing?(this.healthBarBg.setFillStyle(43775),this.healthBarFg.setFillStyle(65535)):(this.healthBarBg.setFillStyle(16711680),this.healthBarFg.setFillStyle(65280))}update(e,t){if(!this.isDead&&this.active)try{this.updateHealthBar();const t=this.scene.player;if(!t)return;const s=Phaser.Math.Distance.Between(this.x,this.y,t.x,t.y);if(!this.isDashing&&e-this.lastDashTime>this.dashCooldown&&s>80&&s<200&&this.startDash(t,e),this.isDashing)return void this.handleDash(e);if(s>this.attackRange){const e=Phaser.Math.Angle.Between(this.x,this.y,t.x,t.y),s=Math.cos(e)*this.speed*.14,i=Math.sin(e)*this.speed*.14;this.body.velocity.x+=s,this.body.velocity.y+=i,this.body.velocity.x*=.92,this.body.velocity.y*=.92,this.applyZombieAvoidance();const a=this.speed,n=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);if(n>a){const e=a/n;this.body.velocity.x*=e,this.body.velocity.y*=e}this.isMoving=!0,this.isAttacking=!1,this.updateDirection(e)}else{this.body.velocity.x*=.85,this.body.velocity.y*=.85;const s=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);this.isMoving=s>4,e-this.lastAttackTime>this.attackCooldown&&(this.attackPlayer(t),this.lastAttackTime=e)}this.updateAnimation()}catch(s){console.error("Error in Saber update:",s)}}startDash(e,t){this.isDashing=!0,this.dashStartTime=t,this.lastDashTime=t;const s=Phaser.Math.Angle.Between(this.x,this.y,e.x,e.y);this.body.velocity.x=Math.cos(s)*this.dashSpeed,this.body.velocity.y=Math.sin(s)*this.dashSpeed,this.setTint(65535),this.scene.sound&&this.scene.sound.get("saber_dash")&&this.scene.sound.play("saber_dash"),this.updateDirection(s)}handleDash(e){e-this.dashStartTime>=this.dashDuration&&(this.isDashing=!1,this.clearTint(),this.body.velocity.x*=.3,this.body.velocity.y*=.3),this.isMoving=!0,this.updateAnimation()}applyZombieAvoidance(){if(!this.scene.zombieGroup||this.isDashing)return;let e=0,t=0,s=0;this.scene.zombieGroup.children.entries.forEach((i=>{if(i===this||i.isDead)return;const a=Phaser.Math.Distance.Between(this.x,this.y,i.x,i.y);if(a<28&&a>0){const n=Phaser.Math.Angle.Between(i.x,i.y,this.x,this.y),r=12*(1-a/28);e+=Math.cos(n)*r,t+=Math.sin(n)*r,s++}})),s>0&&(this.body.velocity.x+=.05*e,this.body.velocity.y+=.05*t)}updateDirection(e){const t=Phaser.Math.RadToDeg(e);this.lastDirection=t>=-45&&t<45?"right":t>=45&&t<135?"down":t>=135||t<-135?"left":"up"}updateAnimation(){this.isDashing?this.scene.anims.exists("Saber Dash")?this.anims.isPlaying&&"Saber Dash"===this.anims.currentAnim.key||this.play("Saber Dash"):this.anims.isPlaying&&"Saber Run"===this.anims.currentAnim.key||this.play("Saber Run"):this.isAttacking?this.scene.anims.exists("Saber Attack")&&(this.anims.isPlaying&&"Saber Attack"===this.anims.currentAnim.key||this.play("Saber Attack")):this.isMoving?this.anims.isPlaying&&"Saber Run"===this.anims.currentAnim.key||this.play("Saber Run"):this.anims.isPlaying&&"Saber Idle"===this.anims.currentAnim.key||this.play("Saber Idle"),"right"===this.lastDirection?this.setFlipX(!1):"left"===this.lastDirection&&this.setFlipX(!0)}attackPlayer(e){e&&e.takeDamage&&(this.isAttacking=!0,this.scene.anims.exists("Saber Attack")?(this.play("Saber Attack"),this.scene.time.delayedCall(200,(()=>{e&&e.takeDamage&&!this.isDead&&e.takeDamage(this.damage),this.isAttacking=!1}))):(e.takeDamage(this.damage),this.scene.time.delayedCall(300,(()=>{this.isAttacking=!1}))),this.setTint(16776960),this.scene.time.delayedCall(100,(()=>{this.active&&!this.isDashing&&this.clearTint()})),this.lastAttackTime=this.scene.time.now)}takeDamage(e){this.isDead||(this.health-=e,this.updateHealthBar(),this.setTint(16711680),this.scene.time.delayedCall(100,(()=>{!this.active||this.isDashing||this.isAttacking||this.clearTint()})),this.health<=0&&this.die())}die(){this.isDead||(this.isDead=!0,this.body.velocity.x=0,this.body.velocity.y=0,this.body.enable=!1,this.stop(),this.scene.zombieGroup&&this.scene.zombieGroup.remove(this),this.scene.tweens.add({targets:this,alpha:0,scale:.6,rotation:this.rotation+Math.PI,duration:450,ease:"Power2",onComplete:()=>this.cleanupAndDestroy()}),this.spawnRewards())}spawnRewards(){try{if(this.scene.spawnExperienceOrb){const e=Phaser.Math.Between(2,5);for(let t=0;t<e;t++){const e=Phaser.Math.Between(-12,12),t=Phaser.Math.Between(-12,12);this.scene.spawnExperienceOrb(this.x+e,this.y+t,2)}}}catch(e){console.error("Error spawning rewards:",e)}}cleanupAndDestroy(){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null)}catch(e){console.error("Error removing update listener:",e)}this.destroy()}destroy(e){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null),this.scene&&this.scene.zombieGroup&&this.scene.zombieGroup.children&&this.scene.zombieGroup.remove(this)}catch(t){console.error("Error in destroy method:",t)}super.destroy(e)}}class FR extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t??64,s??64,i||"guradian_walk224x45",a??0),e.physics.add.existing(this,!1),this.body.setSize(60,40,!1),this.body.setOffset(82,25),this.maxHealth=200,this.health=this.maxHealth,this.damage=35,this.speed=25,this.attackRange=60,this.attackCooldown=2e3,this.lastAttackTime=0,this.isDead=!1,this.isMoving=!1,this.isAttacking=!1,this.lastDirection="down",this.chargeAbilityCooldown=8e3,this.lastChargeTime=0,this.isCharging=!1,this.chargeSpeed=100,this.chargeDuration=1e3,this.chargeStartTime=0,this.chargeDistance=150,this.shieldAbilityCooldown=12e3,this.lastShieldTime=0,this.isShielded=!1,this.shieldDuration=4e3,this.shieldStartTime=0,this.createAnimations(),this.addToZombieGroup(e),this.updateListener=this.update.bind(this),e.events.on("update",this.updateListener)}addToZombieGroup(e){e.zombieGroup||(e.zombieGroup=e.physics.add.group(),e.physics.add.collider(e.zombieGroup,e.zombieGroup,this.handleZombieCollision,null,e)),e.zombieGroup.add(this)}handleZombieCollision(e,t,s){if(Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y)<50){const i=Phaser.Math.Angle.Between(e.x,e.y,t.x,t.y),a=60,n=Math.cos(i)*a,r=Math.sin(i)*a;s===e?(t.body.velocity.x+=2*n,t.body.velocity.y+=2*r,s.body.velocity.x-=.1*n,s.body.velocity.y-=.1*r):s===t?(e.body.velocity.x-=2*n,e.body.velocity.y-=2*r,s.body.velocity.x+=.1*n,s.body.velocity.y+=.1*r):(t.body.velocity.x+=n,t.body.velocity.y+=r,e.body.velocity.x-=n,e.body.velocity.y-=r)}}createAnimations(){this.scene.anims.exists("Guardian Run")||this.scene.anims.create({key:"Guardian Run",frames:this.scene.anims.generateFrameNumbers("guradian_walk224x45",{start:0,end:7}),frameRate:8,repeat:-1}),this.scene.textures.exists("guardian_attack")&&!this.scene.anims.exists("Guardian Attack")&&this.scene.anims.create({key:"Guardian Attack",frames:this.scene.anims.generateFrameNumbers("guardian_attack",{start:0,end:5}),frameRate:10,repeat:0}),this.scene.textures.exists("guardian_charge")&&!this.scene.anims.exists("Guardian Charge")&&this.scene.anims.create({key:"Guardian Charge",frames:this.scene.anims.generateFrameNumbers("guardian_charge",{start:0,end:3}),frameRate:15,repeat:-1}),this.scene.anims.exists("Guardian Idle")||this.scene.anims.create({key:"Guardian Idle",frames:[{key:"guradian_walk224x45",frame:0}],frameRate:1,repeat:0})}createHealthBar(){this.healthBarBg=this.scene.add.rectangle(this.x,this.y-30,60,8,6684672),this.healthBarBg.setOrigin(.5,.5),this.healthBarBg.setDepth(1),this.healthBarFg=this.scene.add.rectangle(this.x-30,this.y-30,60,8,65280),this.healthBarFg.setOrigin(0,.5),this.healthBarFg.setDepth(20),this.shieldIndicator=this.scene.add.rectangle(this.x,this.y-40,60,4,43775),this.shieldIndicator.setOrigin(.5,.5),this.shieldIndicator.setDepth(21),this.shieldIndicator.setVisible(!1),this.on("destroy",(()=>{this.healthBarBg&&this.healthBarBg.destroy(),this.healthBarFg&&this.healthBarFg.destroy(),this.shieldIndicator&&this.shieldIndicator.destroy()})),this.updateHealthBar()}updateHealthBar(){if(!this.healthBarFg||!this.healthBarBg)return;this.healthBarBg.setPosition(this.x,this.y-20),this.healthBarFg.setPosition(this.x-30,this.y-20),this.shieldIndicator&&(this.shieldIndicator.setPosition(this.x,this.y-30),this.shieldIndicator.setVisible(this.isShielded));const e=this.health/this.maxHealth;this.healthBarFg.width=60*e,e>.6?this.healthBarFg.setFillStyle(65280):e>.3?this.healthBarFg.setFillStyle(16755200):this.healthBarFg.setFillStyle(16711680)}update(e,t){if(!this.isDead&&this.active)try{this.updateHealthBar();const t=this.scene.player;if(!t)return;const s=Phaser.Math.Distance.Between(this.x,this.y,t.x,t.y);if(!this.isShielded&&e-this.lastShieldTime>this.shieldAbilityCooldown&&this.health<.5*this.maxHealth&&this.activateShield(e),this.isShielded&&e-this.shieldStartTime>=this.shieldDuration&&this.deactivateShield(),!this.isCharging&&e-this.lastChargeTime>this.chargeAbilityCooldown&&s>100&&s<300&&this.startCharge(t,e),this.isCharging)return void this.handleCharge(e);if(s>this.attackRange){const e=Phaser.Math.Angle.Between(this.x,this.y,t.x,t.y),s=Math.cos(e)*this.speed*.08,i=Math.sin(e)*this.speed*.08;this.body.velocity.x+=s,this.body.velocity.y+=i,this.body.velocity.x*=.8,this.body.velocity.y*=.8,this.applyZombieAvoidance();const a=this.speed,n=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);if(n>a){const e=a/n;this.body.velocity.x*=e,this.body.velocity.y*=e}this.isMoving=!0,this.isAttacking=!1,this.updateDirection(e)}else{this.body.velocity.x*=.6,this.body.velocity.y*=.6;const s=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);this.isMoving=s>3,e-this.lastAttackTime>this.attackCooldown&&(this.attackPlayer(t),this.lastAttackTime=e)}this.updateAnimation()}catch(s){console.error("Error in Guardian update:",s)}}activateShield(e){this.isShielded=!0,this.shieldStartTime=e,this.lastShieldTime=e,this.setTint(4491519),this.scene.sound&&this.scene.sound.get("guardian_shield")&&this.scene.sound.play("guardian_shield")}deactivateShield(){this.isShielded=!1,this.clearTint()}startCharge(e,t){this.isCharging=!0,this.chargeStartTime=t,this.lastChargeTime=t;const s=Phaser.Math.Angle.Between(this.x,this.y,e.x,e.y);this.body.velocity.x=Math.cos(s)*this.chargeSpeed,this.body.velocity.y=Math.sin(s)*this.chargeSpeed,this.setTint(16729088),this.scene.sound&&this.scene.sound.get("guardian_charge")&&this.scene.sound.play("guardian_charge"),this.updateDirection(s)}handleCharge(e){e-this.chargeStartTime>=this.chargeDuration&&(this.isCharging=!1,this.isShielded||this.clearTint(),this.body.velocity.x*=.2,this.body.velocity.y*=.2);const t=this.scene.player;t&&t.active&&Phaser.Math.Distance.Between(this.x,this.y,t.x,t.y)<40&&(t.takeDamage&&t.takeDamage(1.5*this.damage),this.isCharging=!1,this.isShielded||this.clearTint()),this.isMoving=!0,this.updateAnimation()}applyZombieAvoidance(){if(!this.scene.zombieGroup||this.isCharging)return;let e=0,t=0,s=0;this.scene.zombieGroup.children.entries.forEach((i=>{if(i===this||i.isDead)return;const a=Phaser.Math.Distance.Between(this.x,this.y,i.x,i.y);if(a<40&&a>0){const n=Phaser.Math.Angle.Between(i.x,i.y,this.x,this.y),r=8*(1-a/40);e+=Math.cos(n)*r,t+=Math.sin(n)*r,s++}})),s>0&&(this.body.velocity.x+=.03*e,this.body.velocity.y+=.03*t)}updateDirection(e){const t=Phaser.Math.RadToDeg(e);this.lastDirection=t>=-45&&t<45?"right":t>=45&&t<135?"down":t>=135||t<-135?"left":"up"}updateAnimation(){this.isCharging?this.scene.anims.exists("Guardian Charge")?this.anims.isPlaying&&"Guardian Charge"===this.anims.currentAnim.key||this.play("Guardian Charge"):this.anims.isPlaying&&"Guardian Run"===this.anims.currentAnim.key||this.play("Guardian Run"):this.isAttacking?this.scene.anims.exists("Guardian Attack")&&(this.anims.isPlaying&&"Guardian Attack"===this.anims.currentAnim.key||this.play("Guardian Attack")):this.isMoving?this.anims.isPlaying&&"Guardian Run"===this.anims.currentAnim.key||this.play("Guardian Run"):this.anims.isPlaying&&"Guardian Idle"===this.anims.currentAnim.key||this.play("Guardian Idle"),"right"===this.lastDirection?this.setFlipX(!1):"left"===this.lastDirection&&this.setFlipX(!0)}attackPlayer(e){e&&e.takeDamage&&(this.isAttacking=!0,this.scene.anims.exists("Guardian Attack")?(this.play("Guardian Attack"),this.scene.time.delayedCall(500,(()=>{e&&e.takeDamage&&!this.isDead&&e.takeDamage(this.damage),this.isAttacking=!1}))):(e.takeDamage(this.damage),this.scene.time.delayedCall(600,(()=>{this.isAttacking=!1}))),this.setTint(16737792),this.scene.time.delayedCall(200,(()=>{!this.active||this.isCharging||this.isShielded||this.clearTint()})),this.lastAttackTime=this.scene.time.now)}takeDamage(e){this.isDead||(this.isShielded&&(e=Math.floor(.3*e)),this.health-=e,this.updateHealthBar(),this.isShielded||this.isCharging||(this.setTint(16711680),this.scene.time.delayedCall(150,(()=>{!this.active||this.isShielded||this.isCharging||this.clearTint()}))),this.health<=0&&this.die())}die(){this.isDead||(this.isDead=!0,this.body.velocity.x=0,this.body.velocity.y=0,this.body.enable=!1,this.stop(),this.scene.zombieGroup&&this.scene.zombieGroup.remove(this),this.scene.tweens.add({targets:this,alpha:0,scale:1.2,duration:800,ease:"Power2",onComplete:()=>this.cleanupAndDestroy()}),this.spawnRewards())}spawnRewards(){try{if(this.scene.spawnExperienceOrb){const e=Phaser.Math.Between(8,12);for(let t=0;t<e;t++){const e=Phaser.Math.Between(-30,30),t=Phaser.Math.Between(-30,30);this.scene.spawnExperienceOrb(this.x+e,this.y+t,5)}}}catch(e){console.error("Error spawning rewards:",e)}}cleanupAndDestroy(){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null)}catch(e){console.error("Error removing update listener:",e)}this.destroy()}destroy(e){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null),this.scene&&this.scene.zombieGroup&&this.scene.zombieGroup.children&&this.scene.zombieGroup.remove(this)}catch(t){console.error("Error in destroy method:",t)}super.destroy(e)}}class OR extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t??64,s??64,i||"Charger_run_32x32_v01",a??0),e.physics.add.existing(this,!1),this.body.setSize(32,32,!1),this.body.setOffset(0,0),this.maxHealth=60,this.health=this.maxHealth,this.damage=35,this.speed=50,this.chargeSpeed=120,this.attackRange=80,this.chargeRange=150,this.attackCooldown=2e3,this.lastAttackTime=0,this.isDead=!1,this.isMoving=!1,this.isCharging=!1,this.chargeStartTime=0,this.chargeDuration=800,this.chargeDirection={x:0,y:0},this.lastDirection="down",this.createAnimations(),this.addToChargerGroup(e),this.updateListener=this.update.bind(this),e.events.on("update",this.updateListener)}addToChargerGroup(e){e.chargerGroup||(e.chargerGroup=e.physics.add.group(),e.physics.add.collider(e.chargerGroup,e.chargerGroup,this.handleChargerCollision,null,e)),e.chargerGroup.add(this)}handleChargerCollision(e,t){if(Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y)<35){const s=Phaser.Math.Angle.Between(e.x,e.y,t.x,t.y),i=50,a=Math.cos(s)*i,n=Math.sin(s)*i;t.body.velocity.x+=a,t.body.velocity.y+=n,e.body.velocity.x-=a,e.body.velocity.y-=n}}createAnimations(){this.scene.anims.exists("Charger Run")||this.scene.anims.create({key:"Charger Run",frames:this.scene.anims.generateFrameNumbers("Charger_run_32x32_v01",{start:0,end:7}),frameRate:8,repeat:-1}),this.scene.anims.exists("Charger Charge")||this.scene.anims.create({key:"Charger Charge",frames:this.scene.anims.generateFrameNumbers("Charger_run_32x32_v01",{start:0,end:7}),frameRate:12,repeat:-1}),this.scene.anims.exists("Charger Idle")||this.scene.anims.create({key:"Charger Idle",frames:[{key:"Charger_run_32x32_v01",frame:0}],frameRate:1,repeat:0})}createHealthBar(){this.healthBarBg=this.scene.add.rectangle(this.x,this.y-25,35,5,16711680),this.healthBarBg.setOrigin(.5,.5),this.healthBarBg.setDepth(1),this.healthBarFg=this.scene.add.rectangle(this.x-17.5,this.y-25,35,5,65280),this.healthBarFg.setOrigin(0,.5),this.healthBarFg.setDepth(20),this.on("destroy",(()=>{this.healthBarBg&&this.healthBarBg.destroy(),this.healthBarFg&&this.healthBarFg.destroy()})),this.updateHealthBar()}updateHealthBar(){if(!this.healthBarFg||!this.healthBarBg)return;this.healthBarBg.setPosition(this.x,this.y-20),this.healthBarFg.setPosition(this.x-17.5,this.y-20);const e=this.health/this.maxHealth;this.healthBarFg.width=35*e}update(e,t){if(!this.isDead&&this.active)try{this.updateHealthBar();const t=this.scene.player;if(!t)return;const s=Phaser.Math.Distance.Between(this.x,this.y,t.x,t.y);this.isCharging?this.updateCharge(e):s<=this.attackRange&&s>20&&e-this.lastAttackTime>this.attackCooldown?this.startCharge(t):s>this.attackRange?this.moveTowardPlayer(t):(this.body.velocity.x*=.8,this.body.velocity.y*=.8,this.isMoving=Math.abs(this.body.velocity.x)>5||Math.abs(this.body.velocity.y)>5),this.updateAnimation()}catch(s){console.error("Error in Charger update:",s)}}startCharge(e){this.isCharging=!0,this.chargeStartTime=this.scene.time.now,this.lastAttackTime=this.scene.time.now;const t=Phaser.Math.Angle.Between(this.x,this.y,e.x,e.y);this.chargeDirection.x=Math.cos(t),this.chargeDirection.y=Math.sin(t),this.updateDirection(t),this.setTint(16755200),this.scene.time.delayedCall(100,(()=>{this.active&&this.clearTint()}))}updateCharge(e){if(e-this.chargeStartTime<this.chargeDuration){this.body.velocity.x=this.chargeDirection.x*this.chargeSpeed,this.body.velocity.y=this.chargeDirection.y*this.chargeSpeed,this.isMoving=!0;const e=this.scene.player;e&&Phaser.Math.Distance.Between(this.x,this.y,e.x,e.y)<25&&this.hitPlayer(e)}else this.isCharging=!1,this.body.velocity.x*=.3,this.body.velocity.y*=.3}moveTowardPlayer(e){const t=Phaser.Math.Angle.Between(this.x,this.y,e.x,e.y),s=Math.cos(t)*this.speed*.1,i=Math.sin(t)*this.speed*.1;this.body.velocity.x+=s,this.body.velocity.y+=i,this.body.velocity.x*=.85,this.body.velocity.y*=.85,this.applyChargerAvoidance();const a=this.speed,n=Math.sqrt(this.body.velocity.x*this.body.velocity.x+this.body.velocity.y*this.body.velocity.y);if(n>a){const e=a/n;this.body.velocity.x*=e,this.body.velocity.y*=e}this.isMoving=!0,this.updateDirection(t)}applyChargerAvoidance(){if(!this.scene.chargerGroup)return;let e=0,t=0,s=0;this.scene.chargerGroup.children.entries.forEach((i=>{if(i===this||i.isDead)return;const a=Phaser.Math.Distance.Between(this.x,this.y,i.x,i.y);if(a<40&&a>0){const n=Phaser.Math.Angle.Between(i.x,i.y,this.x,this.y),r=25*(1-a/40);e+=Math.cos(n)*r,t+=Math.sin(n)*r,s++}})),s>0&&(this.body.velocity.x+=.1*e,this.body.velocity.y+=.1*t)}updateDirection(e){const t=Phaser.Math.RadToDeg(e);this.lastDirection=t>=-45&&t<45?"right":t>=45&&t<135?"down":t>=135||t<-135?"left":"up"}updateAnimation(){this.isCharging?this.anims.isPlaying&&"Charger Charge"===this.anims.currentAnim.key||this.play("Charger Charge"):this.isMoving?this.anims.isPlaying&&"Charger Run"===this.anims.currentAnim.key||this.play("Charger Run"):this.anims.isPlaying&&"Charger Idle"===this.anims.currentAnim.key||this.play("Charger Idle"),"right"===this.lastDirection?this.setFlipX(!1):"left"===this.lastDirection&&this.setFlipX(!0)}hitPlayer(e){e&&e.takeDamage&&!this.isDead&&(e.takeDamage(this.damage),this.setTint(16729088),this.scene.time.delayedCall(200,(()=>{this.active&&this.clearTint()})),this.isCharging=!1,this.body.velocity.x*=.2,this.body.velocity.y*=.2)}takeDamage(e){this.isDead||(this.health-=e,this.updateHealthBar(),this.setTint(16711680),this.scene.time.delayedCall(150,(()=>{this.active&&this.clearTint()})),this.isCharging&&(this.isCharging=!1,this.body.velocity.x*=.5,this.body.velocity.y*=.5),this.health<=0&&this.die())}die(){this.isDead||(this.isDead=!0,this.isCharging=!1,this.body.velocity.x=0,this.body.velocity.y=0,this.body.enable=!1,this.stop(),this.scene&&this.scene.chargerGroup&&this.scene.chargerGroup.children&&this.scene.chargerGroup.remove(this),this.scene.tweens.add({targets:this,alpha:0,scale:.8,duration:400,onComplete:()=>this.cleanupAndDestroy()}),this.spawnRewards())}spawnRewards(){try{if(this.scene.spawnExperienceOrb){const e=Phaser.Math.Between(2,5);for(let t=0;t<e;t++){const e=Phaser.Math.Between(-12,12),t=Phaser.Math.Between(-12,12);this.scene.spawnExperienceOrb(this.x+e,this.y+t,1.5)}}}catch(e){console.error("Error spawning rewards:",e)}}cleanupAndDestroy(){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null)}catch(e){console.error("Error removing update listener:",e)}this.destroy()}destroy(e){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null),this.scene&&this.scene.chargerGroup&&this.scene.chargerGroup.children&&this.scene.chargerGroup.remove(this)}catch(t){console.error("Error in destroy method:",t)}super.destroy(e)}}const LR={zombie:{class:AR,texture:"zombierun",baseHealth:30,baseDamage:10,baseSpeed:50,expValue:10,goldValue:5,spawnWeight:50,minWave:1,expDropChance:.8,goldDropChance:.4},zombieBig:{class:SR,texture:"Zombie2RunAni",baseHealth:50,baseDamage:20,baseSpeed:40,expValue:20,goldValue:15,spawnWeight:25,minWave:1,expDropChance:.85,goldDropChance:.5},policeDroid:{class:ER,texture:"Police run",baseHealth:35,baseDamage:15,baseSpeed:55,expValue:15,goldValue:10,spawnWeight:20,minWave:1,expDropChance:.82,goldDropChance:.45},assassin:{class:TR,texture:"Dagger Bandit-Run",baseHealth:25,baseDamage:25,baseSpeed:70,expValue:25,goldValue:20,spawnWeight:15,minWave:2,expDropChance:.9,goldDropChance:.6},assassinTank:{class:PR,texture:"assassinTank",baseHealth:80,baseDamage:30,baseSpeed:30,expValue:40,goldValue:35,spawnWeight:8,minWave:2,expDropChance:.95,goldDropChance:.75},assassinArcher:{class:CR,texture:"assassinArcher",baseHealth:20,baseDamage:18,baseSpeed:45,expValue:30,goldValue:25,spawnWeight:12,minWave:2,expDropChance:.92,goldDropChance:.7},bigDude:{class:MR,texture:"run_2",baseHealth:90,baseDamage:22,baseSpeed:30,expValue:50,goldValue:35,spawnWeight:14,minWave:3,expDropChance:.42,goldDropChance:.6},wreacker:{class:BR,texture:"WreackerRun",baseHealth:30,baseDamage:22,baseSpeed:35,expValue:50,goldValue:35,spawnWeight:14,minWave:3,expDropChance:.42,goldDropChance:.6},choppor:{class:RR,texture:"Warrior-Run",baseHealth:30,baseDamage:22,baseSpeed:35,expValue:50,goldValue:35,spawnWeight:14,minWave:3,expDropChance:.42,goldDropChance:.6},bomber:{class:NR,texture:"Bomber_Activited_run_v01",baseHealth:10,baseDamage:42,baseSpeed:35,expValue:20,goldValue:15,spawnWeight:14,minWave:4,expDropChance:.42,goldDropChance:.6},saber:{class:_R,texture:"saber_run_53x53_v01",baseHealth:10,baseDamage:42,baseSpeed:40,expValue:20,goldValue:25,spawnWeight:4,minWave:4,expDropChance:.42,goldDropChance:.6},guardian:{class:FR,texture:"guradian_walk224x45",baseHealth:90,baseDamage:22,baseSpeed:30,expValue:50,goldValue:35,spawnWeight:14,minWave:4,expDropChance:.42,goldDropChance:.6},crawler:{class:DR,texture:"crawler_run_32x16_v01",baseHealth:10,baseDamage:12,baseSpeed:45,expValue:20,goldValue:15,spawnWeight:14,minWave:5,expDropChance:.42,goldDropChance:.6},charger:{class:OR,texture:"harger_run_32x32_v01",baseHealth:90,baseDamage:32,baseSpeed:45,expValue:24,goldValue:35,spawnWeight:14,minWave:5,expDropChance:.42,goldDropChance:.6}};class IR{constructor(e){this.scene=e,this.gameManager=null,this.player=null,this.mobGroup=null,this.activeMobs=new Map,this.spawnTimer=null,this.waveTimer=null,this.maxMobs=100,this.spawnDelay=2e3,this.currentWave=0,this.waveActive=!1,this.waveMobs=[],this.walkingAreaData=null,this.walkablePositions=[],this.tileSize=32,this.mapWidth=80,this.mapHeight=80,this.isWalkingAreaInitialized=!1,this.stats={totalSpawned:0,totalKilled:0,killsByType:new Map},Object.keys(LR).forEach((e=>{this.stats.killsByType.set(e,0)}))}initialize(e,t){this.gameManager=e,this.player=t,this.setupMobGroup(),this.startSpawning(),this.setupEventListeners()}setupMobGroup(){this.mobGroup=this.scene.physics.add.group(),this.scene.physics.add.collider(this.mobGroup,this.mobGroup,this.handleMobCollision,null,this),this.scene.zombieGroup=this.mobGroup,this.scene.enemies=this.mobGroup}startSpawning(){this.spawnTimer=this.scene.time.addEvent({delay:this.spawnDelay,callback:()=>this.spawnRandomMob(),loop:!0}),this.waveTimer=this.scene.time.addEvent({delay:2e4,callback:()=>this.triggerNextWave(),loop:!1})}triggerNextWave(){const e=this.currentWave+1;this.startWave(e),this.waveTimer&&this.waveTimer.destroy(),this.waveTimer=this.scene.time.addEvent({delay:2e4,callback:()=>this.triggerNextWave(),loop:!1})}setupEventListeners(){var e;(null==(e=this.gameManager)?void 0:e.events)&&this.gameManager.events.on("difficultyUpdated",this.updateDifficulty,this)}spawnMob(e,t,s){const i=LR[e];if(!i)return console.warn(`Unknown mob type: ${e}`),null;try{const a=new i.class(this.scene,t,s);return this.applyStats(a,i),this.setupMobProperties(a,e),this.scene.add.existing(a),this.mobGroup.add(a),this.trackMob(a,e),this.stats.totalSpawned++,a}catch(a){return console.error(`Error spawning ${e}:`,a),null}}applyStats(e,t){var s,i;const a=(null==(i=null==(s=this.gameManager)?void 0:s.gameProgress)?void 0:i.currentDifficulty)||1,n=.1*this.currentWave,r=1+.2*(a-1)+n,o=1+.1*(a-1)+.5*n,l=1+.05*(a-1);e.maxHealth=Math.floor(t.baseHealth*r),e.health=e.maxHealth,e.damage=Math.floor(t.baseDamage*o),e.speed=Math.floor(t.baseSpeed*l),e.expValue=Math.floor(t.expValue*(1+n)),e.goldValue=Math.floor(t.goldValue*(1+n)),e.expDropChance=t.expDropChance,e.goldDropChance=t.goldDropChance}setupMobProperties(e,t){var s;e.mobType=t,e.spawnTime=Date.now(),e.isWaveMob=this.waveActive,this.addSpecialAbilities(e,t);const i=null==(s=e.die)?void 0:s.bind(e);e.die=()=>{this.handleMobDeath(e),i&&i()},e.spawnRewards=()=>{this.spawnMobRewards(e)}}addSpecialAbilities(e,t){switch(t){case"policeDroid":this.addProjectileAttack(e,{range:200,cooldown:2e3,projectileSpeed:150,projectileColor:16711680,projectileSize:3});break;case"zombieBig":this.addDeathExplosion(e,{explosionRange:80,explosionDamage:15,explosionColor:16729156});break;case"assassinArcher":this.addProjectileAttack(e,{range:250,cooldown:2500,projectileSpeed:120,projectileColor:16711680,projectileSize:2})}}addProjectileAttack(e,t){e.projectileConfig=t,e.lastProjectileTime=0,e.hasProjectileAttack=!0}updateMobAbilities(e,t){this.getAllActiveMobs().forEach((t=>{t.hasProjectileAttack&&this.updateProjectileAttack(t,e)}))}updateProjectileAttack(e,t){if(!this.player||e.isDead||!e.projectileConfig)return;const s=Phaser.Math.Distance.Between(e.x,e.y,this.player.x,this.player.y),i=e.projectileConfig;s<=i.range&&t-e.lastProjectileTime>i.cooldown&&(this.fireProjectile(e,i),e.lastProjectileTime=t)}fireProjectile(e,t){if(!this.player)return;const s=this.scene.add.circle(e.x,e.y,t.projectileSize,t.projectileColor);s.setStrokeStyle(1,0),this.scene.physics.add.existing(s),s.body.setCircle(t.projectileSize),s.setDepth(15);const i=Phaser.Math.Angle.Between(e.x,e.y,this.player.x,this.player.y);s.body.setVelocity(Math.cos(i)*t.projectileSpeed,Math.sin(i)*t.projectileSpeed);const a=this.scene.physics.add.overlap(this.player,s,(()=>{this.player.takeDamage&&this.player.takeDamage(e.damage),this.createHitEffect(s.x,s.y),a.destroy(),s.destroy()}));this.scene.time.delayedCall(3e3,(()=>{s&&s.active&&(a.destroy(),s.destroy())})),this.createMuzzleFlash(e)}createMuzzleFlash(e){const t=this.scene.add.circle(e.x,e.y,12,16776960,.8);t.setDepth(20),this.scene.tweens.add({targets:t,scale:{from:1,to:2},alpha:{from:.8,to:0},duration:200,onComplete:()=>t.destroy()})}createHitEffect(e,t){const s=this.scene.add.circle(e,t,8,16711680,.7);s.setDepth(25),this.scene.tweens.add({targets:s,scale:{from:.5,to:1.5},alpha:{from:.7,to:0},duration:300,onComplete:()=>s.destroy()})}addDeathExplosion(e,t){var s;e.explosionConfig=t;const i=null==(s=e.die)?void 0:s.bind(e);e.die=()=>{this.createDeathExplosion(e,t),i&&i()}}createDeathExplosion(e,t){if(!this.player)return;const s=this.scene.add.circle(e.x,e.y,t.explosionRange,t.explosionColor,.6);if(s.setDepth(30),this.scene.tweens.add({targets:s,scale:{from:0,to:1.5},alpha:{from:.6,to:0},duration:500,onComplete:()=>s.destroy()}),Phaser.Math.Distance.Between(e.x,e.y,this.player.x,this.player.y)<=t.explosionRange&&(this.player.takeDamage&&this.player.takeDamage(t.explosionDamage),this.player.body)){const t=Phaser.Math.Angle.Between(e.x,e.y,this.player.x,this.player.y),s=150;this.player.body.velocity.x+=Math.cos(t)*s,this.player.body.velocity.y+=Math.sin(t)*s}this.getAllActiveMobs().forEach((s=>{s===e||s.isDead||Phaser.Math.Distance.Between(e.x,e.y,s.x,s.y)<=t.explosionRange&&s.takeDamage&&s.takeDamage(Math.floor(.5*t.explosionDamage))})),this.scene.cameras.main.shake(200,.005)}spawnMobRewards(e){try{this.trySpawnExperienceOrb(e),this.trySpawnGoldOrb(e)}catch(t){console.error("Error spawning mob rewards:",t)}}trySpawnExperienceOrb(e){const t=LR[e.mobType];if(!t)return;let s=t.expDropChance||.8;if(e.isSpecialWave&&(s*=1.2),"boss"===e.specialWaveType&&(s=1),"elite"===e.specialWaveType&&(s=Math.min(1,1.1*s)),Math.random()<s){let t=1;e.expValue&&(t=e.expValue>=40?5:e.expValue>=25?3:e.expValue>=15?2:1),Math.random()<.05&&(t*=3),"boss"===e.specialWaveType&&(t*=5),this.scene.spawnExperienceOrb&&this.scene.spawnExperienceOrb(e.x,e.y,t)}}trySpawnGoldOrb(e){const t=LR[e.mobType];if(!t)return;let s=t.goldDropChance||.4;if(e.isSpecialWave&&(s*=1.3),"boss"===e.specialWaveType&&(s=1),"elite"===e.specialWaveType&&(s=Math.min(1,1.2*s)),Math.random()<s){let s=e.goldValue||t.goldValue;Math.random()<.08&&(s*=2),"boss"===e.specialWaveType&&(s*=3),this.scene.spawnGoldOrb&&this.scene.spawnGoldOrb(e.x,e.y,s)}}trackMob(e,t){const s=`mob_${Date.now()}_${Math.random()}`;e.trackingId=s,this.activeMobs.set(s,{mob:e,type:t,spawnTime:Date.now(),isAlive:!0})}spawnRandomMob(){if(!this.player||this.getActiveMobCount()>=this.maxMobs)return;const e=this.selectMobType(),t=this.getSpawnPosition();return this.spawnMob(e,t.x,t.y)}selectMobType(){var e,t;const s=Math.max((null==(t=null==(e=this.gameManager)?void 0:e.gameProgress)?void 0:t.currentDifficulty)||1,this.currentWave),i=Object.keys(LR).filter((e=>LR[e].minWave<=s)),a=[];return i.forEach((e=>{const t=LR[e].spawnWeight;for(let s=0;s<t;s++)a.push(e)})),Phaser.Utils.Array.GetRandom(a)}getSpawnPosition(){if(!this.player)return{x:0,y:0};if(this.isWalkingAreaInitialized)return this.getWalkableSpawnPosition();const e=Math.random()*Math.PI*2,t=Phaser.Math.Between(300,500);return{x:this.player.x+Math.cos(e)*t,y:this.player.y+Math.sin(e)*t}}setWalkingAreaFromTilemap(e){e&&e.layer?(this.walkingAreaLayer=e,this.mapWidth=e.layer.width,this.mapHeight=e.layer.height,this.tileSize=e.layer.tileWidth||32,this.isWalkingAreaInitialized=!0):console.warn("Invalid tilemap layer provided")}initializeWalkingArea(e,t=80,s=80,i=32){if(e&&Array.isArray(e)){this.mapWidth=t,this.mapHeight=s,this.tileSize=i,this.walkingAreaData=[];for(let i=0;i<s;i++){this.walkingAreaData[i]=[];for(let s=0;s<t;s++){const a=i*t+s;this.walkingAreaData[i][s]=e[a]||0}}this.cacheWalkablePositions(),this.isWalkingAreaInitialized=!0}}cacheWalkablePositions(){if(this.walkablePositions=[],this.walkingAreaData)for(let e=0;e<this.mapHeight;e++)for(let t=0;t<this.mapWidth;t++)if(this.walkingAreaData[e]&&0!==this.walkingAreaData[e][t]){const s=t*this.tileSize+this.tileSize/2,i=e*this.tileSize+this.tileSize/2;this.walkablePositions.push({tileX:t,tileY:e,worldX:s,worldY:i,tileValue:this.walkingAreaData[e][t]})}}isPositionWalkable(e,t){if(!this.isWalkingAreaInitialized)return!0;const s=Math.floor(e/this.tileSize),i=Math.floor(t/this.tileSize);return this.isTileWalkable(s,i)}isTileWalkable(e,t){return!this.walkingAreaData||!(e<0||e>=this.mapWidth||t<0||t>=this.mapHeight)&&this.walkingAreaData[t]&&0!==this.walkingAreaData[t][e]}getRandomWalkablePosition(){if(0===this.walkablePositions.length)return null;const e=Math.floor(Math.random()*this.walkablePositions.length);return{...this.walkablePositions[e]}}getRandomWalkablePositionNear(e,t,s=100,i=300,a=20){if(!this.isWalkingAreaInitialized){const a=Math.random()*Math.PI*2,n=Phaser.Math.Between(s,i);return{worldX:e+Math.cos(a)*n,worldY:t+Math.sin(a)*n}}for(let r=0;r<a;r++){const a=Math.random()*Math.PI*2,n=Phaser.Math.Between(s,i),r=e+Math.cos(a)*n,o=t+Math.sin(a)*n;if(this.isPositionWalkable(r,o))return{worldX:r,worldY:o}}const n=this.getRandomWalkablePosition();return n?{worldX:n.worldX,worldY:n.worldY}:null}getNearestWalkablePosition(e,t,s=10){if(!this.isWalkingAreaInitialized)return{worldX:e,worldY:t};const i=Math.floor(e/this.tileSize),a=Math.floor(t/this.tileSize);if(this.isTileWalkable(i,a))return{worldX:i*this.tileSize+this.tileSize/2,worldY:a*this.tileSize+this.tileSize/2};for(let r=1;r<=s;r++)for(let e=-r;e<=r;e++)for(let t=-r;t<=r;t++){if(Math.abs(e)!==r&&Math.abs(t)!==r)continue;const s=i+e,n=a+t;if(this.isTileWalkable(s,n))return{worldX:s*this.tileSize+this.tileSize/2,worldY:n*this.tileSize+this.tileSize/2}}const n=this.getRandomWalkablePosition();return n?{worldX:n.worldX,worldY:n.worldY}:{worldX:e,worldY:t}}getWalkableSpawnPosition(){if(!this.player){const e=this.getRandomWalkablePosition();return e?{x:e.worldX,y:e.worldY}:{x:0,y:0}}const e=this.getRandomWalkablePositionNear(this.player.x,this.player.y,300,500);return e?{x:e.worldX,y:e.worldY}:{x:this.player.x+400,y:this.player.y}}teleportToWalkablePosition(e,t=10){if(!e||!this.isWalkingAreaInitialized)return!1;const s=this.getNearestWalkablePosition(e.x,e.y,t);return!!s&&(e.x=s.worldX,e.y=s.worldY,e.body&&(e.body.x=s.worldX-e.body.width/2,e.body.y=s.worldY-e.body.height/2),!0)}teleportMobToWalkable(e){const t=Math.floor(e.x/this.tileSize),s=Math.floor(e.y/this.tileSize);for(let i=1;i<=10;i++)for(let a=-i;a<=i;a++)for(let n=-i;n<=i;n++){if(Math.abs(a)!==i&&Math.abs(n)!==i)continue;const r=t+a,o=s+n,l=this.walkingAreaLayer.getTileAt(r,o);if(l&&0!==l.index){const t=r*this.tileSize+this.tileSize/2,s=o*this.tileSize+this.tileSize/2;if(this.player&&Phaser.Math.Distance.Between(t,s,this.player.x,this.player.y)<200)continue;return e.x=t,e.y=s,void(e.body&&(e.body.x=e.x-e.body.width/2,e.body.y=e.y-e.body.height/2))}}}startWave(e){this.currentWave=e,this.waveActive=!0,this.waveMobs=[],kM.emit("wave-notification",{wave:e});const t=this.calculateWaveSize(e),s=this.getSpecialWaveType(e);s?this.startSpecialWave(e,s):this.startNormalWave(e,t)}startNormalWave(e,t){for(let s=0;s<t;s++)this.scene.time.delayedCall(100*s,(()=>{const e=this.selectMobType(),t=this.getSpawnPosition(),s=this.spawnMob(e,t.x,t.y);s&&this.waveMobs.push(s)}))}startSpecialWave(e,t){let s,i;switch(t){case"swarm":s=Math.min(15+3*e,30),i=["zombie"];break;case"elite":s=Math.floor(.4*this.calculateWaveSize(e)),i=["assassinTank","assassinArcher"];break;case"mixed":s=Math.floor(1.3*this.calculateWaveSize(e)),i=["zombie","zombieBig","policeDroid","assassin","bigDude","wreacker","choppor","crawler","bomber","saber","guardian","charger"];break;case"boss":s=Math.max(1,Math.floor(e/10)),i=["assassinTank"];break;default:return void this.startNormalWave(e,this.calculateWaveSize(e))}for(let a=0;a<s;a++)this.scene.time.delayedCall(100*a,(()=>{const e=Phaser.Utils.Array.GetRandom(i),s=this.getSpawnPosition(),a=this.spawnMob(e,s.x,s.y);a&&("elite"!==t&&"boss"!==t||(a.maxHealth*=2,a.health=a.maxHealth,a.damage*=1.5,a.expValue*=2,a.goldValue*=2,a.expDropChance=Math.min(1,1.2*a.expDropChance),a.goldDropChance=Math.min(1,1.3*a.goldDropChance)),"boss"===t&&(a.maxHealth*=3,a.health=a.maxHealth,a.damage*=2,a.expValue*=5,a.goldValue*=5,a.expDropChance=1,a.goldDropChance=1,a.setTint(16711680)),a.isSpecialWave=!0,a.specialWaveType=t,this.waveMobs.push(a),this.createSpawnPortalEffect(s.x,s.y))}))}getSpecialWaveType(e){return e%10==0?"boss":e%7==0?"elite":e%5==0?"swarm":e%8==0?"mixed":null}createSpawnPortalEffect(e,t){const s=this.scene.add.circle(e,t,20,8913151,.8);this.scene.tweens.add({targets:s,scale:{from:0,to:2},alpha:{from:.8,to:0},duration:500,onComplete:()=>s.destroy()})}calculateWaveSize(e){var t,s;const i=Math.floor(1.2*e),a=Math.floor(1.5*((null==(s=null==(t=this.gameManager)?void 0:t.gameProgress)?void 0:s.currentDifficulty)||1));return Math.min(25,8+i+a)}cleanupMobHealthBar(e){try{const t=e.x,s=e.y,i=[];this.scene.children.list.forEach((e=>{e&&e.x&&e.y&&Phaser.Math.Distance.Between(e.x,e.y,t,s-20)<40&&("Rectangle"===e.type&&e.displayWidth<=50&&e.displayHeight<=8||"Container"===e.type&&e.getBounds&&e.getBounds().width<=50&&e.getBounds().height<=15||"Graphics"===e.type&&e.displayWidth<=50&&e.displayHeight<=10)&&i.push(e)})),i.forEach((e=>{e&&e.active&&e.destroy&&e.destroy()})),["healthBar","healthBarBg","healthBarContainer","healthBarFill","healthBarBackground"].forEach((t=>{e[t]&&e[t].destroy&&(e[t].destroy(),e[t]=null)}))}catch(t){console.error("Error cleaning up mob health bar:",t)}}checkWaveCompletion(){this.waveActive&&0===this.waveMobs.filter((e=>e&&e.active&&!e.isDead)).length&&this.completeWave()}completeWave(){this.waveActive=!1;const e=this.currentWave,t=this.waveMobs.length>0?this.waveMobs[0].specialWaveType:null;this.waveMobs=[];let s=100*e,i=50*e;if(t)switch(t){case"swarm":s*=1.5,i*=1.5;break;case"elite":s*=2,i*=2;break;case"mixed":s*=1.8,i*=1.8;break;case"boss":s*=3,i*=3}this.gameManager&&(this.gameManager.addExperience(s),this.gameManager.addGold(i))}showWaveCompletionMessage(e,t,s,i){const a=this.scene.cameras.main.centerX,n=this.scene.cameras.main.centerY;let r=`WAVE ${e} COMPLETE!`;t&&(r+=`\n${t.toUpperCase()} DEFEATED!`);const o=this.scene.add.text(a,n-30,r,{fontFamily:"Arial",fontSize:"28px",color:"#00ff00",stroke:"#000000",strokeThickness:3,align:"center",fontStyle:"bold"});o.setOrigin(.5),o.setScrollFactor(0),o.setDepth(1e3);const l=this.scene.add.text(a,n+20,`BONUS: +${s} XP, +${i} Gold`,{fontFamily:"Arial",fontSize:"20px",color:"#ffff00",stroke:"#000000",strokeThickness:2,align:"center"});l.setOrigin(.5),l.setScrollFactor(0),l.setDepth(1e3),this.scene.tweens.add({targets:[o,l],scale:{from:0,to:1},duration:600,ease:"Back.easeOut",onComplete:()=>{this.scene.time.delayedCall(3e3,(()=>{this.scene.tweens.add({targets:[o,l],alpha:0,duration:1e3,onComplete:()=>{o.destroy(),l.destroy()}})}))}});const c=this.scene.add.rectangle(0,0,2*this.scene.cameras.main.width,2*this.scene.cameras.main.height,65280,.2);c.setScrollFactor(0),c.setDepth(999),this.scene.tweens.add({targets:c,alpha:0,duration:400,onComplete:()=>c.destroy()})}handleMobDeath(e){if(!e.trackingId)return;if(!this.activeMobs.get(e.trackingId))return;this.cleanupMobHealthBar(e),this.stats.totalKilled++;const t=this.stats.killsByType.get(e.mobType)||0;this.stats.killsByType.set(e.mobType,t+1),this.gameManager&&this.gameManager.addEnemyKill(),this.spawnMobRewards(e),e.isWaveMob&&this.checkWaveCompletion(),this.activeMobs.delete(e.trackingId)}handleMobCollision(e,t){if(Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y)<25){const s=Phaser.Math.Angle.Between(e.x,e.y,t.x,t.y),i=20,a=Math.cos(s)*i,n=Math.sin(s)*i;t.body&&(t.body.velocity.x+=a,t.body.velocity.y+=n),e.body&&(e.body.velocity.x-=a,e.body.velocity.y-=n)}}updateDifficulty(e){this.maxMobs=Math.min(60,30+3*e),this.spawnDelay=Math.max(1e3,3e3-200*e),this.spawnTimer&&(this.spawnTimer.delay=this.spawnDelay)}getActiveMobCount(){return Array.from(this.activeMobs.values()).filter((e=>e.isAlive)).length}getAllActiveMobs(){return Array.from(this.activeMobs.values()).filter((e=>e.isAlive)).map((e=>e.mob))}getMobsByType(e){return Array.from(this.activeMobs.values()).filter((t=>t.type===e&&t.isAlive)).map((e=>e.mob))}killAllMobs(){this.getAllActiveMobs().forEach((e=>{e.takeDamage&&e.takeDamage(9999)}))}getWaveProgress(){return this.waveActive?{completed:!1,remaining:this.waveMobs.filter((e=>e.active&&!e.isDead)).length,total:this.waveMobs.length,waveNumber:this.currentWave,nextWaveTime:0}:{completed:!0,remaining:0,total:0,waveNumber:this.currentWave,nextWaveTime:this.waveTimer?Math.ceil(this.waveTimer.getRemaining()/1e3):0}}getCurrentWave(){return this.currentWave}isWaveActive(){return this.waveActive}getTimeToNextWave(){return this.waveTimer?Math.ceil(this.waveTimer.getRemaining()/1e3):0}getStatistics(){return{totalSpawned:this.stats.totalSpawned,totalKilled:this.stats.totalKilled,activeCount:this.getActiveMobCount(),killsByType:Object.fromEntries(this.stats.killsByType),currentWave:this.currentWave,waveActive:this.waveActive,waveProgress:this.getWaveProgress()}}update(e,t){const s=[];this.activeMobs.forEach(((e,t)=>{if(!e.mob.active||e.mob.isDead)s.push(t);else if(this.isWalkingAreaInitialized&&this.walkingAreaLayer){const t=Math.floor(e.mob.x/this.tileSize),s=Math.floor(e.mob.y/this.tileSize),i=this.walkingAreaLayer.getTileAt(t,s);i&&0!==i.index||this.teleportMobToWalkable(e.mob)}})),s.forEach((e=>this.activeMobs.delete(e))),this.updateMobAbilities(e,t)}shutdown(){this.spawnTimer&&this.spawnTimer.destroy(),this.waveTimer&&this.waveTimer.destroy(),this.getAllActiveMobs().forEach((e=>{this.cleanupMobHealthBar(e),e.destroy&&e.destroy()})),this.activeMobs.clear(),this.waveMobs=[],this.mobGroup&&this.mobGroup.clear(!0,!0)}}class jR extends Phaser.GameObjects.Image{constructor(e,t,s,i,a){const n=i||"Exp",r=e.textures.exists(n);super(e,t??8,s??8,r?n:"__WHITE",a),r||this.setTint(65535),e.physics.add.existing(this,!1),this.body.setCircle(8),this.body.setCollideWorldBounds(!1),this.body.setBounce(0,0),this.body.setDrag(10,10),this.expValue=1,this.magneticRange=100,this.magneticForce=150,this.maxForce=300,this.initialY=s,this.floatOffset=5,this.floatSpeed=1.5,this.floatTime=Math.random()*Math.PI*2,this.isBeingCollected=!1,this.isAttracted=!1,this.updateListener=this.update.bind(this),e.events.on("update",this.updateListener)}setExpValue(e){this.expValue=e;const t=.8+Math.min(e,10)/10*.5;return this.setScale(t),e>=10?this.setTint(33023):e>=5?this.setTint(65450):e>=2?this.setTint(43775):this.setTint(65535),this}update(e,t){if(!this.isBeingCollected&&this.active)try{const e=this.scene.player;if(!e)return;this.isAttracted||(this.floatTime+=t/1e3,this.y=this.initialY+Math.sin(this.floatTime*this.floatSpeed)*this.floatOffset);const s=Phaser.Math.Distance.Between(this.x,this.y,e.x,e.y);if(s<=this.magneticRange){this.isAttracted=!0;const t=e.x-this.x,i=e.y-this.y,a=Math.sqrt(t*t+i*i),n=t/a,r=i/a,o=1-s/this.magneticRange,l=this.magneticForce+(this.maxForce-this.magneticForce)*o;this.body.velocity.x=n*l,this.body.velocity.y=r*l,this.initialY=this.y,s<15&&this.collect()}else this.isAttracted=!1,0===this.body.velocity.x&&0===this.body.velocity.y||(this.body.velocity.x*=.95,this.body.velocity.y*=.95,Math.abs(this.body.velocity.x)<1&&(this.body.velocity.x=0),Math.abs(this.body.velocity.y)<1&&(this.body.velocity.y=0))}catch(s){console.error("Error in ExpOrb update:",s),this.destroy()}}collect(){if(this.isBeingCollected)return this.expValue;this.isBeingCollected=!0;try{this.scene.playerLevelSystem?this.scene.playerLevelSystem.addExperience(this.expValue):this.scene.gameManager?this.scene.gameManager.addExperience(this.expValue):console.warn("No experience system found to add experience to"),this.scene.tweens.add({targets:this,scale:{from:this.scale,to:0},alpha:{from:1,to:0},duration:200,onComplete:()=>{this.cleanupAndDestroy()}})}catch(e){console.error("Error collecting experience orb:",e),this.cleanupAndDestroy()}return this.expValue}createFloatingText(e){try{const t=this.scene.add.text(this.x,this.y-20,e,{fontFamily:"Arial, sans-serif",fontSize:"14px",color:"#FFD700",stroke:"#000000",strokeThickness:1});t.setOrigin(.5),this.scene.tweens.add({targets:t,y:t.y-40,alpha:0,duration:1e3,onComplete:()=>{t.destroy()}})}catch(t){console.error("Error creating floating text:",t)}}cleanupAndDestroy(){try{this.scene&&this.updateListener&&this.scene.events.off("update",this.updateListener)}catch(e){console.error("Error removing update listener:",e)}this.destroy()}destroy(e){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null)}catch(t){console.error("Error in destroy method:",t)}super.destroy(e)}}class HR extends Phaser.GameObjects.Image{constructor(e,t,s,i,a){super(e,t??16,s??16,i||"Exp",a),e.physics.add.existing(this,!1),this.body.setCircle(10),this.body.setCollideWorldBounds(!1),this.body.setBounce(0,0),this.body.setDrag(10,10),this.goldValue=1,this.magneticRange=100,this.magneticForce=150,this.maxForce=300,this.initialY=s,this.floatOffset=5,this.floatSpeed=1.5,this.floatTime=Math.random()*Math.PI*2,this.isBeingCollected=!1,this.isAttracted=!1,this.updateListener=this.update.bind(this),e.events.on("update",this.updateListener)}setGoldValue(e){this.goldValue=e;const t=.8+Math.min(e,10)/10*.5;return this.setScale(t),e>=10?this.setTint(16747520):e>=5?this.setTint(16766720):e>=2?this.setTint(16776960):this.setTint(16775885),this}update(e,t){if(!this.isBeingCollected&&this.active)try{const e=this.scene.player;if(!e)return;this.isAttracted||(this.floatTime+=t/1e3,this.y=this.initialY+Math.sin(this.floatTime*this.floatSpeed)*this.floatOffset);const s=Phaser.Math.Distance.Between(this.x,this.y,e.x,e.y);if(s<=this.magneticRange){this.isAttracted=!0;const t=e.x-this.x,i=e.y-this.y,a=Math.sqrt(t*t+i*i),n=t/a,r=i/a,o=1-s/this.magneticRange,l=this.magneticForce+(this.maxForce-this.magneticForce)*o;this.body.velocity.x=n*l,this.body.velocity.y=r*l,this.initialY=this.y,s<15&&this.collect()}else this.isAttracted=!1,0===this.body.velocity.x&&0===this.body.velocity.y||(this.body.velocity.x*=.95,this.body.velocity.y*=.95,Math.abs(this.body.velocity.x)<1&&(this.body.velocity.x=0),Math.abs(this.body.velocity.y)<1&&(this.body.velocity.y=0))}catch(s){console.error("Error in GoldPrefab update:",s),this.destroy()}}collect(){if(this.isBeingCollected)return this.goldValue;this.isBeingCollected=!0;try{this.scene.gameManager?this.scene.gameManager.addGold(this.goldValue):console.warn("No game manager found to add gold to"),this.scene.tweens.add({targets:this,scale:{from:this.scale,to:0},alpha:{from:1,to:0},duration:200,onComplete:()=>{this.cleanupAndDestroy()}})}catch(e){console.error("Error collecting gold:",e),this.cleanupAndDestroy()}return this.goldValue}createFloatingText(e){try{const t=this.scene.add.text(this.x,this.y-20,e,{fontFamily:"Arial, sans-serif",fontSize:"14px",color:"#FFD700",stroke:"#000000",strokeThickness:1});t.setOrigin(.5),this.scene.tweens.add({targets:t,y:t.y-40,alpha:0,duration:1e3,onComplete:()=>{t.destroy()}})}catch(t){console.error("Error creating floating text:",t)}}cleanupAndDestroy(){try{this.scene&&this.updateListener&&this.scene.events.off("update",this.updateListener)}catch(e){console.error("Error removing update listener:",e)}this.destroy()}destroy(e){try{this.scene&&this.updateListener&&(this.scene.events.off("update",this.updateListener),this.updateListener=null)}catch(t){console.error("Error in destroy method:",t)}super.destroy(e)}}class VR{constructor(e){this.scene=e,this.gameManager=FM.get(),this.player=null,this.mobManager=new IR(e),this.expOrbs=null,this.goldOrbs=null,this.enemies=null,this.orbSpawnTimer=null,this.goldSpawnTimer=null,this.difficultyTimer=null}initialize(e){this.player=e,this.mobManager.initialize(this.gameManager,e),this.expOrbs=this.scene.add.group(),this.goldOrbs=this.scene.add.group(),this.enemies=this.mobManager.mobGroup,this.scene.enemies=this.enemies,this.createTextures(),this.setupCollisions(),this.setupTimers(),this.setupControls(),this.scene.spawnExperienceOrb=(e,t,s)=>this.spawnExperienceOrb(e,t,s),this.scene.spawnGoldOrb=(e,t,s)=>this.spawnGoldOrb(e,t,s)}createTextures(){if(["zombierun","Zombie2RunAni","Police run","Dagger Bandit-Run","assassinTank","assassinArcher"].forEach((e=>{this.scene.textures.exists(e)||this.createMobTexture(e)})),!this.scene.textures.exists("Exp")){const e=this.scene.add.graphics();e.fillGradientStyle(65535,65535,35071,35071,1),e.fillCircle(8,8,7),e.fillStyle(8978431,.6),e.fillCircle(8,8,5),e.fillStyle(16777215,.8),e.fillCircle(8,8,2),e.lineStyle(1,16777215,1),e.strokeCircle(8,8,7),e.generateTexture("Exp",16,16),e.destroy()}if(!this.scene.textures.exists("Gold")){const e=this.scene.add.graphics();e.fillGradientStyle(16766720,16766720,16753920,16753920,1),e.fillCircle(10,10,9),e.fillStyle(16777096,.7),e.fillCircle(10,10,6),e.fillStyle(16777215,.9),e.fillCircle(10,10,3),e.lineStyle(2,16770396,1),e.strokeCircle(10,10,9),e.lineStyle(1,16774799,.8),e.strokeCircle(10,10,10),e.generateTexture("Gold",20,20),e.destroy()}if(!this.scene.textures.exists("AOE_Fire_Ball_Projectile_VFX_V01")){const e=this.scene.add.graphics();e.fillStyle(16729088,1),e.fillCircle(16,16,16),e.generateTexture("AOE_Fire_Ball_Projectile_VFX_V01",32,32),e.destroy()}if(!this.scene.textures.exists("AOE_Fire_Blast_Attack_VFX_V01")){const e=this.scene.add.graphics();e.fillStyle(16737792,.8),e.fillCircle(24,24,24),e.generateTexture("AOE_Fire_Blast_Attack_VFX_V01",48,48),e.destroy()}if(!this.scene.textures.exists("AOE_Ice_Shard_Projectile_VFX_V01")){const e=this.scene.add.graphics();e.fillStyle(43775,1),e.fillCircle(16,16,12),e.generateTexture("AOE_Ice_Shard_Projectile_VFX_V01",32,32),e.destroy()}}createMobTexture(e){const t=this.scene.add.graphics();let s=3368499;e.includes("Police")&&(s=3355494),(e.includes("Dagger")||e.includes("assassin"))&&(s=6697779),e.includes("Tank")&&(s=4473924),e.includes("Archer")&&(s=6702131),e.includes("Zombie2")&&(s=5583701),t.fillStyle(s,1),t.fillRect(8,8,16,16),t.fillStyle(s,1),t.fillRect(4,12,4,8),t.fillRect(24,12,4,8),t.generateTexture(e,32,32),t.destroy()}setupCollisions(){this.player&&(this.scene.physics.add.overlap(this.player,this.enemies,((e,t)=>{t.attackPlayer&&t.attackPlayer(e)})),this.scene.physics.add.overlap(this.player,this.goldOrbs,((e,t)=>{this.collectGoldOrb(t)})))}setupTimers(){this.orbSpawnTimer=this.scene.time.addEvent({delay:1e3,callback:()=>this.spawnRandomExperienceOrb(),loop:!0}),this.goldSpawnTimer=this.scene.time.addEvent({delay:2e3,callback:()=>this.spawnRandomGoldOrb(),loop:!0}),this.difficultyTimer=this.scene.time.addEvent({delay:1e3,callback:()=>{this.gameManager.updateDifficulty(1e3)},loop:!0}),this.scene.enemySpawnTimer=this.mobManager.spawnTimer,this.scene.orbSpawnTimer=this.orbSpawnTimer,this.scene.goldSpawnTimer=this.goldSpawnTimer,this.scene.difficultyTimer=this.difficultyTimer}spawnEnemy(e,t,s="zombie"){return this.mobManager.spawnMob(s,e,t)}spawnRandomEnemy(){return this.mobManager.spawnRandomMob()}spawnExperienceOrb(e,t,s=1){try{if(jR){const i=new jR(this.scene,e,t);return this.scene.add.existing(i),this.expOrbs.add(i),i.setExpValue(s),i.setDepth(12),i}}catch(i){}return this.createFallbackOrb(e,t,s)}spawnGoldOrb(e,t,s=1){try{if(HR){const i=new HR(this.scene,e,t);return this.scene.add.existing(i),this.goldOrbs.add(i),i.setGoldValue(s),i.setDepth(12),i}}catch(i){}return this.createFallbackGoldOrb(e,t,s)}createFallbackOrb(e,t,s){const i=this.scene.add.circle(e,t,6,65535);return i.expValue=s||5,this.scene.physics.add.existing(i),i.body.setCircle(6),i.setDepth(12),this.expOrbs.add(i),this.scene.physics.add.overlap(this.player,i,((e,t)=>{this.collectExperienceOrb(t)})),this.setupOrbMovement(i),this.scene.time.delayedCall(3e4,(()=>{i&&i.active&&i.destroy()})),i}createFallbackGoldOrb(e,t,s){const i=this.scene.add.circle(e,t,8,16766720);return i.goldValue=s||1,this.scene.physics.add.existing(i),i.body.setCircle(8),i.setDepth(12),this.goldOrbs.add(i),this.scene.physics.add.overlap(this.player,i,((e,t)=>{this.collectGoldOrb(t)})),this.setupGoldOrbMovement(i),this.scene.time.delayedCall(45e3,(()=>{i&&i.active&&i.destroy()})),i}setupOrbMovement(e){const t=this.scene.time.addEvent({delay:50,callback:()=>{if(this.player&&!this.player.isDead&&e.body&&Phaser.Math.Distance.Between(e.x,e.y,this.player.x,this.player.y)<(this.player.pickupRange||50)){const t=Phaser.Math.Angle.Between(e.x,e.y,this.player.x,this.player.y),s=200;e.body.setVelocity(Math.cos(t)*s,Math.sin(t)*s)}},repeat:-1});e.on("destroy",(()=>{t.destroy()}))}setupGoldOrbMovement(e){const t=this.scene.time.addEvent({delay:50,callback:()=>{if(this.player&&!this.player.isDead&&e.body&&Phaser.Math.Distance.Between(e.x,e.y,this.player.x,this.player.y)<(this.player.pickupRange||50)+20){const t=Phaser.Math.Angle.Between(e.x,e.y,this.player.x,this.player.y),s=180;e.body.setVelocity(Math.cos(t)*s,Math.sin(t)*s)}},repeat:-1});e.on("destroy",(()=>{t.destroy()}))}spawnRandomExperienceOrb(){if(!this.player)return;const e=Math.random()*Math.PI*2,t=Phaser.Math.Between(200,800),s=this.player.x+Math.cos(e)*t,i=this.player.y+Math.sin(e)*t;let a=1;const n=Math.random();return n>.95?a=10:n>.8?a=5:n>.5&&(a=2),this.spawnExperienceOrb(s,i,a)}spawnRandomGoldOrb(){if(!this.player)return;const e=Math.random()*Math.PI*2,t=Phaser.Math.Between(250,600),s=this.player.x+Math.cos(e)*t,i=this.player.y+Math.sin(e)*t;let a=1;const n=Math.random();return n>.98?a=20:n>.9?a=10:n>.7?a=5:n>.4&&(a=2),this.spawnGoldOrb(s,i,a)}collectExperienceOrb(e){try{const t=e.expValue||5;this.gameManager&&this.gameManager.addExperience(t);const s=this.scene.add.text(e.x,e.y-20,`+${t} XP`,{fontFamily:"Arial",fontSize:"14px",color:"#88ff88",stroke:"#000000",strokeThickness:1});s.setOrigin(.5),this.scene.tweens.add({targets:s,y:s.y-30,alpha:0,duration:1e3,onComplete:()=>s.destroy()}),e.destroy()}catch(t){console.error("Error collecting experience orb:",t)}}collectGoldOrb(e){try{const t=e.goldValue||1;this.gameManager&&this.gameManager.addGold(t);const s=this.scene.add.text(e.x,e.y-20,`+${t} Gold`,{fontFamily:"Arial",fontSize:"14px",color:"#FFD700",stroke:"#000000",strokeThickness:1,fontWeight:"bold"});s.setOrigin(.5),this.scene.tweens.add({targets:s,y:s.y-30,alpha:0,duration:1200,onComplete:()=>s.destroy()}),e.destroy()}catch(t){console.error("Error collecting gold orb:",t)}}spawnWave(){const e=(this.scene.currentWave||0)+1;this.scene.currentWave=e,this.mobManager.startWave(e)}setupControls(){const e=this.scene.input.keyboard;e.on("keydown-Z",(()=>{const e=this.scene.input.activePointer,t=this.scene.cameras.main.getWorldPoint(e.x,e.y);this.spawnEnemy(t.x,t.y,"zombie")})),e.on("keydown-X",(()=>{const e=this.scene.input.activePointer,t=this.scene.cameras.main.getWorldPoint(e.x,e.y);this.spawnEnemy(t.x,t.y,"charger")})),e.on("keydown-V",(()=>{const e=this.scene.input.activePointer,t=this.scene.cameras.main.getWorldPoint(e.x,e.y);this.spawnEnemy(t.x,t.y,"policeDroid")})),e.on("keydown-B",(()=>{const e=this.scene.input.activePointer,t=this.scene.cameras.main.getWorldPoint(e.x,e.y);this.spawnEnemy(t.x,t.y,"assassin")})),e.on("keydown-N",(()=>{const e=this.scene.input.activePointer,t=this.scene.cameras.main.getWorldPoint(e.x,e.y);this.spawnEnemy(t.x,t.y,"assassinTank")})),e.on("keydown-M",(()=>{const e=this.scene.input.activePointer,t=this.scene.cameras.main.getWorldPoint(e.x,e.y);this.spawnEnemy(t.x,t.y,"assassinArcher")})),e.on("keydown-E",(()=>{const e=this.scene.input.activePointer,t=this.scene.cameras.main.getWorldPoint(e.x,e.y);this.spawnExperienceOrb(t.x,t.y,1)})),e.on("keydown-G",(()=>{const e=this.scene.input.activePointer,t=this.scene.cameras.main.getWorldPoint(e.x,e.y);this.spawnGoldOrb(t.x,t.y,5)})),e.on("keydown-K",(()=>{this.mobManager.killAllMobs()})),e.on("keydown-O",(()=>{for(let e=0;e<10;e++)this.spawnRandomExperienceOrb()})),e.on("keydown-P",(()=>{for(let e=0;e<10;e++)this.spawnRandomGoldOrb()})),e.on("keydown-W",(()=>{this.spawnWave()})),e.on("keydown-L",(()=>{const e=this.mobManager.getStatistics();console.log("Mob Statistics:",e)}))}checkEnemyBounds(){this.player&&this.mobManager.getAllActiveMobs().forEach((e=>{e.active&&Phaser.Math.Distance.Between(e.x,e.y,this.player.x,this.player.y)>600&&this.teleportMobToPlayer(e)}))}checkOrbBounds(){this.expOrbs&&this.player&&(this.expOrbs.getChildren().forEach((e=>{e.active&&Phaser.Math.Distance.Between(e.x,e.y,this.player.x,this.player.y)>2e3&&e.destroy()})),this.goldOrbs&&this.goldOrbs.getChildren().forEach((e=>{e.active&&Phaser.Math.Distance.Between(e.x,e.y,this.player.x,this.player.y)>2e3&&e.destroy()})))}teleportMobToPlayer(e){const t=Math.random()*Math.PI*2,s=Phaser.Math.Between(300,500);e.x=this.player.x+Math.cos(t)*s,e.y=this.player.y+Math.sin(t)*s,e.body&&e.body.velocity.setTo(0,0);const i=this.scene.add.circle(e.x,e.y,30,3407667,.7);i.setDepth(20),this.scene.tweens.add({targets:i,scale:0,alpha:0,duration:500,onComplete:()=>i.destroy()})}getEnemyCount(){return this.mobManager.getActiveMobCount()}getEnemiesByType(e){return this.mobManager.getMobsByType(e)}getAllEnemies(){return this.mobManager.getAllActiveMobs()}getStatistics(){return this.mobManager.getStatistics()}update(e,t){this.mobManager.update(e,t),this.checkEnemyBounds(),this.checkOrbBounds(),this.expOrbs&&this.expOrbs.getChildren().forEach((e=>{e.depth<10&&e.setDepth(12)})),this.goldOrbs&&this.goldOrbs.getChildren().forEach((e=>{e.depth<10&&e.setDepth(12)}))}shutdown(){var e;[this.orbSpawnTimer,this.goldSpawnTimer,this.difficultyTimer].forEach((e=>{e&&e.remove()})),this.mobManager.shutdown(),this.expOrbs&&this.expOrbs.clear(!0,!0),this.goldOrbs&&this.goldOrbs.clear(!0,!0),(null==(e=this.scene.input)?void 0:e.keyboard)&&["keydown-E","keydown-G","keydown-Z","keydown-V","keydown-X","keydown-B","keydown-N","keydown-M","keydown-K","keydown-O","keydown-P","keydown-W","keydown-L"].forEach((e=>{this.scene.input.keyboard.removeAllListeners(e)}))}}class GR extends Phaser.GameObjects.Container{constructor(e,t,s,i,a){super(e,t??53,s??69),this.cardBackground=e.add.image(0,0,"blank cards7"),this.add(this.cardBackground),this.cardBackground.setScale(2),this.titleText=e.add.text(0,-95,"Power Up",{fontFamily:"Arial, sans-serif",fontSize:"24px",color:"#ffffff",stroke:"#000000",strokeThickness:4,align:"center"}),this.titleText.setOrigin(.5),this.add(this.titleText),this.iconType="image",e.textures.exists("powerup_icon")?(this.icon=e.add.image(0,-30,"powerup_icon"),this.iconType="image"):(this.icon=e.add.star(0,-30,5,15,30,16766720),this.iconType="star"),this.icon.setScale(1.2),this.add(this.icon);const n=e.add.rectangle(0,50,180,70,0,0);n.setOrigin(.5),this.add(n),this.descriptionText=e.add.text(0,50,"Description of the power-up",{fontFamily:"Arial, sans-serif",fontSize:"18px",color:"#ffffff",stroke:"#000000",strokeThickness:3,align:"center",wordWrap:{width:160}}),this.descriptionText.setOrigin(.5),this.add(this.descriptionText);const r=e.add.rectangle(0,95,120,30,0,.5);r.setOrigin(.5),this.add(r),this.levelText=e.add.text(0,95,"Level 1",{fontFamily:"Arial, sans-serif",fontSize:"22px",color:"#ffff00",stroke:"#000000",strokeThickness:3,align:"center"}),this.levelText.setOrigin(.5),this.add(this.levelText),this.setSize(200,300),this.setInteractive({useHandCursor:!0}),this.on("pointerover",this.onPointerOver,this),this.on("pointerout",this.onPointerOut,this),this.on("pointerdown",this.onPointerDown,this),this.cardBackground.setInteractive({useHandCursor:!0}),this.cardBackground.on("pointerover",this.onPointerOver,this),this.cardBackground.on("pointerout",this.onPointerOut,this),this.cardBackground.on("pointerdown",this.onPointerDown,this),this.icon.setInteractive({useHandCursor:!0}),this.icon.on("pointerdown",this.onPointerDown,this),n.setInteractive({useHandCursor:!0}),n.on("pointerdown",this.onPointerDown,this),r.setInteractive({useHandCursor:!0}),r.on("pointerdown",this.onPointerDown,this),this.powerUpType=i||"speed",this.powerUpLevel=a||1,this.setCardContent(),this.cardId=Phaser.Math.RND.uuid(),this.onSelectCallback=null,console.log(`PowerUpSelection card created at ${t}, ${s} for ${i} level ${a}`),console.log(`Card interactive area set: width=${this.width}, height=${this.height}`)}setCardContent(){const e={speed:{title:"Speed Boost",description:"Increase movement speed by 20%",color:65280,iconTexture:"speed_icon"},damage:{title:"Damage Up",description:"Increase attack damage by 15%",color:16711680,iconTexture:"damage_icon"},health:{title:"Max Health",description:"Increase maximum health by 10%",color:255,iconTexture:"health_icon"},fireRate:{title:"Fire Rate",description:"Increase attack speed by 10%",color:16776960,iconTexture:"firerate_icon"},range:{title:"Attack Range",description:"Increase attack range by 15%",color:65535,iconTexture:"range_icon"},magnet:{title:"Magnet",description:"Increase exp collection radius by 20%",color:16711935,iconTexture:"magnet_icon"}},t=e[this.powerUpType]||e.speed;this.titleText.setText(t.title);let s=10;const i=t.description,a=i.match(/\d+/);a&&(s=parseInt(a[0]));const n=Math.floor(s*(1+.5*(this.powerUpLevel-1))),r=i.replace(/\d+%/,`${n}%`);return this.descriptionText.setText(r),this.levelText.setText(`Level ${this.powerUpLevel}`),"image"===this.iconType?this.scene.textures.exists(t.iconTexture)?this.icon.setTexture(t.iconTexture):this.scene.textures.exists("powerup_icon")&&this.icon.setTexture("powerup_icon"):"star"===this.iconType&&this.icon.setFillStyle(t.color),this.cardBackground.setTint(t.color),this}onPointerOver(){this.scene.tweens.add({targets:this,scaleX:.8,scaleY:.8,duration:100,ease:"Power1"}),this.glowEffect||(this.glowEffect=this.scene.add.image(0,0,this.cardBackground.texture.key).setScale(1.1*this.cardBackground.scaleX,1.1*this.cardBackground.scaleY).setAlpha(.5).setTint(16777215).setBlendMode(Phaser.BlendModes.ADD),this.addAt(this.glowEffect,0))}onPointerOut(){this.scene.tweens.add({targets:this,scaleX:.6,scaleY:.6,duration:100,ease:"Power1"}),this.glowEffect&&(this.glowEffect.destroy(),this.glowEffect=null)}onPointerDown(){if(this.scene.tweens.add({targets:this,scaleX:1.2,scaleY:1.2,duration:100,yoyo:!0,ease:"Power1",onComplete:()=>{console.log(`CARD SELECTED: ${this.powerUpType} level ${this.powerUpLevel}`),this.onSelectCallback?this.onSelectCallback(this.powerUpType,this.powerUpLevel):console.warn("No selection callback set for card")}}),this.scene.sound&&this.scene.sound.add)try{const e=this.scene.sound.add("select_sound");e&&e.play({volume:.5})}catch(e){console.log("Sound not available:",e)}}setOnSelectCallback(e){return this.onSelectCallback=e,console.log(`Selection callback set for ${this.powerUpType}`),this}setPowerUpType(e){return this.powerUpType=e,this.setCardContent(),this}setPowerUpLevel(e){return this.powerUpLevel=e,this.setCardContent(),this}}const UR={speed:{base:20,color:65280,apply:(e,t)=>e.moveSpeed*=1+t/100},damage:{base:15,color:16711680,apply:(e,t)=>{var s;e.damage*=1+t/100,null==(s=e.scene.playerAttackSystem)||s.updateStats()}},health:{base:10,color:255,apply:(e,t)=>{e.maxHealth+=50,e.health+=50}},fireRate:{base:10,color:16776960,apply:(e,t)=>{var s;e.fireRate*=1+t/100,null==(s=e.scene.playerAttackSystem)||s.updateStats()}},range:{base:15,color:65535,apply:(e,t)=>{var s;e.attackRange*=1+t/100,null==(s=e.scene.playerAttackSystem)||s.updateStats()}},magnet:{base:20,color:16711935,apply:(e,t)=>e.pickupRange*=1+t/100}},zR={speed:e=>{e.fillTriangle(20,15,32,30,25,32),e.fillTriangle(25,32,44,50,32,30)},damage:e=>{e.fillRect(20,20,24,4),e.fillTriangle(44,20,44,24,52,22)},health:e=>{e.fillRect(22,30,20,4),e.fillRect(30,22,4,20)},fireRate:e=>e.fillTriangle(25,45,32,15,39,45),range:e=>{e.lineStyle(3,16777215,1),e.strokeCircle(32,32,15),e.fillCircle(32,32,5)},magnet:e=>{e.fillRect(22,20,7,24),e.fillRect(35,20,7,24),e.fillRect(22,20,20,7)}};class WR{constructor(e){this.scene=e,this.powerUps=Object.keys(UR).reduce(((e,t)=>({...e,[t]:0})),{}),this.isActive=!1,this.pendingLevelUps=0,this.storedState={timers:[],entities:[]},e.powerUpManager=this}initialize(){this.createTextures()}createTextures(){if(!this.scene.textures.exists("blank cards7")){const e=this.scene.add.graphics();e.fillStyle(3355443,1).fillRoundedRect(0,0,200,300,16),e.lineStyle(4,16777215,1).strokeRoundedRect(0,0,200,300,16),e.generateTexture("blank cards7",200,300),e.destroy()}Object.entries(UR).forEach((([e,t])=>{const s=`${e}_icon`;if(this.scene.textures.exists(s))return;const i=this.scene.add.graphics();i.fillStyle(t.color,1).fillCircle(32,32,32),i.fillStyle(16777215,1),zR[e](i),i.generateTexture(s,64,64),i.destroy()}))}showPowerUpSelection(){this.isActive?this.pendingLevelUps++:(this.isActive=!0,this.pauseGame(),this.createUI())}pauseGame(){var e;["enemySpawnTimer","orbSpawnTimer","difficultyTimer"].forEach((e=>{this.scene[e]&&(this.storedState.timers.push({name:e,paused:this.scene[e].paused}),this.scene[e].paused=!0)})),[this.scene.player,...(null==(e=this.scene.enemies)?void 0:e.getChildren())||[]].forEach((e=>{(null==e?void 0:e.body)&&(this.storedState.entities.push({entity:e,vx:e.body.velocity.x,vy:e.body.velocity.y,enabled:e.body.enable}),e.body.velocity.setTo(0,0),e.body.enable=!1)})),this.originalUpdate=this.scene.update,this.scene.update=()=>{}}createUI(){const e=this.scene.cameras.main;this.overlay=this.scene.add.rectangle(e.width/2,e.height/2,e.width,e.height,0,.7).setScrollFactor(0).setDepth(1e3),this.title=this.scene.add.text(e.width/2,100,"LEVEL UP! Choose a Power-Up",{fontFamily:"Arial",fontSize:"32px",color:"#ffffff",stroke:"#000000",strokeThickness:4}).setOrigin(.5).setScrollFactor(0).setDepth(1001),this.container=this.scene.add.container(0,0).setDepth(1001).setScrollFactor(0);const t=Object.keys(UR).sort((()=>.5-Math.random())).slice(0,3),s=[-220,0,220].map((t=>({x:e.width/2+t,y:e.height/2})));t.forEach(((e,t)=>{const i=new GR(this.scene,s[t].x,s[t].y,e,this.powerUps[e]+1);i.setScale(.7).setScrollFactor(0).setDepth(1002),i.setOnSelectCallback((()=>this.selectPowerUp(e))),i.setInteractive({useHandCursor:!0}),this.container.add(i)}))}selectPowerUp(e){this.powerUps[e]++;const t=UR[e],s=t.base*(1+.5*(this.powerUps[e]-1));t.apply(this.scene.player,s),this.showFeedback(e,s),this.scene.tweens.add({targets:[this.overlay,this.title,this.container],alpha:0,duration:300,onComplete:()=>{[this.overlay,this.title,this.container].forEach((e=>null==e?void 0:e.destroy())),this.resumeGame(),this.handlePending()}})}resumeGame(){this.storedState.timers.forEach((({name:e,paused:t})=>{this.scene[e]&&(this.scene[e].paused=t)})),this.storedState.entities.forEach((({entity:e,vx:t,vy:s,enabled:i})=>{(null==e?void 0:e.body)&&(e.body.velocity.setTo(t,s),e.body.enable=i)})),this.originalUpdate&&(this.scene.update=this.originalUpdate),this.storedState={timers:[],entities:[]},this.isActive=!1}handlePending(){this.pendingLevelUps>0&&(this.pendingLevelUps--,this.scene.time.delayedCall(500,(()=>this.showPowerUpSelection())))}showFeedback(e,t){const s=this.scene.player;if(!s)return;const i="health"===e?"Max Health +50":`${e.charAt(0).toUpperCase()+e.slice(1)} +${t.toFixed(0)}%`,a=this.scene.add.text(s.x,s.y-50,i,{fontFamily:"Arial",fontSize:"24px",color:"#ffffff",stroke:"#000000",strokeThickness:4,align:"center"}).setOrigin(.5);this.scene.tweens.add({targets:a,y:a.y-100,alpha:0,duration:2e3,onComplete:()=>a.destroy()})}shutdown(){[this.overlay,this.title,this.container].forEach((e=>null==e?void 0:e.destroy())),this.originalUpdate&&(this.scene.update=this.originalUpdate)}}class QR extends Phaser.GameObjects.Container{constructor(e,t){super(e,0,0),this.player=t,e.add.existing(this),this.setDepth(18),this.slashDamage=t.slashDamage||10,this.slashFireRate=t.slashFireRate||1,this.slashRange=t.slashRange||70,this.slashCooldown=1e3/this.slashFireRate,this.lastSlashTime=0,this.fireBulletDamage=t.fireBulletDamage||8,this.fireBulletFireRate=t.fireBulletFireRate||1.2,this.fireBulletRange=t.fireBulletRange||300,this.fireBulletCooldown=1e3/this.fireBulletFireRate,this.lastFireBulletTime=0,this.fireBulletSpeed=250,this.fireBulletDotDuration=4e3,this.fireBombDamage=t.fireBombDamage||18,this.fireBombFireRate=t.fireBombFireRate||.4,this.fireBombRange=t.fireBombRange||80,this.fireBombCooldown=1e3/this.fireBombFireRate,this.lastFireBombTime=0,this.fireBombSpeed=120,this.fireBombExplosionRadius=50,this.fireBombDotDuration=5e3,this.iceDamage=t.iceDamage||12,this.iceFireRate=t.iceFireRate||.6,this.iceRange=t.iceRange||180,this.iceCooldown=1e3/this.iceFireRate,this.lastIceTime=0,this.iceProjectileSpeed=120,this.lightningDamage=t.lightningDamage||20,this.lightningFireRate=t.lightningFireRate||.5,this.lightningRange=t.lightningRange||250,this.lightningCooldown=1e3/this.lightningFireRate,this.lastLightningTime=0,this.lightningProjectileSpeed=200,this.lightningChainCount=t.lightningChainCount||10,this.lightningChainRange=100,this.blindingLightRange=t.blindingLightRange||300,this.blindingLightFireRate=t.blindingLightFireRate||.15,this.blindingLightCooldown=1e3/this.blindingLightFireRate,this.lastBlindingLightTime=0,this.blindingLightDisableDuration=4e3,this.attackTypes={slash:!0,fireBullet:!0,fireBomb:!0,ice:!0,lightning:!0,blindingLight:!0},this.setupWeaponVisuals(),this.createAttackAnimations(),this.createProjectileGroups(),this.startAttackTimers(),e.playerAttack=this}setupWeaponVisuals(){this.slashVisual=this.scene.add.arc(0,0,this.slashRange,0,Math.PI/2,!1,65280,.3),this.slashVisual.setVisible(!1),this.slashVisual.setDepth(17),this.add(this.slashVisual),this.slashSprite=this.scene.add.sprite(0,0,"AOE_Basic_Slash_Attack_V01"),this.slashSprite.setVisible(!1),this.slashSprite.setOrigin(.5,.5),this.slashSprite.setDepth(18),this.add(this.slashSprite),this.blindingLightVisual=this.scene.add.circle(0,0,this.blindingLightRange,16777215,0),this.blindingLightVisual.setStrokeStyle(6,16777215,.8),this.blindingLightVisual.setVisible(!1),this.blindingLightVisual.setDepth(19),this.add(this.blindingLightVisual)}createProjectileGroups(){this.fireBulletProjectiles=this.scene.add.group(),this.fireBombProjectiles=this.scene.add.group(),this.iceProjectiles=this.scene.add.group(),this.lightningProjectiles=this.scene.add.group(),this.scene.physics.world.enable(this.fireBulletProjectiles),this.scene.physics.world.enable(this.fireBombProjectiles),this.scene.physics.world.enable(this.iceProjectiles),this.scene.physics.world.enable(this.lightningProjectiles)}createAttackAnimations(){this.scene.anims.exists("slash_attack_v01")||this.scene.anims.create({key:"slash_attack_v01",frames:this.scene.anims.generateFrameNumbers("AOE_Basic_Slash_Attack_V01",{start:0,end:-1}),frameRate:15,repeat:0}),this.scene.anims.exists("fire_bullet")||this.scene.anims.create({key:"fire_bullet",frames:this.scene.anims.generateFrameNumbers("AOE_Fire_Ball_Projectile_VFX_V01",{start:0,end:-1}),frameRate:25,repeat:-1}),this.scene.anims.exists("fire_bomb")||this.scene.anims.create({key:"fire_bomb",frames:this.scene.anims.generateFrameNumbers("AOE_Fire_Ball_Projectile_VFX_V01",{start:0,end:-1}),frameRate:15,repeat:-1}),this.scene.textures.exists("AOE_Fire_Blast_Attack_VFX_V01")&&(this.scene.anims.exists("fire_explosion")||this.scene.anims.create({key:"fire_explosion",frames:this.scene.anims.generateFrameNumbers("AOE_Fire_Blast_Attack_VFX_V01",{start:0,end:-1}),frameRate:25,repeat:0})),this.scene.anims.exists("ice_projectile")||this.scene.anims.create({key:"ice_projectile",frames:this.scene.anims.generateFrameNumbers("AOE_Ice_Shard_Projectile_VFX_V01",{start:0,end:-1}),frameRate:16,repeat:-1}),this.scene.anims.exists("ice_explosion")||this.scene.anims.create({key:"ice_explosion",frames:this.scene.anims.generateFrameNumbers("AOE_Ice_Shard_v01",{start:0,end:-1}),frameRate:20,repeat:0}),this.scene.anims.exists("lightning_projectile")||this.scene.anims.create({key:"lightning_projectile",frames:this.scene.anims.generateFrameNumbers("lighting_chain_projectile_attack_VFX_128x32_v01",{start:0,end:-1}),frameRate:24,repeat:-1}),this.scene.anims.exists("lightning_hit")||this.scene.anims.create({key:"lightning_hit",frames:this.scene.anims.generateFrameNumbers("lighting_chain_attack_hit_projectile_VFX_72x96_v01",{start:0,end:-1}),frameRate:30,repeat:0})}startAttackTimers(){this.attackTypes.slash&&(this.slashTimer=this.scene.time.addEvent({delay:this.slashCooldown,callback:this.attemptSlashAttack,callbackScope:this,loop:!0})),this.attackTypes.fireBullet&&(this.fireBulletTimer=this.scene.time.addEvent({delay:this.fireBulletCooldown,callback:this.attemptFireBulletAttack,callbackScope:this,loop:!0})),this.attackTypes.fireBomb&&(this.fireBombTimer=this.scene.time.addEvent({delay:this.fireBombCooldown,callback:this.attemptFireBombAttack,callbackScope:this,loop:!0})),this.attackTypes.ice&&(this.iceTimer=this.scene.time.addEvent({delay:this.iceCooldown,callback:this.attemptIceAttack,callbackScope:this,loop:!0})),this.attackTypes.lightning&&(this.lightningTimer=this.scene.time.addEvent({delay:this.lightningCooldown,callback:this.attemptLightningAttack,callbackScope:this,loop:!0})),this.attackTypes.blindingLight&&(this.blindingLightTimer=this.scene.time.addEvent({delay:this.blindingLightCooldown,callback:this.attemptBlindingLightAttack,callbackScope:this,loop:!0}))}attemptSlashAttack(){if(this.scene.time.now-this.lastSlashTime<this.slashCooldown)return;const e=this.findEnemiesInSlashRange();e.length>0&&this.slashAttack(e)}findEnemiesInSlashRange(){if(!this.player)return[];const e=[];return this.scene.enemies&&this.scene.enemies.children&&this.scene.enemies.getChildren().filter((e=>e.active&&!e.isDead)).forEach((t=>{const s=Phaser.Math.Distance.Between(this.player.x,this.player.y,t.x,t.y);s<=this.slashRange&&e.push({enemy:t,distance:s})})),this.scene.breakableVases&&this.scene.breakableVases.children&&this.scene.breakableVases.getChildren().filter((e=>e.active&&!e.isBroken)).forEach((t=>{const s=Phaser.Math.Distance.Between(this.player.x,this.player.y,t.x,t.y);s<=this.slashRange&&e.push({enemy:t,distance:s,isVase:!0})})),this.scene.children&&this.scene.children.list&&this.scene.children.list.forEach((t=>{var s;if(t&&t.active&&!t.isBroken&&t.canBeAttacked&&("BreakableVase"===t.constructor.name||"Vase"===(null==(s=t.texture)?void 0:s.key)||t.onPlayerAttack||t.takeDamage&&t.dropLoot)){const s=Phaser.Math.Distance.Between(this.player.x,this.player.y,t.x,t.y);s<=this.slashRange&&(e.some((e=>e.enemy===t))||e.push({enemy:t,distance:s,isVase:!0}))}})),e}slashAttack(e){this.lastSlashTime=this.scene.time.now,this.x=this.player.x,this.y=this.player.y,this.slashSprite.setPosition(0,0),this.slashSprite.setVisible(!0),this.slashSprite.setScale(1.4),this.slashSprite.setDepth(18),this.slashSprite.play("slash_attack_v01"),this.slashSprite.once("animationcomplete",(()=>{this.slashSprite.setVisible(!1),this.slashSprite.setScale(1)})),e.forEach((e=>{e.enemy.active&&!e.enemy.isDead&&(e.isVase?e.enemy.onPlayerAttack&&e.enemy.onPlayerAttack(this.slashDamage):e.enemy.takeDamage&&e.enemy.takeDamage(this.slashDamage))})),this.showSlashIndicator()}attemptBlindingLightAttack(){if(this.scene.time.now-this.lastBlindingLightTime<this.blindingLightCooldown)return;const e=this.findEnemiesInBlindingLightRange();e.length>0&&this.blindingLightAttack(e)}findEnemiesInBlindingLightRange(){if(!this.scene.enemies||!this.player)return[];const e=[];return this.scene.enemies&&this.scene.enemies.children&&this.scene.enemies.getChildren().filter((e=>e.active&&!e.isDead)).forEach((t=>{const s=Phaser.Math.Distance.Between(this.player.x,this.player.y,t.x,t.y);s<=this.blindingLightRange&&e.push({enemy:t,distance:s})})),this.scene.zombieGroup&&this.scene.zombieGroup.children&&this.scene.zombieGroup.getChildren().filter((e=>e.active&&!e.isDead)).forEach((t=>{const s=Phaser.Math.Distance.Between(this.player.x,this.player.y,t.x,t.y);s<=this.blindingLightRange&&e.push({enemy:t,distance:s})})),e}blindingLightAttack(e){this.lastBlindingLightTime=this.scene.time.now,this.x=this.player.x,this.y=this.player.y,this.applyPlayerInvincibility(3e3);for(let t=0;t<3;t++)this.scene.time.delayedCall(100*t,(()=>{this.createBlindingLightRing(t)}));e.forEach((e=>{e.enemy.active&&!e.enemy.isDead&&this.applyBlindEffect(e.enemy,this.blindingLightDisableDuration)})),this.createScreenFlash()}createBlindingLightRing(e){const t=this.scene.add.circle(this.player.x,this.player.y,20,16777215,0);t.setStrokeStyle(4-e,16777215,.9-.2*e),t.setDepth(20),this.scene.tweens.add({targets:t,radius:this.blindingLightRange+50*e,alpha:0,duration:800+200*e,ease:"Power2",onComplete:()=>t.destroy()})}createScreenFlash(){const e=this.scene.add.rectangle(this.scene.cameras.main.centerX,this.scene.cameras.main.centerY,this.scene.cameras.main.width,this.scene.cameras.main.height,16777215,.8);e.setDepth(100),e.setScrollFactor(0),this.scene.tweens.add({targets:e,alpha:0,duration:500,ease:"Power2",onComplete:()=>e.destroy()})}applyBlindEffect(e,t){e&&!e.isDead&&(e.blindTimer&&e.blindTimer.destroy(),void 0===e.originalTint&&(e.originalTint=e.tint),e.setTint(16777215),e.isBlinded=!0,void 0!==e.canAttack&&(e.originalCanAttack=e.canAttack,e.canAttack=!1),void 0===e.originalSpeed&&(e.originalSpeed=e.speed||50),e.speed=.3*e.originalSpeed,e.blindTimer=this.scene.time.delayedCall(t,(()=>{this.clearBlindEffect(e)})))}clearBlindEffect(e){e&&(e.blindTimer&&(e.blindTimer.destroy(),e.blindTimer=null),void 0!==e.originalTint?e.setTint(e.originalTint):e.clearTint(),void 0!==e.originalCanAttack&&(e.canAttack=e.originalCanAttack),void 0!==e.originalSpeed&&(e.speed=e.originalSpeed),e.isBlinded=!1)}applyPlayerInvincibility(e){this.player&&(this.player.invincibilityTimer&&this.player.invincibilityTimer.destroy(),void 0===this.player.originalTint&&(this.player.originalTint=this.player.tint),this.player.isInvincible=!0,this.player.isInvulnerable=!0,this.player.invincibilityTween=this.scene.tweens.add({targets:this.player,alpha:.3,duration:200,ease:"Power2",yoyo:!0,repeat:-1}),this.player.setTint(16766720),this.createProtectiveAura(),this.player.invincibilityTimer=this.scene.time.delayedCall(e,(()=>{this.clearPlayerInvincibility()})))}createProtectiveAura(){if(!this.player)return;const e=this.scene.add.circle(this.player.x,this.player.y,40,16766720,0);e.setStrokeStyle(3,16766720,.6),e.setDepth(this.player.depth-1),this.player.protectiveAura=e,this.scene.tweens.add({targets:e,scaleX:1.2,scaleY:1.2,alpha:.3,duration:800,ease:"Sine.easeInOut",yoyo:!0,repeat:-1})}clearPlayerInvincibility(){this.player&&(this.player.isInvincible=!1,this.player.isInvulnerable=!1,this.player.invincibilityTween&&(this.player.invincibilityTween.stop(),this.player.invincibilityTween=null),this.player.setAlpha(1),void 0!==this.player.originalTint?this.player.setTint(this.player.originalTint):this.player.clearTint(),this.player.protectiveAura&&(this.player.protectiveAura.destroy(),this.player.protectiveAura=null),this.player.invincibilityTimer&&(this.player.invincibilityTimer.destroy(),this.player.invincibilityTimer=null))}attemptFireBulletAttack(){if(this.scene.time.now-this.lastFireBulletTime<this.fireBulletCooldown)return;const e=this.findNearestEnemyInRange(this.fireBulletRange);e&&this.fireBulletAttack(e)}fireBulletAttack(e){this.lastFireBulletTime=this.scene.time.now;const t=this.scene.add.sprite(this.player.x,this.player.y,"AOE_Fire_Ball_Projectile_VFX_V01");this.scene.physics.add.existing(t),t.setScale(.6),t.setDepth(18),t.play("fire_bullet");const s=Phaser.Math.Angle.Between(this.player.x,this.player.y,e.x,e.y);t.body.setVelocity(Math.cos(s)*this.fireBulletSpeed,Math.sin(s)*this.fireBulletSpeed),t.damage=this.fireBulletDamage,t.startX=this.player.x,t.startY=this.player.y,t.maxRange=this.fireBulletRange,t.isFireBullet=!0,t.hitEnemies=[],this.fireBulletProjectiles.add(t)}attemptFireBombAttack(){if(this.scene.time.now-this.lastFireBombTime<this.fireBombCooldown)return;const e=this.findNearestEnemyInRange(this.fireBombRange);e&&this.fireBombAttack(e)}fireBombAttack(e){this.lastFireBombTime=this.scene.time.now;const t=this.scene.add.sprite(this.player.x,this.player.y,"AOE_Fire_Ball_Projectile_VFX_V01");this.scene.physics.add.existing(t),t.setScale(1),t.setDepth(18),t.play("fire_bomb"),t.setTint(16737792);const s=Phaser.Math.Angle.Between(this.player.x,this.player.y,e.x,e.y);t.body.setVelocity(Math.cos(s)*this.fireBombSpeed,Math.sin(s)*this.fireBombSpeed),t.damage=this.fireBombDamage,t.startX=this.player.x,t.startY=this.player.y,t.maxRange=this.fireBombRange,t.targetX=e.x,t.targetY=e.y,t.isFireBomb=!0,t.hasExploded=!1,this.fireBombProjectiles.add(t)}explodeFireBomb(e){e.active&&!e.hasExploded&&(e.hasExploded=!0,e.body.setVelocity(0,0),this.scene.time.delayedCall(500,(()=>{if(e.active){if(this.scene.anims.exists("fire_explosion")){const t=this.scene.add.sprite(e.x,e.y,"AOE_Fire_Blast_Attack_VFX_V01");t.setScale(2),t.setDepth(19),t.play("fire_explosion"),t.once("animationcomplete",(()=>t.destroy()))}this.scene.enemies&&this.scene.enemies.getChildren().filter((e=>e.active&&!e.isDead)).forEach((t=>{Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y)<=this.fireBombExplosionRadius&&(t.isVase&&t.onPlayerAttack?t.onPlayerAttack(e.damage):t.takeDamage&&(t.takeDamage(e.damage),this.applyBurnEffect(t,.4*e.damage,this.fireBombDotDuration)))})),e.destroy()}})))}attemptIceAttack(){if(this.scene.time.now-this.lastIceTime<this.iceCooldown)return;const e=this.findNearestEnemyInRange(this.iceRange);e&&this.iceProjectileAttack(e)}iceProjectileAttack(e){this.lastIceTime=this.scene.time.now;const t=this.scene.add.sprite(this.player.x,this.player.y,"AOE_Ice_Shard_Projectile_VFX_V01");this.scene.physics.add.existing(t),t.setScale(.8),t.setDepth(18),t.play("ice_projectile");const s=Phaser.Math.Angle.Between(this.player.x,this.player.y,e.x,e.y);t.setRotation(s),t.body.setVelocity(Math.cos(s)*this.iceProjectileSpeed,Math.sin(s)*this.iceProjectileSpeed),t.damage=this.iceDamage,t.startX=this.player.x,t.startY=this.player.y,t.maxRange=this.iceRange,t.isIceProjectile=!0,this.iceProjectiles.add(t)}createIceExplosionEffect(e,t){if(this.scene.anims.exists("ice_explosion")){const s=this.scene.add.sprite(e,t,"AOE_Ice_Shard_v01");s.setScale(.8),s.setOrigin(.5,.5),s.setDepth(19),s.play("ice_explosion"),s.once("animationcomplete",(()=>s.destroy()))}}attemptLightningAttack(){if(this.scene.time.now-this.lastLightningTime<this.lightningCooldown)return;const e=this.findNearestEnemyInRange(this.lightningRange);e&&this.lightningChainAttack(e)}lightningChainAttack(e){this.lastLightningTime=this.scene.time.now,this.performLightningChain(this.player,e,0,[])}performLightningChain(e,t,s,i){if(s>=this.lightningChainCount||!t||i.includes(t))return;i.push(t);const a=this.scene.add.sprite(e.x,e.y,"lighting_chain_projectile_attack_VFX_128x32_v01");this.scene.physics.add.existing(a),a.setScale(.7),a.setDepth(19),a.play("lightning_projectile");const n=Phaser.Math.Angle.Between(e.x,e.y,t.x,t.y);a.setRotation(n),a.body.setVelocity(Math.cos(n)*this.lightningProjectileSpeed,Math.sin(n)*this.lightningProjectileSpeed),a.damage=this.lightningDamage*(1-.15*s),a.startX=e.x,a.startY=e.y,a.targetEnemy=t,a.chainDepth=s,a.hitTargets=i,a.isLightningProjectile=!0,this.lightningProjectiles.add(a)}hitLightningTarget(e){if(!e.active||!e.targetEnemy)return;const t=e.targetEnemy;t.takeDamage&&t.active&&!t.isDead&&(t.takeDamage(e.damage),this.applyStunEffect(t,1e3));const s=this.scene.add.sprite(t.x,t.y,"lighting_chain_attack_hit_projectile_VFX_72x96_v01");if(s.setScale(.8),s.setDepth(20),s.play("lightning_hit"),s.once("animationcomplete",(()=>s.destroy())),e.chainDepth<this.lightningChainCount-1){const s=this.findNearestEnemyInChainRange(t,e.hitTargets);s&&this.scene.time.delayedCall(100,(()=>{this.performLightningChain(t,s,e.chainDepth+1,e.hitTargets)}))}e.destroy()}findNearestEnemyInChainRange(e,t){if(!this.scene.enemies||!this.scene.enemies.children)return null;let s=null,i=this.lightningChainRange;return this.scene.enemies.getChildren().filter((e=>e.active&&!e.isDead&&!t.includes(e))).forEach((t=>{const a=Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y);a<=this.lightningChainRange&&a<i&&(i=a,s=t)})),s}applyStunEffect(e,t){e&&!e.isDead&&(e.stunTimer&&e.stunTimer.destroy(),void 0===e.originalSpeed&&(e.originalSpeed=e.speed||50),void 0===e.originalTint&&(e.originalTint=e.tint),e.speed=0,e.setTint(16776960),e.isStunned=!0,e.stunTimer=this.scene.time.delayedCall(t,(()=>{this.clearStunEffect(e)})))}clearStunEffect(e){e&&(void 0!==e.originalSpeed&&(e.speed=e.originalSpeed),e.stunTimer&&(e.stunTimer.destroy(),e.stunTimer=null),void 0!==e.originalTint?e.setTint(e.originalTint):e.clearTint(),e.isStunned=!1)}applyBurnEffect(e,t,s){if(!e||e.isDead)return;e.burnTimer&&e.burnTimer.destroy(),void 0===e.originalTint&&(e.originalTint=e.tint),e.setTint(16729088);const i=s/500,a=t/i;let n=0;e.burnTimer=this.scene.time.addEvent({delay:500,callback:()=>{e&&!e.isDead&&e.active?(e.takeDamage&&e.takeDamage(a),n++,n>=i&&this.clearBurnEffect(e)):this.clearBurnEffect(e)},repeat:i-1})}clearBurnEffect(e){e&&(e.burnTimer&&(e.burnTimer.destroy(),e.burnTimer=null),void 0!==e.originalTint?e.setTint(e.originalTint):e.clearTint())}applySlowEffect(e,t,s){e&&!e.isDead&&(e.slowTimer&&e.slowTimer.destroy(),void 0===e.originalSpeed&&(e.originalSpeed=e.speed||50),void 0===e.originalTint&&(e.originalTint=e.tint),e.speed=e.originalSpeed*(1-t),e.setTint(8969727),e.slowTimer=this.scene.time.delayedCall(s,(()=>{this.clearSlowEffect(e)})))}clearSlowEffect(e){e&&(void 0!==e.originalSpeed&&(e.speed=e.originalSpeed),e.slowTimer&&(e.slowTimer.destroy(),e.slowTimer=null),void 0!==e.originalTint?e.setTint(e.originalTint):e.clearTint())}findNearestEnemyInRange(e){if(!this.player)return null;let t=null,s=e;return this.scene.enemies&&this.scene.enemies.children&&this.scene.enemies.getChildren().filter((e=>e.active&&!e.isDead)).forEach((i=>{const a=Phaser.Math.Distance.Between(this.player.x,this.player.y,i.x,i.y);a<=e&&a<s&&(s=a,t=i)})),this.scene.breakableVases&&this.scene.breakableVases.children&&this.scene.breakableVases.getChildren().filter((e=>e.active&&!e.isBroken)).forEach((i=>{const a=Phaser.Math.Distance.Between(this.player.x,this.player.y,i.x,i.y);a<=e&&a<s&&(s=a,t=i,t.isVase=!0)})),this.scene.children&&this.scene.children.list&&this.scene.children.list.forEach((i=>{var a;if(i&&i.active&&!i.isBroken&&i.canBeAttacked&&("BreakableVase"===i.constructor.name||"Vase"===(null==(a=i.texture)?void 0:a.key)||i.onPlayerAttack||i.takeDamage&&i.dropLoot)){const a=Phaser.Math.Distance.Between(this.player.x,this.player.y,i.x,i.y);a<=e&&a<s&&(s=a,t=i,t.isVase=!0,console.log("Found vase target via fallback detection:",i))}})),t}showSlashIndicator(){this.slashVisual.setVisible(!0),this.slashVisual.setAlpha(.5);const e=this.scene.add.circle(this.player.x,this.player.y,10,65280,0);e.setStrokeStyle(4,65280,.8),e.setDepth(17),this.scene.tweens.add({targets:e,radius:this.slashRange,alpha:0,duration:400,ease:"Power2",onComplete:()=>e.destroy()}),this.scene.time.delayedCall(300,(()=>{this.slashVisual.setVisible(!1)}))}update(){this.player&&this.player.protectiveAura&&this.player.protectiveAura.setPosition(this.player.x,this.player.y),this.fireBulletProjectiles&&this.fireBulletProjectiles.children&&this.fireBulletProjectiles.children.entries&&this.fireBulletProjectiles.children.entries.forEach((e=>{e.active&&e.isFireBullet&&(Phaser.Math.Distance.Between(e.startX,e.startY,e.x,e.y)>=e.maxRange?e.destroy():[this.scene.enemies,this.scene.zombieGroup,this.scene.breakableVases].filter((e=>e&&e.children)).forEach((t=>{t&&t.getChildren().filter((e=>e.active&&!e.isDead)).forEach((t=>{e.hitEnemies.includes(t)||Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y)<=20&&(e.hitEnemies.push(t),t.isVase&&t.onPlayerAttack?t.onPlayerAttack(e.damage):t.takeDamage&&(t.takeDamage(e.damage),this.applyBurnEffect(t,.3*e.damage,this.fireBulletDotDuration)))}))})))})),this.fireBombProjectiles&&this.fireBombProjectiles.children&&this.fireBombProjectiles.children.entries&&this.fireBombProjectiles.children.entries.forEach((e=>{e.active&&e.isFireBomb&&(Phaser.Math.Distance.Between(e.startX,e.startY,e.x,e.y)>=e.maxRange?this.explodeFireBomb(e):[this.scene.enemies,this.scene.zombieGroup,this.scene.breakableVases].filter((e=>e&&e.children)).forEach((t=>{t&&t.getChildren().filter((e=>e.active&&!e.isDead)).forEach((t=>{Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y)<=25&&this.explodeFireBomb(e)}))})))})),this.iceProjectiles&&this.iceProjectiles.children&&this.iceProjectiles.children.entries&&this.iceProjectiles.children.entries.forEach((e=>{if(e.active&&e.isIceProjectile)return Phaser.Math.Distance.Between(e.startX,e.startY,e.x,e.y)>=e.maxRange?(this.createIceExplosionEffect(e.x,e.y),void e.destroy()):void(this.scene.enemies&&this.scene.enemies.children&&this.scene.enemies.getChildren().filter((e=>e.active&&!e.isDead)).forEach((t=>{if(Phaser.Math.Distance.Between(e.x,e.y,t.x,t.y)<=20)return t.isVase&&t.onPlayerAttack?(t.onPlayerAttack(e.damage),this.createIceExplosionEffect(e.x,e.y)):t.takeDamage&&(t.takeDamage(e.damage),this.applySlowEffect(t,.5,2e3),this.createIceExplosionEffect(e.x,e.y)),void e.destroy()})))})),this.lightningProjectiles&&this.lightningProjectiles.children&&this.lightningProjectiles.children.entries&&this.lightningProjectiles.children.entries.forEach((e=>{e.active&&e.isLightningProjectile&&(e.targetEnemy&&e.targetEnemy.active?Phaser.Math.Distance.Between(e.x,e.y,e.targetEnemy.x,e.targetEnemy.y)<=25?this.hitLightningTarget(e):Phaser.Math.Distance.Between(e.startX,e.startY,e.x,e.y)>=this.lightningRange&&e.destroy():e.destroy())}))}updateStats(){if(this.player&&this.scene&&this.scene.active)try{if(this.slashDamage=this.player.slashDamage||10,this.slashFireRate=this.player.slashFireRate||1,this.slashRange=this.player.slashRange||70,this.slashCooldown=1e3/this.slashFireRate,this.fireBulletDamage=this.player.fireBulletDamage||8,this.fireBulletFireRate=this.player.fireBulletFireRate||1.2,this.fireBulletRange=this.player.fireBulletRange||300,this.fireBulletCooldown=1e3/this.fireBulletFireRate,this.fireBombDamage=this.player.fireBombDamage||18,this.fireBombFireRate=this.player.fireBombFireRate||.4,this.fireBombRange=this.player.fireBombRange||220,this.fireBombCooldown=1e3/this.fireBombFireRate,this.iceDamage=this.player.iceDamage||12,this.iceFireRate=this.player.iceFireRate||.6,this.iceRange=this.player.iceRange||180,this.iceCooldown=1e3/this.iceFireRate,this.lightningDamage=this.player.lightningDamage||20,this.lightningFireRate=this.player.lightningFireRate||.5,this.lightningRange=this.player.lightningRange||250,this.lightningCooldown=1e3/this.lightningFireRate,this.lightningChainCount=this.player.lightningChainCount||10,this.blindingLightRange=this.player.blindingLightRange||300,this.blindingLightFireRate=this.player.blindingLightFireRate||.15,this.blindingLightCooldown=1e3/this.blindingLightFireRate,this.blindingLightDisableDuration=this.player.blindingLightDisableDuration||4e3,this.slashTimer&&(this.slashTimer.delay=this.slashCooldown),this.fireBulletTimer&&(this.fireBulletTimer.delay=this.fireBulletCooldown),this.fireBombTimer&&(this.fireBombTimer.delay=this.fireBombCooldown),this.iceTimer&&(this.iceTimer.delay=this.iceCooldown),this.lightningTimer&&(this.lightningTimer.delay=this.lightningCooldown),this.blindingLightTimer&&(this.blindingLightTimer.delay=this.blindingLightCooldown),this.slashVisual&&this.slashVisual.setRadius&&"function"==typeof this.slashVisual.setRadius)try{this.slashVisual.setRadius(this.slashRange)}catch(e){console.warn("Error setting slash visual radius:",e)}if(this.blindingLightVisual&&this.blindingLightVisual.setRadius&&"function"==typeof this.blindingLightVisual.setRadius)try{this.blindingLightVisual.setRadius(this.blindingLightRange)}catch(e){console.warn("Error setting blinding light visual radius:",e)}}catch(e){console.error("Error in PlayerAttack.updateStats:",e)}}destroy(){this.slashTimer&&this.slashTimer.destroy(),this.fireBulletTimer&&this.fireBulletTimer.destroy(),this.fireBombTimer&&this.fireBombTimer.destroy(),this.iceTimer&&this.iceTimer.destroy(),this.lightningTimer&&this.lightningTimer.destroy(),this.blindingLightTimer&&this.blindingLightTimer.destroy(),this.scene.enemies&&this.scene.enemies.getChildren().forEach((e=>{this.clearBurnEffect(e),this.clearSlowEffect(e),this.clearStunEffect(e),this.clearBlindEffect(e)})),this.clearPlayerInvincibility(),this.fireBulletProjectiles.destroy(!0),this.fireBombProjectiles.destroy(!0),this.iceProjectiles.destroy(!0),this.lightningProjectiles.destroy(!0),super.destroy()}}class qR extends Phaser.Scene{constructor(e){super(e),this.gameManager=null,this.uiManager=null,this.gameplayManager=null,this.powerUpManager=null,this.playerAttackSystem=null,this.player=null,this.isTeleporting=!1,this.debugMode=!1,this.enemies=null,this.experienceOrbs=null,this.goldOrbs=null,this.zombieGroup=null,this.staticObstacles=null,this.collisionLayers=[],this.currentWave=0,this.isWaveActive=!1,this.waveEnemiesRemaining=0,this.enemiesKilled=0,this.gameStartTime=0,this.statsContainer=null,this.waveText=null,this.killsText=null,this.goldText=null,this.timeText=null,this.expText=null,this.levelText=null}preload(){this.load.spritesheet("AOE_Fire_Ball_Projectile_VFX_V01","assets/Hero/AttackPatterns/fire_ball.png",{frameWidth:32,frameHeight:32}),this.load.spritesheet("AOE_Fire_Blast_Attack_VFX_V01","assets/Hero/AttackPatterns/fire_blast.png",{frameWidth:48,frameHeight:48}),this.load.spritesheet("AOE_Ice_Shard_Projectile_VFX_V01","assets/Hero/AttackPatterns/ice_shard.png",{frameWidth:32,frameHeight:32})}create(){console.log("BaseGameScene create() called - initializing fresh run"),this.gameManager=this.game.registry.get("gameManager"),this.gameManager||(this.gameManager=new FM,this.game.registry.set("gameManager",this.gameManager)),this.gameManager&&this.gameManager.setCurrentScene(this),this.gameStartTime=Date.now(),this.currentWave=0,this.isWaveActive=!1,this.waveEnemiesRemaining=0,this.enemiesKilled=0,this.isTeleporting=!1,this.initializeCollisionSystem(),this.createStatsDisplay(),this.setupUIEventListeners(),this.gameManager&&(this.gameManager.startNewRun(),this.gameManager.currentWave=0),console.log("BaseGameScene create() completed - ready for new run"),kM.emit("current-scene-ready",this)}createStatsDisplay(){try{this.statsContainer=this.add.container(this.cameras.main.width-20,20),this.statsContainer.setScrollFactor(0),this.statsContainer.setDepth(1e3),this.statsBackground=this.add.rectangle(0,0,220,140,0,.8),this.statsBackground.setOrigin(1,0),this.statsBackground.setStrokeStyle(2,4473924,1),this.statsContainer.add(this.statsBackground),this.waveText=this.add.text(-10,10,"Wave: 0",{fontFamily:"Arial",fontSize:"16px",color:"#ffffff",fontWeight:"bold"}),this.waveText.setOrigin(1,0),this.statsContainer.add(this.waveText),this.killsText=this.add.text(-10,30,"Kills: 0",{fontFamily:"Arial",fontSize:"16px",color:"#ff6666",fontWeight:"bold"}),this.killsText.setOrigin(1,0),this.statsContainer.add(this.killsText),this.goldText=this.add.text(-10,50,"Gold: 0",{fontFamily:"Arial",fontSize:"16px",color:"#FFD700",fontWeight:"bold"}),this.goldText.setOrigin(1,0),this.statsContainer.add(this.goldText),this.timeText=this.add.text(-10,70,"Time: 00:00",{fontFamily:"Arial",fontSize:"16px",color:"#88ff88",fontWeight:"bold"}),this.timeText.setOrigin(1,0),this.statsContainer.add(this.timeText),this.levelText=this.add.text(-10,90,"Level: 1",{fontFamily:"Arial",fontSize:"16px",color:"#ffaa00",fontWeight:"bold"}),this.levelText.setOrigin(1,0),this.statsContainer.add(this.levelText),this.expText=this.add.text(-10,110,"EXP: 0/100",{fontFamily:"Arial",fontSize:"14px",color:"#8888ff",fontWeight:"bold"}),this.expText.setOrigin(1,0),this.statsContainer.add(this.expText)}catch(e){console.error("Error creating stats display:",e)}}setupUIEventListeners(){try{window.addEventListener("gameStateUpdated",(e=>{this.updateStatsDisplay()})),window.addEventListener("levelUp",(e=>{this.updateStatsDisplay()})),this.statsUpdateTimer=this.time.addEvent({delay:100,callback:()=>this.updateStatsDisplay(),loop:!0})}catch(e){console.error("Error setting up UI event listeners:",e)}}updateStatsDisplay(){var e,t,s,i,a,n;if(this.gameManager&&this.statsContainer)try{const r=null==(t=null==(e=this.gameplayManager)?void 0:e.mobManager)?void 0:t.getStatistics(),o=(null==r?void 0:r.currentWave)||0;this.waveText.setText(`Wave: ${o}`);const l=(null==(s=this.gameManager.currentRunStats)?void 0:s.enemiesKilled)||0;this.killsText.setText(`Kills: ${l}`);const c=this.gameManager.getGold()||0;this.goldText.setText(`Gold: ${c}`);const h=this.gameManager.getCurrentSurvivalTime(),u=this.gameManager.formatTime(h);this.timeText.setText(`Time: ${u}`);const d=(null==(i=this.gameManager.playerStats)?void 0:i.level)||1,p=(null==(a=this.gameManager.playerStats)?void 0:a.experience)||0,f=(null==(n=this.gameManager.playerStats)?void 0:n.nextLevelExp)||100;this.levelText.setText(`Level: ${d}`),this.expText.setText(`EXP: ${p}/${f}`)}catch(r){console.error("Error updating stats display:",r)}}initializeCollisionSystem(){try{this.zombieGroup=this.physics.add.group(),this.staticObstacles=this.physics.add.staticGroup(),this.collisionLayers=[]}catch(e){console.error("Error initializing collision system:",e)}}registerCollisionLayer(e,t="Unknown Layer"){var s,i;if(e)try{e.setCollisionBetween(0,1e4),(null==(i=null==(s=this.gameplayManager)?void 0:s.mobManager)?void 0:i.mobGroup)&&this.physics.add.collider(this.gameplayManager.mobManager.mobGroup,e),this.collisionLayers.push({layer:e,name:t})}catch(a){console.error(`Error registering collision layer ${t}:`,a)}}registerStaticObstacle(e,t="Unknown Object"){if(e)try{e.body||this.physics.add.existing(e,!0),this.staticObstacles.add(e)}catch(s){console.error(`Error registering static obstacle ${t}:`,s)}}autoRegisterCollisions(){try{const e=["collision","walls","wall","obstacles","solid","Map_Col","BackGround","Wall_Upper","Wall_down","Wall_RU","Wall_RD","Bed","Vase_AC","Map_","platform","ground"];this.children.list.forEach((t=>{var s;if(t instanceof Phaser.Tilemaps.TilemapLayer){const i=(null==(s=t.layer)?void 0:s.name)||"Unknown";e.some((e=>i.toLowerCase().includes(e.toLowerCase())))&&this.registerCollisionLayer(t,i)}})),this.autoRegisterStaticObjects()}catch(e){console.error("Error in auto-registration:",e)}}autoRegisterStaticObjects(){try{const e=["torch","statue","pillar","column","tree","rock","stone","barrel","crate","wall","fence","door"];this.children.list.forEach((t=>{var s;if(t instanceof Phaser.GameObjects.Sprite||t instanceof Phaser.GameObjects.Image){const i=(null==(s=t.texture)?void 0:s.key)||"",a=t.name||"";e.some((e=>i.toLowerCase().includes(e)||a.toLowerCase().includes(e)))&&this.registerStaticObstacle(t,a||i)}}))}catch(e){console.error("Error auto-registering static objects:",e)}}setupZombieObstacleCollisions(){var e,t;try{this.staticObstacles&&(null==(t=null==(e=this.gameplayManager)?void 0:e.mobManager)?void 0:t.mobGroup)&&this.physics.add.collider(this.gameplayManager.mobManager.mobGroup,this.staticObstacles,this.handleZombieObstacleCollision,null,this)}catch(s){console.error("Error setting up zombie-obstacle collisions:",s)}}handleZombieObstacleCollision(e,t){try{const s=Phaser.Math.Angle.Between(t.x,t.y,e.x,e.y),i=50;e.body.velocity.x+=Math.cos(s)*i,e.body.velocity.y+=Math.sin(s)*i}catch(s){console.error("Error in zombie-obstacle collision handler:",s)}}addZombie(e){var t,s;(null==(s=null==(t=this.gameplayManager)?void 0:t.mobManager)?void 0:s.mobGroup)&&e&&this.gameplayManager.mobManager.mobGroup.add(e)}removeZombie(e){var t,s;(null==(s=null==(t=this.gameplayManager)?void 0:t.mobManager)?void 0:s.mobGroup)&&e&&this.gameplayManager.mobManager.mobGroup.remove(e)}initializeManagers(){try{this.gameManager||(this.gameManager=FM.get()),VR&&(this.gameplayManager=new VR(this),this.gameplayManager.initialize(this.player),this.enemies=this.gameplayManager.enemies,this.experienceOrbs=this.gameplayManager.expOrbs,this.goldOrbs=this.gameplayManager.goldOrbs,this.zombieGroup=this.gameplayManager.mobManager.mobGroup),kR&&(this.uiManager=new kR(this),this.uiManager.initialize()),WR&&(this.powerUpManager=new WR(this),this.powerUpManager.initialize()),this.player&&this.gameManager&&(this.gameManager.applyPlayerStats(this.player),this.gameManager.debugMode&&this.createUpgradeDebugDisplay())}catch(e){console.error("Error initializing managers:",e)}}initializePlayer(){this.player?(this.gameManager&&this.gameManager.applyPlayerStats(this.player),this.player.armor||(this.player.armor=0),this.player.critChance||(this.player.critChance=.05),this.player.critDamage||(this.player.critDamage=1.5),this.player.pickupRange||(this.player.pickupRange=50)):console.warn("No player to initialize")}setupPlayerAttack(){try{QR&&(this.playerAttackSystem=new QR(this,this.player),this.playerAttackSystem.updateStats&&this.playerAttackSystem.updateStats())}catch(e){console.error("Error setting up player attack:",e)}}spawnWave(){var e;(null==(e=this.gameplayManager)?void 0:e.mobManager)&&(this.currentWave++,this.gameplayManager.mobManager.startWave(this.currentWave),this.gameManager&&(this.gameManager.currentWave=this.currentWave))}trackEnemyKill(e){this.enemiesKilled++,this.gameManager&&this.gameManager.addEnemyKill(),this.updateStatsDisplay()}spawnExperienceOrb(e,t,s){var i;if(null==(i=this.gameplayManager)?void 0:i.spawnExperienceOrb)return this.gameplayManager.spawnExperienceOrb(e,t,s);try{const i=this.add.circle(e,t,6,65535);return i.expValue=s||5,this.physics.add.existing(i),i.body.setCircle(6),this.physics.add.overlap(this.player,i,((e,t)=>{this.gameManager&&this.gameManager.addExperience(t.expValue),t.destroy()})),i}catch(a){return console.error("Error spawning experience orb:",a),null}}spawnGoldOrb(e,t,s){var i;if(null==(i=this.gameplayManager)?void 0:i.spawnGoldOrb)return this.gameplayManager.spawnGoldOrb(e,t,s);try{const i=this.add.circle(e,t,8,16766720);return i.goldValue=s||1,this.physics.add.existing(i),i.body.setCircle(8),this.physics.add.overlap(this.player,i,((e,t)=>{this.gameManager&&this.gameManager.addGold(t.goldValue),t.destroy()})),i}catch(a){return console.error("Error spawning gold orb:",a),null}}handleTeleport(e,t,s){if(this.isTeleporting)return;const i=s||"MainMapScene";this.isTeleporting=!0,this.createTeleportEffect(e.x,e.y),this.gameManager&&this.gameManager.handleSceneTransition(this,i),this.time.delayedCall(500,(()=>{this.scene.start(i),this.isTeleporting=!1}))}createTeleportEffect(e,t){try{const s=this.add.circle(e,t,50,16777215,.8);this.tweens.add({targets:s,scale:2,alpha:0,duration:500,onComplete:()=>s.destroy()})}catch(s){console.error("Error creating teleport effect:",s)}}createUpgradeDebugDisplay(){try{this.upgradeDebugText&&this.upgradeDebugText.destroy();const e=this.add.text(10,10,"",{fontFamily:"Arial",fontSize:"12px",color:"#ffffff",backgroundColor:"#000000",padding:{x:5,y:5}});e.setScrollFactor(0),e.setDepth(1e3),this.upgradeDebugText=e}catch(e){console.error("Error creating debug display:",e)}}setupTestControls(){try{this.input.keyboard.on("keydown-BACKTICK",(()=>{this.gameManager&&(this.gameManager.toggleDebugMode()?this.createUpgradeDebugDisplay():this.upgradeDebugText&&(this.upgradeDebugText.destroy(),this.upgradeDebugText=null))})),this.input.keyboard.on("keydown-T",(()=>{this.gameManager&&this.gameManager.debugMode&&this.spawnWave()})),this.input.keyboard.on("keydown-C",(()=>{this.gameManager&&this.gameManager.debugMode&&(this.autoRegisterCollisions(),this.setupZombieObstacleCollisions())})),this.input.keyboard.on("keydown-H",(()=>{this.player&&this.player.heal&&this.gameManager&&this.gameManager.debugMode&&this.player.heal(50)})),this.input.keyboard.on("keydown-Y",(()=>{this.gameManager&&this.gameManager.debugMode&&this.gameManager.addGold(100)})),this.input.keyboard.on("keydown-ESC",(()=>{window.returnToMenu&&(this.shutdown(),window.returnToMenu())}))}catch(e){console.error("Error setting up test controls:",e)}}update(e,t){try{if(this.player&&this.player.isDead)return;this.gameplayManager&&"function"==typeof this.gameplayManager.update&&this.gameplayManager.update(e,t),this.uiManager&&"function"==typeof this.uiManager.update&&this.uiManager.update(e,t),this.playerAttackSystem&&this.playerAttackSystem.update&&this.playerAttackSystem.update(),this.playerAttackSystem&&this.playerAttackSystem.updateStats&&this.playerAttackSystem.updateStats(),this.gameManager&&this.gameManager.isGameRunning&&this.gameManager.updateDifficulty(t),this.gameManager&&this.gameManager.debugMode&&this.upgradeDebugText&&this.updateDebugDisplay()}catch(s){console.error(`Error in ${this.scene.key} update:`,s)}}updateDebugDisplay(){var e,t,s,i,a,n,r,o;if(this.upgradeDebugText&&this.player&&this.gameManager)try{const l=this.gameManager.getCurrentSurvivalTime(),c=(null==(t=null==(e=this.gameplayManager)?void 0:e.mobManager)?void 0:t.getStatistics())||{},h=(null==(i=null==(s=this.gameplayManager)?void 0:s.mobManager)?void 0:i.getWaveProgress())||{},u=["=== DEBUG INFO ===",`Survival Time: ${this.gameManager.formatTime(l)}`,`Level: ${this.gameManager.playerStats.level}`,`XP: ${this.gameManager.playerStats.experience}/${this.gameManager.playerStats.nextLevelExp}`,`Gold: ${this.gameManager.gold}`,"","WAVE SYSTEM:",`Current Wave: ${c.currentWave||0}`,"Wave Active: "+(c.waveActive?"YES":"NO"),`Wave Progress: ${h.remaining||0}/${h.total||0}`,`Next Wave: ${h.nextWaveTime||0}s`,"","MOB SYSTEM:",`Active Mobs: ${c.activeCount||0}`,`Total Spawned: ${c.totalSpawned||0}`,`Total Killed: ${c.totalKilled||0}`,"","Player Stats:",`Health: ${null==(a=this.player.health)?void 0:a.toFixed(1)}/${null==(n=this.player.maxHealth)?void 0:n.toFixed(1)}`,`Damage: ${null==(r=this.player.damage)?void 0:r.toFixed(1)}`,`Speed: ${null==(o=this.player.moveSpeed)?void 0:o.toFixed(1)}`,"","Controls:","T - Trigger Wave | C - Auto-Collisions","H - Heal | Y - Add Gold | ESC - Exit","GameplayManager Debug Controls Active"].join("\n");this.upgradeDebugText.setText(u)}catch(l){console.error("Error updating debug display:",l)}}shutdown(){this.statsUpdateTimer&&(this.statsUpdateTimer.destroy(),this.statsUpdateTimer=null),window.removeEventListener("gameStateUpdated",this.updateStatsDisplay),window.removeEventListener("levelUp",this.updateStatsDisplay),this.gameplayManager&&this.gameplayManager.shutdown(),this.uiManager&&this.uiManager.shutdown(),this.powerUpManager&&this.powerUpManager.shutdown(),this.enemies=null,this.experienceOrbs=null,this.goldOrbs=null,this.zombieGroup=null,this.staticObstacles&&(this.staticObstacles.clear(!0,!0),this.staticObstacles=null),this.collisionLayers=[],this.input.keyboard.removeAllListeners(),this.gameManager&&(this.gameManager.saveGame(),this.gameManager.currentWave=0),this.upgradeDebugText&&(this.upgradeDebugText.destroy(),this.upgradeDebugText=null),this.statsContainer&&(this.statsContainer.destroy(),this.statsContainer=null),this.enemiesKilled=0,this.currentWave=0,this.isWaveActive=!1,this.waveEnemiesRemaining=0,this.gameStartTime=0,console.log("BaseGameScene shutdown complete")}}class KR extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t??24,s??24,i||"Player_Character_Idle_Animation_v01",a??0),e.physics.add.existing(this,!1),this.body.allowGravity=!1,this.body.setSize(24,24,!1),this.body.setOffset(12,12);const n=e.cameras.main;n.startFollow(this,!0,.1,.1),n.setZoom(3.15),n.fadeIn(1e3),this.moveSpeed=150,this.lastDirection="down",this.isMovingToTarget=!1,this.maxHealth=100,this.health=this.maxHealth,this.isInvulnerable=!1,this.invulnerabilityTime=500,this.isDead=!1,this.damage=10,this.armor=0,this.critChance=.05,this.critDamage=1.5,this.fireRate=1,this.attackRange=100,this.pickupRange=50,this.isMoving=!1,this.animationSpeed=200,this.currentAnimFrame=0,this.animationTimer=0,this.gameManager=e.game.registry.get("gameManager"),this.gameManager&&(this.gameManager.applyPlayerStats(this),this.isDead=!1,this.alive=!0,this.isInvulnerable=!1,console.log("Player stats after applying menu upgrades:",{maxHealth:this.maxHealth,health:this.health,damage:this.damage,moveSpeed:this.moveSpeed,armor:this.armor,isAlive:!this.isDead})),this.updateHPBar(),this.createAnimations(),this.setupMouseTracking(),this.scene.input.on("pointerdown",this.handlePointerDown,this),this.scene.input.on("pointerup",this.handlePointerUp,this),e.events.on("update",this.update,this),e.add.existing(this)}updateHPBar(){const e={currentHP:this.health,maxHP:this.maxHealth,health:this.health,maxHealth:this.maxHealth,hp:this.health,maxHp:this.maxHealth};kM.emit("player-health-updated",e),kM.emit("player-hp-changed",e),this.gameManager&&this.gameManager.playerStats&&(this.gameManager.playerStats.health=this.health,this.gameManager.playerStats.maxHealth=this.maxHealth),window.dispatchEvent(new CustomEvent("playerHealthUpdated",{detail:e}))}createAnimations(){this.scene.anims.exists("PlayerRunningAni")||this.scene.anims.create({key:"PlayerRunningAni",frames:this.scene.anims.generateFrameNumbers("heroAsset",{start:0,end:7}),frameRate:10,repeat:-1}),this.scene.anims.exists("PlayerIdleAni")||this.scene.anims.create({key:"PlayerIdleAni",frames:[{key:"heroAsset",frame:0}],frameRate:1,repeat:0}),this.scene.anims.exists("PlayerDeathAni")||this.scene.anims.create({key:"PlayerDeathAni",frames:this.scene.anims.generateFrameNumbers("heroAsset",{start:8,end:15}),frameRate:6,repeat:0})}setupMouseTracking(){this.scene.input.on("pointermove",(e=>{if(!this.isDead&&this.isMovingToTarget){const t=this.scene.cameras.main.getWorldPoint(e.x,e.y),s=t.x-this.x,i=t.y-this.y;Math.abs(s)>Math.abs(i)?this.lastDirection=s>0?"right":"left":this.lastDirection=i>0?"down":"up"}}))}handlePointerDown(e){if(e.leftButtonDown()&&!this.isDead){const t=this.scene.cameras.main.getWorldPoint(e.x,e.y),s=t.x,i=t.y;if(Phaser.Math.Distance.Between(this.x,this.y,s,i)>10){this.isMovingToTarget=!0;const e=s-this.x,t=i-this.y;Math.abs(e)>Math.abs(t)?this.lastDirection=e>0?"right":"left":this.lastDirection=t>0?"down":"up",this.updatePlayerAnimation()}}}handlePointerUp(e){e.leftButtonDown()||(this.isMovingToTarget=!1)}update(e,t){if(this.isDead)return;if(!this.scene||!this.scene.input||!this.scene.input.keyboard)return;const s=this.scene.input.keyboard,i=s.addKey("W").isDown,a=s.addKey("S").isDown,n=s.addKey("A").isDown,r=s.addKey("D").isDown;this.body.velocity.x=0,this.body.velocity.y=0;let o=i||a||n||r,l=0,c=0,h=this.isMoving;if(this.isMoving=!1,o){if(this.isMovingToTarget=!1,n&&(l-=1),r&&(l+=1),i&&(c-=1),a&&(c+=1),0!==l||0!==c){this.isMoving=!0;const e=new Phaser.Math.Vector2(l,c).normalize();this.body.velocity.x=e.x*this.moveSpeed,this.body.velocity.y=e.y*this.moveSpeed,Math.abs(e.x)>Math.abs(e.y)?this.lastDirection=e.x>0?"right":"left":this.lastDirection=e.y>0?"down":"up"}}else if(this.isMovingToTarget&&this.scene.input&&this.scene.input.activePointer){const e=this.scene.input.activePointer,t=this.scene.cameras.main.getWorldPoint(e.x,e.y),s=t.x,i=t.y;if(Phaser.Math.Distance.Between(this.x,this.y,s,i)>5){this.isMoving=!0;const e=Phaser.Math.Angle.Between(this.x,this.y,s,i);this.body.velocity.x=Math.cos(e)*this.moveSpeed,this.body.velocity.y=Math.sin(e)*this.moveSpeed;const t=s-this.x,a=i-this.y;Math.abs(t)>Math.abs(a)?this.lastDirection=t>0?"right":"left":this.lastDirection=a>0?"down":"up"}}this.updatePlayerAnimation(e,t),h!==this.isMoving&&this.updatePlayerFrame()}updatePlayerAnimation(e,t){this.isDead||(this.isMoving?(this.setFlipX("left"===this.lastDirection),this.scene.anims.exists("PlayerRunningAni")&&(this.anims.isPlaying&&"PlayerRunningAni"===this.anims.currentAnim.key||this.anims.play("PlayerRunningAni"))):(this.scene.anims.exists("PlayerIdleAni")?this.anims.isPlaying&&"PlayerIdleAni"===this.anims.currentAnim.key||this.anims.play("PlayerIdleAni"):(this.anims.isPlaying&&this.anims.stop(),this.setFrame(0)),this.setFlipX("left"===this.lastDirection)))}updatePlayerFrame(){if(!this.isDead&&!this.anims.isPlaying){let e=this.isMoving?this.currentAnimFrame:0;switch(this.lastDirection){case"right":this.setFrame(2+e);break;case"left":this.setFrame(1+e);break;case"up":this.setFrame(3+e);break;case"down":this.setFrame(0+e)}}}takeDamage(e,t="Unknown"){if(this.isInvulnerable||this.isDead)return;const s=Math.max(1,e-(this.armor||0));this.health-=s,this.gameManager&&this.gameManager.isGameRunning&&(this.gameManager.currentRunStats.damageTaken+=s),console.log(`Player took ${s} damage from ${t}. Health: ${this.health}/${this.maxHealth}`),this.updateHPBar(),this.showDamageEffect(s),this.setTint(16711680);const i=("up"===this.lastDirection||"down"===this.lastDirection||this.lastDirection,0);if(this.scene.tweens.add({targets:this,x:this.x+("left"===this.lastDirection||"right"===this.lastDirection?0*i:0),y:this.y+("up"===this.lastDirection||"down"===this.lastDirection?0*i:0),duration:100,yoyo:!0,ease:"Power2"}),this.scene.sound&&this.scene.sound.add)try{this.scene.cache.audio.exists("player_hit")&&this.scene.sound.add("player_hit").play({volume:.5})}catch(a){console.warn("Could not play hit sound:",a)}this.makeInvulnerable(),this.health<=0&&this.die(t)}makeInvulnerable(){this.isInvulnerable||(this.isInvulnerable=!0,this.scene.tweens.add({targets:this,alpha:.3,duration:100,yoyo:!0,repeat:9,ease:"Power2",onComplete:()=>{this.alpha=1,this.clearTint()}}),this.scene.time.delayedCall(this.invulnerabilityTime,(()=>{this.isInvulnerable=!1})))}showDamageEffect(e){try{const t=this.scene.add.text(this.x,this.y-30,`-${e}`,{fontFamily:"Arial",fontSize:"18px",color:"#ff4444",stroke:"#000000",strokeThickness:2,fontStyle:"bold"});t.setOrigin(.5),t.setDepth(1e3),this.scene.tweens.add({targets:t,y:t.y-50,x:t.x+Phaser.Math.Between(-10,10),alpha:0,scale:{from:1,to:1.5},duration:1500,ease:"Power2",onComplete:()=>{t.destroy()}}),e>20&&this.scene.cameras.main.shake(200,.01)}catch(t){console.error("Error showing damage effect:",t)}}die(e="Skill Issue"){this.isDead||(this.isDead=!0,this.health=0,this.updateHPBar(),this.body.velocity.x=0,this.body.velocity.y=0,this.body.enable=!1,this.scene.input.keyboard.enabled=!1,this.scene.input.off("pointerdown",this.handlePointerDown,this),this.scene.input.off("pointerup",this.handlePointerUp,this),this.scene.enemySpawnTimer&&(this.scene.enemySpawnTimer.paused=!0),this.scene.orbSpawnTimer&&(this.scene.orbSpawnTimer.paused=!0),this.scene.difficultyTimer&&(this.scene.difficultyTimer.paused=!0),this.scene.enemies&&this.scene.enemies.getChildren().forEach((e=>{e.body&&(e.body.enable=!1),e.updateListener&&this.scene.events.off("update",e.updateListener)})),this.gameManager&&this.gameManager.handlePlayerDeath(e),this.scene.anims.exists("PlayerDeathAni")?(this.anims.play("PlayerDeathAni"),this.on("animationcomplete",(e=>{"PlayerDeathAni"===e.key&&this.applyDeathEffects()}))):this.applyDeathEffects())}applyDeathEffects(){this.scene.tweens.add({targets:this,angle:90,alpha:.3,scaleX:0,scaleY:0,duration:500,ease:"Power2"}),this.scene.time.delayedCall(1e3,(()=>{window.returnToMenu&&window.returnToMenu()}))}heal(e){if(this.isDead)return;const t=this.health;this.health=Math.min(this.health+e,this.maxHealth);const s=this.health-t;s>0&&(console.log(`Player healed for ${s}. Health: ${this.health}/${this.maxHealth}`),this.updateHPBar(),this.showHealEffect(s),this.setTint(65280),this.scene.tweens.add({targets:this,scaleX:1.1,scaleY:1.1,duration:150,yoyo:!0,ease:"Power2"}),this.scene.time.delayedCall(200,(()=>{this.clearTint()})))}showHealEffect(e){try{const t=this.scene.add.text(this.x,this.y-30,`+${e}`,{fontFamily:"Arial",fontSize:"16px",color:"#44ff44",stroke:"#000000",strokeThickness:2,fontStyle:"bold"});t.setOrigin(.5),t.setDepth(1e3),this.scene.tweens.add({targets:t,y:t.y-40,alpha:0,scale:{from:1,to:1.2},duration:1200,ease:"Power2",onComplete:()=>{t.destroy()}})}catch(t){console.error("Error showing heal effect:",t)}}}class ZR extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t??1009,s??1208),Ai(this,"rock_pillars_coming_from_darkness_bg_00"),Ai(this,"statues_far_from_platforms_bg_40"),Ai(this,"crystals1_improved_refraction_80"),Ai(this,"crystals1_improved_refraction_110"),Ai(this,"crystals1_improved_refraction_60"),Ai(this,"crystals1_improved_refraction"),Ai(this,"crystals1_improved_refraction_1"),Ai(this,"crystals1_improved_refraction_2"),Ai(this,"crystals1_improved_refraction_3"),Ai(this,"crystals1_improved_refraction_4"),Ai(this,"crystals1_improved_refraction_5"),Ai(this,"crystals1_improved_refraction_6"),Ai(this,"crystals1_improved_refraction_7"),Ai(this,"crystals1_improved_refraction_8"),Ai(this,"crystals1_improved_refraction_9"),Ai(this,"crystals1_improved_refraction_10"),Ai(this,"crystals1_improved_refraction_11"),Ai(this,"crystals1_improved_refraction_12"),Ai(this,"crystals1_improved_refraction_13"),Ai(this,"crystals1_improved_refraction_14"),Ai(this,"crystals1_improved_refraction_15"),Ai(this,"crystals1_improved_refraction_16"),Ai(this,"crystals1_improved_refraction_17"),Ai(this,"crystals1_improved_refraction_18"),Ai(this,"crystals1_improved_refraction_19"),Ai(this,"crystals1_improved_refraction_20"),Ai(this,"crystals1_improved_refraction_21"),Ai(this,"crystals1_improved_refraction_22"),this.blendMode=Phaser.BlendModes.SKIP_CHECK;const i=e.add.image(14,124,"rock pillars coming from darkness-bg_0",0);this.add(i);const a=e.add.image(16,-18,"statues-far from platforms-bg_4",0);this.add(a);const n=e.add.image(-12,71,"Crystals1-improved refraction_8",0);this.add(n);const r=e.add.image(5,86,"Crystals1-improved refraction_11",0);this.add(r);const o=e.add.image(27,87,"Crystals1-improved refraction_6",0);this.add(o);const l=e.add.image(42,71,"Crystals1-improved refraction_8",0);this.add(l);const c=e.add.image(-22,97,"Crystals1-improved refraction_6",0);this.add(c);const h=e.add.image(4,111,"Crystals1-improved refraction_6",0);this.add(h);const u=e.add.image(29,117,"Crystals1-improved refraction_6",0);this.add(u);const d=e.add.image(-24,119,"Crystals1-improved refraction_6",0);this.add(d);const p=e.add.image(-31,148,"Crystals1-improved refraction_6",0);this.add(p);const f=e.add.image(2,139,"Crystals1-improved refraction_6",0);this.add(f);const m=e.add.image(24,139,"Crystals1-improved refraction_11",0);this.add(m);const g=e.add.image(48,96,"Crystals1-improved refraction_11",0);this.add(g);const y=e.add.image(57,119,"Crystals1-improved refraction_11",0);this.add(y);const b=e.add.image(41,143,"Crystals1-improved refraction_11",0);this.add(b);const v=e.add.image(64,151,"Crystals1-improved refraction_11",0);this.add(v);const w=e.add.image(-15,154,"Crystals1-improved refraction_11",0);this.add(w);const x=e.add.image(-31,176,"Crystals1-improved refraction_11",0);this.add(x);const k=e.add.image(-9,192,"Crystals1-improved refraction_11",0);this.add(k);const A=e.add.image(18,200,"Crystals1-improved refraction_11",0);this.add(A);const S=e.add.image(39,196,"Crystals1-improved refraction_11",0);this.add(S);const E=e.add.image(66,175,"Crystals1-improved refraction_11",0);this.add(E);const T=e.add.image(2,169,"Crystals1-improved refraction_6",0);this.add(T);const P=e.add.image(35,167,"Crystals1-improved refraction_8",0);this.add(P);const C=e.add.image(14,60,"Crystals1-improved refraction_11",0);this.add(C);const M=e.add.image(-13,50,"Crystals1-improved refraction_11",0);this.add(M);const B=e.add.image(33,54,"Crystals1-improved refraction_6",0);this.add(B),this.rock_pillars_coming_from_darkness_bg_00=i,this.statues_far_from_platforms_bg_40=a,this.crystals1_improved_refraction_80=n,this.crystals1_improved_refraction_110=r,this.crystals1_improved_refraction_60=o,this.crystals1_improved_refraction=l,this.crystals1_improved_refraction_1=c,this.crystals1_improved_refraction_2=h,this.crystals1_improved_refraction_3=u,this.crystals1_improved_refraction_4=d,this.crystals1_improved_refraction_5=p,this.crystals1_improved_refraction_6=f,this.crystals1_improved_refraction_7=m,this.crystals1_improved_refraction_8=g,this.crystals1_improved_refraction_9=y,this.crystals1_improved_refraction_10=b,this.crystals1_improved_refraction_11=v,this.crystals1_improved_refraction_12=w,this.crystals1_improved_refraction_13=x,this.crystals1_improved_refraction_14=k,this.crystals1_improved_refraction_15=A,this.crystals1_improved_refraction_16=S,this.crystals1_improved_refraction_17=E,this.crystals1_improved_refraction_18=T,this.crystals1_improved_refraction_19=P,this.crystals1_improved_refraction_20=C,this.crystals1_improved_refraction_21=M,this.crystals1_improved_refraction_22=B,e.physics.add.existing(this,!1),this.body=this.body||{},this.body.allowGravity=!1,this.body.setSize(120,75),this.body.setOffset(-45,135),this.body.moves=!1,this.body.immovable=!0,this.isStatueInvisible=!1,this.isPlayerInvisible=!1,this.statueTop=this.y-95,this.statueBottom=this.y+200,this.updateListener=()=>this.checkPlayerPosition(),e.events.on("update",this.updateListener)}setupCollision(e){this.scene&&e&&(this.scene.physics.add.collider(e,this,null,null,this),this.player=e)}checkPlayerPosition(){if(!this.player||!this.scene)return;const e=Math.abs(this.player.x+10-this.x-25)<55;this.player.y>this.statueTop&&this.player.y<this.statueBottom&&e?(this.isStatueInvisible||this.scene.tweens.add({targets:this,alpha:.4,duration:200,ease:"Power1",onComplete:()=>{this.isStatueInvisible=!0}}),this.isPlayerInvisible||this.scene.tweens.add({targets:this.player,alpha:.3,duration:200,ease:"Power1",onComplete:()=>{this.isPlayerInvisible=!0}})):(this.isStatueInvisible&&this.scene.tweens.add({targets:this,alpha:1,duration:200,ease:"Power1",onComplete:()=>{this.isStatueInvisible=!1}}),this.isPlayerInvisible&&this.scene.tweens.add({targets:this.player,alpha:1,duration:200,ease:"Power1",onComplete:()=>{this.isPlayerInvisible=!1}}))}destroy(){this.scene&&this.scene.events.off("update",this.updateListener),super.destroy()}}const JR=class e extends Phaser.GameObjects.Image{constructor(e,t,s,i,a){super(e,t??16,s??16,i||"Vase",a??0);try{if(!e||!e.physics)return void console.error("BreakableVase: Scene or physics not ready");this.maxHealth=1,this.health=this.maxHealth,this.isBroken=!1,this.canBeAttacked=!0,this.originalTint=16777215,this.dropChance={gold:.4,experience:.7,healing:.2},this.dropAmounts={gold:{min:1,max:3},experience:{min:2,max:5},healing:{min:10,max:25}},this.setTint(this.originalTint),this.setInteractive(),this.randomizeTexture(),this.createPhysicsBodyImmediate(e)}catch(n){console.error("Error in BreakableVase constructor:",n)}}createPhysicsBodyImmediate(e){try{e.breakableVases||(e.breakableVases=e.physics.add.staticGroup(),console.log("BreakableVase: Created breakableVases group")),e.physics.add.existing(this,!0),this.body?(this.body.setSize(28,28),this.body.setOffset(2,2),e.breakableVases.add(this)):e.time.delayedCall(50,(()=>{this.createPhysicsBody(e)}))}catch(t){this.canBeAttacked=!0,this.isInCollisionSystem=!0}}createPhysicsBody(e){try{if(!e||!e.physics||this.body)return;if(e.physics.add.existing(this,!0),!this.body)return;this.body.setSize(28,28),this.body.setOffset(2,2),e.time.delayedCall(16,(()=>{this.addToVaseGroup(e)}))}catch(t){console.error("Error creating physics body for BreakableVase:",t)}}addToVaseGroup(e){try{if(!e.physics.world||e.physics.world.isPaused)return void e.time.delayedCall(50,(()=>this.addToVaseGroup(e)));if(!this.body||!this.body.enable)return;this.addToPhysicsGroup(e)||(this.canBeAttacked=!0,this.isInCollisionSystem=!0)}catch(t){console.error("Error adding BreakableVase to group:",t),this.canBeAttacked=!0,this.isInCollisionSystem=!0}}addToPhysicsGroup(e){try{if(e.breakableVases||(e.breakableVases=e.physics.add.staticGroup(),console.log("BreakableVase: Created breakableVases group in addToPhysicsGroup")),!e.breakableVases.children)return console.warn("BreakableVase: Group children not available"),!1;if(e.breakableVases&&e.breakableVases.add&&"function"==typeof e.breakableVases.add){let s=!1;try{s=e.breakableVases.contains&&e.breakableVases.contains(this)}catch(t){console.warn("Contains check failed, proceeding with add:",t),s=!1}return s?(console.log("BreakableVase: Already in group"),!0):(e.breakableVases.add(this),console.log("BreakableVase: Successfully added to group"),!0)}return console.warn("BreakableVase: Group add method not available"),!1}catch(s){return console.error("Error in addToPhysicsGroup:",s),!1}}randomizeTexture(){try{const t=e.VASE_FRAMES.filter((t=>!e.EXCLUDED_FRAMES.includes(t))),s=t[Math.floor(Math.random()*t.length)];this.scene.textures.exists(this.texture.key)&&this.scene.textures.get(this.texture.key).has(s)&&this.setFrame(s)}catch(t){this.setFrame(0)}}takeDamage(e=1){return!(this.isBroken||!this.canBeAttacked)&&(this.health-=e,this.setTint(16737894),this.scene.time.delayedCall(100,(()=>{this.active&&this.setTint(this.originalTint)})),this.health<=0&&(this.breakVase(),!0))}breakVase(){if(!this.isBroken){if(this.isBroken=!0,this.canBeAttacked=!1,this.createBreakEffect(),this.dropLoot(),this.scene.breakableVases&&this.scene.breakableVases.remove)try{this.scene.breakableVases.remove(this)}catch(e){console.warn("Error removing vase from group:",e)}if(this.body&&this.scene.physics&&this.scene.physics.world)try{this.scene.physics.world.disable(this)}catch(e){console.warn("Error disabling physics body:",e)}this.destroy()}}createBreakEffect(){try{const e=this.scene.add.particles(this.x,this.y,"__WHITE",{speed:{min:50,max:100},scale:{start:.3,end:0},lifespan:300,quantity:8,tint:[9127187,10506797,13468991]});this.scene.time.delayedCall(500,(()=>{e.active&&e.destroy()})),this.scene.sound&&this.scene.sound.get("vase_break")&&this.scene.sound.play("vase_break",{volume:.3})}catch(e){console.error("Error creating break effect:",e)}}dropLoot(){try{let s=0;if(Math.random()<this.dropChance.gold){const t=Phaser.Math.Between(this.dropAmounts.gold.min,this.dropAmounts.gold.max);for(let i=0;i<t;i++){const t=Phaser.Math.Between(-16,16),i=Phaser.Math.Between(-16,16);try{const e=new HR(this.scene,this.x+t,this.y+i);e.setGoldValue(1),this.scene.add.existing(e),s++}catch(e){console.error("Error creating gold orb:",e)}}}if(Math.random()<this.dropChance.experience){const e=Phaser.Math.Between(this.dropAmounts.experience.min,this.dropAmounts.experience.max),i=Phaser.Math.Between(-16,16),a=Phaser.Math.Between(-16,16);try{const t=new jR(this.scene,this.x+i,this.y+a);t.setExpValue(e),this.scene.add.existing(t),s++}catch(t){console.error("Error creating experience orb:",t)}}if(Math.random()<this.dropChance.healing){const e=Phaser.Math.Between(this.dropAmounts.healing.min,this.dropAmounts.healing.max),t=Phaser.Math.Between(-16,16),i=Phaser.Math.Between(-16,16);this.createHealingItem(this.x+t,this.y+i,e),s++}}catch(s){console.error("Error dropping loot:",s)}}createHealingItem(e,t,s){try{const i=this.scene.add.circle(e,t,8,65280,.8);this.scene.physics.add.existing(i,!1),i.body.setCircle(8),i.body.setCollideWorldBounds(!1),i.body.setBounce(.3,.3),i.body.setDrag(100,100);const a=t,n=this.scene.tweens.add({targets:i,y:a-5,duration:1e3,ease:"Sine.easeInOut",yoyo:!0,repeat:-1});i.healValue=s,this.scene.player&&this.scene.physics.add.overlap(this.scene.player,i,((e,t)=>{e.heal?e.heal(t.healValue):void 0!==e.health&&(e.health=Math.min(e.health+t.healValue,e.maxHealth||100)),this.createFloatingText(`+${t.healValue} HP`,t.x,t.y-20,"#00ff00"),n.active&&n.destroy(),t.destroy()})),this.scene.time.delayedCall(3e4,(()=>{i.active&&(n.active&&n.destroy(),i.destroy())}))}catch(i){console.error("Error creating healing item:",i)}}createFloatingText(e,t=this.x,s=this.y-20,i="#ffffff"){try{const a=this.scene.add.text(t,s,e,{fontFamily:"Arial, sans-serif",fontSize:"12px",color:i,stroke:"#000000",strokeThickness:1});a.setOrigin(.5),this.scene.tweens.add({targets:a,y:a.y-30,alpha:0,duration:1e3,onComplete:()=>{a.destroy()}})}catch(a){console.error("Error creating floating text:",a)}}onPlayerAttack(e=1){return this.takeDamage(e)}static spawnVasesOnTilemap(t,s,i=.3){t.breakableVases||(t.breakableVases=t.physics.add.staticGroup());const a=s.tilemap,n=s.layer;for(let r=0;r<n.height;r++)for(let s=0;s<n.width;s++){const o=a.getTileAt(s,r,!1,n.name);if(o&&o.index>0&&Math.random()<i){const i=o.pixelX+o.width/2,l=o.pixelY+o.height/2,c=new e(t,i,l,"Vase");t.add.existing(c),a.removeTileAt(s,r,!1,n.name)}}}};Ai(JR,"VASE_FRAMES",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102]),Ai(JR,"EXCLUDED_FRAMES",[21,22,23,24]);let XR=JR;class $R{constructor(e){if(this.scene=e,this.spawnedVases=[],this.maxVases=25,this.spawnChance=.1,this.respawnEnabled=!1,this.respawnDelay=3e4,this.respawnChance=.1,e&&e.physics){if(!e.breakableVases)try{e.breakableVases=e.physics.add.staticGroup(),console.log("VaseSpawner: Created breakableVases group")}catch(t){return void console.error("VaseSpawner: Error creating breakableVases group:",t)}this.respawnEnabled&&this.setupRespawnTimer()}else console.error("VaseSpawner: Scene or physics not ready")}spawnVasesOnTilemap(e,t={}){const s={spawnChance:t.spawnChance||this.spawnChance,maxVases:t.maxVases||this.maxVases,textureKey:t.textureKey||"Vase",excludeTileIndices:t.excludeTileIndices||[0],targetTileIndex:t.targetTileIndex||null,...t};if(!e||!e.tilemap||!e.layer)return console.error("VaseSpawner: Invalid tilemap layer provided"),0;const i=e.tilemap,a=e.layer;let n=0,r=0;const o=Math.min(a.height,100),l=Math.min(a.width,100);for(let h=0;h<o;h++){for(let t=0;t<l&&!(n>=s.maxVases);t++){const o=i.getTileAt(t,h,!1,a.name);if(o&&void 0!==o.index&&null!==o.index&&0!==o.index){r++;const l=o.width||32,u=o.height||32,d=void 0!==o.pixelX?o.pixelX:t*l,p=void 0!==o.pixelY?o.pixelY:h*u;r<=5&&console.log(`Tile at ${t},${h}: index ${o.index}, pixelX: ${d}, pixelY: ${p}`);let f=!1;if(f=null!==s.targetTileIndex?o.index===s.targetTileIndex:!s.excludeTileIndices.includes(o.index),f&&Math.random()<s.spawnChance){const r=d+l/2+(e.x||0),o=p+u/2+(e.y||0),f=this.createVase(r,o,s.textureKey);if(f&&(f.spawnPosition={x:r,y:o},this.spawnedVases.push(f.spawnPosition),n++,!1!==s.removeTiles))try{i.removeTileAt(t,h,!1,a.name)}catch(c){console.warn("Failed to remove tile:",c)}}}}if(n>=s.maxVases)break}return console.log(`VaseSpawner: Spawned ${n} vases from ${r} tiles checked`),n}createVase(e,t,s="Vase"){try{if(!this.scene||!this.scene.physics||!this.scene.add)return console.error("VaseSpawner: Scene not ready for vase creation"),null;if(!this.scene.textures.exists(s)&&(console.warn(`VaseSpawner: Texture '${s}' does not exist, using default`),s="Vase",!this.scene.textures.exists(s)))return console.error("VaseSpawner: No valid texture available"),null;const i=new XR(this.scene,e,t,s);return i?(this.scene.add.existing(i),i.setVisible(!0),i.setActive(!0),i):(console.error("VaseSpawner: Failed to create vase"),null)}catch(i){return console.error("Error creating vase:",i),null}}setupVaseCollision(e){if(e&&e.active){if(!this.scene.breakableVases){console.warn("VaseSpawner: breakableVases group not found, creating it");try{this.scene.breakableVases=this.scene.physics.add.staticGroup()}catch(t){return void console.error("VaseSpawner: Failed to create breakableVases group:",t)}}try{this.scene.breakableVases&&this.scene.breakableVases.add?(this.scene.breakableVases.add(e),console.log("VaseSpawner: Vase added to collision group")):console.warn("VaseSpawner: breakableVases group has no add method")}catch(t){console.error("VaseSpawner: Error adding vase to collision group:",t)}}else console.warn("VaseSpawner: Invalid vase provided to setupVaseCollision")}setupRespawnTimer(){this.respawnEnabled&&(this.respawnTimer=this.scene.time.addEvent({delay:this.respawnDelay,callback:this.attemptRespawn,callbackScope:this,loop:!0}))}attemptRespawn(){if(!this.respawnEnabled||0===this.spawnedVases.length)return;let e=0;try{e=this.getGroupSize(this.scene.breakableVases)}catch(i){console.warn("VaseSpawner: Error getting current vase count for respawn:",i),e=0}const t=Math.floor(this.maxVases/4);let s=0;for(const a of this.spawnedVases){if(s>=t)break;if(e+s>=this.maxVases)break;let n=null;try{n=this.findVaseAtPosition(a.x,a.y)}catch(i){console.warn("VaseSpawner: Error checking for existing vase:",i)}!n&&Math.random()<this.respawnChance&&this.createVase(a.x,a.y)&&(s++,this.createSpawnEffect(a.x,a.y))}s>0&&console.log(`VaseSpawner: Respawned ${s} vases`)}getGroupSize(e){if(!e)return 0;try{if(e.children){if(void 0!==e.children.size)return e.children.size;if(e.children.entries&&Array.isArray(e.children.entries))return e.children.entries.length;if(e.children.list&&Array.isArray(e.children.list))return e.children.list.length}return void 0!==e.size?e.size:void 0!==e.length?e.length:0}catch(t){return console.warn("VaseSpawner: Error getting group size:",t),0}}findVaseAtPosition(e,t){if(!this.scene.breakableVases)return null;try{const s=this.scene.breakableVases;let i=[];s.children?s.children.entries&&Array.isArray(s.children.entries)?i=s.children.entries:s.children.list&&Array.isArray(s.children.list)&&(i=s.children.list):Array.isArray(s)&&(i=s);for(const a of i)if(a&&a.active&&Phaser.Math.Distance.Between(a.x,a.y,e,t)<32)return a;return null}catch(s){return console.warn("VaseSpawner: Error finding vase at position:",s),null}}createSpawnEffect(e,t){try{const s=this.scene.add.circle(e,t,20,65280,.3);this.scene.tweens.add({targets:s,scale:{from:0,to:1.5},alpha:{from:.5,to:0},duration:500,onComplete:()=>s.destroy()})}catch(s){console.error("Error creating spawn effect:",s)}}destroy(){try{if(this.respawnTimer&&(this.respawnTimer.destroy(),this.respawnTimer=null),this.scene.breakableVases)try{this.scene.breakableVases.clear(!0,!0)}catch(e){console.warn("VaseSpawner: Error clearing breakableVases group:",e)}this.spawnedVases=[],console.log("VaseSpawner: Cleanup completed")}catch(e){console.error("VaseSpawner: Error during destroy:",e)}}getStatistics(){const e=this.getGroupSize(this.scene.breakableVases);return{maxVases:this.maxVases,activeVases:e,totalSpawnPositions:this.spawnedVases.length,respawnEnabled:this.respawnEnabled,spawnChance:this.spawnChance}}}class YR extends qR{constructor(){super("MainMapScene"),Ai(this,"map_Col_1"),Ai(this,"walkingArea_1"),Ai(this,"backGround_1"),Ai(this,"backGround"),Ai(this,"wall_RD_1"),Ai(this,"wall_Upper_1"),Ai(this,"wall_RU_1"),Ai(this,"wall_down_1"),Ai(this,"survive_Zone_1"),Ai(this,"gold_AC_1"),Ai(this,"map"),Ai(this,"bed_1"),Ai(this,"vase_AC_1"),Ai(this,"playerPrefab"),Ai(this,"stoneStatuePrefab"),Ai(this,"stoneStatuePrefab_1"),Ai(this,"stoneStatuePrefab_2"),Ai(this,"stoneStatuePrefab_3"),Ai(this,"torchAnim"),Ai(this,"vase_1"),Ai(this,"mainMap"),this.portals=[],this.activePortal=null,this.portalTimer=null,this.portalActivationInterval=2e4,this.availableScenes=["MiniMapDarkForastScene","MiniMapBossFightScene","MiniMapBeachScene","MiniMapLavaScene"],this.isTeleporting=!1,this.vaseSpawner=null,this.playerLevelSystem=null,this.mobManager=null,this.gameTimer=null,this.gameStartTime=0,this.gameTime=0,this.isGameRunning=!1,this.enemySpawnTimer=null,this.waveTimer=null,this.difficultyTimer=null}initializeMobManager(){try{this.mobManager=new IR(this),this.mobManager.initialize(this.gameManager,this.player),this.walkingArea_1&&this.mobManager.setWalkingAreaFromTilemap(this.walkingArea_1),this.gameplayManager={mobManager:this.mobManager},this.mobManager.startWave(1)}catch(e){console.error("Error initializing MobManager:",e)}}startEnemySpawning(){try{console.log("Starting enemy spawning and game timer..."),this.gameStartTime=Date.now(),this.gameTime=0,this.isGameRunning=!0,this.gameTimer=this.time.addEvent({delay:1e3,callback:()=>{this.isGameRunning&&(this.gameTime=Math.floor((Date.now()-this.gameStartTime)/1e3),this.updateTimerDisplay())},loop:!0}),this.mobManager?(this.mobManager.startWave(1),console.log("Wave 1 started through MobManager")):(console.warn("MobManager not available, starting basic enemy spawning"),this.startBasicEnemySpawning()),kM.emit("timer-start",{gameTime:this.gameTime,currentWave:this.currentWave||1,isGameRunning:!0}),this.waveTimer=this.time.addEvent({delay:3e4,callback:()=>{this.advanceWave()},loop:!0})}catch(e){console.error("Error starting enemy spawning:",e)}}startBasicEnemySpawning(){try{this.enemySpawnTimer=this.time.addEvent({delay:2e3,callback:()=>{console.log("Basic enemy spawn triggered")},loop:!0})}catch(e){console.error("Error in basic enemy spawning:",e)}}ensureEnemyGroups(){var e,t,s;try{console.log("Ensuring enemy groups exist for attack system..."),!this.enemies&&(null==(e=this.gameplayManager)?void 0:e.enemies)?(this.enemies=this.gameplayManager.enemies,console.log("Connected enemies group from gameplayManager")):this.enemies||(this.enemies=this.physics.add.group(),console.log("Created new enemies group")),(null==(s=null==(t=this.gameplayManager)?void 0:t.mobManager)?void 0:s.mobGroup)&&(this.enemies=this.gameplayManager.mobManager.mobGroup,console.log("Connected enemies group to mobManager.mobGroup")),this.zombieGroup||(this.zombieGroup=this.physics.add.group(),console.log("Created zombieGroup")),this.breakableVases||(this.breakableVases=this.physics.add.staticGroup(),console.log("Created breakableVases group")),this.connectAttackSystem(),console.log("Enemy groups setup complete:",{enemies:this.enemies&&this.enemies.children?this.enemies.children.size:"No enemies group",zombieGroup:this.zombieGroup&&this.zombieGroup.children?this.zombieGroup.children.size:"No zombie group",breakableVases:this.breakableVases&&this.breakableVases.children?this.breakableVases.children.size:"No vases group"})}catch(i){console.error("Error ensuring enemy groups:",i)}}updateTimerDisplay(){try{const e=Math.floor(this.gameTime/60),t=this.gameTime%60,s=`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`;kM.emit("timer-updated",{gameTime:this.gameTime,formattedTime:s,currentWave:this.currentWave||1,isGameRunning:this.isGameRunning})}catch(e){console.error("Error updating timer display:",e)}}initializeUIManager(){try{this.uiManager=new kR(this),this.uiManager.initialize(),window.currentGameScene=this,this.currentWave=1}catch(e){console.error("Error initializing UIManager:",e)}}editorCreate(){const e=this.add.tilemap("mainMap");e.addTilesetImage("golden monument anim-going up-packed sheet","golden monument anim-going up-packed sheet"),e.addTilesetImage("Fire-candelabrum","Fire-candelabrum"),e.addTilesetImage("side way-Sheet","side way-Sheet"),e.addTilesetImage("Tileset 3","Tileset 3"),e.addTilesetImage("Wall_3","Wall_3"),e.addTilesetImage("rock pillars coming from darkness-bg_2","rock pillars coming from darkness-bg_2"),e.addTilesetImage("Crystals1-improved refraction_11","Crystals1-improved refraction_11"),e.addTilesetImage("Crystals1-improved refraction_6","Crystals1-improved refraction_6"),e.addTilesetImage("Crystals1-improved refraction_8","Crystals1-improved refraction_8"),e.addTilesetImage("Survive_Zone","Survive_Zone"),e.addTilesetImage("statues-far from platforms-bg_4","statues-far from platforms-bg_4"),e.addTilesetImage("statues-far from platforms-bg_2","statues-far from platforms-bg_2"),e.addTilesetImage("statues-far from platforms-bg_1","statues-far from platforms-bg_1"),e.addTilesetImage("statues-far from platforms-bg_0","statues-far from platforms-bg_0"),e.addTilesetImage("statues-far from platforms-bg_5","statues-far from platforms-bg_5"),e.addTilesetImage("Gold","Gold"),e.addTilesetImage("Bed","Bed"),e.addTilesetImage("Atlas-props","Atlas-props"),e.addTilesetImage("platform2","platform2"),e.addTilesetImage("platform1","platform1"),e.addTilesetImage("lavafal-for Tiled-spritesheet-16frames","lavafal-for Tiled-spritesheet-16frames");const t=e.createLayer("Map_Col",["Bed"],0,0),s=e.createLayer("WalkingArea",["Tileset 3"],-18,8),i=e.createLayer("BackGround",["Wall_3"],-18,8),a=e.createLayer("BackGround_1",["lavafal-for Tiled-spritesheet-16frames"],0,0),n=e.createLayer("Wall_RD",["Tileset 3"],-18,-20),r=e.createLayer("Wall_Upper",["Tileset 3"],12,12),o=e.createLayer("Wall_RU",["Tileset 3"],-18,-20),l=e.createLayer("Wall_down",["Tileset 3"],-18,12),c=e.createLayer("Survive_Zone",["Survive_Zone"],-18,8),h=e.createLayer("Gold_AC",["Gold"],-18,-24),u=e.createLayer("Map_",["platform1","platform2"],0,0),d=e.createLayer("Bed",["Bed"],0,0),p=e.createLayer("Vase_AC",["Atlas-props"],-18,8),f=new KR(this,900,100);this.add.existing(f);const m=new ZR(this,944,869);this.add.existing(m);const g=new ZR(this,944,1417);this.add.existing(g);const y=new ZR(this,1592,1417);this.add.existing(y);const b=new ZR(this,1592,869);this.add.existing(b);const v=this.add.sprite(734,1993,"Fire-candelabrum",0);v.play("TorchAnim"),this.add.sprite(1253,1993,"Fire-candelabrum",0).play("TorchAnim"),this.add.sprite(1799,1993,"Fire-candelabrum",0).play("TorchAnim"),this.add.sprite(2017,1737,"Fire-candelabrum",0).play("TorchAnim"),this.add.sprite(2017,1231,"Fire-candelabrum",0).play("TorchAnim"),this.add.sprite(2017,656,"Fire-candelabrum",0).play("TorchAnim"),this.add.sprite(514,1737,"Fire-candelabrum",0).play("TorchAnim"),this.add.sprite(514,1231,"Fire-candelabrum",0).play("TorchAnim"),this.add.sprite(514,656,"Fire-candelabrum",0).play("TorchAnim"),this.add.sprite(770,485,"Fire-candelabrum",0).play("TorchAnim"),this.add.sprite(1283,485,"Fire-candelabrum",0).play("TorchAnim"),this.add.sprite(1831,485,"Fire-candelabrum",0).play("TorchAnim"),this.add.sprite(72,57,"golden monument anim-going up-packed sheet",53).play("TelAnimation"),this.add.sprite(2482,57,"golden monument anim-going up-packed sheet",53).play("TelAnimation"),this.add.sprite(2482,2420,"golden monument anim-going up-packed sheet",53).play("TelAnimation"),this.add.sprite(72,2420,"golden monument anim-going up-packed sheet",53).play("TelAnimation");const w=e.createLayer("Vase",["Atlas-props"],0,0);w.setVisible(!1),this.map_Col_1=t,this.walkingArea_1=s,this.backGround_1=i,this.backGround=a,this.wall_RD_1=n,this.wall_Upper_1=r,this.wall_RU_1=o,this.wall_down_1=l,this.survive_Zone_1=c,this.gold_AC_1=h,this.map=u,this.bed_1=d,this.vase_AC_1=p,this.playerPrefab=f,this.stoneStatuePrefab=m,this.stoneStatuePrefab_1=g,this.stoneStatuePrefab_2=y,this.stoneStatuePrefab_3=b,this.torchAnim=v,this.vase_1=w,this.mainMap=e,this.events.emit("scene-awake")}create(){var e;this.cameras.main.setBounds(0,0,2560,2560),this.physics.world.bounds.width=2560,this.physics.world.bounds.height=2560;try{super.create(),this.editorCreate(),this.setupCollisions(),this.player=this.playerPrefab,this.initializeManagers(),(null==(e=this.gameplayManager)?void 0:e.mobManager)&&this.walkingArea_1&&this.gameplayManager.mobManager.setWalkingAreaFromTilemap(this.walkingArea_1),this.setupPlayerAttack(),this.setupPortalSystem(),this.setupTestControls(),this.setupZombieCollisionSystem(),this.setupHPBarIntegration(),this.setupPlayerLevelSystem(),this.setupVaseSpawning(),this.initializeUIManager(),this.initializeMobManager(),this.ensureEnemyGroups(),this.startEnemySpawning()}catch(t){console.error("Error in MainMapScene create:",t)}}connectAttackSystem(){try{console.log("Connecting attack system to enemy groups..."),this.playerAttackSystem?(this.playerAttackSystem.scene=this,console.log("Attack system connected. Available groups:",{enemies:this.enemies&&this.enemies.children?this.enemies.children.size:"No enemies group",breakableVases:this.breakableVases&&this.breakableVases.children?this.breakableVases.children.size:"No vases group",zombieGroup:this.zombieGroup&&this.zombieGroup.children?this.zombieGroup.children.size:"No zombie group"})):console.warn("PlayerAttack system not yet created")}catch(e){console.error("Error connecting attack system:",e)}}advanceWave(){this.currentWave=(this.currentWave||1)+1,this.uiManager&&this.uiManager.updateScoreboard(),this.showWaveNotification(),kM.emit("wave-notification",{wave:this.currentWave}),kM.emit("wave-updated",{wave:this.currentWave})}showWaveNotification(){if(!this.cameras||!this.cameras.main)return;const e=this.cameras.main.centerX,t=this.cameras.main.centerY,s=this.add.text(e,t-50,`WAVE ${this.currentWave}`,{fontFamily:"Arial",fontSize:"48px",color:"#FFD700",stroke:"#000000",strokeThickness:4,fontStyle:"bold"});s.setOrigin(.5),s.setScrollFactor(0),s.setDepth(1e3),this.tweens.add({targets:s,scale:{from:0,to:1.2},alpha:{from:0,to:1},duration:500,ease:"Back.easeOut",onComplete:()=>{this.time.delayedCall(1500,(()=>{this.tweens.add({targets:s,alpha:0,scale:.8,duration:800,onComplete:()=>s.destroy()})}))}})}setupPortalSystem(){try{const e=[this.children.getByName?this.children.getByName("telAnimation"):null,this.children.getByName?this.children.getByName("telAnimation_1"):null,this.children.getByName?this.children.getByName("telAnimation_2"):null,this.children.getByName?this.children.getByName("telAnimation_3"):null];if(!e[0]){const t=this.children.list.filter((e=>e&&e instanceof Phaser.GameObjects.Sprite&&e.texture&&"golden monument anim-going up-packed sheet"===e.texture.key));e[0]=t.find((e=>e&&Math.abs(e.x-72)<10&&Math.abs(e.y-57)<10)),e[1]=t.find((e=>e&&Math.abs(e.x-2482)<10&&Math.abs(e.y-57)<10)),e[2]=t.find((e=>e&&Math.abs(e.x-2482)<10&&Math.abs(e.y-2420)<10)),e[3]=t.find((e=>e&&Math.abs(e.x-72)<10&&Math.abs(e.y-2420)<10))}[{x:72,y:57,sprite:e[0]},{x:2482,y:57,sprite:e[1]},{x:2482,y:2420,sprite:e[2]},{x:72,y:2420,sprite:e[3]}].forEach(((e,t)=>{const s=this.add.zone(e.x,e.y,100,100);this.physics.world.enable(s),s.body.setImmovable(!0);const i={id:t,zone:s,sprite:e.sprite,x:e.x,y:e.y,isActive:!1,originalTint:16777215,activeTint:65280,glowEffect:null};this.portals.push(i),this.deactivatePortal(i)})),this.startPortalTimer()}catch(e){console.error("Error setting up portal system:",e)}}startPortalTimer(){this.portalTimer&&this.portalTimer.destroy(),this.portalTimer=this.time.addEvent({delay:this.portalActivationInterval,callback:this.activateRandomPortal,callbackScope:this,loop:!0})}activateRandomPortal(){try{if(this.scene&&!this.scene.isActive())return;if(this.isTeleporting)return;this.activePortal&&this.deactivatePortal(this.activePortal);const e=Math.floor(Math.random()*this.portals.length),t=this.portals[e],s=Math.floor(Math.random()*this.availableScenes.length),i=this.availableScenes[s];this.activatePortal(t,i),this.showPortalNotification(t,i)}catch(e){console.error("Error activating random portal:",e)}}activatePortal(e,t){try{if(!e||!this.scene||!this.scene.isActive())return;e.isActive=!0,e.destinationScene=t,this.activePortal=e,e.sprite&&e.sprite.active&&e.sprite.scene&&e.sprite.setTint(e.activeTint);const s=this.add.circle(e.x,e.y,60,65280,.3);e.sprite&&e.sprite.active&&s.setDepth(e.sprite.depth-1),e.glowEffect=s;const i=e.sprite&&e.sprite.active&&e.sprite.scene?[e.sprite,s]:[s],a=this.tweens.add({targets:i,alpha:{from:1,to:.7},duration:1e3,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"});e.activeTween=a,this.player&&this.player.active&&(e.overlapHandler=this.physics.add.overlap(this.player,e.zone,((t,s)=>{this.handlePortalCollision(e)})))}catch(s){console.error("Error activating portal:",s)}}deactivatePortal(e){try{if(!e)return;e.isActive=!1,e.destinationScene=null,e.sprite&&e.sprite.active&&e.sprite.scene&&(e.sprite.setTint(e.originalTint),e.sprite.setScale(1),e.sprite.setAlpha(1)),e.glowEffect&&e.glowEffect.active&&(e.glowEffect.destroy(),e.glowEffect=null),e.activeTween&&this.tweens&&(this.tweens.remove(e.activeTween),e.activeTween=null),e.overlapHandler&&this.physics&&this.physics.world&&(this.physics.world.removeCollider(e.overlapHandler),e.overlapHandler=null)}catch(t){console.error("Error deactivating portal:",t)}}handlePortalCollision(e){if(!e||!e.isActive||this.isTeleporting||!e.destinationScene)return;if(!this.scene||!this.scene.isActive())return;const t=e.destinationScene;if(this.isTeleporting=!0,this.player&&this.player.active&&"function"==typeof this.createTeleportEffect&&this.createTeleportEffect(this.player.x,this.player.y),this.gameManager&&"function"==typeof this.gameManager.saveGame)try{this.gameManager.saveGame()}catch(s){console.warn("Error saving game:",s)}this.cleanupBeforePortalTeleport(),this.time.delayedCall(500,(()=>{if(this.scene&&this.scene.isActive())try{t&&this.scene.manager&&this.scene.manager.keys&&this.scene.manager.keys[t]?this.scene.start(t):this.scene.start("MainMapScene")}catch(e){console.error("Error switching scenes:",e),this.isTeleporting=!1}})),this.deactivatePortal(e),this.activePortal=null}cleanupBeforePortalTeleport(){try{["enemySpawnTimer","waveTimer","difficultyTimer","portalTimer"].forEach((e=>{this[e]&&void 0!==this[e].hasDispatched&&!this[e].hasDispatched&&(this[e].destroy(),this[e]=null)})),[{obj:this.gameplayManager,prop:"enemies"},{obj:this.gameplayManager,prop:"expOrbs"},{obj:this,prop:"enemies"},{obj:this,prop:"zombieGroup"},{obj:this,prop:"experienceOrbs"}].forEach((({obj:e,prop:t})=>{e&&e[t]&&e[t].active&&"function"==typeof e[t].clear&&e[t].clear(!0,!0)})),this.currentWave=0,this.isWaveActive=!1,this.waveEnemiesRemaining=0,this.enemiesKilled=0}catch(e){console.error("Error during portal teleport cleanup:",e)}}showPortalNotification(e,t){try{if(!this.cameras||!this.cameras.main)return;const e=this.cameras.main.centerX,t=this.cameras.main.centerY,s=this.add.text(e,t,"PORTAL ACTIVATED!",{fontFamily:"Arial",fontSize:"32px",color:"#00ff00",stroke:"#000000",strokeThickness:3,fontStyle:"bold"});s.setOrigin(.5),s.setScrollFactor(0),s.setDepth(1e3),this.tweens.add({targets:s,scale:{from:0,to:1},alpha:{from:0,to:1},duration:500,ease:"Back.easeOut",onComplete:()=>{this.time&&s.active&&this.time.delayedCall(2e3,(()=>{s.active&&this.tweens&&this.tweens.add({targets:s,alpha:0,duration:800,onComplete:()=>{s.active&&s.destroy()}})}))}})}catch(s){console.error("Error showing portal notification:",s)}}setupZombieCollisionSystem(){try{this.map_Col_1&&this.registerCollisionLayer(this.map_Col_1,"Map Collision"),this.backGround&&this.registerCollisionLayer(this.backGround,"Background Collision"),[this.stoneStatuePrefab,this.stoneStatuePrefab_1,this.stoneStatuePrefab_2,this.stoneStatuePrefab_3].forEach(((e,t)=>{e&&e.active&&this.registerStaticObstacle(e,`Stone Statue ${t+1}`)})),"function"==typeof this.setupZombieObstacleCollisions&&this.setupZombieObstacleCollisions()}catch(e){console.error("Error setting up zombie collision system:",e)}}setupCollisions(){try{[this.stoneStatuePrefab,this.stoneStatuePrefab_1,this.stoneStatuePrefab_2,this.stoneStatuePrefab_3].forEach((e=>{e&&e.active&&"function"==typeof e.setupCollision&&this.playerPrefab&&e.setupCollision(this.playerPrefab)})),this.playerPrefab&&this.map_Col_1&&(this.physics.add.collider(this.playerPrefab,this.map_Col_1),this.map_Col_1.setCollisionBetween(0,1e4)),this.playerPrefab&&this.backGround&&(this.physics.add.collider(this.playerPrefab,this.backGround),this.backGround.setCollisionBetween(0,1e4))}catch(e){console.error("Error setting up player collisions:",e)}}setupTestControls(){try{"function"==typeof super.setupTestControls&&super.setupTestControls(),this.input&&this.input.keyboard&&(this.input.keyboard.on("keydown-P",(()=>{this.gameManager&&this.gameManager.debugMode&&this.activateRandomPortal()})),this.input.keyboard.on("keydown-O",(()=>{this.gameManager&&this.gameManager.debugMode&&this.portals.forEach(((e,t)=>{console.log(`Portal ${t}: Active = ${e.isActive}, Destination = ${e.destinationScene||"None"}`)}))})),this.input.keyboard.on("keydown-V",(()=>{if(this.gameManager&&this.gameManager.debugMode&&this.vaseSpawner){const e=this.vaseSpawner.getStatistics();console.log("=== VASE STATISTICS ==="),console.log(`Active vases: ${e.activeVases}/${e.maxVases}`),console.log(`Spawn positions: ${e.totalSpawnPositions}`),console.log(`Spawn chance: ${e.spawnChance}`),console.log(`Respawn enabled: ${e.respawnEnabled}`)}})),this.input.keyboard.on("keydown-B",(()=>{this.gameManager&&this.gameManager.debugMode&&this.vaseSpawner&&this.player&&this.vaseSpawner.createVase(this.player.x+50,this.player.y+50,"Vase")&&console.log("Spawned test vase near player")})),this.input.keyboard.on("keydown-E",(()=>{this.gameManager&&this.gameManager.debugMode&&this.playerLevelSystem&&this.playerLevelSystem.addExperience(50)})),this.input.keyboard.on("keydown-G",(()=>{this.gameManager&&this.gameManager.debugMode&&this.gameManager.addGold(100)})),this.input.keyboard.on("keydown-T",(()=>{this.gameManager&&this.gameManager.debugMode&&kM.emit("timer-reset")})),this.input.keyboard.on("keydown-Y",(()=>{this.gameManager&&this.gameManager.debugMode&&kM.emit("timer-start")})),this.input.keyboard.on("keydown-U",(()=>{this.gameManager&&this.gameManager.debugMode&&kM.emit("timer-stop")})),this.input.keyboard.on("keydown-PLUS",(()=>{this.gameManager&&this.gameManager.debugMode&&window.timerControls&&window.timerControls.advanceWave()})),this.input.keyboard.on("keydown-MINUS",(()=>{if(this.gameManager&&this.gameManager.debugMode&&window.timerControls){const e=window.timerControls.getState(),t=Math.max(1,e.currentWave-1);window.timerControls.setWave(t)}})),this.input.keyboard.on("keydown-N",(()=>{this.gameManager&&this.gameManager.debugMode&&(console.log("Testing wave notification..."),kM.emit("wave-notification",{wave:99}))})),this.input.keyboard.on("keydown-X",(()=>{this.gameManager&&this.gameManager.debugMode&&(console.log("Testing vase breaking..."),this.testVaseBreaking())})),this.input.keyboard.on("keydown-Z",(()=>{this.gameManager&&this.gameManager.debugMode&&(console.log("Testing attack system..."),this.testAttackSystem())})),this.input.keyboard.on("keydown-F1",(()=>{this.gameManager&&this.gameManager.debugMode&&(console.log("=== DEBUG CONTROLS ==="),console.log("~ - Toggle debug mode"),console.log("P - Activate random portal"),console.log("V - Show vase statistics"),console.log("B - Spawn test vase near player"),console.log("X - Test vase breaking"),console.log("Z - Test attack system"),console.log("E - Add experience"),console.log("G - Add gold"),console.log("T - Reset timer | Y - Start timer | U - Stop timer"),console.log("N - Test wave notification"),console.log("F1 - Show this help"))})))}catch(e){console.error("Error setting up portal test controls:",e)}}testVaseBreaking(){try{if(console.log("=== TESTING VASE BREAKING ==="),!this.breakableVases)return void console.error("No breakableVases group found!");const e=this.breakableVases.getChildren();if(console.log(`Found ${e.length} vases`),e.length>0){const t=e[0];console.log("Testing vase:",t),console.log("Vase has onPlayerAttack method:",typeof t.onPlayerAttack),t.onPlayerAttack?(t.onPlayerAttack(999),console.log("Called onPlayerAttack on test vase")):console.error("Vase does not have onPlayerAttack method!")}else console.warn("No vases available to test")}catch(e){console.error("Error testing vase breaking:",e)}}testAttackSystem(){try{if(console.log("=== TESTING ATTACK SYSTEM ==="),!this.playerAttackSystem)return void console.error("No playerAttackSystem found!");if(console.log("PlayerAttack system exists"),console.log("Scene groups available:",{enemies:!!this.enemies,breakableVases:!!this.breakableVases,zombieGroup:!!this.zombieGroup}),this.playerAttackSystem.findEnemiesInSlashRange){const e=this.playerAttackSystem.findEnemiesInSlashRange();console.log(`Found ${e.length} targets in slash range`),e.forEach(((e,t)=>{console.log(`Target ${t}:`,{isVase:e.isVase,distance:e.distance,enemy:e.enemy})})),e.length>0&&(console.log("Triggering manual slash attack..."),this.playerAttackSystem.slashAttack(e))}else console.error("findEnemiesInSlashRange method not found!")}catch(e){console.error("Error testing attack system:",e)}}trackEnemyKill(e){if("function"==typeof this.removeZombie&&this.removeZombie(e),"function"==typeof super.trackEnemyKill&&super.trackEnemyKill(e),this.playerLevelSystem&&this.playerLevelSystem.addExperience(10),this.gameManager){const e=Math.floor(5*Math.random())+2;this.gameManager.addGold(e)}this.enemiesKilled=(this.enemiesKilled||0)+1,this.enemiesKilled%10==0&&this.advanceWave()}update(e,t){"function"==typeof super.update&&super.update(e,t);try{this.player&&this.player.active&&!this.player.isDead&&this.cameras&&this.cameras.main&&this.cameras.main.startFollow(this.player,!0,.1,.1),this.uiManager&&this.uiManager.isInitialized&&this.uiManager.update(e,t),this.mobManager&&this.mobManager.update(e,t)}catch(s){console.error("Error in MainMapScene update:",s)}}shutdown(){try{this.isGameRunning=!1,["portalTimer","gameTimer","enemySpawnTimer","waveTimer","difficultyTimer"].forEach((e=>{this[e]&&!this[e].hasDispatched&&(this[e].destroy(),this[e]=null)})),kM.emit("timer-stop"),this.portalTimer&&!this.portalTimer.hasDispatched&&(this.portalTimer.destroy(),this.portalTimer=null),this.portals.forEach((e=>{this.deactivatePortal(e)})),this.portals=[],this.activePortal=null,this.isTeleporting=!1,this.playerLevelSystem&&(this.playerLevelSystem.destroy(),this.playerLevelSystem=null,console.log("Player Level System cleaned up")),kM.removeListener("request-initial-gold"),kM.removeListener("main-scene-started"),kM.removeListener("wave-updated"),kM.emit("timer-stop"),this.uiManager&&(this.uiManager.shutdown(),this.uiManager=null),this.mobManager&&(this.mobManager.shutdown(),this.mobManager=null),window.currentGameScene===this&&delete window.currentGameScene,"function"==typeof super.shutdown&&super.shutdown()}catch(e){console.error("Error in MainMapScene shutdown:",e)}}setupVaseSpawning(){try{if(console.log("Setting up vase spawning..."),!this.physics||!this.add)return void console.error("Scene not ready for vase spawning");if(!this.textures.exists("Vase"))return void console.error("Vase texture not loaded, skipping vase spawning");if(this.vaseSpawner=new $R(this),this.vase_1){const e=this.vase_1.tilemap;for(let s=0;s<Math.min(10,this.vase_1.layer.height);s++)for(let t=0;t<Math.min(10,this.vase_1.layer.width);t++)e.getTileAt(t,s,!1,this.vase_1.layer.name);const t=this.vaseSpawner.spawnVasesOnTilemap(this.vase_1,{spawnChance:1,maxVases:500,textureKey:"Vase",targetTileIndex:null,excludeTileIndices:[0],removeTiles:!1});console.log(`Successfully spawned ${t} vases`)}else console.error("vase_1 layer not found!");this.setupVaseAttackCollision()}catch(e){console.error("Error setting up vase spawning:",e)}}setupVaseAttackCollision(){try{this.gameManager&&this.gameManager.debugMode&&this.input.on("pointerdown",(e=>{this.breakableVases&&this.breakableVases.children.entries.forEach((t=>{t.active&&t.getBounds().contains(e.worldX,e.worldY)&&t.onPlayerAttack(1)}))}))}catch(e){console.error("Error setting up vase attack collision:",e)}}setupHPBarIntegration(){this.player&&(this.player.health&&this.player.maxHealth||(console.warn("Player missing HP values, applying emergency defaults"),this.player.health=100,this.player.maxHealth=100)),this.updateHPBar(),this.updateGoldDisplay(),this.time.delayedCall(100,(()=>{this.updateGoldDisplay()})),kM.on("request-initial-gold",(()=>{this.time.delayedCall(50,(()=>{this.updateGoldDisplay()}))})),kM.on("main-scene-started",(()=>{this.time.delayedCall(200,(()=>{this.updateGoldDisplay()}))}))}setupPlayerLevelSystem(){try{this.playerLevelSystem=new xR(this,10,50),this.playerLevelSystem.level=1,this.playerLevelSystem.experience=0,this.playerLevelSystem.nextLevelExp=100,this.playerLevelSystem.updateText(),this.playerLevelSystem.updateExpBar(),this.gameManager&&this.gameManager.debugMode&&this.time.addEvent({delay:5e3,callback:()=>{this.playerLevelSystem&&this.playerLevelSystem.addExperience(25)},loop:!0})}catch(e){console.error("Error setting up Player Level System:",e)}}playerTakeDamage(e){this.player&&(this.player.health=Math.max(0,this.player.health-e),this.updateHPBar(),this.player.setTint&&(this.player.setTint(16711680),this.time.delayedCall(100,(()=>{this.player&&this.player.clearTint&&this.player.clearTint()}))),this.player.health<=0&&this.handlePlayerDeath())}playerHeal(e){this.player&&(this.player.health=Math.min(this.player.maxHealth,this.player.health+e),this.updateHPBar(),this.player.setTint&&(this.player.setTint(65280),this.time.delayedCall(100,(()=>{this.player&&this.player.clearTint&&this.player.clearTint()}))))}updateHPBar(){if(!this.player)return;const e={currentHP:this.player.health||100,maxHP:this.player.maxHealth||100,health:this.player.health||100,maxHealth:this.player.maxHealth||100};kM.emit("player-health-updated",e)}updateGoldDisplay(){const e=this.gameManager?this.gameManager.getGold():500,t={gold:e,totalGold:e,currentGold:e};kM.emit("player-gold-updated",t),kM.emit("player-stats-updated",t)}handlePlayerDeath(){this.player&&this.player.setAlpha&&this.player.setAlpha(.5),this.time.delayedCall(2e3,(()=>{this.player.health=this.player.maxHealth,this.player&&this.player.setAlpha&&this.player.setAlpha(1),this.updateHPBar()}))}}class eD extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t??1125,s??954,i||"animated lamp posts-4",a??0),this.play("LampPostsAnimation1animated lamp posts"),e.add.existing(this),e.physics.add.existing(this,!1),this.body.allowGravity=!1,this.body.setSize(40,10),this.body.setOffset(15,75),this.body.moves=!1,this.body.immovable=!0,this.isLampInvisible=!1,this.isPlayerInvisible=!1,this.lampTop=this.y-45,this.lampBottom=this.y+20,e.events.on("update",(()=>{if(!this.player)return;const t=Math.abs(this.player.x-(this.x+this.body.offset.x-20))<45;this.player.y>this.lampTop&&this.player.y<this.lampBottom&&t?(this.isLampInvisible||e.tweens.add({targets:this,alpha:.4,duration:200,ease:"Power1",onComplete:()=>{this.isLampInvisible=!0}}),this.isPlayerInvisible||e.tweens.add({targets:this.player,alpha:.3,duration:200,ease:"Power1",onComplete:()=>{this.isPlayerInvisible=!0}})):(this.isLampInvisible&&e.tweens.add({targets:this,alpha:1,duration:200,ease:"Power1",onComplete:()=>{this.isLampInvisible=!1}}),this.isPlayerInvisible&&e.tweens.add({targets:this.player,alpha:1,duration:200,ease:"Power1",onComplete:()=>{this.isPlayerInvisible=!1}}))}))}setupCollision(e){this.scene&&e&&(this.scene.physics.add.collider(e,this,null,null,this),this.player=e)}destroy(){this.scene&&this.scene.events.off("update"),super.destroy()}}class tD extends qR{constructor(){super("MiniMapDarkForastScene"),Ai(this,"tile_Layer"),Ai(this,"road_1"),Ai(this,"tall_Grass_1"),Ai(this,"rampt_1"),Ai(this,"base_1"),Ai(this,"scrift_1"),Ai(this,"pad_1"),Ai(this,"cliff_1"),Ai(this,"tree"),Ai(this,"tree_1"),Ai(this,"tree_2"),Ai(this,"river_1"),Ai(this,"playerPrefab"),Ai(this,"shrine_1"),Ai(this,"lampPrefab"),Ai(this,"lampPrefab_1"),Ai(this,"lampPrefab_2"),Ai(this,"lampPrefab_3"),Ai(this,"lampPrefab_4"),Ai(this,"lampPrefab_5"),Ai(this,"telAnimation"),Ai(this,"miniMapDarkForast")}editorCreate(){const e=this.add.tilemap("MiniMapDarkForast");e.addTilesetImage("Tree_pattern","Tree_pattern"),e.addTilesetImage("GroundTileset_V02","GroundTileset_V02"),e.addTilesetImage("AncientScript_V01-Sheet","AncientScript_V01-Sheet"),e.addTilesetImage("shrine-buff available animation-295x311","shrine-buff available animation-295x311"),e.addTilesetImage("animated lamp posts-4","animated lamp posts-4"),e.addTilesetImage("animated lamp posts-5","animated lamp posts-5"),e.addTilesetImage("stronghold - embranchment section","stronghold - embranchment section"),e.addTilesetImage("Lift_Platform","Lift_Platform"),e.addTilesetImage("golden monument anim-going up-packed sheet","golden monument anim-going up-packed sheet"),e.addTilesetImage("carriage - no tent","carriage - no tent"),e.addTilesetImage("bone - big - 2","bone - big - 2"),e.addTilesetImage("bone - big - 1","bone - big - 1"),e.addTilesetImage("RiverShallowSheet_v01","RiverShallowSheet_v01"),e.addTilesetImage("tree - color scheme 1 - 2","tree - color scheme 1 - 2"),e.addTilesetImage("tree - color scheme 1 - 1","tree - color scheme 1 - 1"),e.addTilesetImage("tree - color scheme 4 - 1","tree - color scheme 4 - 1"),e.addTilesetImage("tree - color scheme 5 - 1","tree - color scheme 5 - 1"),e.addTilesetImage("tree - naked 1","tree - naked 1");const t=e.createLayer("Tile Layer 2",["GroundTileset_V02"],0,0),s=e.createLayer("Road",["GroundTileset_V02"],0,0),i=e.createLayer("Tall Grass",["GroundTileset_V02"],0,0),a=e.createLayer("Rampt",["GroundTileset_V02"],0,0),n=e.createLayer("Base",["GroundTileset_V02","AncientScript_V01-Sheet"],0,0),r=e.createLayer("Scrift",["AncientScript_V01-Sheet"],0,0),o=e.createLayer("Pad",["Lift_Platform"],16,4),l=e.createLayer("Cliff",["GroundTileset_V02"],0,0),c=e.createLayer("Tree",["tree - color scheme 4 - 1","tree - color scheme 1 - 2","tree - color scheme 1 - 1","Tree_pattern","tree - naked 1"],0,0),h=e.createLayer("Tree",["tree - color scheme 4 - 1","tree - color scheme 1 - 2","tree - color scheme 1 - 1","Tree_pattern","tree - naked 1"],0,0),u=e.createLayer("Tree",["tree - color scheme 4 - 1","tree - color scheme 1 - 2","tree - color scheme 1 - 1","Tree_pattern","tree - naked 1"],0,0),d=e.createLayer("River",["RiverShallowSheet_v01"],0,0),p=new KR(this,1180,715);this.add.existing(p);const f=e.createLayer("Shrine",["shrine-buff available animation-295x311"],0,0);this.add.image(266,243,"tree - color scheme 5 - 1",0),this.add.image(85,590,"tree - color scheme 5 - 1",0),this.add.image(72,2066,"tree - color scheme 5 - 1",0),this.add.image(183,965,"tree - color scheme 5 - 1",0);const m=new eD(this,654,758);this.add.existing(m),m.flipX=!0,m.flipY=!1;const g=new eD(this,654,927);this.add.existing(g),g.flipX=!0,g.flipY=!1;const y=new eD(this,1404,1558);this.add.existing(y);const b=new eD(this,1185,1558);this.add.existing(b),b.flipX=!0,b.flipY=!1;const v=new eD(this,1906,896);this.add.existing(v);const w=new eD(this,1906,759);this.add.existing(w);const x=this.add.sprite(1263,393,"golden monument anim-going up-packed sheet",53);x.play("TelAnimation"),this.tile_Layer=t,this.road_1=s,this.tall_Grass_1=i,this.rampt_1=a,this.base_1=n,this.scrift_1=r,this.pad_1=o,this.cliff_1=l,this.tree=c,this.tree_1=h,this.tree_2=u,this.river_1=d,this.playerPrefab=p,this.shrine_1=f,this.lampPrefab=m,this.lampPrefab_1=g,this.lampPrefab_2=y,this.lampPrefab_3=b,this.lampPrefab_4=v,this.lampPrefab_5=w,this.telAnimation=x,this.miniMapDarkForast=e,this.events.emit("scene-awake")}preload(){super.preload()}create(){this.cameras.main.setBounds(0,0,2560,2560),this.physics.world.bounds.width=2560,this.physics.world.bounds.height=2560;try{this.editorCreate(),super.create(),this.setupCollisions(),this.player=this.playerPrefab,this.initializeManagers(),this.setupPlayerAttack(),this.setupTestControls(),this.setupZombieCollisionSystem(),this.startEnemySpawning()}catch(e){console.error("Error in MiniMapDarkForastScene create:",e)}}setupCollisions(){try{this.lampPrefab&&this.lampPrefab.setupCollision(this.playerPrefab),this.lampPrefab_1&&this.lampPrefab_1.setupCollision(this.playerPrefab),this.lampPrefab_2&&this.lampPrefab_2.setupCollision(this.playerPrefab),this.lampPrefab_3&&this.lampPrefab_3.setupCollision(this.playerPrefab),this.lampPrefab_4&&this.lampPrefab_4.setupCollision(this.playerPrefab),this.lampPrefab_5&&this.lampPrefab_5.setupCollision(this.playerPrefab),this.cliff_1&&(this.physics.add.collider(this.playerPrefab,this.cliff_1),this.cliff_1.setCollisionBetween(0,1e4)),this.rampt_1&&(this.physics.add.collider(this.playerPrefab,this.rampt_1),this.rampt_1.setCollisionBetween(0,1e4)),this.base_1&&(this.physics.add.collider(this.playerPrefab,this.base_1),this.base_1.setCollisionBetween(0,1e4))}catch(e){console.error("Error setting up dark forest collisions:",e)}}setupZombieCollisionSystem(){try{this.cliff_1&&this.registerCollisionLayer(this.cliff_1,"Cliff Collision"),this.rampt_1&&this.registerCollisionLayer(this.rampt_1,"Ramp Collision"),this.base_1&&this.registerCollisionLayer(this.base_1,"Base Collision"),[this.lampPrefab,this.lampPrefab_1,this.lampPrefab_2,this.lampPrefab_3,this.lampPrefab_4,this.lampPrefab_5].forEach(((e,t)=>{e&&this.registerStaticObstacle(e,`Forest Lamp ${t+1}`)})),this.setupZombieObstacleCollisions()}catch(e){console.error("Error setting up dark forest zombie collision system:",e)}}trackEnemyKill(e){this.removeZombie(e),super.trackEnemyKill(e)}update(e,t){super.update(e,t);try{this.player&&!this.player.isDead&&this.cameras.main.startFollow(this.player,!0,.1,.1)}catch(s){console.error("Error in MiniMapDarkForastScene update:",s)}}shutdown(){super.shutdown()}}class sD extends qR{constructor(){super("MiniMapBossFightScene"),Ai(this,"floor_1"),Ai(this,"bg_1"),Ai(this,"lava_floor_1"),Ai(this,"fire_animation_1"),Ai(this,"floating_plat_form_Chain_1"),Ai(this,"floating_plat_form_Floating_Col_1"),Ai(this,"floating_plat_form_Floatind_platform_1"),Ai(this,"gate_1"),Ai(this,"wall_wall_bottom_1"),Ai(this,"lift_1"),Ai(this,"floating_plat_form_Chain_shadow_1"),Ai(this,"wall_Wall_side_1"),Ai(this,"pillar_1"),Ai(this,"decoration_1"),Ai(this,"stoneStatuePrefab_1"),Ai(this,"stoneStatuePrefab"),Ai(this,"telAnimation"),Ai(this,"playerPrefab"),Ai(this,"miniMapBossFight")}editorCreate(){const e=this.add.tilemap("MiniMapBossFight");e.addTilesetImage("Tileset 4 - transp","Tileset 4"),e.addTilesetImage("Tileset 2","Tileset 2"),e.addTilesetImage("pillars-bg_5","pillars-bg_5"),e.addTilesetImage("pillars-bg_0","pillars-bg_0"),e.addTilesetImage("floor","floor"),e.addTilesetImage("Decor corner","Decor corner"),e.addTilesetImage("TorchBowlRegular_V01-Sheet","TorchBowlRegular_V01-Sheet"),e.addTilesetImage("side way-Sheet","side way-Sheet"),e.addTilesetImage("Lift_Platform","Lift_Platform"),e.addTilesetImage("Floading_flat_form","Floading_flat_form"),e.addTilesetImage("animated lava river spritesheet","animated lava river spritesheet"),e.addTilesetImage("floor_Lava_Crack","floor_Lava_Crack"),e.addTilesetImage("static idle","static idle"),e.addTilesetImage("golden monument anim-going up-packed sheet","golden monument anim-going up-packed sheet"),e.addTilesetImage("rock pillars coming from darkness-bg_2","rock pillars coming from darkness-bg_2"),e.addTilesetImage("Crystals2-improved refraction_25","Crystals2-improved refraction_25"),e.addTilesetImage("Crystals2-improved refraction_3","Crystals2-improved refraction_3"),e.addTilesetImage("Crystals2-improved refraction_9","Crystals2-improved refraction_9"),e.addTilesetImage("Crystals2-improved refraction_19","Crystals2-improved refraction_19"),e.addTilesetImage("AncientScript_V01","AncientScript_V01");const t=e.createLayer("Floor",["floor","floor_Lava_Crack"],0,0),s=e.createLayer("bg",["Tileset 4 - transp"],0,0),i=e.createLayer("lava floor",["animated lava river spritesheet"],0,0),a=e.createLayer("fire animation",["TorchBowlRegular_V01-Sheet"],0,0),n=e.createLayer("Floating plat form/Chain",["Floading_flat_form"],0,0),r=e.createLayer("Floating plat form/Floating Col",["Floading_flat_form"],0,0),o=e.createLayer("Floating plat form/Floatind platform",["Floading_flat_form"],0,0),l=e.createLayer("Gate",["side way-Sheet"],0,0),c=e.createLayer("wall/wall bottom",["Tileset 4 - transp"],0,0),h=e.createLayer("lift",["Lift_Platform"],0,0),u=e.createLayer("Floating plat form/Chain shadow",["Floading_flat_form"],0,0),d=e.createLayer("wall/Wall side",["Tileset 4 - transp"],0,0),p=e.createLayer("pillar",["pillars-bg_5","pillars-bg_0","Decor corner"],0,0),f=e.createLayer("Decoration",["Crystals2-improved refraction_3","Crystals2-improved refraction_9","Crystals2-improved refraction_25","Crystals2-improved refraction_19","AncientScript_V01"],0,0),m=new ZR(this,1610,1451);this.add.existing(m);const g=new ZR(this,856,1451);this.add.existing(g);const y=this.add.sprite(1280,844,"golden monument anim-going up-packed sheet",53);y.play("TelAnimation");const b=new KR(this,978,1191);this.add.existing(b),this.add.sprite(618,1797,"TorchBowlRegular_V01-Sheet",0).play("Torch1Anim"),this.add.sprite(1935,1797,"TorchBowlRegular_V01-Sheet",0).play("Torch1Anim"),this.add.sprite(1935,872,"TorchBowlRegular_V01-Sheet",0).play("Torch1Anim"),this.add.sprite(618,872,"TorchBowlRegular_V01-Sheet",0).play("Torch1Anim"),this.floor_1=t,this.bg_1=s,this.lava_floor_1=i,this.fire_animation_1=a,this.floating_plat_form_Chain_1=n,this.floating_plat_form_Floating_Col_1=r,this.floating_plat_form_Floatind_platform_1=o,this.gate_1=l,this.wall_wall_bottom_1=c,this.lift_1=h,this.floating_plat_form_Chain_shadow_1=u,this.wall_Wall_side_1=d,this.pillar_1=p,this.decoration_1=f,this.stoneStatuePrefab_1=m,this.stoneStatuePrefab=g,this.telAnimation=y,this.playerPrefab=b,this.miniMapBossFight=e,this.events.emit("scene-awake")}preload(){super.preload()}create(){this.cameras.main.setBounds(0,0,2560,2560),this.physics.world.bounds.width=2560,this.physics.world.bounds.height=2560;try{super.create(),this.editorCreate(),this.setupCollisions(),this.player=this.playerPrefab,this.initializeManagers(),this.setupPlayerAttack(),this.setupTestControls(),this.setupZombieCollisionSystem(),this.startEnemySpawning(),this.setupLavaAnimations()}catch(e){console.error("Error in MiniMapBossFightScene create:",e)}}setupCollisions(){try{this.lava_floor_1.setDepth(1),this.floating_plat_form_Floating_Col_1.setDepth(2),this.floating_plat_form_Floatind_platform_1.setDepth(3),this.stoneStatuePrefab.setDepth(4),this.stoneStatuePrefab_1.setDepth(4),this.playerPrefab.setDepth(4),this.decoration_1.setDepth(4),this.telAnimation.setDepth(4),this.floating_plat_form_Chain_1.setDepth(4),this.stoneStatuePrefab_1.setupCollision(this.playerPrefab),this.stoneStatuePrefab.setupCollision(this.playerPrefab),this.physics.add.collider(this.playerPrefab,this.floating_plat_form_Floating_Col_1),this.floating_plat_form_Floating_Col_1.setCollisionBetween(0,1e4)}catch(e){console.error("Error setting up boss fight collisions:",e)}}setupZombieCollisionSystem(){try{this.registerCollisionLayer(this.floating_plat_form_Floating_Col_1,"Platform Collision"),[this.stoneStatuePrefab,this.stoneStatuePrefab_1].forEach(((e,t)=>{e&&this.registerStaticObstacle(e,`Boss Arena Statue ${t+1}`)})),this.setupZombieObstacleCollisions()}catch(e){console.error("Error setting up boss fight zombie collision system:",e)}}setupLavaAnimations(){try{const e=this.lava_floor_1.getTilesWithin(),t=this.add.container(0,0);t.setDepth(1),this.lavaSprites=[],e.forEach((e=>{if(e&&-1!==e.index){let s=null;switch(e.index){case 2309:s="lava0";break;case 2307:s="lava9";break;case 2275:s="lava6";break;case 2311:s="lava3";break;case 2343:s="lava12";break;case 2324:s="lava10";break;case 2290:s="lava7.1";break;case 2276:s="lava4.1";break;case 2328:s="lava1.1"}if(s){const i=this.add.sprite(e.pixelX+e.width/2,e.pixelY+e.height/2,"animated lava river spritesheet");i.play(s),t.add(i),this.lavaSprites.push(i),e.visible=!1}}}))}catch(e){console.error("Error setting up lava animations:",e)}}trackEnemyKill(e){this.removeZombie(e),super.trackEnemyKill(e)}update(e,t){super.update(e,t);try{this.player&&!this.player.isDead&&this.cameras.main.startFollow(this.player,!0,.1,.1)}catch(s){console.error("Error in MiniMapBossFightScene update:",s)}}shutdown(){super.shutdown()}}let iD=class extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t??65,s??105,i||"TreePalmSheet_01",a??0),this.play("Tree1"),e.add.existing(this),e.physics.add.existing(this,!1),this.body.allowGravity=!1,this.body.setSize(30,15),this.body.setOffset(70,135),this.body.immovable=!0,this.isTreeInvisible=!1,this.isPlayerInvisible=!1,this.treeTop=this.y-125,this.treeBottom=this.y+55,e.events.on("update",(()=>{if(!this.player)return;const t=Math.abs(this.player.x-(this.x+this.body.offset.x-85))<45;this.player.y>this.treeTop&&this.player.y<this.treeBottom-20&&t?(this.isTreeInvisible||e.tweens.add({targets:this,alpha:.4,duration:200,ease:"Power1",onComplete:()=>{this.isTreeInvisible=!0}}),this.isPlayerInvisible||e.tweens.add({targets:this.player,alpha:.3,duration:200,ease:"Power1",onComplete:()=>{this.isPlayerInvisible=!0}})):(this.isTreeInvisible&&e.tweens.add({targets:this,alpha:1,duration:200,ease:"Power1",onComplete:()=>{this.isTreeInvisible=!1}}),this.isPlayerInvisible&&e.tweens.add({targets:this.player,alpha:1,duration:200,ease:"Power1",onComplete:()=>{this.isPlayerInvisible=!1}}))}))}setupCollision(e){this.scene&&e&&(this.scene.physics.add.collider(e,this,null,null,this),this.player=e)}destroy(){this.scene&&this.scene.events.off("update"),super.destroy()}};class aD extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t??669,s??803,i||"TreePalmSheet_02",a??0),this.play("Tree2"),e.add.existing(this),e.physics.add.existing(this,!1),this.body.allowGravity=!1,this.body.setSize(20,15),this.body.setOffset(50,105),this.body.immovable=!0,this.isTreeInvisible=!1,this.isPlayerInvisible=!1,this.treeTop=this.y-125,this.treeBottom=this.y+55,e.events.on("update",(()=>{if(!this.player)return;const t=Math.abs(this.player.x-(this.x+this.body.offset.x-55))<45;this.player.y>this.treeTop&&this.player.y<this.treeBottom-20&&t?(this.isTreeInvisible||e.tweens.add({targets:this,alpha:.4,duration:200,ease:"Power1",onComplete:()=>{this.isTreeInvisible=!0}}),this.isPlayerInvisible||e.tweens.add({targets:this.player,alpha:.3,duration:200,ease:"Power1",onComplete:()=>{this.isPlayerInvisible=!0}})):(this.isTreeInvisible&&e.tweens.add({targets:this,alpha:1,duration:200,ease:"Power1",onComplete:()=>{this.isTreeInvisible=!1}}),this.isPlayerInvisible&&e.tweens.add({targets:this.player,alpha:1,duration:200,ease:"Power1",onComplete:()=>{this.isPlayerInvisible=!1}}))}))}setupCollision(e){this.scene&&e&&(this.scene.physics.add.collider(e,this,null,null,this),this.player=e)}destroy(){this.scene&&this.scene.events.off("update"),super.destroy()}}class nD extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t??48,s??80,i||"TreePalmSheet_03",a??0),this.play("Tree3"),e.add.existing(this),e.physics.add.existing(this,!1),this.body.allowGravity=!1,this.body.setSize(20,15),this.body.setOffset(40,105),this.body.moves=!1,this.body.immovable=!0,this.isTreeInvisible=!1,this.isPlayerInvisible=!1,this.treeTop=this.y-125,this.treeBottom=this.y+55,e.events.on("update",(()=>{if(!this.player)return;const t=Math.abs(this.player.x-(this.x+this.body.offset.x-50))<45;this.player.y>this.treeTop&&this.player.y<this.treeBottom-20&&t?(this.isTreeInvisible||e.tweens.add({targets:this,alpha:.4,duration:200,ease:"Power1",onComplete:()=>{this.isTreeInvisible=!0}}),this.isPlayerInvisible||e.tweens.add({targets:this.player,alpha:.3,duration:200,ease:"Power1",onComplete:()=>{this.isPlayerInvisible=!0}})):(this.isTreeInvisible&&e.tweens.add({targets:this,alpha:1,duration:200,ease:"Power1",onComplete:()=>{this.isTreeInvisible=!1}}),this.isPlayerInvisible&&e.tweens.add({targets:this.player,alpha:1,duration:200,ease:"Power1",onComplete:()=>{this.isPlayerInvisible=!1}}))}))}setupCollision(e){this.scene&&e&&(this.scene.physics.add.collider(e,this,null,null,this),this.player=e)}destroy(){this.scene&&this.scene.events.off("update"),super.destroy()}}class rD extends qR{constructor(){super("MiniMapBeachScene"),Ai(this,"beachTreePrefab"),Ai(this,"beachTree1Prefab"),Ai(this,"beachTreePrefab2"),Ai(this,"water_1"),Ai(this,"ground_1"),Ai(this,"bridge_1"),Ai(this,"respawn_point_1"),Ai(this,"block_1"),Ai(this,"recked_ship_1"),Ai(this,"decor_1"),Ai(this,"block"),Ai(this,"skull_stone_1"),Ai(this,"playerPrefab"),Ai(this,"miniMapBeachBiom")}editorCreate(){const e=this.add.tilemap("MiniMapBeachBiom");e.addTilesetImage("beach - standard - with thick foam - spritesheet","beach - standard - with thick foam - spritesheet"),e.addTilesetImage("golden monument anim-going up-packed sheet","golden monument anim-going up-packed sheet"),e.addTilesetImage("rocky skull structure-sand","rocky skull structure-sand"),e.addTilesetImage("stranded ship-sand","stranded ship-sand"),e.addTilesetImage("TreePalmSheet_03","TreePalmSheet_03"),e.addTilesetImage("TreePalmSheet_01","TreePalmSheet_01"),e.addTilesetImage("TreePalmSheet_02","TreePalmSheet_02"),e.addTilesetImage("bones_17","bones_17"),e.addTilesetImage("bones_15","bones_15"),e.addTilesetImage("bones_16","bones_16"),e.addTilesetImage("TreePalmSheet_02","TreePalmSheet_02"),e.addTilesetImage("BeachDeckSheet","BeachDeckSheet");const t=new iD(this,1402,842);this.add.existing(t);const s=new aD(this,1081,870);this.add.existing(s),s.flipX=!0,s.flipY=!1;const i=new nD(this,1201,816);this.add.existing(i);const a=e.createLayer("water",["beach - standard - with thick foam - spritesheet"],0,0),n=e.createLayer("Ground",["beach - standard - with thick foam - spritesheet"],0,0),r=e.createLayer("bridge",["BeachDeckSheet"],0,-9),o=e.createLayer("respawn point",[],0,0),l=e.createLayer("Block",["BeachDeckSheet"],0,0),c=e.createLayer("Recked ship",["stranded ship-sand","golden monument anim-going up-packed sheet"],0,0),h=e.createLayer("decor",["bones_15","bones_16","bones_17"],0,0),u=e.createLayer("Block",["BeachDeckSheet"],0,0),d=e.createLayer("Skull stone",["rocky skull structure-sand"],4,5),p=new KR(this,846,1110);this.add.existing(p),this.beachTreePrefab=t,this.beachTree1Prefab=s,this.beachTreePrefab2=i,this.water_1=a,this.ground_1=n,this.bridge_1=r,this.respawn_point_1=o,this.block_1=l,this.recked_ship_1=c,this.decor_1=h,this.block=u,this.skull_stone_1=d,this.playerPrefab=p,this.miniMapBeachBiom=e,this.events.emit("scene-awake")}preload(){super.preload()}create(){this.cameras.main.setBounds(0,0,2560,2560),this.physics.world.bounds.width=2560,this.physics.world.bounds.height=2560;try{super.create(),this.editorCreate(),this.setupCollisions(),this.player=this.playerPrefab,this.initializeManagers(),this.setupPlayerAttack(),this.setupTestControls(),this.setupZombieCollisionSystem(),this.startEnemySpawning(),this.setupWaterAnimations()}catch(e){console.error("Error in MiniMapBeachScene create:",e)}}setupCollisions(){try{this.playerPrefab.setDepth(2),this.bridge_1.setDepth(1),this.beachTreePrefab.setupCollision(this.playerPrefab),this.beachTree1Prefab.setupCollision(this.playerPrefab),this.beachTreePrefab2.setupCollision(this.playerPrefab),this.physics.add.collider(this.playerPrefab,this.block_1),this.block_1.setCollisionBetween(0,1e4),this.physics.add.collider(this.playerPrefab,this.water_1),this.water_1.setCollisionBetween(0,1e4)}catch(e){console.error("Error setting up beach collisions:",e)}}setupZombieCollisionSystem(){try{this.registerCollisionLayer(this.block_1,"Beach Blocks"),this.registerCollisionLayer(this.water_1,"Water Collision"),[this.beachTreePrefab,this.beachTree1Prefab,this.beachTreePrefab2].forEach(((e,t)=>{e&&this.registerStaticObstacle(e,`Beach Tree ${t+1}`)})),this.setupZombieObstacleCollisions()}catch(e){console.error("Error setting up beach zombie collision system:",e)}}setupWaterAnimations(){try{this.water_1.getTilesWithin().forEach((e=>{e&&227===e.index&&this.add.sprite(e.pixelX+e.width/2,e.pixelY+e.height/2,"water_1").play("Water0")})),this.ground_1.getTilesWithin().forEach((e=>{e&&103===e.index&&this.add.sprite(e.pixelX+e.width/2,e.pixelY+e.height/2,"water.1").play("water.r"),e&&174===e.index&&this.add.sprite(e.pixelX+e.width/2,e.pixelY+e.height/2,"water.2").play("water.r.d"),e&&70===e.index&&this.add.sprite(e.pixelX+e.width/2,e.pixelY+e.height/2,"water.3").play("water.r.u"),e&&69===e.index&&this.add.sprite(e.pixelX+e.width/2,e.pixelY+e.height/2,"water.4").play("water12"),e&&37===e.index&&this.add.sprite(e.pixelX+e.width/2,e.pixelY+e.height/2,"water.5").play("water11"),e&&36===e.index&&this.add.sprite(e.pixelX+e.width/2,e.pixelY+e.height/2,"water.6").play("water13"),e&&107===e.index&&this.add.sprite(e.pixelX+e.width/2,e.pixelY+e.height/2,"water.7").play("water1"),e&&137===e.index&&this.add.sprite(e.pixelX+e.width/2,e.pixelY+e.height/2,"water.8").play("water2"),e&&138===e.index&&this.add.sprite(e.pixelX+e.width/2,e.pixelY+e.height/2,"water.9").play("water3"),e&&73===e.index&&this.add.sprite(e.pixelX+e.width/2,e.pixelY+e.height/2,"water.10").play("water4"),e&&72===e.index&&this.add.sprite(e.pixelX+e.width/2,e.pixelY+e.height/2,"water.11").play("water5"),e&&173===e.index&&this.add.sprite(e.pixelX+e.width/2,e.pixelY+e.height/2,"water.12").play("water6"),e&&141===e.index&&this.add.sprite(e.pixelX+e.width/2,e.pixelY+e.height/2,"water.13").play("water7"),e&&140===e.index&&this.add.sprite(e.pixelX+e.width/2,e.pixelY+e.height/2,"water.14").play("water8"),e&&172===e.index&&this.add.sprite(e.pixelX+e.width/2,e.pixelY+e.height/2,"water.15").play("water9")}))}catch(e){console.error("Error setting up water animations:",e)}}trackEnemyKill(e){this.removeZombie(e),super.trackEnemyKill(e)}update(e,t){super.update(e,t);try{this.player&&!this.player.isDead&&this.cameras.main.startFollow(this.player,!0,.1,.1)}catch(s){console.error("Error in MiniMapBeachScene update:",s)}}shutdown(){super.shutdown()}}class oD extends qR{constructor(){super("MiniMapLavaScene"),Ai(this,"bG_lava_1"),Ai(this,"bG_Platform_1"),Ai(this,"bG_Platform_L__1"),Ai(this,"bG_Stairs_1"),Ai(this,"bG_Totem_platform_1"),Ai(this,"decor_Shard_rocks_1"),Ai(this,"decor_Decor_1"),Ai(this,"traps_Statue_1"),Ai(this,"playerPrefab"),Ai(this,"miniMapLava")}editorCreate(){const e=this.add.tilemap("MiniMapLava");e.addTilesetImage("platform1","platform1"),e.addTilesetImage("animated lava river spritesheet","animated lava river spritesheet"),e.addTilesetImage("golden monument anim-going up-packed sheet","golden monument anim-going up-packed sheet"),e.addTilesetImage("tileset","tileset"),e.addTilesetImage("spike-pack-horizontal-attack","spike-pack-horizontal-attack"),e.addTilesetImage("spike-pack-horizontal-retreat","spike-pack-horizontal-retreat"),e.addTilesetImage("spike-pack-vertical-attack","spike-pack-vertical-attack"),e.addTilesetImage("spike-pack-vertical-retreat","spike-pack-vertical-retreat"),e.addTilesetImage("tumor-destroy","tumor-destroy"),e.addTilesetImage("egg-ish prop-explosion","egg-ish prop-explosion"),e.addTilesetImage("lava ball-falling","lava ball-falling"),e.addTilesetImage("nasty structure_0","nasty structure_0"),e.addTilesetImage("big eye-loop","big eye-loop"),e.addTilesetImage("crusher-stand-retreat-v2","crusher-stand-retreat-v2"),e.addTilesetImage("crusher-retreat-v2","crusher-retreat-v2"),e.addTilesetImage("crusher-smash-pentagram FX","crusher-smash-pentagram FX"),e.addTilesetImage("spitfire device-vertical-starting","spitfire device-vertical-starting"),e.addTilesetImage("spitfire device-multidirectional-firing-loop-8frames","spitfire device-multidirectional-firing-loop-8frames"),e.addTilesetImage("spitfire device-horizontal-starting","spitfire device-horizontal-starting"),e.addTilesetImage("spitfire device-vertical-firing-loop-flame","spitfire device-vertical-firing-loop-flame"),e.addTilesetImage("spitfire device-diagonal-firing-loop-flame","spitfire device-diagonal-firing-loop-flame"),e.addTilesetImage("tormented souls tile-9-hand3","tormented souls tile-9-hand3"),e.addTilesetImage("tormented souls tile-7-hand1","tormented souls tile-7-hand1"),e.addTilesetImage("tormented souls tile-8-hand2","tormented souls tile-8-hand2"),e.addTilesetImage("tiny volcanos_0","tiny volcanos_0"),e.addTilesetImage("spears with dead bodies_0","spears with dead bodies_0"),e.addTilesetImage("spears with dead bodies_1","spears with dead bodies_1"),e.addTilesetImage("spears with dead bodies_2","spears with dead bodies_2"),e.addTilesetImage("spears with dead bodies_3","spears with dead bodies_3"),e.addTilesetImage("spears with dead bodies_4","spears with dead bodies_4"),e.addTilesetImage("spears with dead bodies_5","spears with dead bodies_5"),e.addTilesetImage("statues_0","statues_0"),e.addTilesetImage("statues_3","statues_3"),e.addTilesetImage("towers_0","towers_0"),e.addTilesetImage("sharp rocks_0","sharp rocks_0"),e.addTilesetImage("sharp rocks_1","sharp rocks_1"),e.addTilesetImage("sharp rocks_2","sharp rocks_2"),e.addTilesetImage("sharp rocks_3","sharp rocks_3"),e.addTilesetImage("sharp rocks_4","sharp rocks_4"),e.addTilesetImage("rock-formations on lava-_0","rock-formations on lava-_0"),e.addTilesetImage("rock-formations on lava-_1","rock-formations on lava-_1"),e.addTilesetImage("rock-formations on lava-_2","rock-formations on lava-_2"),e.addTilesetImage("rock-formations on lava-_3","rock-formations on lava-_3"),e.addTilesetImage("rock-formations on lava-_4","rock-formations on lava-_4"),e.addTilesetImage("rocks1-_0","rocks1-_0"),e.addTilesetImage("rocks1-_1","rocks1-_1"),e.addTilesetImage("rocks1-_2","rocks1-_2"),e.addTilesetImage("rocks1-_3","rocks1-_3"),e.addTilesetImage("rocks1-_4","rocks1-_4"),e.addTilesetImage("rocks1-_5","rocks1-_5"),e.addTilesetImage("rocks1-_6","rocks1-_6"),e.addTilesetImage("rocks1-_7","rocks1-_7"),e.addTilesetImage("tormented souls Manu hand","tormented souls Manu hand"),e.addTilesetImage("spike-1-attack","spike-1-attack"),e.addTilesetImage("spike-3-retreat","spike-3-retreat"),e.addTilesetImage("big rocks_1","big rocks_1"),e.addTilesetImage("big rocks_11","big rocks_11"),e.addTilesetImage("towers_2","towers_2"),e.addTilesetImage("chest-anims-shaking","chest-anims-shaking");const t=e.createLayer("BG/lava",["animated lava river spritesheet"],0,0),s=e.createLayer("BG/Platform",["platform1","tileset"],0,0),i=e.createLayer("BG/Platform L@",["platform1","tileset"],0,0),a=e.createLayer("BG/Stairs",["tileset","crusher-stand-retreat-v2"],0,0),n=e.createLayer("BG/Totem platform",["tileset"],0,0),r=e.createLayer("decor/Shard rocks",["rock-formations on lava-_2","rock-formations on lava-_0","sharp rocks_0","rock-formations on lava-_4","sharp rocks_2","sharp rocks_3","sharp rocks_1","rock-formations on lava-_3","rock-formations on lava-_1","rocks1-_7","rocks1-_4","sharp rocks_4","big rocks_1","rocks1-_2","rocks1-_0","rocks1-_6","rocks1-_1","rocks1-_3"],0,0),o=e.createLayer("decor/Decor",["rock-formations on lava-_2","rocks1-_0","spears with dead bodies_1","spears with dead bodies_4","spears with dead bodies_2","spears with dead bodies_5","rock-formations on lava-_4","spears with dead bodies_0","spears with dead bodies_3","rock-formations on lava-_3","big rocks_1","big rocks_11","rocks1-_5","towers_2","rock-formations on lava-_1","rocks1-_4"],0,0),l=e.createLayer("Traps/Statue",["statues_0","statues_3"],0,0);this.add.sprite(668,2510,"tumor-destroy",0).play("TumorDestroyAni"),this.add.sprite(898,2687,"tumor-destroy",0).play("TumorDestroyAni"),this.add.sprite(1901,1667,"tumor-destroy",0).play("TumorDestroyAni"),this.add.sprite(1436,1698,"tumor-destroy",0).play("TumorDestroyAni"),this.add.sprite(2412,546,"tumor-destroy",0).play("TumorDestroyAni");const c=new KR(this,644,2600);this.add.existing(c),this.bG_lava_1=t,this.bG_Platform_1=s,this.bG_Platform_L__1=i,this.bG_Stairs_1=a,this.bG_Totem_platform_1=n,this.decor_Shard_rocks_1=r,this.decor_Decor_1=o,this.traps_Statue_1=l,this.playerPrefab=c,this.miniMapLava=e,this.events.emit("scene-awake")}preload(){super.preload()}create(){this.cameras.main.setBounds(0,0,3200,3200),this.physics.world.bounds.width=3200,this.physics.world.bounds.height=3200;try{super.create(),this.editorCreate(),this.setupCollisions(),this.player=this.playerPrefab,this.initializeManagers(),this.setupPlayerAttack(),this.setupTestControls(),this.setupZombieCollisionSystem(),this.startEnemySpawning(),this.setupLavaAnimations()}catch(e){console.error("Error in MiniMapLavaScene create:",e)}}setupCollisions(){try{this.bG_lava_1.setDepth(1),this.bG_Platform_1.setDepth(2),this.playerPrefab.setDepth(2),this.bG_Stairs_1.setDepth(2),this.bG_Totem_platform_1.setDepth(2),this.decor_Decor_1.setDepth(2),this.traps_Statue_1.setDepth(2),this.bG_Platform_L__1.setDepth(2),this.physics.add.collider(this.playerPrefab,this.bG_lava_1),this.bG_lava_1.setCollisionBetween(0,1e4)}catch(e){console.error("Error setting up lava scene collisions:",e)}}setupZombieCollisionSystem(){try{this.registerCollisionLayer(this.bG_lava_1,"Lava Collision"),this.setupZombieObstacleCollisions()}catch(e){console.error("Error setting up lava scene zombie collision system:",e)}}setupLavaAnimations(){try{this.lavaContainer=this.add.container(0,0);const e=this.bG_lava_1.getTilesWithin();this.lavaSprites=[],e.forEach((e=>{if(e&&-1!==e.index){let t=null;if(391===e.index&&(t="lava0"),t){const s=this.add.sprite(e.pixelX+e.width/2,e.pixelY+e.height/2,"animated lava river spritesheet");s.play(t),this.lavaContainer.add(s),this.lavaSprites.push(s),e.visible=!1}}}))}catch(e){console.error("Error setting up lava animations:",e)}}trackEnemyKill(e){this.removeZombie(e),super.trackEnemyKill(e)}update(e,t){super.update(e,t);try{this.player&&!this.player.isDead&&this.cameras.main.startFollow(this.player,!0,.1,.1)}catch(s){console.error("Error in MiniMapLavaScene update:",s)}}shutdown(){super.shutdown()}}const lD={type:Phaser.AUTO,width:1920,height:1080,backgroundColor:"#242424",parent:"game-container",physics:{default:"arcade",arcade:{debug:!1,tileBias:32}},render:{pixelArt:!0},scale:{mode:Phaser.Scale.WIDTH_CONTROLS_HEIGHT,autoCenter:Phaser.Scale.CENTER_BOTH,width:1920,height:1080,min:{width:1280,height:720},max:{width:2560,height:1440}}};class cD extends Phaser.Scene{constructor(){super("Boot")}preload(){this.load.pack("pack","assets/preload-asset-pack.json")}create(){window.dispatchEvent(new CustomEvent("gameBootComplete")),this.scene.start("Preload"),kM.emit("current-scene-ready",this)}}let hD=null;window.startGameManually=function(){if(hD){const e=hD.registry.get("gameManager");e&&e.startNewRun(),hD.scene.start("MainMapScene")}},window.stopGameManually=function(){if(console.log("Manual game stop requested"),hD){const e=hD.registry.get("gameManager");e&&e.isGameRunning&&e.handlePlayerDeath("Manual Exit"),hD.scene.getScenes(!0).forEach((e=>{"Boot"!==e.scene.key&&"Preload"!==e.scene.key&&hD.scene.stop(e.scene.key)}))}};const uD=ga.forwardRef((function({currentActiveScene:e,showModal:t,autoStart:s=!1},i){const a=ga.useRef(),{gameManager:n}=LM(),r=ga.useRef(!1);return ga.useLayoutEffect((()=>{var e;return void 0===a.current&&(a.current=((e,t=null,s=!1)=>{console.log("Initializing Phaser game...",{parent:e,autoStartGame:s});const i=t||new FM,a={...lD,parent:e};return hD=new Phaser.Game(a),hD.registry.set("gameManager",i),console.log("GameManager initialized and registered with Phaser"),hD.scene.add("Boot",cD,!0),hD.scene.add("Preload",vR),hD.scene.add("Level",bR),hD.scene.add("MainMapScene",YR),hD.scene.add("MiniMapDarkForastScene",tD),hD.scene.add("MiniMapBossFightScene",sD),hD.scene.add("MiniMapBeachScene",rD),hD.scene.add("MiniMapLavaScene",oD),window.game=hD,window.EventBus=kM,kM.on("return-to-menu",(()=>{console.log("Return to menu event received"),i&&i.isGameRunning&&i.handlePlayerDeath("Manual Exit"),kM.emit("game-stopped")})),kM.on("change-scene",((e,t)=>{console.log(`Changing scene to: ${e}`),hD.scene.isActive(e)?hD.scene.restart(e,t):hD.scene.start(e,t)})),kM.on("player-health-update",(e=>{kM.emit("player-health-updated",e)})),kM.on("game-state-update",(e=>{kM.emit("game-state-updated",e),window.dispatchEvent(new CustomEvent("gameStateUpdated",{detail:e}))})),s&&setTimeout((()=>{i&&i.startNewRun(),hD.scene.start("MainMapScene")}),1e3),hD})("game-container",n,!1),null!==i&&(i.current={game:a.current,scene:null,gameManager:n,startGame:()=>{console.log("Manual game start triggered"),a.current&&n&&!r.current&&(r.current=!0,n.applyPassiveUpgrades&&n.applyPassiveUpgrades(),n.startNewRun&&n.startNewRun(),setTimeout((()=>{a.current.scene.start("MainMapScene"),kM.emit("game-started")}),100))},stopGame:()=>{console.log("Manual game stop triggered"),a.current&&r.current&&(r.current=!1,a.current.scene.getScenes(!0).forEach((e=>{"Boot"!==e.scene.key&&"Preload"!==e.scene.key&&a.current.scene.stop(e.scene.key)})),n&&n.isGameRunning&&n.handlePlayerDeath("Manual Exit"),kM.emit("game-stopped"))},pauseGame:()=>{a.current&&r.current&&(a.current.scene.getScenes(!0).forEach((e=>{"Boot"!==e.scene.key&&"Preload"!==e.scene.key&&a.current.scene.pause(e.scene.key)})),kM.emit("game-paused"))},resumeGame:()=>{a.current&&r.current&&(a.current.scene.getScenes(!1).forEach((e=>{"Boot"!==e.scene.key&&"Preload"!==e.scene.key&&a.current.scene.resume(e.scene.key)})),kM.emit("game-resumed"))},getCurrentScene:()=>a.current&&a.current.scene.getScenes(!0).find((e=>"Boot"!==e.scene.key&&"Preload"!==e.scene.key))||null}),s&&(null==(e=null==i?void 0:i.current)?void 0:e.startGame)&&setTimeout((()=>{i.current.startGame()}),100)),()=>{a.current&&(console.log("Destroying Phaser game"),r.current=!1,a.current.destroy(!0),a.current=void 0)}}),[i,n,s]),ga.useEffect((()=>{const s=t=>{var s,a;console.log("Scene ready:",null==(s=null==t?void 0:t.scene)?void 0:s.key),e&&"function"==typeof e&&e(t),i&&i.current&&(i.current.scene=t),"MainMapScene"===(null==(a=null==t?void 0:t.scene)?void 0:a.key)&&kM.emit("main-scene-started")},n=e=>{console.log("Player death detected:",e),r.current=!1,a.current&&a.current.scene.getScenes(!0).forEach((e=>{"Boot"!==e.scene.key&&"Preload"!==e.scene.key&&a.current.scene.stop(e.scene.key)})),t&&t("GAME_OVER",e),kM.emit("game-over",e)},o=()=>{var e;console.log("Return to menu requested"),(null==(e=null==i?void 0:i.current)?void 0:e.stopGame)&&i.current.stopGame(),kM.emit("return-to-menu")},l=()=>{t&&t("PAUSE_MENU")};return kM.on("current-scene-ready",s),kM.on("player-died",n),kM.on("return-to-menu",o),kM.on("pause-game",l),window.addEventListener("playerDeath",(e=>n(e.detail))),window.addEventListener("returnToMenu",o),()=>{kM.removeListener("current-scene-ready",s),kM.removeListener("player-died",n),kM.removeListener("return-to-menu",o),kM.removeListener("pause-game",l),window.removeEventListener("playerDeath",(e=>n(e.detail))),window.removeEventListener("returnToMenu",o)}}),[e,t,i]),ga.useEffect((()=>{const e=e=>{"Escape"===e.key&&r.current&&kM.emit("pause-game")};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[]),Ea.jsx("div",{id:"game-container",className:"game-container",style:{width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#242424",margin:0,padding:0,overflow:"hidden"}})}));uD.propTypes={currentActiveScene:yR.func,showModal:yR.func,autoStart:yR.bool};class dD{constructor(){this.gameManager=null,this.currentScene=null,this.isConnected=!1,this.sessionId=null,this.sessionEnding=!1,this.lastSyncTime=0,this.syncInterval=5e3,this.setupMutations(),this.init()}init(){this.startPolling(),this.setupEventEnhancement(),this.isConnected=!0,console.log("GameBridge connected"),console.log("GameBridge: Mutations setup complete"),kM.emit("bridge-connected")}startPolling(){setInterval((()=>{this.updateGameReferences(),this.syncGameData()}),100)}updateGameReferences(){var e,t,s,i,a;const n=null==(t=null==(e=window.game)?void 0:e.registry)?void 0:t.get("gameManager"),r=window.gameManager,o=null==(s=window.currentGameScene)?void 0:s.gameManager,l=n||r||o||null;l&&l!==this.gameManager&&(this.gameManager=l,console.log("GameBridge: GameManager connected"));const c=null==(a=null==(i=window.game)?void 0:i.scene)?void 0:a.getScene("MainMapScene"),h=window.currentGameScene,u=c||h||null;u&&u!==this.currentScene&&(this.currentScene=u,console.log("GameBridge: Scene connected"),(u.player||u.playerPrefab)&&(this.player=u.player||u.playerPrefab,console.log("GameBridge: Player connected")))}syncGameData(){if(!this.gameManager||!this.currentScene)return;const e=this.getPlayerData();kM.emit("bridge-player-data",e);const t=this.getGameProgress();kM.emit("bridge-game-progress",t);const s=Date.now();this.sessionId&&s-this.lastSyncTime>this.syncInterval&&(this.syncToBackend(e,t),this.lastSyncTime=s)}getPlayerData(){var e,t,s;const i={health:100,maxHealth:100,healthPercentage:100,experience:0,maxExperience:100,level:1,experiencePercentage:0,gold:500,isAlive:!0,isInGame:!1},a=this.player||(null==(e=this.currentScene)?void 0:e.player)||(null==(t=this.currentScene)?void 0:t.playerPrefab);if(a&&(i.health=void 0!==a.health?a.health:i.health,i.maxHealth=void 0!==a.maxHealth?a.maxHealth:i.maxHealth,i.isAlive=!1!==a.alive&&a.health>0),null==(s=this.gameManager)?void 0:s.playerStats){const e=this.gameManager.playerStats;i.health=void 0!==e.health?e.health:i.health,i.maxHealth=void 0!==e.maxHealth?e.maxHealth:i.maxHealth,i.experience=void 0!==e.experience?e.experience:i.experience,i.maxExperience=void 0!==e.nextLevelExp?e.nextLevelExp:i.maxExperience,i.level=void 0!==e.level?e.level:i.level}return this.gameManager&&(i.gold=void 0!==this.gameManager.gold?this.gameManager.gold:i.gold,i.isInGame=this.gameManager.isGameRunning||!1),i.healthPercentage=i.maxHealth>0?Math.max(0,i.health/i.maxHealth*100):0,i.experiencePercentage=i.maxExperience>0?i.experience/i.maxExperience*100:0,i}getGameProgress(){var e,t,s,i,a;const n={gameTime:0,formattedTime:"00:00",currentWave:1,survivalTime:0,isGameRunning:!1};if(this.gameManager&&(n.survivalTime=this.gameManager.getCurrentSurvivalTime(),n.isGameRunning=this.gameManager.isGameRunning),null==(t=null==(e=this.currentScene)?void 0:e.uiManager)?void 0:t.timer){const e=this.currentScene.uiManager.timer.elapsed||0;n.gameTime=e;const t=Math.floor(e/60),s=Math.floor(e%60);n.formattedTime=`${t.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`}return(null==(i=null==(s=this.currentScene)?void 0:s.uiManager)?void 0:i.lastWave)?n.currentWave=this.currentScene.uiManager.lastWave:(null==(a=this.currentScene)?void 0:a.currentWave)&&(n.currentWave=this.currentScene.currentWave),n}setupEventEnhancement(){kM.on("player-health-updated",(e=>{const t={...e,percentage:e.maxHP>0?e.currentHP/e.maxHP*100:0,isLowHealth:e.currentHP<.25*e.maxHP,isCritical:e.currentHP<.1*e.maxHP};kM.emit("bridge-health-updated",t)})),kM.on("player-gold-updated",(e=>{const t={...e,formatted:this.formatNumber(e.gold||0)};kM.emit("bridge-gold-updated",t)})),kM.on("game-started",(()=>{console.log("GameBridge: Game started event received"),this.startSession()})),kM.on("player-died",(e=>{console.log("GameBridge: Player death event received",e),this.endSession(e)}))}formatNumber(e){return e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString()}setupMutations(){console.log("GameBridge: Setting up mutations for API calls"),this.startSessionMutation={mutationFn:CM,onSuccess:e=>{console.log("GameBridge: Start session mutation success",e),this.sessionId=e.sessionId,this.lastSyncTime=Date.now(),kM.emit("bridge-session-started",{sessionId:this.sessionId})},onError:e=>{console.error("GameBridge: Start session mutation error",e)}},this.saveCheckpointMutation={mutationFn:MM,onSuccess:(e,t)=>{console.log("GameBridge: Save checkpoint mutation success",e,t)},onError:(e,t)=>{console.error("GameBridge: Save checkpoint mutation error",e,t)}},this.endSessionMutation={mutationFn:BM,onSuccess:(e,t)=>{console.log("GameBridge: End session mutation success",e,t),kM.emit("bridge-session-ended",{sessionId:this.sessionId,deathData:t}),this.sessionId=null},onError:(e,t)=>{console.error("GameBridge: End session mutation error",e,t)}}}async startSession(){try{console.log("GameBridge: Starting session...");const e={userId:this.getCurrentUserId(),mapId:"87224afa-25e3-4bce-8fce-0981f854e6b6"};console.log("GameBridge: Session data prepared",e);const t=await CM(e);console.log("GameBridge: Session API response",t),this.sessionId=t.sessionId,this.lastSyncTime=Date.now(),console.log("GameBridge: Session started",this.sessionId,e),kM.emit("bridge-session-started",{sessionId:this.sessionId})}catch(e){console.error("GameBridge: Failed to start session",e),console.error("GameBridge: Error details",e.message,e.stack)}}async syncToBackend(e,t){if(this.sessionId)try{console.log("GameBridge: Starting backend sync...");const t={sessionId:this.sessionId,xp:e.experience||0,gold:e.gold||0,position:this.getPlayerPosition(),skillsUsed:this.getSkillsUsedWithCounts()};console.log("GameBridge: Checkpoint data prepared",t);const s=await MM(t);console.log("GameBridge: Checkpoint API response",s),console.log("GameBridge: Checkpoint saved:",t)}catch(s){console.error("GameBridge: Failed to save checkpoint",s),console.error("GameBridge: Checkpoint error details",s.message,s.stack)}else console.log("GameBridge: No session ID available for sync")}getPlayerPosition(){var e;return(null==(e=this.currentScene)?void 0:e.player)?`x${Math.floor(this.currentScene.player.x||0)}y${Math.floor(this.currentScene.player.y||0)}`:this.player?`x${Math.floor(this.player.x||0)}y${Math.floor(this.player.y||0)}`:"x0y0"}getSkillsUsedWithCounts(){var e,t,s;return(null==(t=null==(e=this.gameManager)?void 0:e.playerStats)?void 0:t.skillsUsed)?this.gameManager.playerStats.skillsUsed.map((e=>({skillId:e.skillId,uses:e.uses||e.count||1}))):(null==(s=this.currentScene)?void 0:s.skillsUsed)?this.currentScene.skillsUsed:[]}async endSession(e={}){if(this.sessionEnding)console.log("GameBridge: Session already ending, ignoring duplicate call");else{this.sessionId||console.log("GameBridge: No session ID available, but still sending death data"),this.sessionEnding=!0;try{console.log("GameBridge: Ending session...",e);const t={userId:this.getCurrentUserId(),deathReason:this.getDeathReason(e),causeOfDeath:this.getDeathReason(e),survivalTime:e.survivalTime||this.getGameProgress().survivalTime||0,enemiesKilled:e.enemiesKilled||0,goldEarned:e.goldEarned||0,maxLevel:e.maxLevel||1,kills:this.formatKillsData(e),skillsUsed:this.getSkillsUsed(),perfectRun:this.isPerfectRun(e),achievementPoints:this.calculateAchievementPoints(e)};console.log("GameBridge: Death payload prepared",t),console.log("GameBridge: Attempting to send death data to API...");const s=await BM(t);console.log("GameBridge: End session API response",s),console.log("GameBridge: Session ended with death data:",t),kM.emit("bridge-session-ended",{sessionId:this.sessionId,deathData:t}),kM.emit("invalidate-dashboard-data"),console.log("GameBridge: Dashboard data invalidation requested"),this.sessionId=null}catch(t){console.error("GameBridge: Failed to end session",t),console.error("GameBridge: End session error details",t.message,t.stack)}finally{this.sessionEnding=!1}}}getCurrentUserId(){const e=localStorage.getItem("access_token");if(e)try{const t=JSON.parse(atob(e.split(".")[1]));return t.userId||t.sub}catch(SD){console.warn("Failed to parse user ID from token")}return null}getCurrentMapId(){var e,t,s,i;return(null==(e=this.currentScene)?void 0:e.mapId)?this.currentScene.mapId:(null==(s=null==(t=this.currentScene)?void 0:t.scene)?void 0:s.key)?this.getMapIdFromSceneKey(this.currentScene.scene.key):(null==(i=this.gameManager)?void 0:i.currentMapId)?this.gameManager.currentMapId:"a1b32a8b-0ff3-432c-b787-dd1713f580d9"}getMapIdFromSceneKey(e){return{MainMapScene:"a1b32a8b-0ff3-432c-b787-dd1713f580d9",MiniMapBeachScene:"b2c43b9c-1aa4-543d-c898-ee2824g691ea",MiniMapDarkForastScene:"c3d54cad-2bb5-654e-d9a9-ff3935h7a2fb",MiniMapLavaScene:"d4e65dbe-3cc6-765f-eaba-004046i8b3gc",MiniMapBossFightScene:"e5f76ecf-4dd7-876g-fbc-115157j9c4hd"}[e]||"a1b32a8b-0ff3-432c-b787-dd1713f580d9"}getDeathReason(e){return e.deathReason?e.deathReason:0===e.enemiesKilled?"You barely survived the first wave":e.survivalTime<30?"Quick death, better luck next time":"You have failed emperor"}formatKillsData(e){const t=[];return e.enemiesKilled&&t.push({type:"regular",count:e.enemiesKilled}),e.bossKills&&t.push({type:"boss",count:e.bossKills}),0===t.length&&t.push({type:"regular",count:0}),t}getSkillsUsed(){var e,t,s;return(null==(t=null==(e=this.gameManager)?void 0:e.playerStats)?void 0:t.skillsUsed)?this.gameManager.playerStats.skillsUsed.map((e=>({skillId:e.skillId,tier:e.tier||e.level||1}))):(null==(s=this.currentScene)?void 0:s.skillsUsed)?this.currentScene.skillsUsed.map((e=>({skillId:e.skillId,tier:e.tier||e.level||1}))):[]}isPerfectRun(e){const t=this.getPlayerData();return t.health===t.maxHealth&&e.survivalTime>60&&e.enemiesKilled>10}calculateAchievementPoints(e){let t=0;return t+=10*(e.survivalTime||0),t+=100*(e.enemiesKilled||0),t+=1e3*(e.bossKills||0),this.isPerfectRun(e)&&(t*=2),t}getGameState(){return{player:this.getPlayerData(),progress:this.getGameProgress(),connected:this.isConnected,sessionId:this.sessionId}}isGameReady(){return!(!this.gameManager||!this.currentScene)}async forceSyncToBackend(){if(!this.sessionId)return void console.warn("GameBridge: No active session to sync");console.log("GameBridge: Force sync requested");const e=this.getPlayerData(),t=this.getGameProgress();console.log("GameBridge: Force sync data",{playerData:e,gameProgress:t}),await this.syncToBackend(e,t)}getSessionInfo(){return{sessionId:this.sessionId,isActive:!!this.sessionId,lastSyncTime:this.lastSyncTime}}}let pD=null;const fD=({showGoldIcon:e=!0})=>{const[t,s]=ga.useState({currentHP:100,maxHP:100,gold:500}),[i,a]=ga.useState(!0),[n,r]=ga.useState(!1),o=ga.useRef(!1);if(ga.useEffect((()=>{const e=e=>{console.log("HPBar: Health update received:",e),s((t=>({...t,currentHP:e.currentHP||e.health||e.hp||t.currentHP,maxHP:e.maxHP||e.maxHealth||e.maxHp||t.maxHP}))),r(!0),o.current=!0,a(!0)},t=e=>{if(s((t=>({currentHP:e.health||t.currentHP,maxHP:e.maxHealth||t.maxHP,gold:e.gold||t.gold}))),e.health>0&&e.maxHealth>0)return r(!0),o.current=!0,void a(!0);o.current||!1!==e.isInGame&&!1!==e.isAlive?!1!==e.isInGame&&a(!0):(a(!1),r(!1),o.current=!1)},i=e=>{s((t=>({...t,gold:e.gold||e.totalGold||t.gold})))};kM.on("player-health-updated",e),kM.on("player-hp-changed",e),kM.on("bridge-player-data",t),kM.on("player-gold-updated",i),kM.on("bridge-gold-updated",i);const n=()=>{console.log("HPBar: Game started - showing HP bar and marking as active"),r(!0),o.current=!0,a(!0)},l=()=>{console.log("HPBar: Game ended - marking as inactive"),r(!1),o.current=!1};kM.on("game-started",n),kM.on("main-scene-started",n),kM.on("current-scene-ready",n),kM.on("new-run-started",n),kM.on("player-death",l),kM.on("game-ended",l);const c=(pD||(pD=new dD),pD).getGameState();c&&c.player&&t(c.player);const h=setTimeout((()=>{console.log("HPBar: Fallback timer - ensuring HP bar is visible"),a(!0)}),2e3);return()=>{clearTimeout(h),kM.off("player-health-updated",e),kM.off("player-hp-changed",e),kM.off("bridge-player-data",t),kM.off("player-gold-updated",i),kM.off("bridge-gold-updated",i),kM.off("game-started",n),kM.off("main-scene-started",n),kM.off("current-scene-ready",n),kM.off("new-run-started",n),kM.off("player-death",l),kM.off("game-ended",l)}}),[]),!i)return null;const l=Math.max(0,Math.min(100,t.currentHP/t.maxHP*100)),c=l<25,h=l<10;return Ea.jsx("div",{children:i&&Ea.jsxs("div",{style:{position:"fixed",top:"2vh",left:"2vw",zIndex:9999,display:"flex",flexDirection:"column",gap:"10px"},children:[Ea.jsxs("div",{style:{position:"relative",width:"300px",height:"50px"},children:[Ea.jsx("div",{style:{position:"absolute",top:"0px",left:"0px",width:"200%",height:"250%",backgroundImage:"url(/assets/HUD/HUD_HP_BG_V01.png)",backgroundSize:"100% 100%",backgroundRepeat:"no-repeat",zIndex:1}}),Ea.jsx("div",{style:{position:"absolute",top:"26px",left:"60px",width:`calc((165% - 24px) * ${l/100})`,height:"calc(140% - 12px)",backgroundColor:l>50?"#4CAF50":l>25?"#FF9800":"#F44336",borderRadius:"3px",zIndex:2,transition:"width 0.3s ease-in-out, background-color 0.3s ease-in-out"}}),Ea.jsx("div",{style:{position:"absolute",top:"26px",left:"60px",width:"160%",height:"140%",backgroundImage:"url(/assets/HUD/HUD_HP_Indicator_Frame_V01.png)",backgroundSize:"100% 100%",backgroundRepeat:"no-repeat",zIndex:3}}),Ea.jsxs("div",{style:{position:"absolute",top:"130%",left:"100%",transform:"translate(-50%, -50%)",color:c?"#ff6b6b":"white",fontSize:"20px",fontWeight:"bold",textShadow:"2px 2px 4px rgba(0,0,0,0.9)",zIndex:4,pointerEvents:"none"},children:[Math.ceil(t.currentHP),"/",t.maxHP]}),c&&Ea.jsx("div",{style:{position:"absolute",top:"55px",left:"150px",transform:"translateX(-50%)",color:h?"#ff4444":"#ff8844",fontSize:"12px",fontWeight:"bold",textShadow:"1px 1px 2px rgba(0,0,0,0.9)",zIndex:4},children:h?"CRITICAL!":"LOW HEALTH!"})]}),e&&Ea.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",background:"rgba(0,0,0,0.7)",padding:"10px 15px",borderRadius:"25px",border:"2px solid #FFD700",marginTop:"65px",marginLeft:"10px"},children:[Ea.jsx("div",{style:{width:"30px",height:"30px",backgroundImage:"url(/assets/HUD/HUD_Gold_Icon_V01.png)",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center"}}),Ea.jsx("span",{style:{color:"#FFD700",fontSize:"20px",fontWeight:"bold",textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:t.gold.toLocaleString()})]})]})})},mD=()=>{const[e,t]=ga.useState({currentExp:0,maxExp:100,level:1}),[s,i]=ga.useState(!0);if(ga.useEffect((()=>{const e=e=>{t((t=>({...t,currentExp:e.currentExp??e.experience??e.exp??t.currentExp,maxExp:e.maxExp??e.maxExperience??e.maxExp??t.maxExp,level:e.level??e.lvl??t.level})))},s=e=>{t((t=>({...t,currentExp:e.currentExp??e.experience??e.exp??t.currentExp,maxExp:e.maxExp??e.maxExperience??e.maxExp??t.maxExp,level:e.level??e.lvl??t.level})))},a=()=>{i(!0)},n=()=>{i(!1)},r=()=>{i(!1)};kM.on("player-exp-updated",e),kM.on("player-experience-updated",e),kM.on("player-stats-updated",s),kM.on("game-started",a),kM.on("game-stopped",n),kM.on("player-death",r),kM.on("main-scene-started",a);const o=t=>{t.detail&&e(t.detail)},l=e=>{e.detail&&s(e.detail)};return window.addEventListener("playerExpUpdated",o),window.addEventListener("playerExperienceUpdated",o),window.addEventListener("playerStatsUpdated",l),window.addEventListener("playerDeath",r),()=>{kM.removeListener("player-exp-updated",e),kM.removeListener("player-experience-updated",e),kM.removeListener("player-stats-updated",s),kM.removeListener("game-started",a),kM.removeListener("game-stopped",n),kM.removeListener("player-death",r),kM.removeListener("main-scene-started",a),window.removeEventListener("playerExpUpdated",o),window.removeEventListener("playerExperienceUpdated",o),window.removeEventListener("playerStatsUpdated",l),window.removeEventListener("playerDeath",r)}}),[]),!s)return null;const a=Math.max(0,Math.min(100,e.currentExp/e.maxExp*100));return Ea.jsx("div",{style:{position:"fixed",bottom:"3vh",left:"50%",transform:"translateX(-50%)",zIndex:9999},children:Ea.jsxs("div",{style:{position:"relative",width:"600px",height:"180px"},children:[Ea.jsx("div",{style:{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",backgroundImage:"url(/assets/HUD/HUD_Skill_Table_XP_BG_V01.png)",backgroundSize:"100% 100%",backgroundRepeat:"no-repeat",zIndex:2}}),Ea.jsx("div",{style:{position:"absolute",left:"48px",top:"26px",width:`calc((26.3vw) * ${a/100})`,height:"24px",backgroundImage:"url(/assets/HUD/HUD_Skill_Table_XP_Indicator_Animation_V01.png)",backgroundSize:"100% 100%",backgroundRepeat:"no-repeat",zIndex:1,transition:"width 0.5s ease-in-out"}}),Ea.jsx("div",{style:{position:"absolute",top:"60px",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"15px",zIndex:2},children:[1,2,3,4,5].map((e=>Ea.jsx("div",{style:{position:"relative",width:"60px",height:"60px",backgroundColor:"rgba(0,0,0,0.5)",border:"2px solid #654321",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:Ea.jsx("div",{style:{position:"absolute",bottom:"-3px",right:"-3px",width:"20px",height:"20px",backgroundColor:"rgba(0,0,0,0.8)",border:"1px solid #FFD700",borderRadius:"50%",color:"#FFD700",fontSize:"12px",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",zIndex:6},children:e})},e)))}),Ea.jsxs("div",{style:{position:"absolute",left:"24px",color:"#FFD700",fontSize:"20px",top:"-5px",fontWeight:"bold",textShadow:"2px 2px 4px rgba(0,0,0,0.9)",zIndex:3,pointerEvents:"none"},children:["Lv.",e.level]}),Ea.jsxs("div",{style:{position:"absolute",top:"-5px",right:"24px",color:"white",fontSize:"20px",fontWeight:"bold",textShadow:"2px 2px 4px rgba(0,0,0,0.9)",zIndex:3,pointerEvents:"none"},children:[Math.floor(e.currentExp),"/",e.maxExp]})]})})},gD=()=>{const[e,t]=ga.useState("00:00"),[s,i]=ga.useState(1),[a,n]=ga.useState(!1);return ga.useEffect((()=>{const e=()=>{n(!0)},s=()=>{n(!1)},a=e=>{e.formattedTime&&t(e.formattedTime),void 0!==e.currentWave&&i(e.currentWave)},r=e=>{void 0!==e.wave&&i(e.wave)};return kM.on("timer-start",e),kM.on("timer-stop",s),kM.on("timer-updated",a),kM.on("wave-updated",r),kM.on("wave-notification",r),()=>{kM.off("timer-start",e),kM.off("timer-stop",s),kM.off("timer-updated",a),kM.off("wave-updated",r),kM.off("wave-notification",r)}}),[]),ga.useEffect((()=>(window.reactTimerState={time:e,currentWave:s,isGameRunning:a,getGameScene:()=>{var e,t,s,i,a;return(null==(t=null==(e=window.game)?void 0:e.scene)?void 0:t.getScene("MainMapScene"))||(null==(a=null==(i=null==(s=window.game)?void 0:s.scene)?void 0:i.scenes)?void 0:a.find((e=>"MainMapScene"===e.scene.key)))||window.currentGameScene}},()=>{delete window.reactTimerState})),[e,s,a]),Ea.jsx("div",{style:{position:"fixed",top:"2vh",left:"50%",transform:"translateX(-50%)",zIndex:9999},children:Ea.jsxs("div",{style:{position:"relative",width:"280px",height:"120px",display:"flex",flexDirection:"column",alignItems:"center"},children:[Ea.jsx("div",{style:{position:"absolute",top:"0px",left:"50%",transform:"translateX(-50%)",width:"240px",height:"80px",backgroundImage:"url(/assets/HUD/HUD_Timer_Shroud_Top_V01.png)",backgroundSize:"100% 100%",backgroundRepeat:"no-repeat",zIndex:1}}),Ea.jsx("div",{style:{position:"absolute",top:"35%",left:"50%",transform:"translateX(-50%)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:3},children:Ea.jsx("div",{style:{color:"white",fontSize:"40px",fontWeight:"bold",textShadow:"2px 2px 4px rgba(0,0,0,0.9)",letterSpacing:"1px"},children:e})}),Ea.jsx("div",{style:{position:"absolute",top:"65%",left:"50%",transform:"translateX(-50%)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:3},children:Ea.jsxs("div",{style:{color:"#FFD700",fontSize:"20px",fontWeight:"bold",textShadow:"2px 2px 4px rgba(0,0,0,0.9)",letterSpacing:"1px"},children:["WAVE ",s]})}),Ea.jsx("div",{style:{position:"absolute",top:"80%",left:"50%",transform:"translateX(-50%)",width:"200px",height:"60px",backgroundImage:"url(/assets/HUD/HUD_Timer_Shroud_Bottom_V01.png)",backgroundSize:"100% 100%",backgroundRepeat:"no-repeat",zIndex:1}}),!1]})})},yD=()=>{const[e,t]=ga.useState(null);return ga.useEffect((()=>{const e=e=>{const s={id:Date.now(),text:`WAVE ${e.wave||e.value||1}`,timestamp:Date.now()};t(s),setTimeout((()=>{t(null)}),3e3)};return kM.on("wave-notification",e),()=>{kM.removeListener("wave-notification",e)}}),[]),e?Ea.jsxs("div",{style:{position:"fixed",bottom:"20vh",left:"50%",transform:"translateX(-50%)",width:"220px",height:"80px",zIndex:1e4,pointerEvents:"none",backgroundImage:"url(/assets/HUD/HUD_Timer_Shroud_Top_V01.png)",backgroundSize:"100% 100%",backgroundRepeat:"no-repeat",display:"flex",alignItems:"center",justifyContent:"center",animation:"simpleFade 3s ease-in-out forwards"},children:[Ea.jsx("div",{style:{color:"#FFD700",marginTop:"5vh",fontSize:"20px",fontWeight:"bold",textShadow:"1px 1px 2px rgba(0,0,0,1)",letterSpacing:"1px",textAlign:"center",whiteSpace:"nowrap"},children:e.text}),Ea.jsx("style",{jsx:!0,children:"\n                @keyframes simpleFade {\n                    0% { opacity: 0; }\n                    20% { opacity: 1; }\n                    80% { opacity: 1; }\n                    100% { opacity: 0; }\n                }\n            "})]}):null},bD=({children:e})=>{const{user:t,isLoading:s}=Qv();return s?Ea.jsx("div",{children:"Loading..."}):t?e:Ea.jsx(Wg,{to:"/login",replace:!0})},vD=({children:e})=>{const{user:t,isLoading:s}=Qv();return s?Ea.jsx("div",{children:"Loading..."}):t?Ea.jsx(Wg,{to:"/",replace:!0}):e};function wD(){const e=ga.useRef(),[t,s]=ga.useState("menu"),[i,a]=ga.useState(!1),[n,r]=ga.useState(null),{setGameControls:o}=Kv(),l=Bg(),c=Ng(),h=()=>{var t;s("playing"),a(!0),(null==(t=e.current)?void 0:t.startGame)&&e.current.startGame()},u=()=>{var t;s("menu"),a(!1),(null==(t=e.current)?void 0:t.stopGame)&&e.current.stopGame()};return ga.useEffect((()=>{o&&o({startGame:h,returnToMenu:u,gameState:t})}),[o,t]),ga.useEffect((()=>{"true"===new URLSearchParams(l.search).get("autostart")&&"menu"===t&&(console.log("Auto-starting game from URL parameter"),setTimeout((()=>{h()}),500))}),[l.search,t]),ga.useEffect((()=>{const e=()=>{s("playing"),a(!0)},i=()=>{s("menu"),a(!1),console.log("Game over - navigating to dashboard"),c("/")},n=()=>{u()};kM.on("game-started",e),kM.on("game-over",i),kM.on("return-to-menu",n);const r=e=>{"Escape"===e.key&&"playing"===t&&u()};return document.addEventListener("keydown",r),()=>{kM.removeListener("game-started",e),kM.removeListener("game-over",i),kM.removeListener("return-to-menu",n),document.removeEventListener("keydown",r)}}),[t]),Ea.jsxs("div",{style:{width:"100vw",height:"100vh",position:"relative",overflow:"hidden"},children:["menu"===t&&Ea.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:10},children:Ea.jsx(zB,{onStartGame:h})}),Ea.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:1,overflow:"hidden",display:"playing"===t?"block":"none"},children:Ea.jsx(uD,{ref:e,currentActiveScene:e=>{var t;"MainMapScene"===(null==(t=null==e?void 0:e.scene)?void 0:t.key)&&a(!0)},showModal:(e,t)=>{switch(console.log("Game modal requested:",{id:e,modalData:t}),e){case"PAUSE_MENU":s("paused");break;case"GAME_OVER":s("menu"),a(!1)}},autoStart:!1})}),"playing"===t&&Ea.jsxs(Ea.Fragment,{children:[i&&Ea.jsx(fD,{showGoldIcon:!0}),i&&Ea.jsx(mD,{}),i&&Ea.jsx(gD,{}),i&&Ea.jsx(yD,{}),Ea.jsx("div",{style:{position:"fixed",top:"2vh",right:"2vw",color:"white",fontSize:"14px",background:"rgba(0,0,0,0.7)",padding:"8px 12px",borderRadius:"4px",zIndex:1e3},children:"Press ESC to return to menu"})]}),"paused"===t&&Ea.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:Ea.jsxs("div",{style:{background:"#333",padding:"20px",borderRadius:"8px",color:"white",textAlign:"center"},children:[Ea.jsx("h2",{children:"Game Paused"}),Ea.jsx("button",{onClick:()=>s("playing"),style:{margin:"10px",padding:"10px 20px"},children:"Resume"}),Ea.jsx("button",{onClick:u,style:{margin:"10px",padding:"10px 20px"},children:"Return to Menu"})]})})]})}function xD(){return Ea.jsx("div",{className:"App",children:Ea.jsxs(Zg,{children:[Ea.jsx(qg,{path:"/login",element:Ea.jsx(vD,{children:Ea.jsx(bM,{})})}),Ea.jsxs(qg,{path:"/",element:Ea.jsx(bD,{children:Ea.jsx(YB,{})}),children:[Ea.jsx(qg,{index:!0,element:Ea.jsx(sR,{})}),Ea.jsx(qg,{path:"leaderboard",element:Ea.jsx(iR,{})}),Ea.jsx(qg,{path:"quest",element:Ea.jsx(aR,{})}),Ea.jsx(qg,{path:"market",element:Ea.jsx(nR,{})}),Ea.jsx(qg,{path:"guide",element:Ea.jsx(rR,{})}),Ea.jsx(qg,{path:"account",element:Ea.jsx(pR,{})}),Ea.jsx(qg,{path:"about",element:Ea.jsx(bD,{children:Ea.jsxs("div",{className:"p-8",children:[Ea.jsx("h1",{className:"text-display-1-alagard-bold",children:"Alagard title"}),Ea.jsx("h1",{className:"text-display-1-pixelify-bold",children:"Pixelify title"}),"// Heading Typography",Ea.jsx("h2",{className:"text-heading-1-alagard",children:"Alagard heading"}),Ea.jsx("h2",{className:"text-heading-1-pixelify-bold",children:"Pixelify heading"}),"// Body Typography",Ea.jsx("p",{className:"text-body-1-alagard",children:"Alagard body text"}),Ea.jsx("p",{className:"text-body-2-pixelify-bold",children:"Pixelify body text"}),"// Button Typography",Ea.jsx("button",{className:"text-button-56-alagard",children:"Alagard button"}),Ea.jsx("button",{className:"text-button-48-pixelify",children:"Pixelify button"})]})})}),Ea.jsx(qg,{path:"profile",element:Ea.jsx(bD,{children:Ea.jsxs("div",{className:"p-8",children:[Ea.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Profile"}),Ea.jsx("p",{children:"This is your profile page. Only accessible after login."})]})})}),Ea.jsx(qg,{path:"settings",element:Ea.jsx(bD,{children:Ea.jsxs("div",{className:"p-8",children:[Ea.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Settings"}),Ea.jsx("p",{children:"This is the settings page. Only accessible after login."})]})})}),Ea.jsx(qg,{path:"*",element:Ea.jsx(Wg,{to:"/",replace:!0})})]}),Ea.jsx(qg,{path:"/game/*",element:Ea.jsx(bD,{children:Ea.jsx(Zv,{children:Ea.jsx(wD,{})})})})]})})}const kD=new CB({defaultOptions:{queries:{staleTime:3e5,retry:1}}});function AD(){return Ea.jsx(LB,{client:kD,children:Ea.jsx(Wv,{children:Ea.jsx(IM,{children:Ea.jsx(fy,{children:Ea.jsx(xD,{})})})})})}Ta.createRoot(document.getElementById("root")).render(Ea.jsx(ya.StrictMode,{children:Ea.jsx(AD,{})}));
